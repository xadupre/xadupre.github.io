
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Benchmark, comparison torch - forward-backward &#8212; onnxcustom</title>
    
    <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
  
    
    <link rel="stylesheet"
      href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">
  
    
      
  
    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/pydata-sphinx-theme.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/style_notebook_snippet.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinxtrib-images/LightBox2/lightbox2/css/lightbox.css" />
    <link rel="stylesheet" type="text/css" href="../_static/my-styles.css" />
    
    <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">
  
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script src="../_static/require.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script src="../_static/sphinxtrib-images/LightBox2/lightbox2/js/jquery-1.11.0.min.js"></script>
    <script src="../_static/sphinxtrib-images/LightBox2/lightbox2/js/lightbox.min.js"></script>
    <script src="../_static/sphinxtrib-images/LightBox2/lightbox2_customize/jquery-noconflict.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Notebooks Gallery" href="../all_notebooks.html" />
    <link rel="prev" title="Examples Gallery" href="index.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/project_ico.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../tutorials/index.html">
  Tutorials
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../api/apis.html">
  API
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="index.html">
  Examples Gallery
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../all_notebooks.html">
  Notebooks Gallery
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../other_pages.html">
  Other pages
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../blog/blogindex.html">
  Blog Gallery
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_qextend_onnxruntime.html">
   Fast runtime with onnxruntime
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_benchmark_inference_standard.html">
   Benchmark inference for scikit-learn models
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_cbegin_opset.html">
   What is the opset number?
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_abegin_convert_pipeline.html">
   Train and deploy a scikit-learn pipeline
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_gexternal_lightgbm.html">
   Convert a pipeline with a LightGBM classifier
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_fbegin_investigate.html">
   Intermediate results and investigation
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_gbegin_cst.html">
   Store arrays in one onnx graph
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_dbegin_options_list.html">
   Black list operators when converting
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_orttraining_nn_gpu_fwbw.html">
   Forward backward on a neural network on GPU
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_orttraining_nn_gpu.html">
   Train a scikit-learn neural network with onnxruntime-training on GPU
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_gconverting.html">
   Modify the ONNX graph
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_woe_transformer.html">
   Converter for WOE
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_orttraining_linear_regression_fwbw.html">
   Train a linear regression with forward backward
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_bbegin_measure_time.html">
   Benchmark ONNX conversion
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_gbegin_dataframe.html">
   Dataframe as an input
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_funny_sigmoid.html">
   Funny discrepancies
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_orttraining_linear_regression.html">
   Train a linear regression with onnxruntime-training
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_gexternal_lightgbm_reg.html">
   Convert a pipeline with a LightGBM regressor
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_orttraining_nn_gpu_fwbw_nesterov.html">
   Forward backward on a neural network on GPU (Nesterov) and penalty
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_kcustom_converter_wrapper.html">
   Implement a new converter using other converters
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_dbegin_options.html">
   One model, many possible conversions with options
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_profile_ort.html">
   Profile onnxruntime execution
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_mcustom_parser.html">
   Change the number of outputs by adding a parser
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_jcustom_syntax.html">
   Two ways to implement a converter
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_gexternal_xgboost.html">
   Convert a pipeline with a XGBoost model
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_dbegin_options_zipmap.html">
   Choose appropriate output of a classifier
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_lcustom_options.html">
   A new converter with options
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_gbegin_transfer_learning.html">
   Transfer Learning with ONNX
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_profile_ort_onnx.html">
   Profiling of ONNX graph with onnxruntime
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_ebegin_float_double.html">
   Issues when switching to float
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_icustom_converter.html">
   Implement a new converter
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_benchmark_graph_opt.html">
   Benchmark onnxruntime optimization
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_orttraining_benchmark_fwbw.html">
   Benchmark, comparison scikit-learn - forward-backward
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_orttraining_benchmark.html">
   Benchmark, comparison scikit-learn - onnxruntime-training
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_benchmark_op_leakyrelu.html">
   Benchmark operator LeakyRelu
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_benchmark_op_short.html">
   Benchmark operator Slice
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Benchmark, comparison torch - forward-backward
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_catwoe_transformer.html">
   Converter for WOEEncoder from categorical_encoder
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_benchmark_ort_api.html">
   Benchmark onnxruntime API: run or …
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_orttraining_benchmark_fwbw_cls.html">
   Benchmark, comparison sklearn - forward-backward - classification
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_usparse_xgboost.html">
   TfIdf and sparse matrices
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_benchmark_inference.html">
   Benchmark inference for a linear regression
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_benchmark_onnx_function.html">
   Compares numpy to onnxruntime on simple functions
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_pextend_python_runtime.html">
   Fast design with a python runtime
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_benchmark_op.html">
   Benchmark and profile of operator Slice
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_mcustom_parser_dataframe.html">
   Add a parser to handle dataframes
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_orttraining_linear_regression_gpu.html">
   Train a linear regression with onnxruntime-training on GPU in details
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="plot_orttraining_linear_regression_cpu.html">
   Train a linear regression with onnxruntime-training in details
  </a>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#first-comparison-neural-network">
   First comparison: neural network
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#common-parameters-and-training-algorithm">
   Common parameters and training algorithm
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#profiling">
   Profiling
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#if-gpu-is-available">
   if GPU is available
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#linear-regression">
   Linear Regression
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#graphs">
   Graphs
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-gyexamples-plot-orttraining-benchmark-torch-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="benchmark-comparison-torch-forward-backward">
<span id="l-orttraining-benchmark-torch"></span><span id="sphx-glr-gyexamples-plot-orttraining-benchmark-torch-py"></span><h1>Benchmark, comparison torch - forward-backward<a class="headerlink" href="#benchmark-comparison-torch-forward-backward" title="Permalink to this headline">¶</a></h1>
<p>The benchmark compares the processing time between <a class="reference external" href="https://pytorch.org/">pytorch</a>
and <a class="reference external" href="https://github.com/microsoft/onnxruntime/tree/master/orttraining">onnxruntime-training</a> on a linear regression and a neural network.
This example starts from <a class="reference internal" href="plot_orttraining_linear_regression_fwbw.html#l-orttraining-linreg-fwbw"><span class="std std-ref">Train a linear regression with forward backward</span></a>
but uses <a class="reference external" href="https://pytorch.org/">pytorch</a> to replace the parts updating the gradients
and computing the error gradient. The training algorithm becomes:</p>
<img alt="../_images/onnxfwbwtorch.png" src="../_images/onnxfwbwtorch.png" />
<p>Class <a class="reference external" href="http://www.xavierdupre.fr/app/onnxcustom/helpsphinx/onnxmd/onnxruntime_python/training_partial.html#trainingagent">TrainingAgent</a> (from <a class="reference external" href="https://github.com/microsoft/onnxruntime/tree/master/orttraining">onnxruntime-training</a>) is still
used and wrapped into <a class="reference external" href="http://www.xavierdupre.fr/app/onnxcustom/helpsphinx/api/onnxruntime_python/training_torch.html#ortmodule">ORTModule</a>. This script then
follows the same instructions as <a class="reference internal" href="plot_orttraining_benchmark_fwbw.html#l-orttraining-benchmark-fwbw"><span class="std std-ref">Benchmark, comparison scikit-learn - forward-backward</span></a>
to compare <a class="reference external" href="https://pytorch.org/">pytorch</a> only against <a class="reference external" href="https://pytorch.org/">pytorch</a> and
<a class="reference external" href="https://github.com/microsoft/onnxruntime/tree/master/orttraining">onnxruntime-training</a>.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#first-comparison-neural-network" id="id1">First comparison: neural network</a></p></li>
<li><p><a class="reference internal" href="#common-parameters-and-training-algorithm" id="id2">Common parameters and training algorithm</a></p></li>
<li><p><a class="reference internal" href="#profiling" id="id3">Profiling</a></p></li>
<li><p><a class="reference internal" href="#if-gpu-is-available" id="id4">if GPU is available</a></p></li>
<li><p><a class="reference internal" href="#linear-regression" id="id5">Linear Regression</a></p></li>
<li><p><a class="reference internal" href="#graphs" id="id6">Graphs</a></p></li>
</ul>
</div>
<section id="first-comparison-neural-network">
<h2><a class="toc-backref" href="#id1">First comparison: neural network</a><a class="headerlink" href="#first-comparison-neural-network" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">DataFrame</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">onnxruntime</span> <span class="kn">import</span> <span class="n">get_device</span>
<span class="kn">from</span> <span class="nn">onnxruntime.training.ortmodule</span> <span class="kn">import</span> <span class="n">ORTModule</span>
<span class="kn">from</span> <span class="nn">pyquickhelper.pycode.profiling</span> <span class="kn">import</span> <span class="n">profile</span><span class="p">,</span> <span class="n">profile2graph</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_regression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>


<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_regression</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="common-parameters-and-training-algorithm">
<h2><a class="toc-backref" href="#id2">Common parameters and training algorithm</a><a class="headerlink" href="#common-parameters-and-training-algorithm" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">from_numpy</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convers a numpy array into a torch array and</span>
<span class="sd">    sets *device* and *requires_grad*.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">device</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
    <span class="n">v</span><span class="o">.</span><span class="n">requires_grad_</span><span class="p">(</span><span class="n">requires_grad</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">v</span>
</pre></div>
</div>
<p>Training, two functions with same code but it is easier
to distinguish between in the profiling.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">train_model_torch</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span>
                      <span class="n">profiler</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">from_numpy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">from_numpy</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>

    <span class="n">criterion</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">(</span><span class="n">reduction</span><span class="o">=</span><span class="s1">&#39;sum&#39;</span><span class="p">)</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="n">learning_rate</span><span class="p">)</span>
    <span class="n">losses</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_iter</span><span class="p">):</span>

        <span class="k">def</span> <span class="nf">step_train_torch</span><span class="p">():</span>
            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
            <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
            <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
            <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">loss</span>

        <span class="n">loss</span> <span class="o">=</span> <span class="n">step_train_torch</span><span class="p">()</span>
        <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">profiler</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">profiler</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">losses</span>


<span class="k">def</span> <span class="nf">train_model_ort</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span>
                    <span class="n">profiler</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">from_numpy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">from_numpy</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>

    <span class="n">criterion</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">(</span><span class="n">reduction</span><span class="o">=</span><span class="s1">&#39;sum&#39;</span><span class="p">)</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="n">learning_rate</span><span class="p">)</span>
    <span class="n">losses</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_iter</span><span class="p">):</span>

        <span class="k">def</span> <span class="nf">step_train_ort</span><span class="p">():</span>
            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
            <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
            <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
            <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">loss</span>

        <span class="n">loss</span> <span class="o">=</span> <span class="n">step_train_ort</span><span class="p">()</span>
        <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">profiler</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">profiler</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">losses</span>
</pre></div>
</div>
<p>Benchmark function</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">benchmark</span><span class="p">(</span><span class="n">model_torch</span><span class="p">,</span> <span class="n">model_ort</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[benchmark] </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
    <span class="n">begin</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">losses</span> <span class="o">=</span> <span class="n">train_model_torch</span><span class="p">(</span>
        <span class="n">model_torch</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">duration_torch</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">begin</span>
    <span class="n">length_torch</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">losses</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[benchmark] torch=</span><span class="si">%r</span><span class="s2"> iterations - </span><span class="si">%r</span><span class="s2"> seconds&quot;</span> <span class="o">%</span> <span class="p">(</span>
        <span class="n">length_torch</span><span class="p">,</span> <span class="n">duration_torch</span><span class="p">))</span>

    <span class="n">begin</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">losses</span> <span class="o">=</span> <span class="n">train_model_ort</span><span class="p">(</span><span class="n">model_ort</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">duration_ort</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">begin</span>
    <span class="n">length_ort</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">losses</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[benchmark] onxrt=</span><span class="si">%r</span><span class="s2"> iteration - </span><span class="si">%r</span><span class="s2"> seconds&quot;</span> <span class="o">%</span> <span class="p">(</span>
        <span class="n">length_ort</span><span class="p">,</span> <span class="n">duration_ort</span><span class="p">))</span>

    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">torch</span><span class="o">=</span><span class="n">duration_torch</span><span class="p">,</span> <span class="n">ort</span><span class="o">=</span><span class="n">duration_ort</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">iter_torch</span><span class="o">=</span><span class="n">length_torch</span><span class="p">,</span> <span class="n">iter_ort</span><span class="o">=</span><span class="n">length_ort</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">MLPNet</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">D_in</span><span class="p">,</span> <span class="n">D_out</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MLPNet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linear1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">D_in</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linear2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linear3</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">D_out</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">o1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linear1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">o2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linear2</span><span class="p">(</span><span class="n">o1</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">linear3</span><span class="p">(</span><span class="n">o2</span><span class="p">)</span>


<span class="n">d_in</span><span class="p">,</span> <span class="n">d_out</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">model_torch</span> <span class="o">=</span> <span class="n">MLPNet</span><span class="p">(</span><span class="n">d_in</span><span class="p">,</span> <span class="n">d_out</span><span class="p">)</span>
<span class="n">model_ort</span> <span class="o">=</span> <span class="n">ORTModule</span><span class="p">(</span><span class="n">MLPNet</span><span class="p">(</span><span class="n">d_in</span><span class="p">,</span> <span class="n">d_out</span><span class="p">))</span>

<span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
<span class="n">benches</span> <span class="o">=</span> <span class="p">[</span><span class="n">benchmark</span><span class="p">(</span><span class="n">model_torch</span><span class="p">,</span> <span class="n">model_ort</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;NN-CPU&#39;</span><span class="p">)]</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[benchmark] NN-CPU
/var/lib/jenkins/workspace/onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/loss.py:520: UserWarning: Using a target size (torch.Size([1500])) that is different to the input size (torch.Size([1500, 1])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  return F.mse_loss(input, target, reduction=self.reduction)
[benchmark] torch=200 iterations - 27.19600000232458 seconds
/var/lib/jenkins/workspace/onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/onnxruntime/training/ortmodule/_training_manager.py:221: UserWarning: Fast path enabled - skipping checks. Rebuild graph: True, Execution agent: True, Device check: True
  warnings.warn(f&quot;Fast path enabled - skipping checks.&quot;
[benchmark] onxrt=200 iteration - 21.621971057727933 seconds
</pre></div>
</div>
</section>
<section id="profiling">
<h2><a class="toc-backref" href="#id3">Profiling</a><a class="headerlink" href="#profiling" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">clean_name</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;onnxruntime&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pos</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">text</span><span class="p">[</span><span class="n">pos</span><span class="p">:]</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;onnxcustom&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pos</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">text</span><span class="p">[</span><span class="n">pos</span><span class="p">:]</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;torch&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pos</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">text</span><span class="p">[</span><span class="n">pos</span><span class="p">:]</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;site-packages&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pos</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">text</span><span class="p">[</span><span class="n">pos</span><span class="p">:]</span>
    <span class="k">return</span> <span class="n">text</span>


<span class="n">ps</span> <span class="o">=</span> <span class="n">profile</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">benchmark</span><span class="p">(</span>
    <span class="n">model_torch</span><span class="p">,</span> <span class="n">model_ort</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;LR-CPU&#39;</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">root</span><span class="p">,</span> <span class="n">nodes</span> <span class="o">=</span> <span class="n">profile2graph</span><span class="p">(</span><span class="n">ps</span><span class="p">,</span> <span class="n">clean_text</span><span class="o">=</span><span class="n">clean_name</span><span class="p">)</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">to_text</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[benchmark] LR-CPU
/var/lib/jenkins/workspace/onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/loss.py:520: UserWarning: Using a target size (torch.Size([1500])) that is different to the input size (torch.Size([1500, 1])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  return F.mse_loss(input, target, reduction=self.reduction)
[benchmark] torch=200 iterations - 22.505997819826007 seconds
[benchmark] onxrt=200 iteration - 17.312450517900288 seconds
__contains__                                                 --  1600  1600 -- 0.00639 0.00756 -- /usr/local/lib/python3.9/enum.py:748:__contains__ (__contains__)
    &lt;built-in method builtins.isinstance&gt;                    --  1600  1600 -- 0.00117 0.00117 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
filter                                                       --    18    18 -- 0.00008 0.00019 -- /usr/local/lib/python3.9/logging/__init__.py:787:filter (filter)
    filter                                                   --    12    12 -- 0.00002 0.00002 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:358:filter (filter)
    filter                                                   --     6     6 -- 0.00005 0.00007 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:491:filter (filter)
        &lt;built-in method builtins.isinstance&gt;                --    18    18 -- 0.00001 0.00001 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
    &lt;built-in method builtins.hasattr&gt;                       --    18    18 -- 0.00003 0.00003 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
acquire                                                      --    30    30 -- 0.00007 0.00012 -- /usr/local/lib/python3.9/logging/__init__.py:892:acquire (acquire)
    &lt;method &#39;acquire&#39; of &#39;_thread.RLock&#39; objects&gt;            --    30    30 -- 0.00005 0.00005 -- ~:0:&lt;method &#39;acquire&#39; of &#39;_thread.RLock&#39; objects&gt; (&lt;method &#39;acquire&#39; of &#39;_thread.RLock&#39; objects&gt;)
release                                                      --    30    30 -- 0.00006 0.00008 -- /usr/local/lib/python3.9/logging/__init__.py:899:release (release)
    &lt;method &#39;release&#39; of &#39;_thread.RLock&#39; objects&gt;            --    30    30 -- 0.00002 0.00002 -- ~:0:&lt;method &#39;release&#39; of &#39;_thread.RLock&#39; objects&gt; (&lt;method &#39;release&#39; of &#39;_thread.RLock&#39; objects&gt;)
emit                                                         --    12    12 -- 0.00010 0.00291 -- /usr/local/lib/python3.9/logging/__init__.py:1067:emit (emit)
    format                                                   --    12    12 -- 0.00005 0.00061 -- /usr/local/lib/python3.9/logging/__init__.py:912:format (format)
        format                                               --    12    12 -- 0.00011 0.00056 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:536:format (format)
            format                                           --    12    12 -- 0.00008 0.00041 -- /usr/local/lib/python3.9/logging/__init__.py:646:format (format)
                usesTime                                     --    12    12 -- 0.00003 0.00009 -- /usr/local/lib/python3.9/logging/__init__.py:624:usesTime (usesTime)
                    usesTime                                 --    12    12 -- 0.00004 0.00006 -- /usr/local/lib/python3.9/logging/__init__.py:417:usesTime (usesTime)
                        &lt;method &#39;find&#39; of &#39;str&#39; objects&gt;     --    12    12 -- 0.00002 0.00002 -- ~:0:&lt;method &#39;find&#39; of &#39;str&#39; objects&gt; (&lt;method &#39;find&#39; of &#39;str&#39; objects&gt;)
                formatMessage                                --    12    12 -- 0.00002 0.00010 -- /usr/local/lib/python3.9/logging/__init__.py:630:formatMessage (formatMessage)
                    format                                   --    12    12 -- 0.00002 0.00007 -- /usr/local/lib/python3.9/logging/__init__.py:428:format (format)
                        _format                              --    12    12 -- 0.00005 0.00005 -- /usr/local/lib/python3.9/logging/__init__.py:425:_format (_format)
                getMessage                                   --    12    12 -- 0.00007 0.00014 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:96:getMessage (getMessage)
                    getMessage                               --    12    12 -- 0.00006 0.00006 -- /usr/local/lib/python3.9/logging/__init__.py:354:getMessage (getMessage)
                    &lt;built-in method builtins.getattr&gt;       --    12    12 -- 0.00001 0.00001 -- ~:0:&lt;built-in method builtins.getattr&gt; (&lt;built-in method builtins.getattr&gt;) +++
            colorize                                         --     2     2 -- 0.00002 0.00003 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/console.py:85:colorize (colorize)
                escseq                                       --     4     4 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/console.py:86:escseq (escseq)
            &lt;built-in method builtins.getattr&gt;               --    12    12 -- 0.00001 0.00001 -- ~:0:&lt;built-in method builtins.getattr&gt; (&lt;built-in method builtins.getattr&gt;) +++
    flush                                                    --    12    12 -- 0.00008 0.00213 -- /usr/local/lib/python3.9/logging/__init__.py:1056:flush (flush)
        acquire                                              --    12    12 -- 0.00002 0.00004 -- /usr/local/lib/python3.9/logging/__init__.py:892:acquire (acquire) +++
        release                                              --    12    12 -- 0.00003 0.00004 -- /usr/local/lib/python3.9/logging/__init__.py:899:release (release) +++
        flush                                                --     6     6 -- 0.00003 0.00196 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:562:flush (flush)
            &lt;method &#39;flush&#39; of &#39;_io.TextIOWrapper&#39; objects&gt;  --     6     6 -- 0.00193 0.00193 -- ~:0:&lt;method &#39;flush&#39; of &#39;_io.TextIOWrapper&#39; objects&gt; (&lt;method &#39;flush&#39; of &#39;_io.TextIOWrapper&#39; objects&gt;)
        &lt;built-in method builtins.hasattr&gt;                   --    12    12 -- 0.00001 0.00001 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
    write                                                    --     6     6 -- 0.00003 0.00004 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:554:write (write)
    write                                                    --     6     6 -- 0.00003 0.00004 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:572:write (write)
isEnabledFor                                                 --    12    12 -- 0.00002 0.00002 -- /usr/local/lib/python3.9/logging/__init__.py:1677:isEnabledFor (isEnabledFor)
__init__                                                     --     2     2 -- 0.00002 0.00002 -- /usr/local/lib/python3.9/warnings.py:403:__init__ (__init__)
from_numpy                                                   --     4     4 -- 0.00006 0.00016 -- onnxcustom/onnxcustom_UT_39_std/_doc/examples/plot_orttraining_benchmark_torch.py:51:from_numpy (from_numpy)
&lt;lambda&gt;                                                     --     1     1 -- 0.00271 39.82415 -- onnxcustom/onnxcustom_UT_39_std/_doc/examples/plot_orttraining_benchmark_torch.py:187:&lt;lambda&gt; (&lt;lambda&gt;)
    benchmark                                                --     1     1 -- 0.00460 39.82144 -- onnxcustom/onnxcustom_UT_39_std/_doc/examples/plot_orttraining_benchmark_torch.py:124:benchmark (benchmark)
        train_model_torch                                    --     1     1 -- 0.00344 22.50597 -- onnxcustom/onnxcustom_UT_39_std/_doc/examples/plot_orttraining_benchmark_torch.py:67:train_model_torch (train_model_torch)
            from_numpy                                       --     2     2 -- 0.00004 0.00009 -- onnxcustom/onnxcustom_UT_39_std/_doc/examples/plot_orttraining_benchmark_torch.py:51:from_numpy (from_numpy) +++
            step_train_torch                                 --   200   200 -- 0.00979 22.50023 -- onnxcustom/onnxcustom_UT_39_std/_doc/examples/plot_orttraining_benchmark_torch.py:78:step_train_torch (step_train_torch)
                backward                                     --   200   200 -- 0.00353 17.14371 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/_tensor.py:251:backward (backward) +++
                _call_impl                                   --   400   400 -- 0.00598 5.12884 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:1096:_call_impl (_call_impl) +++
                wrapper                                      --   200   200 -- 0.00996 0.13539 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/optim/optimizer.py:83:wrapper (wrapper) +++
                zero_grad                                    --   200   200 -- 0.02333 0.08251 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/optim/optimizer.py:189:zero_grad (zero_grad) +++
            __init__                                         --     1     1 -- 0.00001 0.00027 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/loss.py:516:__init__ (__init__) +++
            to                                               --     1     1 -- 0.00002 0.00128 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:795:to (to) +++
            __init__                                         --     1     1 -- 0.00002 0.00042 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/optim/sgd.py:82:__init__ (__init__) +++
            &lt;method &#39;append&#39; of &#39;list&#39; objects&gt;              --   200   200 -- 0.00022 0.00022 -- ~:0:&lt;method &#39;append&#39; of &#39;list&#39; objects&gt; (&lt;method &#39;append&#39; of &#39;list&#39; objects&gt;) +++
        train_model_ort                                      --     1     1 -- 0.00446 17.30797 -- onnxcustom/onnxcustom_UT_39_std/_doc/examples/plot_orttraining_benchmark_torch.py:94:train_model_ort (train_model_ort)
            from_numpy                                       --     2     2 -- 0.00001 0.00006 -- onnxcustom/onnxcustom_UT_39_std/_doc/examples/plot_orttraining_benchmark_torch.py:51:from_numpy (from_numpy) +++
            step_train_ort                                   --   200   200 -- 0.00973 17.30124 -- onnxcustom/onnxcustom_UT_39_std/_doc/examples/plot_orttraining_benchmark_torch.py:105:step_train_ort (step_train_ort)
                backward                                     --   200   200 -- 0.00323 12.09236 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/_tensor.py:251:backward (backward) +++
                _call_impl                                   --   400   400 -- 0.00780 4.97881 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:1096:_call_impl (_call_impl) +++
                wrapper                                      --   200   200 -- 0.01392 0.13474 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/optim/optimizer.py:83:wrapper (wrapper) +++
                zero_grad                                    --   200   200 -- 0.02388 0.08561 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/optim/optimizer.py:189:zero_grad (zero_grad) +++
            __init__                                         --     1     1 -- 0.00001 0.00027 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/loss.py:516:__init__ (__init__) +++
            to                                               --     1     1 -- 0.00002 0.00130 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:795:to (to) +++
            __init__                                         --     1     1 -- 0.00001 0.00041 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/optim/sgd.py:82:__init__ (__init__) +++
            &lt;method &#39;append&#39; of &#39;list&#39; objects&gt;              --   200   200 -- 0.00024 0.00024 -- ~:0:&lt;method &#39;append&#39; of &#39;list&#39; objects&gt; (&lt;method &#39;append&#39; of &#39;list&#39; objects&gt;) +++
        &lt;built-in method builtins.print&gt;                     --     3     3 -- 0.00005 0.00290 -- ~:0:&lt;built-in method builtins.print&gt; (&lt;built-in method builtins.print&gt;)
            write                                            --     6     6 -- 0.00012 0.00285 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx_gallery/gen_rst.py:81:write (write) +++
write                                                        --     7     7 -- 0.00014 0.00523 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx_gallery/gen_rst.py:81:write (write)
    verbose                                                  --     6     6 -- 0.00006 0.00507 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:135:verbose (verbose)
        log                                                  --     6     6 -- 0.00008 0.00501 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:128:log (log)
            log                                              --     6     6 -- 0.00010 0.00492 -- /usr/local/lib/python3.9/logging/__init__.py:1825:log (log)
                log                                          --     6     6 -- 0.00008 0.00472 -- /usr/local/lib/python3.9/logging/__init__.py:1485:log (log)
                    _log                                     --     6     6 -- 0.00006 0.00463 -- /usr/local/lib/python3.9/logging/__init__.py:1553:_log (_log)
                        findCaller                           --     6     6 -- 0.00012 0.00020 -- /usr/local/lib/python3.9/logging/__init__.py:1502:findCaller (findCaller)
                            &lt;lambda&gt;                         --     6     6 -- 0.00002 0.00003 -- /usr/local/lib/python3.9/logging/__init__.py:156:&lt;lambda&gt; (&lt;lambda&gt;)
                            normcase                         --    12    12 -- 0.00003 0.00004 -- /usr/local/lib/python3.9/posixpath.py:52:normcase (normcase)
                                &lt;built-in met...osix.fspath&gt; --    12    12 -- 0.00001 0.00001 -- ~:0:&lt;built-in method posix.fspath&gt; (&lt;built-in method posix.fspath&gt;) +++
                            &lt;built-in metho...ltins.hasattr&gt; --    12    12 -- 0.00001 0.00001 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
                        makeRecord                           --     6     6 -- 0.00006 0.00088 -- /usr/local/lib/python3.9/logging/__init__.py:1538:makeRecord (makeRecord)
                            __init__                         --     6     6 -- 0.00038 0.00082 -- /usr/local/lib/python3.9/logging/__init__.py:278:__init__ (__init__)
                                getLevelName                 --     6     6 -- 0.00005 0.00006 -- /usr/local/lib/python3.9/logging/__init__.py:119:getLevelName (getLevelName)
                                    &lt;method &#39;ge...&#39; objects&gt; --    12    12 -- 0.00001 0.00001 -- ~:0:&lt;method &#39;get&#39; of &#39;dict&#39; objects&gt; (&lt;method &#39;get&#39; of &#39;dict&#39; objects&gt;) +++
                                current_process              --     6     6 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/multiprocessing/process.py:37:current_process (current_process)
                                name                         --     6     6 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/multiprocessing/process.py:189:name (name)
                                splitext                     --     6     6 -- 0.00003 0.00011 -- /usr/local/lib/python3.9/posixpath.py:117:splitext (splitext)
                                    _splitext                --     6     6 -- 0.00005 0.00006 -- /usr/local/lib/python3.9/genericpath.py:121:_splitext (_splitext)
                                        &lt;method &#39;...objects&gt; --    12    12 -- 0.00002 0.00002 -- ~:0:&lt;method &#39;rfind&#39; of &#39;str&#39; objects&gt; (&lt;method &#39;rfind&#39; of &#39;str&#39; objects&gt;) +++
                                basename                     --     6     6 -- 0.00006 0.00010 -- /usr/local/lib/python3.9/posixpath.py:140:basename (basename)
                                    _get_sep                 --     6     6 -- 0.00001 0.00002 -- /usr/local/lib/python3.9/posixpath.py:41:_get_sep (_get_sep)
                                name                         --     6     6 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/threading.py:1053:name (name)
                                current_thread               --     6     6 -- 0.00002 0.00002 -- /usr/local/lib/python3.9/threading.py:1318:current_thread (current_thread)
                        handle                               --     6     6 -- 0.00003 0.00348 -- /usr/local/lib/python3.9/logging/__init__.py:1579:handle (handle)
                            filter                           --     6     6 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/logging/__init__.py:787:filter (filter) +++
                            callHandlers                     --     6     6 -- 0.00008 0.00344 -- /usr/local/lib/python3.9/logging/__init__.py:1633:callHandlers (callHandlers)
                                handle                       --    12    12 -- 0.00008 0.00337 -- /usr/local/lib/python3.9/logging/__init__.py:935:handle (handle)
                                    filter                   --    12    12 -- 0.00007 0.00018 -- /usr/local/lib/python3.9/logging/__init__.py:787:filter (filter) +++
                                    acquire                  --    12    12 -- 0.00004 0.00006 -- /usr/local/lib/python3.9/logging/__init__.py:892:acquire (acquire) +++
                                    release                  --    12    12 -- 0.00002 0.00003 -- /usr/local/lib/python3.9/logging/__init__.py:899:release (release) +++
                                    emit                     --     6     6 -- 0.00004 0.00042 -- /usr/local/lib/python3.9/logging/__init__.py:1067:emit (emit) +++
                                    emit                     --     6     6 -- 0.00007 0.00260 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:158:emit (emit)
                                        acquire              --     6     6 -- 0.00001 0.00002 -- /usr/local/lib/python3.9/logging/__init__.py:892:acquire (acquire) +++
                                        release              --     6     6 -- 0.00001 0.00002 -- /usr/local/lib/python3.9/logging/__init__.py:899:release (release) +++
                                        emit                 --     6     6 -- 0.00005 0.00249 -- /usr/local/lib/python3.9/logging/__init__.py:1067:emit (emit) +++
                    isEnabledFor                             --     6     6 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/logging/__init__.py:1677:isEnabledFor (isEnabledFor) +++
                isEnabledFor                                 --     6     6 -- 0.00002 0.00003 -- /usr/local/lib/python3.9/logging/__init__.py:1834:isEnabledFor (isEnabledFor)
                    isEnabledFor                             --     6     6 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/logging/__init__.py:1677:isEnabledFor (isEnabledFor) +++
                process                                      --     6     6 -- 0.00005 0.00006 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:138:process (process)
backward                                                     --   400   400 -- 0.00676 29.23606 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/_tensor.py:251:backward (backward)
    backward                                                 --   400   400 -- 0.00895 29.22903 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/autograd/__init__.py:69:backward (backward)
        _make_grads                                          --   400   400 -- 0.00951 0.02535 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/autograd/__init__.py:29:_make_grads (_make_grads)
            &lt;built-in method ones_like&gt;                      --   400   400 -- 0.01367 0.01367 -- ~:0:&lt;built-in method ones_like&gt; (&lt;built-in method ones_like&gt;)
            &lt;method &#39;numel&#39; of &#39;tor...._TensorBase&#39; objects&gt; --   400   400 -- 0.00073 0.00073 -- ~:0:&lt;method &#39;numel&#39; of &#39;torch._C._TensorBase&#39; objects&gt; (&lt;method &#39;numel&#39; of &#39;torch._C._TensorBase&#39; objects&gt;)
            &lt;method &#39;append&#39; of &#39;list&#39; objects&gt;              --   400   400 -- 0.00061 0.00061 -- ~:0:&lt;method &#39;append&#39; of &#39;list&#39; objects&gt; (&lt;method &#39;append&#39; of &#39;list&#39; objects&gt;) +++
            &lt;built-in method builtins.isinstance&gt;            --   400   400 -- 0.00082 0.00082 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
        _tensor_or_tensors_to_tuple                          --   400   400 -- 0.00129 0.00129 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/autograd/__init__.py:61:_tensor_or_tensors_to_tuple (_tensor_or_tensors_to_tuple)
        &lt;method &#39;run_backward&#39; of..._C._EngineBase&#39; objects&gt; --   400   400 -- 27.81035 29.19138 -- ~:0:&lt;method &#39;run_backward&#39; of &#39;torch._C._EngineBase&#39; objects&gt; (&lt;method &#39;run_backward&#39; of &#39;torch._C._EngineBase&#39; objects&gt;)
            apply                                            --   200   200 -- 0.00645 1.38102 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/autograd/function.py:189:apply (apply)
                backward                                     --   200   200 -- 0.07834 1.37457 -- onnxruntime/training/ortmodule/_training_manager.py:126:backward (backward)
                    run_backward                             --   200   200 -- 1.21328 1.21328 -- onnxruntime/training/ortmodule/_execution_agent.py:129:run_backward (run_backward)
                    is_set                                   --   200   200 -- 0.00133 0.00560 -- onnxruntime/training/ortmodule/_graph_execution_manager.py:59:is_set (is_set) +++
                    _ortvalue_to_torch_tensor                --  1400  1400 -- 0.03245 0.07078 -- onnxruntime/training/ortmodule/_utils.py:46:_ortvalue_to_torch_tensor (_ortvalue_to_torch_tensor) +++
                    _torch_tensor_to_dlpack                  --   200   200 -- 0.00196 0.00338 -- onnxruntime/training/ortmodule/_utils.py:56:_torch_tensor_to_dlpack (_torch_tensor_to_dlpack) +++
                    &lt;method &#39;is_contigu...nsorBase&#39; objects&gt; --   200   200 -- 0.00106 0.00106 -- ~:0:&lt;method &#39;is_contiguous&#39; of &#39;torch._C._TensorBase&#39; objects&gt; (&lt;method &#39;is_contiguous&#39; of &#39;torch._C._TensorBase&#39; objects&gt;) +++
                    &lt;method &#39;append&#39; of &#39;list&#39; objects&gt;      --  1400  1400 -- 0.00124 0.00124 -- ~:0:&lt;method &#39;append&#39; of &#39;list&#39; objects&gt; (&lt;method &#39;append&#39; of &#39;list&#39; objects&gt;) +++
                    &lt;built-in method builtins.len&gt;           --   400   400 -- 0.00088 0.00088 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;) +++
        &lt;built-in method builtins.isinstance&gt;                --   800   800 -- 0.00153 0.00153 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
        &lt;built-in method builtins.len&gt;                       --   400   400 -- 0.00054 0.00054 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;) +++
    &lt;built-in method torch._C._has_torch_function_unary&gt;     --   400   400 -- 0.00027 0.00027 -- ~:0:&lt;built-in method torch._C._has_torch_function_unary&gt; (&lt;built-in method torch._C._has_torch_function_unary&gt;) +++
__hash__                                                     --  4860  4860 -- 0.00763 0.01353 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/_tensor.py:650:__hash__ (__hash__)
    &lt;built-in method torch._C._has_torch_function_unary&gt;     --  4860  4860 -- 0.00247 0.00247 -- ~:0:&lt;built-in method torch._C._has_torch_function_unary&gt; (&lt;built-in method torch._C._has_torch_function_unary&gt;) +++
    &lt;built-in method builtins.id&gt;                            --  4860  4860 -- 0.00343 0.00343 -- ~:0:&lt;built-in method builtins.id&gt; (&lt;built-in method builtins.id&gt;)
grad                                                         --  14448  14448 -- 0.04387 0.05281 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/_tensor.py:1001:grad (grad)
    &lt;built-in method torch._C._has_torch_function_unary&gt;     --  14448  14448 -- 0.00894 0.00894 -- ~:0:&lt;built-in method torch._C._has_torch_function_unary&gt; (&lt;built-in method torch._C._has_torch_function_unary&gt;) +++
__init__                                                     --   424   424 -- 0.00695 0.00729 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/autograd/grad_mode.py:119:__init__ (__init__)
    is_scripting                                             --   424   424 -- 0.00034 0.00034 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/_jit_internal.py:957:is_scripting (is_scripting)
__enter__                                                    --   424   424 -- 0.00441 0.00899 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/autograd/grad_mode.py:124:__enter__ (__enter__)
    __init__                                                 --   424   424 -- 0.00269 0.00371 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/autograd/grad_mode.py:213:__init__ (__init__) +++
    &lt;built-in method torch._C.is_grad_enabled&gt;               --   424   424 -- 0.00087 0.00087 -- ~:0:&lt;built-in method torch._C.is_grad_enabled&gt; (&lt;built-in method torch._C.is_grad_enabled&gt;) +++
__exit__                                                     --   424   424 -- 0.00335 0.00626 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/autograd/grad_mode.py:128:__exit__ (__exit__)
    __init__                                                 --   424   424 -- 0.00186 0.00291 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/autograd/grad_mode.py:213:__init__ (__init__) +++
__init__                                                     --   848   848 -- 0.00454 0.00662 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/autograd/grad_mode.py:213:__init__ (__init__)
    &lt;built-in method torch._C._set_grad_enabled&gt;             --   848   848 -- 0.00095 0.00095 -- ~:0:&lt;built-in method torch._C._set_grad_enabled&gt; (&lt;built-in method torch._C._set_grad_enabled&gt;)
    &lt;built-in method torch._C.is_grad_enabled&gt;               --   848   848 -- 0.00113 0.00113 -- ~:0:&lt;built-in method torch._C.is_grad_enabled&gt; (&lt;built-in method torch._C.is_grad_enabled&gt;) +++
__init__                                                     --   800   800 -- 0.00921 0.04650 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/autograd/profiler.py:426:__init__ (__init__)
    &lt;built-in method zeros&gt;                                  --   800   800 -- 0.03729 0.03729 -- ~:0:&lt;built-in method zeros&gt; (&lt;built-in method zeros&gt;)
__enter__                                                    --   800   800 -- 0.01345 0.05612 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/autograd/profiler.py:434:__enter__ (__enter__)
    &lt;built-in method torch._ops...er._record_function_enter&gt; --   800   800 -- 0.04267 0.04267 -- ~:0:&lt;built-in method torch._ops.profiler._record_function_enter&gt; (&lt;built-in method torch._ops.profiler._record_function_enter&gt;)
__exit__                                                     --   800   800 -- 0.00571 0.01755 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/autograd/profiler.py:438:__exit__ (__exit__)
    &lt;built-in method torch._ops...ler._record_function_exit&gt; --   800   800 -- 0.01184 0.01184 -- ~:0:&lt;built-in method torch._ops.profiler._record_function_exit&gt; (&lt;built-in method torch._ops.profiler._record_function_exit&gt;)
__init__                                                     --     2     2 -- 0.00002 0.00054 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/loss.py:516:__init__ (__init__)
    __init__                                                 --     2     2 -- 0.00002 0.00052 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/loss.py:15:__init__ (__init__)
        __init__                                             --     2     2 -- 0.00010 0.00048 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:250:__init__ (__init__)
            __setattr__                                      --    22    22 -- 0.00025 0.00035 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:1180:__setattr__ (__setattr__) +++
        __setattr__                                          --     2     2 -- 0.00002 0.00003 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:1180:__setattr__ (__setattr__) +++
_apply                                                       --     2     9 -- 0.00073 0.00250 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:568:_apply (_apply)
    grad                                                     --    48    48 -- 0.00018 0.00023 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/_tensor.py:1001:grad (grad) +++
    __init__                                                 --    24    24 -- 0.00018 0.00019 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/autograd/grad_mode.py:119:__init__ (__init__) +++
    __enter__                                                --    24    24 -- 0.00016 0.00033 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/autograd/grad_mode.py:124:__enter__ (__enter__) +++
    __exit__                                                 --    24    24 -- 0.00012 0.00026 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/autograd/grad_mode.py:128:__exit__ (__exit__) +++
    _apply                                                   --     7     4 -- 0.00067 0.00238 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:568:_apply (_apply) +++
    compute_should_use_set_data                              --    24    24 -- 0.00013 0.00026 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:572:compute_should_use_set_data (compute_should_use_set_data)
        get_overwrite_module_params_on_conversion            --    24    24 -- 0.00002 0.00002 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/__future__.py:18:get_overwrite_module_params_on_conversion (get_overwrite_module_params_on_conversion)
        &lt;built-in method _has_compatible_shallow_copy_type&gt;  --    24    24 -- 0.00011 0.00011 -- ~:0:&lt;built-in method _has_compatible_shallow_copy_type&gt; (&lt;built-in method _has_compatible_shallow_copy_type&gt;)
    convert                                                  --    24    24 -- 0.00012 0.00033 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:893:convert (convert)
        &lt;method &#39;to&#39; of &#39;torch._C._TensorBase&#39; objects&gt;      --    24    24 -- 0.00015 0.00015 -- ~:0:&lt;method &#39;to&#39; of &#39;torch._C._TensorBase&#39; objects&gt; (&lt;method &#39;to&#39; of &#39;torch._C._TensorBase&#39; objects&gt;) +++
        &lt;method &#39;is_floating_poin..._C._TensorBase&#39; objects&gt; --    24    24 -- 0.00006 0.00006 -- ~:0:&lt;method &#39;is_floating_point&#39; of &#39;torch._C._TensorBase&#39; objects&gt; (&lt;method &#39;is_floating_point&#39; of &#39;torch._C._TensorBase&#39; objects&gt;)
    children                                                 --    16    16 -- 0.00005 0.00015 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:1597:children (children)
        named_children                                       --    16    16 -- 0.00009 0.00010 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:1606:named_children (named_children)
    &lt;method &#39;items&#39; of &#39;collections.OrderedDict&#39; objects&gt;    --    18    18 -- 0.00001 0.00001 -- ~:0:&lt;method &#39;items&#39; of &#39;collections.OrderedDict&#39; objects&gt; (&lt;method &#39;items&#39; of &#39;collections.OrderedDict&#39; objects&gt;) +++
to                                                           --     2     2 -- 0.00004 0.00258 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:795:to (to)
    _apply                                                   --     1     1 -- 0.00003 0.00125 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:568:_apply (_apply) +++
    _apply                                                   --     1     1 -- 0.00001 0.00127 -- onnxruntime/training/ortmodule/ortmodule.py:173:_apply (_apply)
        _apply                                               --     1     1 -- 0.00001 0.00126 -- onnxruntime/training/ortmodule/_torch_module_ort.py:27:_apply (_apply)
            _apply                                           --     1     1 -- 0.00002 0.00126 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:568:_apply (_apply) +++
_call_impl                                                   --   800  1400 -- 0.02115 10.10765 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:1096:_call_impl (_call_impl)
    forward                                                  --   200   200 -- 0.01635 3.10423 -- onnxcustom/onnxcustom_UT_39_std/_doc/examples/plot_orttraining_benchmark_torch.py:153:forward (forward)
        _call_impl                                           --   600   600 -- 0.00737 2.23022 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:1096:_call_impl (_call_impl) +++
        __getattr__                                          --   600   600 -- 0.01102 0.01102 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:1164:__getattr__ (__getattr__) +++
        &lt;built-in method sigmoid&gt;                            --   400   400 -- 0.84665 0.84665 -- ~:0:&lt;built-in method sigmoid&gt; (&lt;built-in method sigmoid&gt;)
    forward                                                  --   600   600 -- 0.00919 2.21962 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/linear.py:102:forward (forward)
        linear                                               --   600   600 -- 0.00371 2.20760 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/functional.py:1832:linear (linear)
            &lt;built-in method torch....rch_function_variadic&gt; --   600   600 -- 0.00087 0.00087 -- ~:0:&lt;built-in method torch._C._has_torch_function_variadic&gt; (&lt;built-in method torch._C._has_torch_function_variadic&gt;) +++
            &lt;built-in method torch._C._nn.linear&gt;            --   600   600 -- 2.20302 2.20302 -- ~:0:&lt;built-in method torch._C._nn.linear&gt; (&lt;built-in method torch._C._nn.linear&gt;)
        __getattr__                                          --  1200  1200 -- 0.00284 0.00284 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:1164:__getattr__ (__getattr__) +++
    forward                                                  --   400   400 -- 0.00896 6.12083 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/loss.py:519:forward (forward)
        mse_loss                                             --   400   400 -- 0.01514 6.11187 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/functional.py:3084:mse_loss (mse_loss)
            broadcast_tensors                                --   400   400 -- 0.00834 0.03776 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/functional.py:43:broadcast_tensors (broadcast_tensors)
                __getattr__                                  --   400   400 -- 0.00179 0.00246 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/_VF.py:25:__getattr__ (__getattr__)
                    &lt;built-in method builtins.getattr&gt;       --   400   400 -- 0.00068 0.00068 -- ~:0:&lt;built-in method builtins.getattr&gt; (&lt;built-in method builtins.getattr&gt;) +++
                &lt;built-in method torc..._has_torch_function&gt; --   400   400 -- 0.00047 0.00047 -- ~:0:&lt;built-in method torch._C._has_torch_function&gt; (&lt;built-in method torch._C._has_torch_function&gt;)
                &lt;built-in method broadcast_tensors&gt;          --   400   400 -- 0.02648 0.02648 -- ~:0:&lt;built-in method broadcast_tensors&gt; (&lt;built-in method broadcast_tensors&gt;)
            get_enum                                         --   400   400 -- 0.00101 0.00101 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/_reduction.py:7:get_enum (get_enum)
            &lt;built-in method torch....rch_function_variadic&gt; --   400   400 -- 0.00039 0.00039 -- ~:0:&lt;built-in method torch._C._has_torch_function_variadic&gt; (&lt;built-in method torch._C._has_torch_function_variadic&gt;) +++
            &lt;method &#39;size&#39; of &#39;torc...._TensorBase&#39; objects&gt; --  1600  1600 -- 0.00549 0.00549 -- ~:0:&lt;method &#39;size&#39; of &#39;torch._C._TensorBase&#39; objects&gt; (&lt;method &#39;size&#39; of &#39;torch._C._TensorBase&#39; objects&gt;)
            &lt;built-in method torch._C._nn.mse_loss&gt;          --   400   400 -- 6.02641 6.02641 -- ~:0:&lt;built-in method torch._C._nn.mse_loss&gt; (&lt;built-in method torch._C._nn.mse_loss&gt;)
            &lt;method &#39;format&#39; of &#39;str&#39; objects&gt;               --   400   400 -- 0.01483 0.01483 -- ~:0:&lt;method &#39;format&#39; of &#39;str&#39; objects&gt; (&lt;method &#39;format&#39; of &#39;str&#39; objects&gt;) +++
            &lt;built-in method _warnings.warn&gt;                 --   400   400 -- 0.00834 0.01083 -- ~:0:&lt;built-in method _warnings.warn&gt; (&lt;built-in method _warnings.warn&gt;) +++
    _forward                                                 --   200   200 -- 0.00129 0.86395 -- onnxruntime/training/ortmodule/_utils.py:301:_forward (_forward)
        _forward                                             --   200   200 -- 0.00302 0.86266 -- onnxruntime/training/ortmodule/_utils.py:280:_forward (_forward)
            __call__                                         --   200   200 -- 0.00033 0.00033 -- onnxruntime/training/ortmodule/_graph_execution_manager_factory.py:17:__call__ (__call__)
            is_training                                      --   200   200 -- 0.00133 0.00165 -- onnxruntime/training/ortmodule/_torch_module_ort.py:43:is_training (is_training)
                &lt;built-in method torch._C.is_grad_enabled&gt;   --   200   200 -- 0.00032 0.00032 -- ~:0:&lt;built-in method torch._C.is_grad_enabled&gt; (&lt;built-in method torch._C.is_grad_enabled&gt;) +++
            forward                                          --   200   200 -- 0.01515 0.85766 -- onnxruntime/training/ortmodule/_training_manager.py:203:forward (forward)
                is_pending                                   --   200   200 -- 0.00027 0.00027 -- onnxruntime/training/ortmodule/_fallback.py:153:is_pending (is_pending)
                maybe_update_cache_before_run                --   200   200 -- 0.00059 0.00085 -- onnxruntime/training/ortmodule/_gradient_accumulation_manager.py:66:maybe_update_cache_before_run (maybe_update_cache_before_run)
                    enabled                                  --   200   200 -- 0.00026 0.00026 -- onnxruntime/training/ortmodule/_gradient_accumulation_manager.py:45:enabled (enabled) +++
                is_set                                       --   400   400 -- 0.00176 0.00655 -- onnxruntime/training/ortmodule/_graph_execution_manager.py:59:is_set (is_set) +++
                _combine_input_buffers_initializers          --   200   200 -- 0.00503 0.04765 -- onnxruntime/training/ortmodule/_io.py:132:_combine_input_buffers_initializers (_combine_input_buffers_initializers)
                    is_primitive_type                        --   200   200 -- 0.00064 0.00064 -- onnxruntime/training/ortmodule/_io.py:65:is_primitive_type (is_primitive_type)
                    _expand_inputs                           --   200   200 -- 0.00174 0.01476 -- onnxruntime/training/ortmodule/_io.py:140:_expand_inputs (_expand_inputs) +++
                    &lt;dictcomp&gt;                               --   200   200 -- 0.00053 0.02666 -- onnxruntime/training/ortmodule/_io.py:165:&lt;dictcomp&gt; (&lt;dictcomp&gt;)
                        named_buffers                        --   200   200 -- 0.00165 0.02614 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:1571:named_buffers (named_buffers)
                            _named_members                   --   200   200 -- 0.00496 0.02449 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:1486:_named_members (_named_members) +++
                    &lt;method &#39;append&#39; of &#39;list&#39; objects&gt;      --   200   200 -- 0.00014 0.00014 -- ~:0:&lt;method &#39;append&#39; of &#39;list&#39; objects&gt; (&lt;method &#39;append&#39; of &#39;list&#39; objects&gt;) +++
                    &lt;method &#39;extend&#39; of &#39;list&#39; objects&gt;      --   200   200 -- 0.00041 0.00041 -- ~:0:&lt;method &#39;extend&#39; of &#39;list&#39; objects&gt; (&lt;method &#39;extend&#39; of &#39;list&#39; objects&gt;)
                unflatten_user_output                        --   200   200 -- 0.00123 0.00260 -- onnxruntime/training/ortmodule/_io.py:275:unflatten_user_output (unflatten_user_output)
                    _replace_stub_with_tensor_value          --   200   200 -- 0.00116 0.00137 -- onnxruntime/training/ortmodule/_io.py:278:_replace_stub_with_tensor_value (_replace_stub_with_tensor_value)
                        &lt;built-in method ...tins.isinstance&gt; --   200   200 -- 0.00020 0.00020 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
                &lt;built-in method apply&gt;                      --   200   200 -- 0.02316 0.78458 -- ~:0:&lt;built-in method apply&gt; (&lt;built-in method apply&gt;)
                    forward                                  --   200   200 -- 0.01059 0.76143 -- onnxruntime/training/ortmodule/_training_manager.py:81:forward (forward)
                        set_materialize_grads                --   200   200 -- 0.00098 0.00098 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/autograd/function.py:130:set_materialize_grads (set_materialize_grads)
                        is_set                               --   200   200 -- 0.00087 0.00298 -- onnxruntime/training/ortmodule/_graph_execution_manager.py:59:is_set (is_set) +++
                        execution_session_run_forward        --   200   200 -- 0.06922 0.74688 -- onnxruntime/training/ortmodule/_training_manager.py:39:execution_session_run_forward (execution_session_run_forward)
                            run_forward                      --   200   200 -- 0.47448 0.47448 -- onnxruntime/training/ortmodule/_execution_agent.py:119:run_forward (run_forward)
                            extract_outputs...e_update_cache --   200   200 -- 0.00573 0.02963 -- onnxruntime/training/ortmodule/_gradient_accumulation_manager.py:51:extract_outputs_and_maybe_update_cache (extract_outputs_and_maybe_update_cache)
                                enabled                      --   200   200 -- 0.00048 0.00048 -- onnxruntime/training/ortmodule/_gradient_accumulation_manager.py:45:enabled (enabled) +++
                                &lt;genexpr&gt;                    --   400   400 -- 0.00548 0.02137 -- onnxruntime/training/ortmodule/_gradient_accumulation_manager.py:58:&lt;genexpr&gt; (&lt;genexpr&gt;)
                                    _ortvalue_t...rch_tensor --   200   200 -- 0.00671 0.01589 -- onnxruntime/training/ortmodule/_utils.py:46:_ortvalue_to_torch_tensor (_ortvalue_to_torch_tensor) +++
                                &lt;built-in met...uiltins.len&gt; --   200   200 -- 0.00205 0.00205 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;) +++
                            __init__                         --   200   200 -- 0.00081 0.00081 -- onnxruntime/training/ortmodule/_graph_execution_manager.py:42:__init__ (__init__)
                            &lt;listcomp&gt;                       --   200   200 -- 0.00270 0.00270 -- onnxruntime/training/ortmodule/_training_manager.py:70:&lt;listcomp&gt; (&lt;listcomp&gt;)
                            _torch_tensor_to_dlpack          --  1400  1400 -- 0.00819 0.01720 -- onnxruntime/training/ortmodule/_utils.py:56:_torch_tensor_to_dlpack (_torch_tensor_to_dlpack) +++
                            clear_all_grad_fns               --   200   200 -- 0.01070 0.14831 -- onnxruntime/training/ortmodule/torch_cpp_extensions/cpu/torch_interop_utils/__init__.py:3:clear_all_grad_fns (clear_all_grad_fns)
                                _handle_fromlist             --   200   200 -- 0.00548 0.12528 -- &lt;frozen importlib._bootstrap&gt;:1033:_handle_fromlist (_handle_fromlist)
                                    _call_with_...es_removed --   200   200 -- 0.00067 0.11689 -- &lt;frozen importlib._bootstrap&gt;:220:_call_with_frames_removed (_call_with_frames_removed)
                                        &lt;built-in...mport__&gt; --   200   200 -- 0.00272 0.11621 -- ~:0:&lt;built-in method builtins.__import__&gt; (&lt;built-in method builtins.__import__&gt;)
                                            _find_and_load   --   200   200 -- 0.00485 0.11349 -- &lt;frozen importlib._bootstrap&gt;:1002:_find_and_load (_find_and_load)
                                                __init__     --   200   200 -- 0.00053 0.00053 -- &lt;frozen importlib._bootstrap&gt;:152:__init__ (__init__)
                                                __enter__    --   200   200 -- 0.00119 0.02100 -- &lt;frozen importlib._bootstrap&gt;:156:__enter__ (__enter__)
                                                    acquire  --   200   200 -- 0.00234 0.00284 -- &lt;frozen importlib._bootstrap&gt;:87:acquire (acquire)
                                                        &lt;...&lt;built-in method _thread.get_ident&gt; --   200   200 -- 0.00020 0.00020 -- ~:0:&lt;built-in method _thread.get_ident&gt; (&lt;built-in method _thread.get_ident&gt;) +++
                                                        &lt;...&lt;method &#39;__exit__&#39; of &#39;_thread.lock&#39; objects&gt; --   200   200 -- 0.00029 0.00029 -- ~:0:&lt;method &#39;__exit__&#39; of &#39;_thread.lock&#39; objects&gt; (&lt;method &#39;__exit__&#39; of &#39;_thread.lock&#39; objects&gt;) +++
                                                    _ge...ck --   200   200 -- 0.00761 0.01698 -- &lt;frozen importlib._bootstrap&gt;:166:_get_module_lock (_get_module_lock)
                                                        _...__init__ --   200   200 -- 0.00489 0.00869 -- &lt;frozen importlib._bootstrap&gt;:58:__init__ (__init__)
                                                            &lt;built-in method _thread.allocate_lock&gt; --   400   400 -- 0.00380 0.00380 -- ~:0:&lt;built-in method _thread.allocate_lock&gt; (&lt;built-in method _thread.allocate_lock&gt;)
                                                        &lt;...&lt;built-in method _imp.acquire_lock&gt; --   200   200 -- 0.00045 0.00045 -- ~:0:&lt;built-in method _imp.acquire_lock&gt; (&lt;built-in method _imp.acquire_lock&gt;) +++
                                                        &lt;...&lt;built-in method _imp.release_lock&gt; --   200   200 -- 0.00023 0.00023 -- ~:0:&lt;built-in method _imp.release_lock&gt; (&lt;built-in method _imp.release_lock&gt;) +++
                                                __exit__     --   200   200 -- 0.00075 0.00322 -- &lt;frozen importlib._bootstrap&gt;:160:__exit__ (__exit__)
                                                    release  --   200   200 -- 0.00203 0.00247 -- &lt;frozen importlib._bootstrap&gt;:112:release (release)
                                                        &lt;...&lt;built-in method _thread.get_ident&gt; --   200   200 -- 0.00019 0.00019 -- ~:0:&lt;built-in method _thread.get_ident&gt; (&lt;built-in method _thread.get_ident&gt;) +++
                                                        &lt;...&lt;method &#39;__exit__&#39; of &#39;_thread.lock&#39; objects&gt; --   200   200 -- 0.00025 0.00025 -- ~:0:&lt;method &#39;__exit__&#39; of &#39;_thread.lock&#39; objects&gt; (&lt;method &#39;__exit__&#39; of &#39;_thread.lock&#39; objects&gt;) +++
                                                cb           --   200   200 -- 0.00127 0.00168 -- &lt;frozen importlib._bootstrap&gt;:185:cb (cb)
                                                    &lt;me...s&gt; --   200   200 -- 0.00014 0.00014 -- ~:0:&lt;method &#39;get&#39; of &#39;dict&#39; objects&gt; (&lt;method &#39;get&#39; of &#39;dict&#39; objects&gt;) +++
                                                    &lt;bu...k&gt; --   200   200 -- 0.00015 0.00015 -- ~:0:&lt;built-in method _imp.acquire_lock&gt; (&lt;built-in method _imp.acquire_lock&gt;) +++
                                                    &lt;bu...k&gt; --   200   200 -- 0.00012 0.00012 -- ~:0:&lt;built-in method _imp.release_lock&gt; (&lt;built-in method _imp.release_lock&gt;) +++
                                                _find...cked --   200   200 -- 0.00428 0.08202 -- &lt;frozen importlib._bootstrap&gt;:967:_find_and_load_unlocked (_find_and_load_unlocked)
                                                    _fi...ec --   200   200 -- 0.01998 0.07622 -- &lt;frozen importlib._bootstrap&gt;:901:_find_spec (_find_spec)
                                                        f...find_spec --   200   200 -- 0.00016 0.00016 -- &lt;frozen importlib._bootstrap&gt;:736:find_spec (find_spec)
                                                        f...find_spec --   200   200 -- 0.00062 0.00101 -- &lt;frozen importlib._bootstrap&gt;:811:find_spec (find_spec)
                                                            &lt;built-in method _imp.is_frozen&gt; --   200   200 -- 0.00039 0.00039 -- ~:0:&lt;built-in method _imp.is_frozen&gt; (&lt;built-in method _imp.is_frozen&gt;)
                                                        _...__enter__ --  2000  2000 -- 0.00316 0.00449 -- &lt;frozen importlib._bootstrap&gt;:874:__enter__ (__enter__)
                                                            &lt;built-in method _imp.acquire_lock&gt; --  2000  2000 -- 0.00133 0.00133 -- ~:0:&lt;built-in method _imp.acquire_lock&gt; (&lt;built-in method _imp.acquire_lock&gt;) +++
                                                        _...__exit__ --  2000  2000 -- 0.00277 0.00408 -- &lt;frozen importlib._bootstrap&gt;:878:__exit__ (__exit__)
                                                            &lt;built-in method _imp.release_lock&gt; --  2000  2000 -- 0.00131 0.00131 -- ~:0:&lt;built-in method _imp.release_lock&gt; (&lt;built-in method _imp.release_lock&gt;) +++
                                                        f...find_spec --   200   200 -- 0.00091 0.04134 -- &lt;frozen importlib._bootstrap_external&gt;:1341:find_spec (find_spec)
                                                            _get_spec --   200   200 -- 0.00338 0.04043 -- &lt;frozen importlib._bootstrap_external&gt;:1309:_get_spec (_get_spec)
                                                                __init__ --   200   200 -- 0.00081 0.00081 -- &lt;frozen importlib._bootstrap&gt;:351:__init__ (__init__)
                                                                _path_importer_cache --   200   200 -- 0.00070 0.00070 -- &lt;frozen importlib._bootstrap_external&gt;:1272:_path_importer_cache (_path_importer_cache)
                                                                find_spec --   200   200 -- 0.01135 0.03507 -- &lt;frozen importlib._bootstrap_external&gt;:1438:find_spec (find_spec)
                                                                    _verbose_message --  1000  1000 -- 0.00205 0.00205 -- &lt;frozen importlib._bootstrap&gt;:231:_verbose_message (_verbose_message)
                                                                    _relax_case --   200   200 -- 0.00016 0.00016 -- &lt;frozen importlib._bootstrap_external&gt;:40:_relax_case (_relax_case)
                                                                    _path_join --  1000  1000 -- 0.00469 0.01179 -- &lt;frozen importlib._bootstrap_external&gt;:62:_path_join (_path_join)
                                                                        &lt;listcomp&gt; --  1000  1000 -- 0.00441 0.00575 -- &lt;frozen importlib._bootstrap_external&gt;:64:&lt;listcomp&gt; (&lt;listcomp&gt;)
                                                                            &lt;method &#39;rstrip&#39; of &#39;str&#39; objects&gt; --  2000  2000 -- 0.00134 0.00134 -- ~:0:&lt;method &#39;rstrip&#39; of &#39;str&#39; objects&gt; (&lt;method &#39;rstrip&#39; of &#39;str&#39; objects&gt;)
                                                                        &lt;method &#39;join&#39; of &#39;str&#39; objects&gt; --  1000  1000 -- 0.00136 0.00136 -- ~:0:&lt;method &#39;join&#39; of &#39;str&#39; objects&gt; (&lt;method &#39;join&#39; of &#39;str&#39; objects&gt;)
                                                                    _path_stat --   200   200 -- 0.00067 0.00941 -- &lt;frozen importlib._bootstrap_external&gt;:80:_path_stat (_path_stat)
                                                                        &lt;built-in method posix.stat&gt; --   200   200 -- 0.00874 0.00874 -- ~:0:&lt;built-in method posix.stat&gt; (&lt;built-in method posix.stat&gt;)
                                                                    &lt;method &#39;rpartition&#39; of &#39;str&#39; objects&gt; --   200   200 -- 0.00030 0.00030 -- ~:0:&lt;method &#39;rpartition&#39; of &#39;str&#39; objects&gt; (&lt;method &#39;rpartition&#39; of &#39;str&#39; objects&gt;) +++
                                                                &lt;built-in method builtins.hasattr&gt; --   200   200 -- 0.00034 0.00034 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
                                                                &lt;built-in method builtins.isinstance&gt; --   200   200 -- 0.00013 0.00013 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
                                                        f...find_spec --   200   200 -- 0.00019 0.00019 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/_distutils_hack/__init__.py:83:find_spec (find_spec)
                                                        f...find_spec --   200   200 -- 0.00044 0.00044 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/_virtualenv.py:54:find_spec (find_spec)
                                                        f...find_spec --   200   200 -- 0.00012 0.00012 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/importlib_metadata/_compat.py:51:find_spec (find_spec)
                                                        f...find_spec --   200   200 -- 0.00062 0.00202 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/pkg_resources/extern/__init__.py:57:find_spec (find_spec)
                                                            _module_matches_namespace --   200   200 -- 0.00103 0.00140 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/pkg_resources/extern/__init__.py:24:_module_matches_namespace (_module_matches_namespace)
                                                                &lt;method &#39;partition&#39; of &#39;str&#39; objects&gt; --   200   200 -- 0.00037 0.00037 -- ~:0:&lt;method &#39;partition&#39; of &#39;str&#39; objects&gt; (&lt;method &#39;partition&#39; of &#39;str&#39; objects&gt;) +++
                                                        f...find_spec --   200   200 -- 0.00064 0.00170 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/setuptools/extern/__init__.py:57:find_spec (find_spec)
                                                            _module_matches_namespace --   200   200 -- 0.00081 0.00106 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/setuptools/extern/__init__.py:24:_module_matches_namespace (_module_matches_namespace)
                                                                &lt;method &#39;partition&#39; of &#39;str&#39; objects&gt; --   200   200 -- 0.00026 0.00026 -- ~:0:&lt;method &#39;partition&#39; of &#39;str&#39; objects&gt; (&lt;method &#39;partition&#39; of &#39;str&#39; objects&gt;) +++
                                                        f...find_spec --   200   200 -- 0.00032 0.00032 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/six.py:194:find_spec (find_spec)
                                                        f...find_spec --   200   200 -- 0.00037 0.00037 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/urllib3/packages/six.py:190:find_spec (find_spec)
                                                    &lt;me...s&gt; --   200   200 -- 0.00044 0.00044 -- ~:0:&lt;method &#39;rpartition&#39; of &#39;str&#39; objects&gt; (&lt;method &#39;rpartition&#39; of &#39;str&#39; objects&gt;) +++
                                                    &lt;me...s&gt; --   200   200 -- 0.00108 0.00108 -- ~:0:&lt;method &#39;format&#39; of &#39;str&#39; objects&gt; (&lt;method &#39;format&#39; of &#39;str&#39; objects&gt;) +++
                                                &lt;meth...cts&gt; --   200   200 -- 0.00019 0.00019 -- ~:0:&lt;method &#39;get&#39; of &#39;dict&#39; objects&gt; (&lt;method &#39;get&#39; of &#39;dict&#39; objects&gt;) +++
                                    &lt;method &#39;ge...&#39; objects&gt; --   200   200 -- 0.00017 0.00017 -- ~:0:&lt;method &#39;get&#39; of &#39;dict&#39; objects&gt; (&lt;method &#39;get&#39; of &#39;dict&#39; objects&gt;) +++
                                    &lt;method &#39;fo...&#39; objects&gt; --   200   200 -- 0.00075 0.00075 -- ~:0:&lt;method &#39;format&#39; of &#39;str&#39; objects&gt; (&lt;method &#39;format&#39; of &#39;str&#39; objects&gt;) +++
                                    &lt;built-in m...s.hasattr&gt; --   200   200 -- 0.00187 0.00187 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
                                    &lt;built-in m...sinstance&gt; --   200   200 -- 0.00012 0.00012 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
                                &lt;built-in met...ll_grad_fns&gt; --   200   200 -- 0.00117 0.00117 -- ~:0:&lt;built-in method torch_interop_utils.clear_all_grad_fns&gt; (&lt;built-in method torch_interop_utils.clear_all_grad_fns&gt;)
                                &lt;built-in met...rnings.warn&gt; --   200   200 -- 0.01116 0.01116 -- ~:0:&lt;built-in method _warnings.warn&gt; (&lt;built-in method _warnings.warn&gt;) +++
                            &lt;method &#39;is_con...Base&#39; objects&gt; --  1400  1400 -- 0.00432 0.00432 -- ~:0:&lt;method &#39;is_contiguous&#39; of &#39;torch._C._TensorBase&#39; objects&gt; (&lt;method &#39;is_contiguous&#39; of &#39;torch._C._TensorBase&#39; objects&gt;) +++
                            &lt;built-in method builtins.len&gt;   --   200   200 -- 0.00023 0.00023 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;) +++
    &lt;built-in method torch._C._get_tracing_state&gt;            --  1400  1400 -- 0.00809 0.00809 -- ~:0:&lt;built-in method torch._C._get_tracing_state&gt; (&lt;built-in method torch._C._get_tracing_state&gt;)
__getattr__                                                  --  1800  1800 -- 0.01385 0.01385 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:1164:__getattr__ (__getattr__)
__setattr__                                                  --    24    24 -- 0.00028 0.00038 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:1180:__setattr__ (__setattr__)
    &lt;method &#39;get&#39; of &#39;dict&#39; objects&gt;                         --    72    72 -- 0.00004 0.00004 -- ~:0:&lt;method &#39;get&#39; of &#39;dict&#39; objects&gt; (&lt;method &#39;get&#39; of &#39;dict&#39; objects&gt;) +++
    &lt;built-in method builtins.isinstance&gt;                    --    48    48 -- 0.00006 0.00006 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
_named_members                                               --   214   214 -- 0.00508 0.02483 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:1486:_named_members (_named_members)
    __hash__                                                 --    12    12 -- 0.00003 0.00005 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/_tensor.py:650:__hash__ (__hash__) +++
    &lt;lambda&gt;                                                 --     8     8 -- 0.00002 0.00002 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:1544:&lt;lambda&gt; (&lt;lambda&gt;)
    &lt;lambda&gt;                                                 --  1000  1000 -- 0.00293 0.00358 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:1592:&lt;lambda&gt; (&lt;lambda&gt;)
        &lt;method &#39;items&#39; of &#39;colle...ns.OrderedDict&#39; objects&gt; --  1000  1000 -- 0.00065 0.00065 -- ~:0:&lt;method &#39;items&#39; of &#39;collections.OrderedDict&#39; objects&gt; (&lt;method &#39;items&#39; of &#39;collections.OrderedDict&#39; objects&gt;) +++
    named_modules                                            --  1210  1210 -- 0.00463 0.01605 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:1653:named_modules (named_modules) +++
    &lt;method &#39;add&#39; of &#39;set&#39; objects&gt;                          --    12    12 -- 0.00003 0.00005 -- ~:0:&lt;method &#39;add&#39; of &#39;set&#39; objects&gt; (&lt;method &#39;add&#39; of &#39;set&#39; objects&gt;) +++
parameters                                                   --    14    14 -- 0.00002 0.00040 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:1499:parameters (parameters)
    named_parameters                                         --    14    14 -- 0.00003 0.00038 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:1523:named_parameters (named_parameters)
        _named_members                                       --    14    14 -- 0.00012 0.00035 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:1486:_named_members (_named_members) +++
named_modules                                                --  1210  3422 -- 0.01457 0.01605 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:1653:named_modules (named_modules)
    named_modules                                            --  2212  1012 -- 0.00993 0.01108 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:1653:named_modules (named_modules) +++
    &lt;method &#39;items&#39; of &#39;collections.OrderedDict&#39; objects&gt;    --  1008  1008 -- 0.00050 0.00050 -- ~:0:&lt;method &#39;items&#39; of &#39;collections.OrderedDict&#39; objects&gt; (&lt;method &#39;items&#39; of &#39;collections.OrderedDict&#39; objects&gt;) +++
    &lt;method &#39;add&#39; of &#39;set&#39; objects&gt;                          --  1008  1008 -- 0.00099 0.00099 -- ~:0:&lt;method &#39;add&#39; of &#39;set&#39; objects&gt; (&lt;method &#39;add&#39; of &#39;set&#39; objects&gt;) +++
wrapper                                                      --   400   400 -- 0.02388 0.27012 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/optim/optimizer.py:83:wrapper (wrapper)
    decorate_context                                         --   400   400 -- 0.00742 0.18507 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/autograd/grad_mode.py:25:decorate_context (decorate_context)
        __init__                                             --   400   400 -- 0.00677 0.00710 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/autograd/grad_mode.py:119:__init__ (__init__) +++
        __enter__                                            --   400   400 -- 0.00425 0.00865 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/autograd/grad_mode.py:124:__enter__ (__enter__) +++
        __exit__                                             --   400   400 -- 0.00323 0.00600 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/autograd/grad_mode.py:128:__exit__ (__exit__) +++
        step                                                 --   400   400 -- 0.04397 0.15589 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/optim/sgd.py:102:step (step)
            __hash__                                         --  4812  4812 -- 0.00756 0.01340 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/_tensor.py:650:__hash__ (__hash__) +++
            grad                                             --  4800  4800 -- 0.01602 0.01865 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/_tensor.py:1001:grad (grad) +++
            sgd                                              --   400   400 -- 0.01417 0.07578 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/optim/_functional.py:146:sgd (sgd)
                &lt;method &#39;add_&#39; of &#39;to...TensorBase&#39; objects&gt; --  2400  2400 -- 0.06162 0.06162 -- ~:0:&lt;method &#39;add_&#39; of &#39;torch._C._TensorBase&#39; objects&gt; (&lt;method &#39;add_&#39; of &#39;torch._C._TensorBase&#39; objects&gt;)
            &lt;method &#39;append&#39; of &#39;list&#39; objects&gt;              --  7200  7200 -- 0.00409 0.00409 -- ~:0:&lt;method &#39;append&#39; of &#39;list&#39; objects&gt; (&lt;method &#39;append&#39; of &#39;list&#39; objects&gt;) +++
    __init__                                                 --   400   400 -- 0.00394 0.02138 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/autograd/profiler.py:426:__init__ (__init__) +++
    __enter__                                                --   400   400 -- 0.00654 0.02775 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/autograd/profiler.py:434:__enter__ (__enter__) +++
    __exit__                                                 --   400   400 -- 0.00286 0.00901 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/autograd/profiler.py:438:__exit__ (__exit__) +++
    &lt;method &#39;format&#39; of &#39;str&#39; objects&gt;                       --   400   400 -- 0.00303 0.00303 -- ~:0:&lt;method &#39;format&#39; of &#39;str&#39; objects&gt; (&lt;method &#39;format&#39; of &#39;str&#39; objects&gt;) +++
zero_grad                                                    --   400   400 -- 0.04721 0.16812 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/optim/optimizer.py:189:zero_grad (zero_grad)
    grad                                                     --  9600  9600 -- 0.02767 0.03392 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/_tensor.py:1001:grad (grad) +++
    __init__                                                 --   400   400 -- 0.00528 0.02512 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/autograd/profiler.py:426:__init__ (__init__) +++
    __enter__                                                --   400   400 -- 0.00691 0.02837 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/autograd/profiler.py:434:__enter__ (__enter__) +++
    __exit__                                                 --   400   400 -- 0.00285 0.00854 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/autograd/profiler.py:438:__exit__ (__exit__) +++
    &lt;method &#39;requires_grad_&#39; of...h._C._TensorBase&#39; objects&gt; --  2400  2400 -- 0.00744 0.00744 -- ~:0:&lt;method &#39;requires_grad_&#39; of &#39;torch._C._TensorBase&#39; objects&gt; (&lt;method &#39;requires_grad_&#39; of &#39;torch._C._TensorBase&#39; objects&gt;) +++
    &lt;method &#39;zero_&#39; of &#39;torch._C._TensorBase&#39; objects&gt;       --  2400  2400 -- 0.01662 0.01662 -- ~:0:&lt;method &#39;zero_&#39; of &#39;torch._C._TensorBase&#39; objects&gt; (&lt;method &#39;zero_&#39; of &#39;torch._C._TensorBase&#39; objects&gt;)
    &lt;built-in method builtins.hasattr&gt;                       --   400   400 -- 0.00090 0.00090 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
__init__                                                     --     2     2 -- 0.00003 0.00083 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/optim/sgd.py:82:__init__ (__init__)
    __init__                                                 --     2     2 -- 0.00008 0.00080 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/optim/optimizer.py:33:__init__ (__init__)
        parameters                                           --     7     7 -- 0.00001 0.00021 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:1499:parameters (parameters) +++
        _hook_for_profile                                    --     2     2 -- 0.00002 0.00003 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/optim/optimizer.py:78:_hook_for_profile (_hook_for_profile)
        add_param_group                                      --     2     2 -- 0.00015 0.00024 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/optim/optimizer.py:232:add_param_group (add_param_group)
            __hash__                                         --    24    24 -- 0.00003 0.00005 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/_tensor.py:650:__hash__ (__hash__) +++
            &lt;built-in method builtins.isinstance&gt;            --    18    18 -- 0.00002 0.00002 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
        parameters                                           --     7     7 -- 0.00001 0.00022 -- onnxruntime/training/ortmodule/ortmodule.py:233:parameters (parameters)
            parameters                                       --     7     7 -- 0.00001 0.00021 -- onnxruntime/training/ortmodule/_torch_module_ort.py:91:parameters (parameters)
                parameters                                   --     7     7 -- 0.00001 0.00019 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/module.py:1499:parameters (parameters) +++
enabled                                                      --   400   400 -- 0.00074 0.00074 -- onnxruntime/training/ortmodule/_gradient_accumulation_manager.py:45:enabled (enabled)
is_set                                                       --   800   800 -- 0.00396 0.01513 -- onnxruntime/training/ortmodule/_graph_execution_manager.py:59:is_set (is_set)
    __contains__                                             --   800   800 -- 0.00207 0.00241 -- /usr/local/lib/python3.9/enum.py:748:__contains__ (__contains__) +++
    is_disabled                                              --   800   800 -- 0.00361 0.00876 -- onnxruntime/training/ortmodule/_graph_execution_manager.py:67:is_disabled (is_disabled)
        __contains__                                         --   800   800 -- 0.00432 0.00515 -- /usr/local/lib/python3.9/enum.py:748:__contains__ (__contains__) +++
_expand_inputs                                               --   200   400 -- 0.00300 0.01476 -- onnxruntime/training/ortmodule/_io.py:140:_expand_inputs (_expand_inputs)
    _expand_inputs                                           --   200   200 -- 0.00126 0.00766 -- onnxruntime/training/ortmodule/_io.py:140:_expand_inputs (_expand_inputs) +++
    &lt;method &#39;append&#39; of &#39;list&#39; objects&gt;                      --   200   200 -- 0.00017 0.00017 -- ~:0:&lt;method &#39;append&#39; of &#39;list&#39; objects&gt; (&lt;method &#39;append&#39; of &#39;list&#39; objects&gt;) +++
    &lt;built-in method builtins.isinstance&gt;                    --  1000  1000 -- 0.00258 0.01158 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
_ortvalue_to_torch_tensor                                    --  1600  1600 -- 0.03916 0.08667 -- onnxruntime/training/ortmodule/_utils.py:46:_ortvalue_to_torch_tensor (_ortvalue_to_torch_tensor)
    _torch_tensor_from_dl_pack                               --  1600  1600 -- 0.02234 0.04752 -- onnxruntime/training/ortmodule/_utils.py:41:_torch_tensor_from_dl_pack (_torch_tensor_from_dl_pack)
        from_dlpack                                          --  1600  1600 -- 0.00448 0.02518 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/utils/dlpack.py:36:from_dlpack (from_dlpack)
            &lt;built-in method torch._C._from_dlpack&gt;          --  1600  1600 -- 0.01822 0.01822 -- ~:0:&lt;built-in method torch._C._from_dlpack&gt; (&lt;built-in method torch._C._from_dlpack&gt;)
            &lt;built-in method builtins.hasattr&gt;               --  1600  1600 -- 0.00248 0.00248 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
_torch_tensor_to_dlpack                                      --  1600  1600 -- 0.01015 0.02057 -- onnxruntime/training/ortmodule/_utils.py:56:_torch_tensor_to_dlpack (_torch_tensor_to_dlpack)
    &lt;built-in method torch._C._to_dlpack&gt;                    --  1600  1600 -- 0.00712 0.00712 -- ~:0:&lt;built-in method torch._C._to_dlpack&gt; (&lt;built-in method torch._C._to_dlpack&gt;)
    &lt;method &#39;is_contiguous&#39; of ...h._C._TensorBase&#39; objects&gt; --  1600  1600 -- 0.00330 0.00330 -- ~:0:&lt;method &#39;is_contiguous&#39; of &#39;torch._C._TensorBase&#39; objects&gt; (&lt;method &#39;is_contiguous&#39; of &#39;torch._C._TensorBase&#39; objects&gt;) +++
&lt;built-in method builtins.len&gt;                               --  1216  1216 -- 0.00371 0.00371 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;)
&lt;method &#39;append&#39; of &#39;list&#39; objects&gt;                          --  9802  9802 -- 0.00672 0.00672 -- ~:0:&lt;method &#39;append&#39; of &#39;list&#39; objects&gt; (&lt;method &#39;append&#39; of &#39;list&#39; objects&gt;)
&lt;method &#39;requires_grad_&#39; of &#39;torch._C._TensorBase&#39; objects&gt;  --  2404  2404 -- 0.00746 0.00746 -- ~:0:&lt;method &#39;requires_grad_&#39; of &#39;torch._C._TensorBase&#39; objects&gt; (&lt;method &#39;requires_grad_&#39; of &#39;torch._C._TensorBase&#39; objects&gt;)
&lt;method &#39;to&#39; of &#39;torch._C._TensorBase&#39; objects&gt;              --    28    28 -- 0.00017 0.00017 -- ~:0:&lt;method &#39;to&#39; of &#39;torch._C._TensorBase&#39; objects&gt; (&lt;method &#39;to&#39; of &#39;torch._C._TensorBase&#39; objects&gt;)
&lt;method &#39;format&#39; of &#39;str&#39; objects&gt;                           --  1202  1202 -- 0.01970 0.01970 -- ~:0:&lt;method &#39;format&#39; of &#39;str&#39; objects&gt; (&lt;method &#39;format&#39; of &#39;str&#39; objects&gt;)
&lt;built-in method builtins.hasattr&gt;                           --  2454  2454 -- 0.00565 0.00565 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;)
&lt;built-in method torch._C._has_torch_function_unary&gt;         --  19708  19708 -- 0.01168 0.01168 -- ~:0:&lt;built-in method torch._C._has_torch_function_unary&gt; (&lt;built-in method torch._C._has_torch_function_unary&gt;)
&lt;built-in method builtins.isinstance&gt;                        --  4518  4518 -- 0.00672 0.01576 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;)
    __instancecheck__                                        --   606   606 -- 0.00091 0.00904 -- /usr/local/lib/python3.9/abc.py:96:__instancecheck__ (__instancecheck__)
        &lt;built-in method _abc._abc_instancecheck&gt;            --   606   606 -- 0.00607 0.00813 -- ~:0:&lt;built-in method _abc._abc_instancecheck&gt; (&lt;built-in method _abc._abc_instancecheck&gt;)
            __subclasscheck__                                --   200   200 -- 0.00039 0.00207 -- /usr/local/lib/python3.9/abc.py:100:__subclasscheck__ (__subclasscheck__)
                &lt;built-in method _abc._abc_subclasscheck&gt;    --   200   200 -- 0.00133 0.00168 -- ~:0:&lt;built-in method _abc._abc_subclasscheck&gt; (&lt;built-in method _abc._abc_subclasscheck&gt;)
                    __subclasshook__                         --   200   200 -- 0.00034 0.00034 -- /usr/local/lib/python3.9/_collections_abc.py:311:__subclasshook__ (__subclasshook__)
&lt;method &#39;items&#39; of &#39;collections.OrderedDict&#39; objects&gt;        --  2043  2043 -- 0.00117 0.00117 -- ~:0:&lt;method &#39;items&#39; of &#39;collections.OrderedDict&#39; objects&gt; (&lt;method &#39;items&#39; of &#39;collections.OrderedDict&#39; objects&gt;)
&lt;built-in method builtins.getattr&gt;                           --   438   438 -- 0.00071 0.00071 -- ~:0:&lt;built-in method builtins.getattr&gt; (&lt;built-in method builtins.getattr&gt;)
&lt;method &#39;setdefault&#39; of &#39;dict&#39; objects&gt;                      --    16    16 -- 0.00002 0.00002 -- ~:0:&lt;method &#39;setdefault&#39; of &#39;dict&#39; objects&gt; (&lt;method &#39;setdefault&#39; of &#39;dict&#39; objects&gt;)
&lt;method &#39;get&#39; of &#39;dict&#39; objects&gt;                             --   704   704 -- 0.00057 0.00057 -- ~:0:&lt;method &#39;get&#39; of &#39;dict&#39; objects&gt; (&lt;method &#39;get&#39; of &#39;dict&#39; objects&gt;)
&lt;built-in method torch._C.is_grad_enabled&gt;                   --  1472  1472 -- 0.00232 0.00232 -- ~:0:&lt;built-in method torch._C.is_grad_enabled&gt; (&lt;built-in method torch._C.is_grad_enabled&gt;)
&lt;built-in method torch._C._has_torch_function_variadic&gt;      --  1000  1000 -- 0.00126 0.00126 -- ~:0:&lt;built-in method torch._C._has_torch_function_variadic&gt; (&lt;built-in method torch._C._has_torch_function_variadic&gt;)
&lt;built-in method _warnings.warn&gt;                             --   600   600 -- 0.01950 0.02199 -- ~:0:&lt;built-in method _warnings.warn&gt; (&lt;built-in method _warnings.warn&gt;)
    _showwarnmsg                                             --     1     1 -- 0.00002 0.00248 -- /usr/local/lib/python3.9/warnings.py:96:_showwarnmsg (_showwarnmsg)
        _showwarning                                         --     1     1 -- 0.00001 0.00246 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx_gallery/gen_rst.py:473:_showwarning (_showwarning)
            formatwarning                                    --     1     1 -- 0.00001 0.00006 -- /usr/local/lib/python3.9/warnings.py:15:formatwarning (formatwarning)
                _formatwarnmsg_impl                          --     1     1 -- 0.00003 0.00005 -- /usr/local/lib/python3.9/warnings.py:35:_formatwarnmsg_impl (_formatwarnmsg_impl)
                    getline                                  --     1     1 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/linecache.py:26:getline (getline)
                        getlines                             --     1     1 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/linecache.py:36:getlines (getlines)
                __init__                                     --     1     1 -- 0.00000 0.00000 -- /usr/local/lib/python3.9/warnings.py:403:__init__ (__init__) +++
            write                                            --     1     1 -- 0.00002 0.00239 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx_gallery/gen_rst.py:81:write (write) +++
    __init__                                                 --     1     1 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/warnings.py:403:__init__ (__init__) +++
&lt;method &#39;add&#39; of &#39;set&#39; objects&gt;                              --  1027  1027 -- 0.00102 0.00105 -- ~:0:&lt;method &#39;add&#39; of &#39;set&#39; objects&gt; (&lt;method &#39;add&#39; of &#39;set&#39; objects&gt;)
    __hash__                                                 --    12    12 -- 0.00002 0.00003 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/_tensor.py:650:__hash__ (__hash__) +++
&lt;method &#39;is_contiguous&#39; of &#39;torch._C._TensorBase&#39; objects&gt;   --  3200  3200 -- 0.00867 0.00867 -- ~:0:&lt;method &#39;is_contiguous&#39; of &#39;torch._C._TensorBase&#39; objects&gt; (&lt;method &#39;is_contiguous&#39; of &#39;torch._C._TensorBase&#39; objects&gt;)
&lt;built-in method posix.fspath&gt;                               --    24    24 -- 0.00001 0.00001 -- ~:0:&lt;built-in method posix.fspath&gt; (&lt;built-in method posix.fspath&gt;)
&lt;built-in method _thread.get_ident&gt;                          --   412   412 -- 0.00041 0.00041 -- ~:0:&lt;built-in method _thread.get_ident&gt; (&lt;built-in method _thread.get_ident&gt;)
&lt;method &#39;rfind&#39; of &#39;str&#39; objects&gt;                            --    18    18 -- 0.00004 0.00004 -- ~:0:&lt;method &#39;rfind&#39; of &#39;str&#39; objects&gt; (&lt;method &#39;rfind&#39; of &#39;str&#39; objects&gt;)
&lt;built-in method _imp.acquire_lock&gt;                          --  2400  2400 -- 0.00194 0.00194 -- ~:0:&lt;built-in method _imp.acquire_lock&gt; (&lt;built-in method _imp.acquire_lock&gt;)
&lt;built-in method _imp.release_lock&gt;                          --  2400  2400 -- 0.00166 0.00166 -- ~:0:&lt;built-in method _imp.release_lock&gt; (&lt;built-in method _imp.release_lock&gt;)
&lt;method &#39;rpartition&#39; of &#39;str&#39; objects&gt;                       --   400   400 -- 0.00074 0.00074 -- ~:0:&lt;method &#39;rpartition&#39; of &#39;str&#39; objects&gt; (&lt;method &#39;rpartition&#39; of &#39;str&#39; objects&gt;)
&lt;method &#39;__exit__&#39; of &#39;_thread.lock&#39; objects&gt;                --   400   400 -- 0.00054 0.00054 -- ~:0:&lt;method &#39;__exit__&#39; of &#39;_thread.lock&#39; objects&gt; (&lt;method &#39;__exit__&#39; of &#39;_thread.lock&#39; objects&gt;)
&lt;method &#39;partition&#39; of &#39;str&#39; objects&gt;                        --   400   400 -- 0.00063 0.00063 -- ~:0:&lt;method &#39;partition&#39; of &#39;str&#39; objects&gt; (&lt;method &#39;partition&#39; of &#39;str&#39; objects&gt;)
</pre></div>
</div>
</section>
<section id="if-gpu-is-available">
<h2><a class="toc-backref" href="#id4">if GPU is available</a><a class="headerlink" href="#if-gpu-is-available" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">get_device</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;GPU&#39;</span><span class="p">:</span>

    <span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">)</span>
    <span class="n">benches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">benchmark</span><span class="p">(</span><span class="n">model_torch</span><span class="p">,</span> <span class="n">model_ort</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;LR-GPU&#39;</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="linear-regression">
<h2><a class="toc-backref" href="#id5">Linear Regression</a><a class="headerlink" href="#linear-regression" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">LinearRegressionNet</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">D_in</span><span class="p">,</span> <span class="n">D_out</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">LinearRegressionNet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linear</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">D_in</span><span class="p">,</span> <span class="n">D_out</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">linear</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>


<span class="n">d_in</span><span class="p">,</span> <span class="n">d_out</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">model_torch</span> <span class="o">=</span> <span class="n">LinearRegressionNet</span><span class="p">(</span><span class="n">d_in</span><span class="p">,</span> <span class="n">d_out</span><span class="p">)</span>
<span class="n">model_ort</span> <span class="o">=</span> <span class="n">ORTModule</span><span class="p">(</span><span class="n">LinearRegressionNet</span><span class="p">(</span><span class="n">d_in</span><span class="p">,</span> <span class="n">d_out</span><span class="p">))</span>

<span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
<span class="n">benches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">benchmark</span><span class="p">(</span><span class="n">model_torch</span><span class="p">,</span> <span class="n">model_ort</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;LR-CPU&#39;</span><span class="p">))</span>


<span class="k">if</span> <span class="n">get_device</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;GPU&#39;</span><span class="p">:</span>

    <span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">)</span>
    <span class="n">benches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">benchmark</span><span class="p">(</span><span class="n">model_torch</span><span class="p">,</span> <span class="n">model_ort</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;LR-GPU&#39;</span><span class="p">))</span>

    <span class="c1">######################################</span>
    <span class="c1"># GPU profiling</span>
    <span class="c1"># +++++++++++++</span>

    <span class="k">if</span> <span class="n">get_device</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;GPU&#39;</span><span class="p">:</span>
        <span class="n">ps</span> <span class="o">=</span> <span class="n">profile</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">benchmark</span><span class="p">(</span>
            <span class="n">model_torch</span><span class="p">,</span> <span class="n">model_ort</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;LR-GPU&#39;</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">root</span><span class="p">,</span> <span class="n">nodes</span> <span class="o">=</span> <span class="n">profile2graph</span><span class="p">(</span><span class="n">ps</span><span class="p">,</span> <span class="n">clean_text</span><span class="o">=</span><span class="n">clean_name</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">to_text</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[benchmark] LR-CPU
/var/lib/jenkins/workspace/onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/torch/nn/modules/loss.py:520: UserWarning: Using a target size (torch.Size([1500])) that is different to the input size (torch.Size([1500, 1])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  return F.mse_loss(input, target, reduction=self.reduction)
[benchmark] torch=200 iterations - 4.432110550813377 seconds
/var/lib/jenkins/workspace/onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/onnxruntime/training/ortmodule/_training_manager.py:221: UserWarning: Fast path enabled - skipping checks. Rebuild graph: True, Execution agent: True, Device check: True
  warnings.warn(f&quot;Fast path enabled - skipping checks.&quot;
[benchmark] onxrt=200 iteration - 18.49321104120463 seconds
</pre></div>
</div>
</section>
<section id="graphs">
<h2><a class="toc-backref" href="#id6">Graphs</a><a class="headerlink" href="#graphs" title="Permalink to this headline">¶</a></h2>
<p>Dataframe first.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">benches</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>torch</th>
      <th>ort</th>
      <th>iter_torch</th>
      <th>iter_ort</th>
    </tr>
    <tr>
      <th>name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>NN-CPU</th>
      <td>27.196000</td>
      <td>21.621971</td>
      <td>200</td>
      <td>200</td>
    </tr>
    <tr>
      <th>LR-CPU</th>
      <td>4.432111</td>
      <td>18.493211</td>
      <td>200</td>
      <td>200</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<br />
<br /><p>text output</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>            torch        ort  iter_torch  iter_ort
name
NN-CPU  27.196000  21.621971         200       200
LR-CPU   4.432111  18.493211         200       200
</pre></div>
</div>
<p>Graphs.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;torch&#39;</span><span class="p">,</span> <span class="s1">&#39;ort&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Processing time&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="c1"># import matplotlib.pyplot as plt</span>
<span class="c1"># plt.show()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_orttraining_benchmark_torch_001.png" srcset="../_images/sphx_glr_plot_orttraining_benchmark_torch_001.png" alt="Processing time" class = "sphx-glr-single-img"/><p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Index([&#39;torch&#39;, &#39;ort&#39;, &#39;iter_torch&#39;, &#39;iter_ort&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 1 minutes  52.318 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-gyexamples-plot-orttraining-benchmark-torch-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/5710a3305be4e47a34662b3d7b1be481/plot_orttraining_benchmark_torch.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_orttraining_benchmark_torch.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/80cc4c34e84c651621dc749bb911677b/plot_orttraining_benchmark_torch.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_orttraining_benchmark_torch.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="index.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Examples Gallery</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../all_notebooks.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Notebooks Gallery</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
    <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2022, Xavier Dupré.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.4.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>