
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Benchmark, comparison scikit-learn - forward-backward &#8212; onnxcustom</title>
    
    <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
  
    
    <link rel="stylesheet"
      href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">
  
    
      
  
    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/pydata-sphinx-theme.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/style_notebook_snippet.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinxtrib-images/LightBox2/lightbox2/css/lightbox.css" />
    <link rel="stylesheet" type="text/css" href="../_static/my-styles.css" />
    
    <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">
  
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script src="../_static/require.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script src="../_static/sphinxtrib-images/LightBox2/lightbox2/js/jquery-1.11.0.min.js"></script>
    <script src="../_static/sphinxtrib-images/LightBox2/lightbox2/js/lightbox.min.js"></script>
    <script src="../_static/sphinxtrib-images/LightBox2/lightbox2_customize/jquery-noconflict.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Benchmark, comparison sklearn - forward-backward - classification" href="plot_orttraining_benchmark_fwbw_cls.html" />
    <link rel="prev" title="Forward backward on a neural network on GPU (Nesterov) and penalty" href="plot_orttraining_nn_gpu_fwbw_nesterov.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/project_ico.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../tutorials/index.html">
  Tutorials
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../api/apis.html">
  API
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="index.html">
  Examples Gallery
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../all_notebooks.html">
  Notebooks Gallery
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../other_pages.html">
  Other pages
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../blog/blogindex.html">
  Blog Gallery
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/tutorial_onnx/index.html">
   Introduction to ONNX
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/tutorial_onnxruntime/index.html">
   Introduction to onnxruntime
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/tutorial_skl/index.html">
   scikit-learn to ONNX Tutorial
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../tutorials/tutorial_training/index.html">
   Training Tutorial
  </a>
  <input checked class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/tutorial_training/tutorial_6_training.html">
     Full Training with OrtGradientOptimizer
    </a>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="../tutorials/tutorial_training/tutorial_6_training_partial.html">
     Partial Training with OrtGradientForwardBackwardOptimizer
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3">
      <a class="reference internal" href="plot_orttraining_linear_regression_fwbw.html">
       Train a linear regression with forward backward
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="plot_orttraining_nn_gpu_fwbw.html">
       Forward backward on a neural network on GPU
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="plot_orttraining_nn_gpu_fwbw_nesterov.html">
       Forward backward on a neural network on GPU (Nesterov) and penalty
      </a>
     </li>
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       Benchmark, comparison scikit-learn - forward-backward
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="plot_orttraining_benchmark_fwbw_cls.html">
       Benchmark, comparison sklearn - forward-backward - classification
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="plot_benchmark_onnx_function.html">
       Compares numpy to onnxruntime on simple functions
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/tutorial_bench/index.html">
   Benchmarking and profiling Tutorial
  </a>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#first-comparison-neural-network">
   First comparison: neural network
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#profiling">
   Profiling
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#if-gpu-is-available">
   if GPU is available
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#linear-regression">
   Linear Regression
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gpu-profiling">
   GPU profiling
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#graphs">
   Graphs
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-gyexamples-plot-orttraining-benchmark-fwbw-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="benchmark-comparison-scikit-learn-forward-backward">
<span id="l-orttraining-benchmark-fwbw"></span><span id="sphx-glr-gyexamples-plot-orttraining-benchmark-fwbw-py"></span><h1>Benchmark, comparison scikit-learn - forward-backward<a class="headerlink" href="#benchmark-comparison-scikit-learn-forward-backward" title="Permalink to this headline">¶</a></h1>
<p>The benchmark compares the processing time between <a class="reference external" href="https://scikit-learn.org/stable/">scikit-learn</a>
and <a class="reference external" href="https://github.com/microsoft/onnxruntime/tree/master/orttraining">onnxruntime-training</a> on a linear regression and a neural network.
It replicates the benchmark implemented in <a class="reference internal" href="plot_orttraining_benchmark.html#l-orttraining-benchmark"><span class="std std-ref">Benchmark, comparison scikit-learn - onnxruntime-training</span></a>
but uses the forward backward approach developped in
<a class="reference internal" href="plot_orttraining_linear_regression_fwbw.html#l-orttraining-linreg-fwbw"><span class="std std-ref">Train a linear regression with forward backward</span></a>.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#first-comparison-neural-network" id="id1">First comparison: neural network</a></p></li>
<li><p><a class="reference internal" href="#profiling" id="id2">Profiling</a></p></li>
<li><p><a class="reference internal" href="#if-gpu-is-available" id="id3">if GPU is available</a></p></li>
<li><p><a class="reference internal" href="#linear-regression" id="id4">Linear Regression</a></p></li>
<li><p><a class="reference internal" href="#gpu-profiling" id="id5">GPU profiling</a></p></li>
<li><p><a class="reference internal" href="#graphs" id="id6">Graphs</a></p></li>
</ul>
</div>
<section id="first-comparison-neural-network">
<h2><a class="toc-backref" href="#id1">First comparison: neural network</a><a class="headerlink" href="#first-comparison-neural-network" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">DataFrame</span>
<span class="kn">from</span> <span class="nn">onnxruntime</span> <span class="kn">import</span> <span class="n">get_device</span>
<span class="kn">from</span> <span class="nn">pyquickhelper.pycode.profiling</span> <span class="kn">import</span> <span class="n">profile</span><span class="p">,</span> <span class="n">profile2graph</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_regression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPRegressor</span>
<span class="kn">from</span> <span class="nn">mlprodict.onnx_conv</span> <span class="kn">import</span> <span class="n">to_onnx</span>
<span class="kn">from</span> <span class="nn">onnxcustom.utils.onnx_helper</span> <span class="kn">import</span> <span class="n">onnx_rename_weights</span>
<span class="kn">from</span> <span class="nn">onnxcustom.training.optimizers_partial</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">OrtGradientForwardBackwardOptimizer</span><span class="p">)</span>


<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_regression</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>Benchmark function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">benchmark</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">skl_model</span><span class="p">,</span> <span class="n">train_session</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :param skl_model: model from scikit-learn</span>
<span class="sd">    :param train_session: instance of OrtGradientForwardBackwardOptimizer</span>
<span class="sd">    :param name: experiment name</span>
<span class="sd">    :param verbose: to debug</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[benchmark] </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
    <span class="n">begin</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">skl_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">duration_skl</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">begin</span>
    <span class="n">length_skl</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">skl_model</span><span class="o">.</span><span class="n">loss_curve_</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[benchmark] skl=</span><span class="si">%r</span><span class="s2"> iterations - </span><span class="si">%r</span><span class="s2"> seconds&quot;</span> <span class="o">%</span> <span class="p">(</span>
        <span class="n">length_skl</span><span class="p">,</span> <span class="n">duration_skl</span><span class="p">))</span>

    <span class="n">begin</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">train_session</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">duration_ort</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">begin</span>
    <span class="n">length_ort</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_session</span><span class="o">.</span><span class="n">train_losses_</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[benchmark] ort=</span><span class="si">%r</span><span class="s2"> iteration - </span><span class="si">%r</span><span class="s2"> seconds&quot;</span> <span class="o">%</span> <span class="p">(</span>
        <span class="n">length_ort</span><span class="p">,</span> <span class="n">duration_ort</span><span class="p">))</span>

    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">skl</span><span class="o">=</span><span class="n">duration_skl</span><span class="p">,</span> <span class="n">ort</span><span class="o">=</span><span class="n">duration_ort</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">iter_skl</span><span class="o">=</span><span class="n">length_skl</span><span class="p">,</span> <span class="n">iter_ort</span><span class="o">=</span><span class="n">length_ort</span><span class="p">,</span>
                <span class="n">losses_skl</span><span class="o">=</span><span class="n">skl_model</span><span class="o">.</span><span class="n">loss_curve_</span><span class="p">,</span>
                <span class="n">losses_ort</span><span class="o">=</span><span class="n">train_session</span><span class="o">.</span><span class="n">train_losses_</span><span class="p">)</span>
</pre></div>
</div>
<p>Common parameters and model</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">max_iter</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">nn</span> <span class="o">=</span> <span class="n">MLPRegressor</span><span class="p">(</span><span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span><span class="p">,</span>
                  <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;sgd&#39;</span><span class="p">,</span> <span class="n">learning_rate_init</span><span class="o">=</span><span class="mf">5e-4</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                  <span class="n">n_iter_no_change</span><span class="o">=</span><span class="n">max_iter</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
                  <span class="n">nesterovs_momentum</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                  <span class="n">learning_rate</span><span class="o">=</span><span class="s2">&quot;invscaling&quot;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
<p>Conversion to ONNX and trainer initialization</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">onx</span> <span class="o">=</span> <span class="n">to_onnx</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="n">X_train</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="n">target_opset</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">onx</span> <span class="o">=</span> <span class="n">onnx_rename_weights</span><span class="p">(</span><span class="n">onx</span><span class="p">)</span>

<span class="n">train_session</span> <span class="o">=</span> <span class="n">OrtGradientForwardBackwardOptimizer</span><span class="p">(</span>
    <span class="n">onx</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span>
    <span class="n">warm_start</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>


<span class="n">benches</span> <span class="o">=</span> <span class="p">[</span><span class="n">benchmark</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">nn</span><span class="p">,</span> <span class="n">train_session</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;NN-CPU&#39;</span><span class="p">)]</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[benchmark] NN-CPU
/var/lib/jenkins/workspace/onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:692: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (100) reached and the optimization hasn&#39;t converged yet.
  warnings.warn(
[benchmark] skl=100 iterations - 9.95523340255022 seconds
[benchmark] ort=100 iteration - 9.524543109349906 seconds
</pre></div>
</div>
</section>
<section id="profiling">
<h2><a class="toc-backref" href="#id2">Profiling</a><a class="headerlink" href="#profiling" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">clean_name</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;onnxruntime&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pos</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">text</span><span class="p">[</span><span class="n">pos</span><span class="p">:]</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;sklearn&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pos</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">text</span><span class="p">[</span><span class="n">pos</span><span class="p">:]</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;onnxcustom&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pos</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">text</span><span class="p">[</span><span class="n">pos</span><span class="p">:]</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;site-packages&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pos</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">text</span><span class="p">[</span><span class="n">pos</span><span class="p">:]</span>
    <span class="k">return</span> <span class="n">text</span>


<span class="n">ps</span> <span class="o">=</span> <span class="n">profile</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">benchmark</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span>
             <span class="n">nn</span><span class="p">,</span> <span class="n">train_session</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;NN-CPU&#39;</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">root</span><span class="p">,</span> <span class="n">nodes</span> <span class="o">=</span> <span class="n">profile2graph</span><span class="p">(</span><span class="n">ps</span><span class="p">,</span> <span class="n">clean_text</span><span class="o">=</span><span class="n">clean_name</span><span class="p">)</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">to_text</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[benchmark] NN-CPU
/var/lib/jenkins/workspace/onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:692: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (100) reached and the optimization hasn&#39;t converged yet.
  warnings.warn(
[benchmark] skl=100 iterations - 11.28734419029206 seconds
[benchmark] ort=100 iteration - 11.375201171264052 seconds
filter                                                       --     18     18 -- 0.00007 0.00018 -- /usr/local/lib/python3.9/logging/__init__.py:787:filter (filter)
    filter                                                   --     12     12 -- 0.00002 0.00002 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:358:filter (filter)
    filter                                                   --      6      6 -- 0.00005 0.00006 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:491:filter (filter)
        &lt;built-in method builtins.isinstance&gt;                --     18     18 -- 0.00001 0.00001 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
    &lt;built-in method builtins.hasattr&gt;                       --     18     18 -- 0.00002 0.00002 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
acquire                                                      --     30     30 -- 0.00007 0.00012 -- /usr/local/lib/python3.9/logging/__init__.py:892:acquire (acquire)
    &lt;method &#39;acquire&#39; of &#39;_thread.RLock&#39; objects&gt;            --     30     30 -- 0.00005 0.00005 -- ~:0:&lt;method &#39;acquire&#39; of &#39;_thread.RLock&#39; objects&gt; (&lt;method &#39;acquire&#39; of &#39;_thread.RLock&#39; objects&gt;)
release                                                      --     30     30 -- 0.00006 0.00008 -- /usr/local/lib/python3.9/logging/__init__.py:899:release (release)
    &lt;method &#39;release&#39; of &#39;_thread.RLock&#39; objects&gt;            --     30     30 -- 0.00002 0.00002 -- ~:0:&lt;method &#39;release&#39; of &#39;_thread.RLock&#39; objects&gt; (&lt;method &#39;release&#39; of &#39;_thread.RLock&#39; objects&gt;)
emit                                                         --     12     12 -- 0.00009 0.00114 -- /usr/local/lib/python3.9/logging/__init__.py:1067:emit (emit)
    format                                                   --     12     12 -- 0.00004 0.00060 -- /usr/local/lib/python3.9/logging/__init__.py:912:format (format)
        format                                               --     12     12 -- 0.00010 0.00055 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:536:format (format)
            format                                           --     12     12 -- 0.00008 0.00041 -- /usr/local/lib/python3.9/logging/__init__.py:646:format (format)
                usesTime                                     --     12     12 -- 0.00003 0.00009 -- /usr/local/lib/python3.9/logging/__init__.py:624:usesTime (usesTime)
                    usesTime                                 --     12     12 -- 0.00004 0.00006 -- /usr/local/lib/python3.9/logging/__init__.py:417:usesTime (usesTime)
                        &lt;method &#39;find&#39; of &#39;str&#39; objects&gt;     --     12     12 -- 0.00002 0.00002 -- ~:0:&lt;method &#39;find&#39; of &#39;str&#39; objects&gt; (&lt;method &#39;find&#39; of &#39;str&#39; objects&gt;)
                formatMessage                                --     12     12 -- 0.00002 0.00009 -- /usr/local/lib/python3.9/logging/__init__.py:630:formatMessage (formatMessage)
                    format                                   --     12     12 -- 0.00002 0.00007 -- /usr/local/lib/python3.9/logging/__init__.py:428:format (format)
                        _format                              --     12     12 -- 0.00005 0.00005 -- /usr/local/lib/python3.9/logging/__init__.py:425:_format (_format)
                getMessage                                   --     12     12 -- 0.00007 0.00014 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:96:getMessage (getMessage)
                    getMessage                               --     12     12 -- 0.00006 0.00006 -- /usr/local/lib/python3.9/logging/__init__.py:354:getMessage (getMessage)
                    &lt;built-in method builtins.getattr&gt;       --     12     12 -- 0.00001 0.00001 -- ~:0:&lt;built-in method builtins.getattr&gt; (&lt;built-in method builtins.getattr&gt;) +++
            colorize                                         --      2      2 -- 0.00002 0.00003 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/console.py:85:colorize (colorize)
                escseq                                       --      4      4 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/console.py:86:escseq (escseq)
            &lt;built-in method builtins.getattr&gt;               --     12     12 -- 0.00001 0.00001 -- ~:0:&lt;built-in method builtins.getattr&gt; (&lt;built-in method builtins.getattr&gt;) +++
    flush                                                    --     12     12 -- 0.00007 0.00038 -- /usr/local/lib/python3.9/logging/__init__.py:1056:flush (flush)
        acquire                                              --     12     12 -- 0.00002 0.00004 -- /usr/local/lib/python3.9/logging/__init__.py:892:acquire (acquire) +++
        release                                              --     12     12 -- 0.00003 0.00004 -- /usr/local/lib/python3.9/logging/__init__.py:899:release (release) +++
        flush                                                --      6      6 -- 0.00003 0.00022 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:562:flush (flush)
            &lt;method &#39;flush&#39; of &#39;_io.TextIOWrapper&#39; objects&gt;  --      6      6 -- 0.00019 0.00019 -- ~:0:&lt;method &#39;flush&#39; of &#39;_io.TextIOWrapper&#39; objects&gt; (&lt;method &#39;flush&#39; of &#39;_io.TextIOWrapper&#39; objects&gt;)
        &lt;built-in method builtins.hasattr&gt;                   --     12     12 -- 0.00001 0.00001 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
    write                                                    --      6      6 -- 0.00003 0.00003 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:554:write (write)
    write                                                    --      6      6 -- 0.00003 0.00003 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:572:write (write)
isEnabledFor                                                 --     12     12 -- 0.00003 0.00003 -- /usr/local/lib/python3.9/logging/__init__.py:1677:isEnabledFor (isEnabledFor)
inner                                                        --      6      6 -- 0.00002 0.00002 -- /usr/local/lib/python3.9/typing.py:256:inner (inner)
cast                                                         --      6      6 -- 0.00000 0.00000 -- /usr/local/lib/python3.9/typing.py:1326:cast (cast)
__init__                                                     --      2      2 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/warnings.py:403:__init__ (__init__)
&lt;lambda&gt;                                                     --      1      1 -- 0.00001 22.66494 -- onnxcustom/onnxcustom_UT_39_std/_doc/examples/plot_orttraining_benchmark_fwbw.py:124:&lt;lambda&gt; (&lt;lambda&gt;)
    benchmark                                                --      1      1 -- 0.00013 22.66493 -- onnxcustom/onnxcustom_UT_39_std/_doc/examples/plot_orttraining_benchmark_fwbw.py:46:benchmark (benchmark)
        fit                                                  --      1      1 -- 0.00546 11.37516 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers_partial.py:263:fit (fit)
            __init__                                         --      1      1 -- 0.00004 0.00009 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/data_loader.py:31:__init__ (__init__)
                get_ort_device                               --      1      1 -- 0.00000 0.00000 -- onnxruntime_helper.py:63:get_ort_device (get_ort_device)
                numpy_to_ort_value                           --      2      2 -- 0.00001 0.00003 -- onnxruntime_helper.py:134:numpy_to_ort_value (numpy_to_ort_value) +++
            needs_grad                                       --      3      3 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers_partial.py:99:needs_grad (needs_grad)
                needs_grad                                   --      3      3 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/sgd_learning_rate.py:194:needs_grad (needs_grad)
            get_full_state                                   --    101    101 -- 0.00072 0.00221 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers_partial.py:147:get_full_state (get_full_state) +++
            set_state                                        --      2      2 -- 0.00013 0.00040 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers_partial.py:196:set_state (set_state)
                _get_att_state                               --      2      2 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers_partial.py:139:_get_att_state (_get_att_state) +++
                numpy_to_ort_value                           --     12     12 -- 0.00004 0.00021 -- onnxruntime_helper.py:134:numpy_to_ort_value (numpy_to_ort_value) +++
                &lt;method &#39;append&#39; of &#39;list&#39; objects&gt;          --     28     28 -- 0.00002 0.00002 -- ~:0:&lt;method &#39;append&#39; of &#39;list&#39; objects&gt; (&lt;method &#39;append&#39; of &#39;list&#39; objects&gt;) +++
                &lt;built-in method builtins.isinstance&gt;        --     12     12 -- 0.00001 0.00001 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
            &lt;listcomp&gt;                                       --      1      1 -- 0.00005 0.00293 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers_partial.py:311:&lt;listcomp&gt; (&lt;listcomp&gt;)
                get_initializer                              --      7      7 -- 0.00019 0.00287 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:280:get_initializer (get_initializer)
                    to_array                                 --      6      6 -- 0.00018 0.00268 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/onnx/numpy_helper.py:21:to_array (to_array)
                        uses_external_data                   --      6      6 -- 0.00002 0.00004 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/onnx/external_data_helper.py:224:uses_external_data (uses_external_data)
                        &lt;method &#39;HasField...essage&#39; objects&gt; --     12     12 -- 0.00004 0.00004 -- ~:0:&lt;method &#39;HasField&#39; of &#39;google.protobuf.pyext._message.CMessage&#39; objects&gt; (&lt;method &#39;HasField&#39; of &#39;google.protobuf.pyext._message.CMessage&#39; objects&gt;) +++
                        &lt;built-in method numpy.asarray&gt;      --      6      6 -- 0.00231 0.00231 -- ~:0:&lt;built-in method numpy.asarray&gt; (&lt;built-in method numpy.asarray&gt;) +++
            _iteration                                       --    100    100 -- 1.51192 11.31931 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers_partial.py:397:_iteration (_iteration)
                iter_ortvalue                                --   5100   5100 -- 0.11578 0.62476 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/data_loader.py:147:iter_ortvalue (iter_ortvalue)
                    _next_iter                               --   5000   5000 -- 0.03669 0.32882 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/data_loader.py:98:_next_iter (_next_iter)
                        &lt;method &#39;randint&#39;...mState&#39; objects&gt; --   5000   5000 -- 0.28000 0.28000 -- ~:0:&lt;method &#39;randint&#39; of &#39;numpy.random.mtrand.RandomState&#39; objects&gt; (&lt;method &#39;randint&#39; of &#39;numpy.random.mtrand.RandomState&#39; objects&gt;)
                        &lt;built-in method builtins.len&gt;       --   5000   5000 -- 0.00736 0.01212 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;) +++
                    numpy_to_ort_value                       --  10000  10000 -- 0.02676 0.14872 -- onnxruntime_helper.py:134:numpy_to_ort_value (numpy_to_ort_value) +++
                    &lt;built-in method builtins.len&gt;           --   5200   5200 -- 0.01605 0.03145 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;) +++
                forward                                      --   5000   5000 -- 1.15865 1.50858 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:655:forward (forward)
                    input_to_ort                             --   5000   5000 -- 0.20900 0.29731 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:578:input_to_ort (input_to_ort) +++
                    save_for_backward                        --   5000   5000 -- 0.04315 0.04315 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:630:save_for_backward (save_for_backward)
                    &lt;method &#39;append&#39; of &#39;list&#39; objects&gt;      --   5000   5000 -- 0.00947 0.00947 -- ~:0:&lt;method &#39;append&#39; of &#39;list&#39; objects&gt; (&lt;method &#39;append&#39; of &#39;list&#39; objects&gt;) +++
                backward                                     --   5000   5000 -- 1.52888 1.70706 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:737:backward (backward)
                    input_to_ort                             --   5000   5000 -- 0.12678 0.16444 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:578:input_to_ort (input_to_ort) +++
                    saved_tensors                            --   5000   5000 -- 0.00583 0.00583 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:642:saved_tensors (saved_tensors)
                    &lt;method &#39;pop&#39; of &#39;list&#39; objects&gt;         --   5000   5000 -- 0.00790 0.00790 -- ~:0:&lt;method &#39;pop&#39; of &#39;list&#39; objects&gt; (&lt;method &#39;pop&#39; of &#39;list&#39; objects&gt;)
                loss_gradient                                --   5000   5000 -- 0.24661 1.01789 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/sgd_learning_loss.py:61:loss_gradient (loss_gradient)
                    clear_binding_inputs                     --   5000   5000 -- 0.01997 0.04478 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/_base_onnx_function.py:147:clear_binding_inputs (clear_binding_inputs)
                        _cache_in_clear                      --   5000   5000 -- 0.01776 0.02481 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/_base_onnx_function.py:136:_cache_in_clear (_cache_in_clear)
                            &lt;built-in method builtins.id&gt;    --   5000   5000 -- 0.00705 0.00705 -- ~:0:&lt;built-in method builtins.id&gt; (&lt;built-in method builtins.id&gt;) +++
                    _bind_input_ortvalue                     --  10000  10000 -- 0.07895 0.32362 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/_base_onnx_function.py:179:_bind_input_ortvalue (_bind_input_ortvalue) +++
                    _call_iobinding                          --   5000   5000 -- 0.39241 0.39241 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/sgd_learning_loss.py:58:_call_iobinding (_call_iobinding)
                    &lt;built-in method builtins.hasattr&gt;       --  10000  10000 -- 0.01046 0.01046 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
                penalty_loss                                 --   5000   5000 -- 0.00408 0.00408 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/sgd_learning_penalty.py:101:penalty_loss (penalty_loss)
                update_weights                               --  30000  30000 -- 0.01839 0.01839 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/sgd_learning_penalty.py:115:update_weights (update_weights)
                update_weights                               --  30000  30000 -- 1.28455 4.85402 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/sgd_learning_rate.py:258:update_weights (update_weights)
                    _bind_input_ortvalue                     --  90000  90000 -- 0.43514 1.31716 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/_base_onnx_function.py:179:_bind_input_ortvalue (_bind_input_ortvalue) +++
                    _bind_output_ortvalue                    --  30000  30000 -- 0.13868 0.41809 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/_base_onnx_function.py:225:_bind_output_ortvalue (_bind_output_ortvalue)
                        _bio_cache                           --  30000  30000 -- 0.09062 0.11264 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/_base_onnx_function.py:158:_bio_cache (_bio_cache) +++
                        _bio_ptr                             --  30000  30000 -- 0.15124 0.15124 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/_base_onnx_function.py:175:_bio_ptr (_bio_ptr) +++
                        &lt;built-in method ...tins.isinstance&gt; --  30000  30000 -- 0.01552 0.01552 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
                    _call_iobinding                          --  30000  30000 -- 1.35059 1.35059 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/sgd_learning_rate.py:33:_call_iobinding (_call_iobinding)
                    value                                    --  30000  30000 -- 0.03443 0.03443 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/sgd_learning_rate.py:186:value (value) +++
                    &lt;built-in method on...tvalue_from_numpy&gt; --  30000  30000 -- 0.39967 0.39967 -- ~:0:&lt;built-in method onnxruntime.capi.onnxruntime_pybind11_state.ortvalue_from_numpy&gt; (&lt;built-in method onnxruntime.capi.onnxruntime_pybind11_state.ortvalue_from_numpy&gt;) +++
                    &lt;built-in method builtins.hasattr&gt;       --  60000  60000 -- 0.04953 0.04953 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
                &lt;method &#39;mean&#39; of &#39;numpy.ndarray&#39; objects&gt;   --    100    100 -- 0.00071 0.01559 -- ~:0:&lt;method &#39;mean&#39; of &#39;numpy.ndarray&#39; objects&gt; (&lt;method &#39;mean&#39; of &#39;numpy.ndarray&#39; objects&gt;) +++
                &lt;built-in method numpy.array&gt;                --    100    100 -- 0.00813 0.00813 -- ~:0:&lt;built-in method numpy.array&gt; (&lt;built-in method numpy.array&gt;) +++
                &lt;method &#39;append&#39; of &#39;list&#39; objects&gt;          --   5000   5000 -- 0.00548 0.00548 -- ~:0:&lt;method &#39;append&#39; of &#39;list&#39; objects&gt; (&lt;method &#39;append&#39; of &#39;list&#39; objects&gt;) +++
                &lt;built-in method builtins.len&gt;               --  30100  30100 -- 0.04341 0.04341 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;) +++
            _create_training_session                         --      1      1 -- 0.00003 0.04024 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers_partial.py:626:_create_training_session (_create_training_session)
                __init__                                     --      1      1 -- 0.00019 0.04017 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:59:__init__ (__init__)
                    &lt;listcomp&gt;                               --      1      1 -- 0.00003 0.00003 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:96:&lt;listcomp&gt; (&lt;listcomp&gt;)
                    &lt;listcomp&gt;                               --      1      1 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:99:&lt;listcomp&gt; (&lt;listcomp&gt;)
                    &lt;listcomp&gt;                               --      1      1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:118:&lt;listcomp&gt; (&lt;listcomp&gt;)
                    _init_next                               --      1      1 -- 0.00020 0.03992 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:171:_init_next (_init_next)
                        &lt;listcomp&gt;                           --      1      1 -- 0.00003 0.00003 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:181:&lt;listcomp&gt; (&lt;listcomp&gt;)
                        &lt;listcomp&gt;                           --      1      1 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:183:&lt;listcomp&gt; (&lt;listcomp&gt;)
                        &lt;listcomp&gt;                           --      1      1 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:186:&lt;listcomp&gt; (&lt;listcomp&gt;)
                        _create_onnx_graphs                  --      1      1 -- 0.00840 0.03967 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:301:_create_onnx_graphs (_create_onnx_graphs)
                            &lt;listcomp&gt;                       --      1      1 -- 0.00002 0.00002 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:413:&lt;listcomp&gt; (&lt;listcomp&gt;)
                            &lt;listcomp&gt;                       --      1      1 -- 0.00002 0.00002 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:414:&lt;listcomp&gt; (&lt;listcomp&gt;)
                            &lt;listcomp&gt;                       --      1      1 -- 0.00004 0.00004 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:416:&lt;listcomp&gt; (&lt;listcomp&gt;)
                                _provider_nam..._device_type --      1      1 -- 0.00000 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:271:_provider_name_to_device_type (_provider_name_to_device_type) +++
                            &lt;listcomp&gt;                       --      1      1 -- 0.00009 0.00011 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:421:&lt;listcomp&gt; (&lt;listcomp&gt;)
                                _provider_nam..._device_type --      7      7 -- 0.00001 0.00002 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:271:_provider_name_to_device_type (_provider_name_to_device_type) +++
                            &lt;listcomp&gt;                       --      1      1 -- 0.00001 0.00002 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:427:&lt;listcomp&gt; (&lt;listcomp&gt;)
                                _provider_nam..._device_type --      1      1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:271:_provider_name_to_device_type (_provider_name_to_device_type) +++
                            &lt;listcomp&gt;                       --      1      1 -- 0.00003 0.00003 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:496:&lt;listcomp&gt; (&lt;listcomp&gt;)
                            &lt;listcomp&gt;                       --      1      1 -- 0.00002 0.00002 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:497:&lt;listcomp&gt; (&lt;listcomp&gt;)
                            load_model                       --      2      2 -- 0.00001 0.00124 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/onnx/__init__.py:107:load_model (load_model)
                                _load_bytes                  --      2      2 -- 0.00005 0.00007 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/onnx/__init__.py:30:_load_bytes (_load_bytes)
                                    inner                    --      4      4 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/typing.py:256:inner (inner) +++
                                    cast                     --      4      4 -- 0.00000 0.00000 -- /usr/local/lib/python3.9/typing.py:1326:cast (cast) +++
                                _get_file_path               --      2      2 -- 0.00000 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/onnx/__init__.py:50:_get_file_path (_get_file_path)
                                load_model_from_string       --      2      2 -- 0.00003 0.00115 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/onnx/__init__.py:147:load_model_from_string (load_model_from_string)
                                    _deserialize             --      2      2 -- 0.00004 0.00112 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/onnx/__init__.py:81:_deserialize (_deserialize)
                                        inner                --      2      2 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/typing.py:256:inner (inner) +++
                                        cast                 --      2      2 -- 0.00000 0.00000 -- /usr/local/lib/python3.9/typing.py:1326:cast (cast) +++
                                        &lt;method &#39;...objects&gt; --      2      2 -- 0.00106 0.00106 -- ~:0:&lt;method &#39;ParseFromString&#39; of &#39;google.protobuf.pyext._message.CMessage&#39; objects&gt; (&lt;method &#39;ParseFromString&#39; of &#39;google.protobuf.pyext._message.CMessage&#39; objects&gt;)
                            get_inputs                       --      1      1 -- 0.00000 0.00000 -- onnxruntime/capi/onnxruntime_inference_collection.py:111:get_inputs (get_inputs)
                            get_outputs                      --      1      1 -- 0.00000 0.00000 -- onnxruntime/capi/onnxruntime_inference_collection.py:115:get_outputs (get_outputs)
                            __init__                         --      2      2 -- 0.00008 0.02947 -- onnxruntime/capi/onnxruntime_inference_collection.py:283:__init__ (__init__)
                                get                          --      2      2 -- 0.00002 0.00009 -- /usr/local/lib/python3.9/_collections_abc.py:675:get (get)
                                    __getitem__              --      2      2 -- 0.00003 0.00007 -- /usr/local/lib/python3.9/os.py:674:__getitem__ (__getitem__)
                                        encode               --      2      2 -- 0.00003 0.00004 -- /usr/local/lib/python3.9/os.py:754:encode (encode)
                                __init__                     --      2      2 -- 0.00001 0.00001 -- onnxruntime/capi/onnxruntime_inference_collection.py:101:__init__ (__init__)
                                _create_inference_session    --      2      2 -- 0.02906 0.02928 -- onnxruntime/capi/onnxruntime_inference_collection.py:346:_create_inference_session (_create_inference_session)
                                    check_and_n...vider_args --      2      2 -- 0.00010 0.00019 -- onnxruntime/capi/onnxruntime_inference_collection.py:25:check_and_normalize_provider_args (check_and_normalize_provider_args)
                                        set_provider_options --      2      2 -- 0.00002 0.00003 -- onnxruntime/capi/onnxruntime_inference_collection.py:53:set_provider_options (set_provider_options)
                                            &lt;dictcomp&gt;       --      2      2 -- 0.00000 0.00000 -- onnxruntime/capi/onnxruntime_inference_collection.py:62:&lt;dictcomp&gt; (&lt;dictcomp&gt;)
                                        &lt;listcomp&gt;           --      2      2 -- 0.00001 0.00001 -- onnxruntime/capi/onnxruntime_inference_collection.py:75:&lt;listcomp&gt; (&lt;listcomp&gt;)
                                        &lt;listcomp&gt;           --      2      2 -- 0.00001 0.00001 -- onnxruntime/capi/onnxruntime_inference_collection.py:78:&lt;listcomp&gt; (&lt;listcomp&gt;)
                            &lt;method &#39;Serial...sage&#39; objects&gt; --      1      1 -- 0.00027 0.00027 -- ~:0:&lt;method &#39;SerializeToString&#39; of &#39;google.protobuf.pyext._message.CMessage&#39; objects&gt; (&lt;method &#39;SerializeToString&#39; of &#39;google.protobuf.pyext._message.CMessage&#39; objects&gt;)
                            &lt;built-in method builtins.len&gt;   --     16     16 -- 0.00001 0.00001 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;) +++
                new_instance                                 --      1      1 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:219:new_instance (new_instance)
                    __init__                                 --      1      1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:521:__init__ (__init__)
                device_to_providers                          --      1      1 -- 0.00003 0.00003 -- onnxruntime_helper.py:150:device_to_providers (device_to_providers)
            value                                            --    100    100 -- 0.00012 0.00012 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/sgd_learning_rate.py:186:value (value) +++
            init_learning_rate                               --      1      1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/sgd_learning_rate.py:205:init_learning_rate (init_learning_rate)
            update_learning_rate                             --    100    100 -- 0.00338 0.00338 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/sgd_learning_rate.py:226:update_learning_rate (update_learning_rate)
            proto_type_to_dtype                              --      6      6 -- 0.00002 0.00002 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/utils/onnx_helper.py:61:proto_type_to_dtype (proto_type_to_dtype)
            &lt;method &#39;randn&#39; of &#39;num....RandomState&#39; objects&gt; --      6      6 -- 0.00075 0.00075 -- ~:0:&lt;method &#39;randn&#39; of &#39;numpy.random.mtrand.RandomState&#39; objects&gt; (&lt;method &#39;randn&#39; of &#39;numpy.random.mtrand.RandomState&#39; objects&gt;)
            &lt;method &#39;append&#39; of &#39;list&#39; objects&gt;              --    107    107 -- 0.00009 0.00009 -- ~:0:&lt;method &#39;append&#39; of &#39;list&#39; objects&gt; (&lt;method &#39;append&#39; of &#39;list&#39; objects&gt;) +++
            &lt;built-in method builtins.len&gt;                   --    108    108 -- 0.00006 0.00006 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;) +++
        fit                                                  --      1      1 -- 0.00002 11.28733 -- sklearn/neural_network/_multilayer_perceptron.py:735:fit (fit)
            _fit                                             --      1      1 -- 0.00014 11.28731 -- sklearn/neural_network/_multilayer_perceptron.py:376:_fit (_fit)
                any                                          --      1      1 -- 0.00001 0.00011 -- &lt;__array_function__ internals&gt;:177:any (any)
                    _any_dispatcher                          --      1      1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:2300:_any_dispatcher (_any_dispatcher)
                _initialize                                  --      1      1 -- 0.00006 0.00066 -- sklearn/neural_network/_multilayer_perceptron.py:319:_initialize (_initialize)
                    is_classifier                            --      1      1 -- 0.00000 0.00000 -- sklearn/base.py:960:is_classifier (is_classifier)
                    _init_coef                               --      3      3 -- 0.00011 0.00059 -- sklearn/neural_network/_multilayer_perceptron.py:359:_init_coef (_init_coef)
                        &lt;method &#39;uniform&#39;...mState&#39; objects&gt; --      6      6 -- 0.00041 0.00041 -- ~:0:&lt;method &#39;uniform&#39; of &#39;numpy.random.mtrand.RandomState&#39; objects&gt; (&lt;method &#39;uniform&#39; of &#39;numpy.random.mtrand.RandomState&#39; objects&gt;)
                &lt;listcomp&gt;                                   --      1      1 -- 0.00001 0.00003 -- sklearn/neural_network/_multilayer_perceptron.py:416:&lt;listcomp&gt; (&lt;listcomp&gt;)
                &lt;listcomp&gt;                                   --      1      1 -- 0.00001 0.00003 -- sklearn/neural_network/_multilayer_perceptron.py:421:&lt;listcomp&gt; (&lt;listcomp&gt;)
                _validate_hyperparameters                    --      1      1 -- 0.00002 0.00002 -- sklearn/neural_network/_multilayer_perceptron.py:445:_validate_hyperparameters (_validate_hyperparameters)
                _fit_stochastic                              --      1      1 -- 0.27705 11.28491 -- sklearn/neural_network/_multilayer_perceptron.py:553:_fit_stochastic (_fit_stochastic)
                    clip                                     --      1      1 -- 0.00001 0.00021 -- &lt;__array_function__ internals&gt;:177:clip (clip)
                        _clip_dispatcher                     --      1      1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:2079:_clip_dispatcher (_clip_dispatcher)
                        &lt;built-in method ..._array_function&gt; --      1      1 -- 0.00000 0.00020 -- ~:0:&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt; (&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt;) +++
                    _backprop                                --   5000   5000 -- 0.61941 7.85197 -- sklearn/neural_network/_multilayer_perceptron.py:240:_backprop (_backprop)
                        dot                                  --  15000  15000 -- 0.07069 0.29679 -- &lt;__array_function__ internals&gt;:177:dot (dot)
                            dot                              --  15000  15000 -- 0.01269 0.01269 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/multiarray.py:736:dot (dot)
                            &lt;built-in metho...rray_function&gt; --  15000  15000 -- 0.21340 0.21340 -- ~:0:&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt; (&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt;) +++
                        inplace_relu_derivative              --  10000  10000 -- 0.43059 0.43059 -- sklearn/neural_network/_base.py:132:inplace_relu_derivative (inplace_relu_derivative)
                        squared_loss                         --   5000   5000 -- 0.25597 0.89775 -- sklearn/neural_network/_base.py:158:squared_loss (squared_loss)
                            &lt;method &#39;mean&#39; ...rray&#39; objects&gt; --   5000   5000 -- 0.02929 0.64179 -- ~:0:&lt;method &#39;mean&#39; of &#39;numpy.ndarray&#39; objects&gt; (&lt;method &#39;mean&#39; of &#39;numpy.ndarray&#39; objects&gt;) +++
                        _forward_pass                        --   5000   5000 -- 0.49933 1.53180 -- sklearn/neural_network/_multilayer_perceptron.py:118:_forward_pass (_forward_pass)
                            inplace_identity                 --   5000   5000 -- 0.00453 0.00453 -- sklearn/neural_network/_base.py:13:inplace_identity (inplace_identity)
                            inplace_relu                     --  10000  10000 -- 0.34052 0.34052 -- sklearn/neural_network/_base.py:47:inplace_relu (inplace_relu)
                            safe_sparse_dot                  --  15000  15000 -- 0.64358 0.68743 -- sklearn/utils/extmath.py:120:safe_sparse_dot (safe_sparse_dot) +++
                        _compute_loss_grad                   --  15000  15000 -- 1.31595 3.71698 -- sklearn/neural_network/_multilayer_perceptron.py:176:_compute_loss_grad (_compute_loss_grad)
                            mean                             --  15000  15000 -- 0.07534 1.68971 -- &lt;__array_function__ internals&gt;:177:mean (mean)
                                _mean_dispatcher             --  15000  15000 -- 0.01462 0.01462 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:3351:_mean_dispatcher (_mean_dispatcher)
                                &lt;built-in met...ay_function&gt; --  15000  15000 -- 0.06731 1.59975 -- ~:0:&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt; (&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt;) +++
                            safe_sparse_dot                  --  15000  15000 -- 0.66765 0.71131 -- sklearn/utils/extmath.py:120:safe_sparse_dot (safe_sparse_dot) +++
                        safe_sparse_dot                      --  10000  10000 -- 0.29445 0.32338 -- sklearn/utils/extmath.py:120:safe_sparse_dot (safe_sparse_dot) +++
                        &lt;method &#39;ravel&#39; o...darray&#39; objects&gt; --  15000  15000 -- 0.03525 0.03525 -- ~:0:&lt;method &#39;ravel&#39; of &#39;numpy.ndarray&#39; objects&gt; (&lt;method &#39;ravel&#39; of &#39;numpy.ndarray&#39; objects&gt;)
                    _update_no_improvement_count             --    100    100 -- 0.00077 0.00077 -- sklearn/neural_network/_multilayer_perceptron.py:706:_update_no_improvement_count (_update_no_improvement_count)
                    update_params                            --   5000   5000 -- 0.45401 2.04171 -- sklearn/neural_network/_stochastic_optimizers.py:29:update_params (update_params)
                        &lt;genexpr&gt;                            --  35000  35000 -- 0.03299 0.03299 -- sklearn/neural_network/_stochastic_optimizers.py:43:&lt;genexpr&gt; (&lt;genexpr&gt;)
                        _get_updates                         --   5000   5000 -- 0.06997 1.55471 -- sklearn/neural_network/_stochastic_optimizers.py:169:_get_updates (_get_updates)
                            &lt;listcomp&gt;                       --   5000   5000 -- 1.48474 1.48474 -- sklearn/neural_network/_stochastic_optimizers.py:183:&lt;listcomp&gt; (&lt;listcomp&gt;)
                    __init__                                 --      1      1 -- 0.00002 0.00041 -- sklearn/neural_network/_stochastic_optimizers.py:121:__init__ (__init__)
                        __init__                             --      1      1 -- 0.00001 0.00001 -- sklearn/neural_network/_stochastic_optimizers.py:25:__init__ (__init__)
                        &lt;listcomp&gt;                           --      1      1 -- 0.00003 0.00039 -- sklearn/neural_network/_stochastic_optimizers.py:136:&lt;listcomp&gt; (&lt;listcomp&gt;)
                            zeros_like                       --      6      6 -- 0.00002 0.00037 -- &lt;__array_function__ internals&gt;:177:zeros_like (zeros_like)
                                _zeros_like_dispatcher       --      6      6 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/numeric.py:72:_zeros_like_dispatcher (_zeros_like_dispatcher)
                                &lt;built-in met...ay_function&gt; --      6      6 -- 0.00003 0.00034 -- ~:0:&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt; (&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt;) +++
                    iteration_ends                           --    100    100 -- 0.00116 0.00116 -- sklearn/neural_network/_stochastic_optimizers.py:138:iteration_ends (iteration_ends)
                    _safe_indexing                           --   5000   5000 -- 0.05405 1.00884 -- sklearn/utils/__init__.py:307:_safe_indexing (_safe_indexing) +++
                    shuffle                                  --    100    100 -- 0.00121 0.05293 -- sklearn/utils/__init__.py:602:shuffle (shuffle)
                        resample                             --    100    100 -- 0.00335 0.05172 -- sklearn/utils/__init__.py:452:resample (resample)
                            &lt;listcomp&gt;                       --    100    100 -- 0.00043 0.00081 -- sklearn/utils/__init__.py:593:&lt;listcomp&gt; (&lt;listcomp&gt;)
                                isspmatrix                   --    100    100 -- 0.00022 0.00037 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_base.py:1291:isspmatrix (isspmatrix) +++
                            &lt;listcomp&gt;                       --    100    100 -- 0.00037 0.01940 -- sklearn/utils/__init__.py:594:&lt;listcomp&gt; (&lt;listcomp&gt;)
                                _safe_indexing               --    100    100 -- 0.00098 0.01902 -- sklearn/utils/__init__.py:307:_safe_indexing (_safe_indexing) +++
                            check_consistent_length          --    100    100 -- 0.00114 0.01675 -- sklearn/utils/validation.py:318:check_consistent_length (check_consistent_length) +++
                            check_random_state               --    100    100 -- 0.00094 0.00242 -- sklearn/utils/validation.py:1043:check_random_state (check_random_state) +++
                            &lt;method &#39;shuffl...tate&#39; objects&gt; --    100    100 -- 0.00681 0.00681 -- ~:0:&lt;method &#39;shuffle&#39; of &#39;numpy.random.mtrand.RandomState&#39; objects&gt; (&lt;method &#39;shuffle&#39; of &#39;numpy.random.mtrand.RandomState&#39; objects&gt;)
                            &lt;built-in method numpy.arange&gt;   --    100    100 -- 0.00180 0.00180 -- ~:0:&lt;built-in method numpy.arange&gt; (&lt;built-in method numpy.arange&gt;) +++
                            &lt;built-in metho...ltins.hasattr&gt; --    100    100 -- 0.00023 0.00023 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
                            &lt;built-in method builtins.len&gt;   --    200    200 -- 0.00016 0.00016 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;) +++
                    gen_batches                              --   5100   5100 -- 0.04745 0.04853 -- sklearn/utils/__init__.py:712:gen_batches (gen_batches)
                        &lt;built-in method ...tins.isinstance&gt; --    100    100 -- 0.00036 0.00107 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
                    &lt;method &#39;append&#39; of &#39;list&#39; objects&gt;      --    100    100 -- 0.00013 0.00013 -- ~:0:&lt;method &#39;append&#39; of &#39;list&#39; objects&gt; (&lt;method &#39;append&#39; of &#39;list&#39; objects&gt;) +++
                    &lt;built-in method _warnings.warn&gt;         --      1      1 -- 0.00007 0.00118 -- ~:0:&lt;built-in method _warnings.warn&gt; (&lt;built-in method _warnings.warn&gt;)
                        _showwarnmsg                         --      1      1 -- 0.00002 0.00110 -- /usr/local/lib/python3.9/warnings.py:96:_showwarnmsg (_showwarnmsg)
                            _showwarning                     --      1      1 -- 0.00001 0.00108 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx_gallery/gen_rst.py:473:_showwarning (_showwarning)
                                formatwarning                --      1      1 -- 0.00001 0.00006 -- /usr/local/lib/python3.9/warnings.py:15:formatwarning (formatwarning)
                                    _formatwarnmsg_impl      --      1      1 -- 0.00004 0.00005 -- /usr/local/lib/python3.9/warnings.py:35:_formatwarnmsg_impl (_formatwarnmsg_impl)
                                        getline              --      1      1 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/linecache.py:26:getline (getline)
                                            getlines         --      1      1 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/linecache.py:36:getlines (getlines)
                                    __init__                 --      1      1 -- 0.00000 0.00000 -- /usr/local/lib/python3.9/warnings.py:403:__init__ (__init__) +++
                                write                        --      1      1 -- 0.00002 0.00101 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx_gallery/gen_rst.py:81:write (write) +++
                        __init__                             --      1      1 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/warnings.py:403:__init__ (__init__) +++
                _validate_input                              --      1      1 -- 0.00002 0.00137 -- sklearn/neural_network/_multilayer_perceptron.py:1588:_validate_input (_validate_input)
                    _validate_data                           --      1      1 -- 0.00003 0.00136 -- sklearn/base.py:495:_validate_data (_validate_data)
                        _check_n_features                    --      1      1 -- 0.00001 0.00002 -- sklearn/base.py:359:_check_n_features (_check_n_features)
                            _num_features                    --      1      1 -- 0.00001 0.00002 -- sklearn/utils/validation.py:201:_num_features (_num_features)
                        _check_feature_names                 --      1      1 -- 0.00000 0.00001 -- sklearn/base.py:405:_check_feature_names (_check_feature_names)
                            _get_feature_names               --      1      1 -- 0.00000 0.00000 -- sklearn/utils/validation.py:1653:_get_feature_names (_get_feature_names)
                        check_X_y                            --      1      1 -- 0.00001 0.00129 -- sklearn/utils/validation.py:845:check_X_y (check_X_y)
                            check_consistent_length          --      1      1 -- 0.00001 0.00021 -- sklearn/utils/validation.py:318:check_consistent_length (check_consistent_length) +++
                            check_array                      --      1      1 -- 0.00006 0.00071 -- sklearn/utils/validation.py:494:check_array (check_array) +++
                            _check_y                         --      1      1 -- 0.00001 0.00036 -- sklearn/utils/validation.py:986:_check_y (_check_y)
                                check_array                  --      1      1 -- 0.00004 0.00035 -- sklearn/utils/validation.py:494:check_array (check_array) +++
                check_random_state                           --      1      1 -- 0.00001 0.00001 -- sklearn/utils/validation.py:1043:check_random_state (check_random_state) +++
        &lt;built-in method builtins.print&gt;                     --      3      3 -- 0.00004 0.00230 -- ~:0:&lt;built-in method builtins.print&gt; (&lt;built-in method builtins.print&gt;)
            write                                            --      6      6 -- 0.00010 0.00226 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx_gallery/gen_rst.py:81:write (write) +++
_bio_cache                                                   --  130000  130000 -- 0.42142 0.52307 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/_base_onnx_function.py:158:_bio_cache (_bio_cache)
    &lt;built-in method builtins.id&gt;                            --  130000  130000 -- 0.10165 0.10165 -- ~:0:&lt;built-in method builtins.id&gt; (&lt;built-in method builtins.id&gt;) +++
_bio_ptr                                                     --  130000  130000 -- 0.67095 0.67095 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/_base_onnx_function.py:175:_bio_ptr (_bio_ptr)
_bind_input_ortvalue                                         --  100000  100000 -- 0.51409 1.64079 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/_base_onnx_function.py:179:_bind_input_ortvalue (_bind_input_ortvalue)
    _bio_cache                                               --  100000  100000 -- 0.33080 0.41042 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/_base_onnx_function.py:158:_bio_cache (_bio_cache) +++
    _bio_do_bind_in                                          --  10591  10591 -- 0.14121 0.14121 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/_base_onnx_function.py:171:_bio_do_bind_in (_bio_do_bind_in)
    _bio_ptr                                                 --  100000  100000 -- 0.51971 0.51971 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/_base_onnx_function.py:175:_bio_ptr (_bio_ptr) +++
    &lt;built-in method builtins.isinstance&gt;                    --  100000  100000 -- 0.05536 0.05536 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
_get_att_state                                               --    103    103 -- 0.00013 0.00013 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers_partial.py:139:_get_att_state (_get_att_state)
get_full_state                                               --    101    201 -- 0.00121 0.00221 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers_partial.py:147:get_full_state (get_full_state)
    _get_att_state                                           --    101    101 -- 0.00013 0.00013 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers_partial.py:139:_get_att_state (_get_att_state) +++
    &lt;listcomp&gt;                                               --    100    100 -- 0.00053 0.00143 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers_partial.py:152:&lt;listcomp&gt; (&lt;listcomp&gt;)
        get_full_state                                       --    100    100 -- 0.00049 0.00090 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers_partial.py:147:get_full_state (get_full_state) +++
    &lt;built-in method builtins.getattr&gt;                       --    101    101 -- 0.00007 0.00007 -- ~:0:&lt;built-in method builtins.getattr&gt; (&lt;built-in method builtins.getattr&gt;) +++
    &lt;built-in method builtins.hasattr&gt;                       --    101    101 -- 0.00008 0.00008 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
    &lt;built-in method builtins.isinstance&gt;                    --    201    201 -- 0.00020 0.00020 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
_provider_name_to_device_type                                --      9      9 -- 0.00002 0.00003 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:271:_provider_name_to_device_type (_provider_name_to_device_type)
input_to_ort                                                 --  10000  10000 -- 0.33579 0.46175 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:578:input_to_ort (input_to_ort)
    &lt;built-in method builtins.all&gt;                           --  10000  10000 -- 0.04191 0.08625 -- ~:0:&lt;built-in method builtins.all&gt; (&lt;built-in method builtins.all&gt;) +++
    &lt;built-in method builtins.isinstance&gt;                    --  10000  10000 -- 0.03224 0.03224 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
    &lt;built-in method builtins.len&gt;                           --  10000  10000 -- 0.00748 0.00748 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;) +++
value                                                        --  30100  30100 -- 0.03454 0.03454 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/sgd_learning_rate.py:186:value (value)
_mean                                                        --  20100  20100 -- 1.00503 2.01167 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/_methods.py:162:_mean (_mean)
    _count_reduce_items                                      --  20100  20100 -- 0.38557 0.44100 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/_methods.py:66:_count_reduce_items (_count_reduce_items)
        &lt;built-in method numpy.co...th.normalize_axis_index&gt; --  25200  25200 -- 0.03628 0.03628 -- ~:0:&lt;built-in method numpy.core._multiarray_umath.normalize_axis_index&gt; (&lt;built-in method numpy.core._multiarray_umath.normalize_axis_index&gt;)
        &lt;built-in method builtins.isinstance&gt;                --  15000  15000 -- 0.01915 0.01915 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
    &lt;built-in method numpy.asanyarray&gt;                       --  20100  20100 -- 0.01397 0.01397 -- ~:0:&lt;built-in method numpy.asanyarray&gt; (&lt;built-in method numpy.asanyarray&gt;) +++
    &lt;method &#39;reduce&#39; of &#39;numpy.ufunc&#39; objects&gt;               --  20100  20100 -- 0.48794 0.48794 -- ~:0:&lt;method &#39;reduce&#39; of &#39;numpy.ufunc&#39; objects&gt; (&lt;method &#39;reduce&#39; of &#39;numpy.ufunc&#39; objects&gt;) +++
    &lt;built-in method builtins.hasattr&gt;                       --   5100   5100 -- 0.00940 0.00940 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
    &lt;built-in method builtins.isinstance&gt;                    --  20100  20100 -- 0.01883 0.01883 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
    &lt;built-in method builtins.issubclass&gt;                    --  40200  40200 -- 0.03550 0.03550 -- ~:0:&lt;built-in method builtins.issubclass&gt; (&lt;built-in method builtins.issubclass&gt;) +++
_wrapreduction                                               --      3      3 -- 0.00005 0.00043 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:69:_wrapreduction (_wrapreduction)
    &lt;dictcomp&gt;                                               --      3      3 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:70:&lt;dictcomp&gt; (&lt;dictcomp&gt;)
    &lt;method &#39;reduce&#39; of &#39;numpy.ufunc&#39; objects&gt;               --      3      3 -- 0.00037 0.00037 -- ~:0:&lt;method &#39;reduce&#39; of &#39;numpy.ufunc&#39; objects&gt; (&lt;method &#39;reduce&#39; of &#39;numpy.ufunc&#39; objects&gt;) +++
isspmatrix                                                   --  45202  45202 -- 0.07155 0.12909 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_base.py:1291:isspmatrix (isspmatrix)
    &lt;built-in method builtins.isinstance&gt;                    --  45202  45202 -- 0.05754 0.05754 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
write                                                        --      7      7 -- 0.00012 0.00327 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx_gallery/gen_rst.py:81:write (write)
    verbose                                                  --      6      6 -- 0.00005 0.00312 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:135:verbose (verbose)
        log                                                  --      6      6 -- 0.00008 0.00307 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:128:log (log)
            log                                              --      6      6 -- 0.00009 0.00299 -- /usr/local/lib/python3.9/logging/__init__.py:1825:log (log)
                log                                          --      6      6 -- 0.00008 0.00281 -- /usr/local/lib/python3.9/logging/__init__.py:1485:log (log)
                    _log                                     --      6      6 -- 0.00006 0.00271 -- /usr/local/lib/python3.9/logging/__init__.py:1553:_log (_log)
                        findCaller                           --      6      6 -- 0.00010 0.00017 -- /usr/local/lib/python3.9/logging/__init__.py:1502:findCaller (findCaller)
                            &lt;lambda&gt;                         --      6      6 -- 0.00002 0.00003 -- /usr/local/lib/python3.9/logging/__init__.py:156:&lt;lambda&gt; (&lt;lambda&gt;)
                            normcase                         --     12     12 -- 0.00002 0.00003 -- /usr/local/lib/python3.9/posixpath.py:52:normcase (normcase)
                                &lt;built-in met...osix.fspath&gt; --     12     12 -- 0.00001 0.00001 -- ~:0:&lt;built-in method posix.fspath&gt; (&lt;built-in method posix.fspath&gt;) +++
                            &lt;built-in metho...ltins.hasattr&gt; --     12     12 -- 0.00001 0.00001 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
                        makeRecord                           --      6      6 -- 0.00006 0.00080 -- /usr/local/lib/python3.9/logging/__init__.py:1538:makeRecord (makeRecord)
                            __init__                         --      6      6 -- 0.00033 0.00074 -- /usr/local/lib/python3.9/logging/__init__.py:278:__init__ (__init__)
                                getLevelName                 --      6      6 -- 0.00005 0.00005 -- /usr/local/lib/python3.9/logging/__init__.py:119:getLevelName (getLevelName)
                                    &lt;method &#39;ge...&#39; objects&gt; --     12     12 -- 0.00001 0.00001 -- ~:0:&lt;method &#39;get&#39; of &#39;dict&#39; objects&gt; (&lt;method &#39;get&#39; of &#39;dict&#39; objects&gt;) +++
                                current_process              --      6      6 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/multiprocessing/process.py:37:current_process (current_process)
                                name                         --      6      6 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/multiprocessing/process.py:189:name (name)
                                splitext                     --      6      6 -- 0.00003 0.00010 -- /usr/local/lib/python3.9/posixpath.py:117:splitext (splitext)
                                    _splitext                --      6      6 -- 0.00005 0.00006 -- /usr/local/lib/python3.9/genericpath.py:121:_splitext (_splitext)
                                        &lt;method &#39;...objects&gt; --     12     12 -- 0.00002 0.00002 -- ~:0:&lt;method &#39;rfind&#39; of &#39;str&#39; objects&gt; (&lt;method &#39;rfind&#39; of &#39;str&#39; objects&gt;) +++
                                basename                     --      6      6 -- 0.00005 0.00009 -- /usr/local/lib/python3.9/posixpath.py:140:basename (basename)
                                    _get_sep                 --      6      6 -- 0.00001 0.00002 -- /usr/local/lib/python3.9/posixpath.py:41:_get_sep (_get_sep)
                                name                         --      6      6 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/threading.py:1053:name (name)
                                current_thread               --      6      6 -- 0.00002 0.00002 -- /usr/local/lib/python3.9/threading.py:1318:current_thread (current_thread)
                        handle                               --      6      6 -- 0.00003 0.00169 -- /usr/local/lib/python3.9/logging/__init__.py:1579:handle (handle)
                            filter                           --      6      6 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/logging/__init__.py:787:filter (filter) +++
                            callHandlers                     --      6      6 -- 0.00007 0.00165 -- /usr/local/lib/python3.9/logging/__init__.py:1633:callHandlers (callHandlers)
                                handle                       --     12     12 -- 0.00008 0.00158 -- /usr/local/lib/python3.9/logging/__init__.py:935:handle (handle)
                                    filter                   --     12     12 -- 0.00006 0.00017 -- /usr/local/lib/python3.9/logging/__init__.py:787:filter (filter) +++
                                    acquire                  --     12     12 -- 0.00004 0.00006 -- /usr/local/lib/python3.9/logging/__init__.py:892:acquire (acquire) +++
                                    release                  --     12     12 -- 0.00002 0.00003 -- /usr/local/lib/python3.9/logging/__init__.py:899:release (release) +++
                                    emit                     --      6      6 -- 0.00004 0.00041 -- /usr/local/lib/python3.9/logging/__init__.py:1067:emit (emit) +++
                                    emit                     --      6      6 -- 0.00006 0.00083 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:158:emit (emit)
                                        acquire              --      6      6 -- 0.00001 0.00002 -- /usr/local/lib/python3.9/logging/__init__.py:892:acquire (acquire) +++
                                        release              --      6      6 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/logging/__init__.py:899:release (release) +++
                                        emit                 --      6      6 -- 0.00005 0.00073 -- /usr/local/lib/python3.9/logging/__init__.py:1067:emit (emit) +++
                    isEnabledFor                             --      6      6 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/logging/__init__.py:1677:isEnabledFor (isEnabledFor) +++
                isEnabledFor                                 --      6      6 -- 0.00002 0.00004 -- /usr/local/lib/python3.9/logging/__init__.py:1834:isEnabledFor (isEnabledFor)
                    isEnabledFor                             --      6      6 -- 0.00002 0.00002 -- /usr/local/lib/python3.9/logging/__init__.py:1677:isEnabledFor (isEnabledFor) +++
                process                                      --      6      6 -- 0.00005 0.00006 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:138:process (process)
numpy_to_ort_value                                           --  10014  10014 -- 0.02680 0.14896 -- onnxruntime_helper.py:134:numpy_to_ort_value (numpy_to_ort_value)
    &lt;built-in method onnxruntim...state.ortvalue_from_numpy&gt; --  10014  10014 -- 0.12215 0.12215 -- ~:0:&lt;built-in method onnxruntime.capi.onnxruntime_pybind11_state.ortvalue_from_numpy&gt; (&lt;built-in method onnxruntime.capi.onnxruntime_pybind11_state.ortvalue_from_numpy&gt;) +++
_safe_indexing                                               --   5100   5100 -- 0.05502 1.02787 -- sklearn/utils/__init__.py:307:_safe_indexing (_safe_indexing)
    _array_indexing                                          --   5100   5100 -- 0.21322 0.84006 -- sklearn/utils/__init__.py:193:_array_indexing (_array_indexing)
        isspmatrix                                           --   5100   5100 -- 0.00688 0.01226 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_base.py:1291:isspmatrix (isspmatrix) +++
        parse                                                --   5100   5100 -- 0.02665 0.58928 -- sklearn/externals/_packaging/version.py:65:parse (parse)
            __init__                                         --   5100   5100 -- 0.23286 0.56263 -- sklearn/externals/_packaging/version.py:284:__init__ (__init__)
                &lt;lambda&gt;                                     --   5100   5100 -- 0.01266 0.02426 -- &lt;string&gt;:1:&lt;lambda&gt; (&lt;lambda&gt;)
                    &lt;built-in method __...at 0x7f5da6713960&gt; --   5100   5100 -- 0.01160 0.01160 -- ~:0:&lt;built-in method __new__ of type object at 0x7f5da6713960&gt; (&lt;built-in method __new__ of type object at 0x7f5da6713960&gt;)
                &lt;genexpr&gt;                                    --  15300  15300 -- 0.03869 0.03869 -- sklearn/externals/_packaging/version.py:294:&lt;genexpr&gt; (&lt;genexpr&gt;)
                _parse_letter_version                        --  15300  15300 -- 0.01259 0.01259 -- sklearn/externals/_packaging/version.py:416:_parse_letter_version (_parse_letter_version)
                _parse_local_version                         --   5100   5100 -- 0.00331 0.00331 -- sklearn/externals/_packaging/version.py:455:_parse_local_version (_parse_local_version)
                _cmpkey                                      --   5100   5100 -- 0.08616 0.09149 -- sklearn/externals/_packaging/version.py:467:_cmpkey (_cmpkey)
                    &lt;lambda&gt;                                 --   5100   5100 -- 0.00533 0.00533 -- sklearn/externals/_packaging/version.py:482:&lt;lambda&gt; (&lt;lambda&gt;)
                &lt;method &#39;split&#39; of &#39;str&#39; objects&gt;            --   5100   5100 -- 0.01197 0.01197 -- ~:0:&lt;method &#39;split&#39; of &#39;str&#39; objects&gt; (&lt;method &#39;split&#39; of &#39;str&#39; objects&gt;)
                &lt;method &#39;group&#39; of &#39;re.Match&#39; objects&gt;       --  51000  51000 -- 0.05703 0.05703 -- ~:0:&lt;method &#39;group&#39; of &#39;re.Match&#39; objects&gt; (&lt;method &#39;group&#39; of &#39;re.Match&#39; objects&gt;)
                &lt;method &#39;search&#39; of &#39;re.Pattern&#39; objects&gt;    --   5100   5100 -- 0.09045 0.09045 -- ~:0:&lt;method &#39;search&#39; of &#39;re.Pattern&#39; objects&gt; (&lt;method &#39;search&#39; of &#39;re.Pattern&#39; objects&gt;)
        __lt__                                               --   5100   5100 -- 0.01814 0.02240 -- sklearn/externals/_packaging/version.py:92:__lt__ (__lt__)
            &lt;built-in method builtins.isinstance&gt;            --   5100   5100 -- 0.00426 0.00426 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
        &lt;built-in method builtins.isinstance&gt;                --   5100   5100 -- 0.00290 0.00290 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
    _determine_key_type                                      --   5100   5100 -- 0.09186 0.11912 -- sklearn/utils/__init__.py:237:_determine_key_type (_determine_key_type)
        &lt;method &#39;keys&#39; of &#39;dict&#39; objects&gt;                    --   5100   5100 -- 0.00561 0.00561 -- ~:0:&lt;method &#39;keys&#39; of &#39;dict&#39; objects&gt; (&lt;method &#39;keys&#39; of &#39;dict&#39; objects&gt;)
        &lt;built-in method builtins.hasattr&gt;                   --   5100   5100 -- 0.00433 0.00433 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
        &lt;built-in method builtins.isinstance&gt;                --  15300  15300 -- 0.01733 0.01733 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
    &lt;built-in method builtins.hasattr&gt;                       --  10200  10200 -- 0.01366 0.01366 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
safe_sparse_dot                                              --  40000  40000 -- 1.60568 1.72212 -- sklearn/utils/extmath.py:120:safe_sparse_dot (safe_sparse_dot)
    isspmatrix                                               --  40000  40000 -- 0.06444 0.11645 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_base.py:1291:isspmatrix (isspmatrix) +++
_num_samples                                                 --    104    104 -- 0.00231 0.00444 -- sklearn/utils/validation.py:254:_num_samples (_num_samples)
    &lt;built-in method builtins.hasattr&gt;                       --    312    312 -- 0.00046 0.00046 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
    &lt;built-in method builtins.isinstance&gt;                    --    104    104 -- 0.00031 0.00161 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
    &lt;built-in method builtins.len&gt;                           --    104    104 -- 0.00006 0.00006 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;) +++
check_consistent_length                                      --    101    101 -- 0.00116 0.01696 -- sklearn/utils/validation.py:318:check_consistent_length (check_consistent_length)
    unique                                                   --    101    101 -- 0.00055 0.01102 -- &lt;__array_function__ internals&gt;:177:unique (unique)
        _unique_dispatcher                                   --    101    101 -- 0.00010 0.00010 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/lib/arraysetops.py:133:_unique_dispatcher (_unique_dispatcher)
        &lt;built-in method numpy.co...mplement_array_function&gt; --    101    101 -- 0.00072 0.01038 -- ~:0:&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt; (&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt;) +++
    &lt;listcomp&gt;                                               --    101    101 -- 0.00038 0.00472 -- sklearn/utils/validation.py:329:&lt;listcomp&gt; (&lt;listcomp&gt;)
        _num_samples                                         --    102    102 -- 0.00227 0.00434 -- sklearn/utils/validation.py:254:_num_samples (_num_samples) +++
    &lt;built-in method builtins.len&gt;                           --    101    101 -- 0.00006 0.00006 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;) +++
check_array                                                  --      2      2 -- 0.00011 0.00106 -- sklearn/utils/validation.py:494:check_array (check_array)
    simplefilter                                             --      2      2 -- 0.00001 0.00007 -- /usr/local/lib/python3.9/warnings.py:165:simplefilter (simplefilter)
        _add_filter                                          --      2      2 -- 0.00003 0.00005 -- /usr/local/lib/python3.9/warnings.py:181:_add_filter (_add_filter)
    __init__                                                 --      2      2 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/warnings.py:437:__init__ (__init__)
    __enter__                                                --      2      2 -- 0.00003 0.00003 -- /usr/local/lib/python3.9/warnings.py:458:__enter__ (__enter__)
    __exit__                                                 --      2      2 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/warnings.py:477:__exit__ (__exit__)
    isspmatrix                                               --      2      2 -- 0.00000 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_base.py:1291:isspmatrix (isspmatrix) +++
    _assert_all_finite                                       --      2      2 -- 0.00017 0.00070 -- sklearn/utils/validation.py:90:_assert_all_finite (_assert_all_finite)
        get_config                                           --      2      2 -- 0.00001 0.00003 -- sklearn/_config.py:24:get_config (get_config)
            _get_threadlocal_config                          --      2      2 -- 0.00000 0.00001 -- sklearn/_config.py:16:_get_threadlocal_config (_get_threadlocal_config)
        _safe_accumulator_op                                 --      2      2 -- 0.00003 0.00048 -- sklearn/utils/extmath.py:869:_safe_accumulator_op (_safe_accumulator_op)
            sum                                              --      2      2 -- 0.00001 0.00041 -- &lt;__array_function__ internals&gt;:177:sum (sum)
                _sum_dispatcher                              --      2      2 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:2155:_sum_dispatcher (_sum_dispatcher)
                &lt;built-in method nump...ment_array_function&gt; --      2      2 -- 0.00001 0.00039 -- ~:0:&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt; (&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt;) +++
            issubdtype                                       --      2      2 -- 0.00001 0.00004 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/numerictypes.py:356:issubdtype (issubdtype)
                issubclass_                                  --      4      4 -- 0.00002 0.00002 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/numerictypes.py:282:issubclass_ (issubclass_)
    _num_samples                                             --      2      2 -- 0.00004 0.00010 -- sklearn/utils/validation.py:254:_num_samples (_num_samples) +++
    _ensure_no_complex_data                                  --      2      2 -- 0.00001 0.00001 -- sklearn/utils/validation.py:484:_ensure_no_complex_data (_ensure_no_complex_data)
check_random_state                                           --    101    101 -- 0.00095 0.00243 -- sklearn/utils/validation.py:1043:check_random_state (check_random_state)
    &lt;built-in method builtins.isinstance&gt;                    --    200    200 -- 0.00060 0.00148 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
&lt;built-in method builtins.len&gt;                               --  50957  50957 -- 0.07475 0.09491 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;)
    __len__                                                  --  10200  10200 -- 0.02016 0.02016 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/data_loader.py:94:__len__ (__len__)
&lt;method &#39;astype&#39; of &#39;numpy.ndarray&#39; objects&gt;                 --     18     18 -- 0.00019 0.00019 -- ~:0:&lt;method &#39;astype&#39; of &#39;numpy.ndarray&#39; objects&gt; (&lt;method &#39;astype&#39; of &#39;numpy.ndarray&#39; objects&gt;)
&lt;method &#39;append&#39; of &#39;list&#39; objects&gt;                          --  10253  10253 -- 0.01521 0.01521 -- ~:0:&lt;method &#39;append&#39; of &#39;list&#39; objects&gt; (&lt;method &#39;append&#39; of &#39;list&#39; objects&gt;)
&lt;built-in method builtins.hasattr&gt;                           --  91002  91002 -- 0.08824 0.08824 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;)
&lt;built-in method builtins.isinstance&gt;                        --  286510  286510 -- 0.23681 0.23976 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;)
    __instancecheck__                                        --    314    314 -- 0.00050 0.00294 -- /usr/local/lib/python3.9/abc.py:96:__instancecheck__ (__instancecheck__)
        &lt;built-in method _abc._abc_instancecheck&gt;            --    314    314 -- 0.00181 0.00245 -- ~:0:&lt;built-in method _abc._abc_instancecheck&gt; (&lt;built-in method _abc._abc_instancecheck&gt;)
            __subclasscheck__                                --    104    104 -- 0.00017 0.00064 -- /usr/local/lib/python3.9/abc.py:100:__subclasscheck__ (__subclasscheck__)
                &lt;built-in method _abc._abc_subclasscheck&gt;    --    104    104 -- 0.00047 0.00047 -- ~:0:&lt;built-in method _abc._abc_subclasscheck&gt; (&lt;built-in method _abc._abc_subclasscheck&gt;)
&lt;built-in method builtins.getattr&gt;                           --    148    148 -- 0.00012 0.00012 -- ~:0:&lt;built-in method builtins.getattr&gt; (&lt;built-in method builtins.getattr&gt;)
&lt;method &#39;mean&#39; of &#39;numpy.ndarray&#39; objects&gt;                   --   5100   5100 -- 0.03000 0.65738 -- ~:0:&lt;method &#39;mean&#39; of &#39;numpy.ndarray&#39; objects&gt; (&lt;method &#39;mean&#39; of &#39;numpy.ndarray&#39; objects&gt;)
    _mean                                                    --   5100   5100 -- 0.31469 0.62739 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/_methods.py:162:_mean (_mean) +++
&lt;built-in method numpy.array&gt;                                --    101    101 -- 0.00815 0.00815 -- ~:0:&lt;built-in method numpy.array&gt; (&lt;built-in method numpy.array&gt;)
&lt;built-in method onnxruntime....1_state.ortvalue_from_numpy&gt; --  40014  40014 -- 0.52182 0.52182 -- ~:0:&lt;built-in method onnxruntime.capi.onnxruntime_pybind11_state.ortvalue_from_numpy&gt; (&lt;built-in method onnxruntime.capi.onnxruntime_pybind11_state.ortvalue_from_numpy&gt;)
&lt;built-in method builtins.id&gt;                                --  135001  135001 -- 0.10870 0.10870 -- ~:0:&lt;built-in method builtins.id&gt; (&lt;built-in method builtins.id&gt;)
&lt;built-in method numpy.empty&gt;                                --    107    107 -- 0.00062 0.00062 -- ~:0:&lt;built-in method numpy.empty&gt; (&lt;built-in method numpy.empty&gt;)
&lt;built-in method numpy.arange&gt;                               --    101    101 -- 0.00181 0.00181 -- ~:0:&lt;built-in method numpy.arange&gt; (&lt;built-in method numpy.arange&gt;)
&lt;built-in method numpy.core._...th.implement_array_function&gt; --  30111  30125 -- 0.28162 1.82456 -- ~:0:&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt; (&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt;)
    clip                                                     --      1      1 -- 0.00001 0.00020 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:2083:clip (clip)
        _wrapfunc                                            --      1      1 -- 0.00001 0.00019 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:51:_wrapfunc (_wrapfunc)
            _wrapit                                          --      1      1 -- 0.00002 0.00018 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:38:_wrapit (_wrapit)
                &lt;method &#39;clip&#39; of &#39;numpy.ndarray&#39; objects&gt;   --      1      1 -- 0.00001 0.00015 -- ~:0:&lt;method &#39;clip&#39; of &#39;numpy.ndarray&#39; objects&gt; (&lt;method &#39;clip&#39; of &#39;numpy.ndarray&#39; objects&gt;)
                    _clip                                    --      1      1 -- 0.00002 0.00015 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/_methods.py:125:_clip (_clip)
                        _clip_dep_is_scalar_nan              --      2      2 -- 0.00006 0.00010 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/_methods.py:91:_clip_dep_is_scalar_nan (_clip_dep_is_scalar_nan)
                            ndim                             --      2      2 -- 0.00001 0.00004 -- &lt;__array_function__ internals&gt;:177:ndim (ndim)
                                _ndim_dispatcher             --      2      2 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:3160:_ndim_dispatcher (_ndim_dispatcher)
                        _clip_dep_is_byte_swapped            --      2      2 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/_methods.py:101:_clip_dep_is_byte_swapped (_clip_dep_is_byte_swapped)
                        _clip_dep_invoke_with_casting        --      1      1 -- 0.00002 0.00002 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/_methods.py:106:_clip_dep_invoke_with_casting (_clip_dep_invoke_with_casting)
    sum                                                      --      2      2 -- 0.00002 0.00038 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:2160:sum (sum)
        _wrapreduction                                       --      2      2 -- 0.00002 0.00036 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:69:_wrapreduction (_wrapreduction) +++
    any                                                      --      1      1 -- 0.00001 0.00008 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:2305:any (any)
        _wrapreduction                                       --      1      1 -- 0.00002 0.00007 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:69:_wrapreduction (_wrapreduction) +++
    ndim                                                     --      2      2 -- 0.00002 0.00003 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:3164:ndim (ndim)
    mean                                                     --  15000  15000 -- 0.14815 1.53244 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:3356:mean (mean)
        _mean                                                --  15000  15000 -- 0.69034 1.38428 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/_methods.py:162:_mean (_mean) +++
    zeros_like                                               --      6      6 -- 0.00007 0.00031 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/numeric.py:76:zeros_like (zeros_like)
        empty_like                                           --      6      6 -- 0.00003 0.00010 -- &lt;__array_function__ internals&gt;:177:empty_like (empty_like)
            empty_like                                       --      6      6 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/multiarray.py:80:empty_like (empty_like)
        copyto                                               --      6      6 -- 0.00003 0.00010 -- &lt;__array_function__ internals&gt;:177:copyto (copyto)
            copyto                                           --      6      6 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/multiarray.py:1071:copyto (copyto)
    unique                                                   --    101    101 -- 0.00094 0.00966 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/lib/arraysetops.py:138:unique (unique)
        _unpack_tuple                                        --    101    101 -- 0.00024 0.00031 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/lib/arraysetops.py:125:_unpack_tuple (_unpack_tuple)
            &lt;built-in method builtins.len&gt;                   --    101    101 -- 0.00007 0.00007 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;) +++
        _unique1d                                            --    101    101 -- 0.00583 0.00743 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/lib/arraysetops.py:320:_unique1d (_unique1d)
            &lt;method &#39;flatten&#39; of &#39;numpy.ndarray&#39; objects&gt;    --    101    101 -- 0.00079 0.00079 -- ~:0:&lt;method &#39;flatten&#39; of &#39;numpy.ndarray&#39; objects&gt; (&lt;method &#39;flatten&#39; of &#39;numpy.ndarray&#39; objects&gt;)
            &lt;method &#39;sort&#39; of &#39;numpy.ndarray&#39; objects&gt;       --    101    101 -- 0.00018 0.00018 -- ~:0:&lt;method &#39;sort&#39; of &#39;numpy.ndarray&#39; objects&gt; (&lt;method &#39;sort&#39; of &#39;numpy.ndarray&#39; objects&gt;)
            &lt;built-in method numpy.asanyarray&gt;               --    101    101 -- 0.00005 0.00005 -- ~:0:&lt;built-in method numpy.asanyarray&gt; (&lt;built-in method numpy.asanyarray&gt;) +++
            &lt;built-in method numpy.empty&gt;                    --    101    101 -- 0.00059 0.00059 -- ~:0:&lt;built-in method numpy.empty&gt; (&lt;built-in method numpy.empty&gt;) +++
        &lt;built-in method numpy.asanyarray&gt;                   --    101    101 -- 0.00098 0.00098 -- ~:0:&lt;built-in method numpy.asanyarray&gt; (&lt;built-in method numpy.asanyarray&gt;) +++
&lt;built-in method builtins.all&gt;                               --  10004  10004 -- 0.04191 0.08625 -- ~:0:&lt;built-in method builtins.all&gt; (&lt;built-in method builtins.all&gt;)
    &lt;lambda&gt;                                                 --  40000  40000 -- 0.03225 0.04434 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:598:&lt;lambda&gt; (&lt;lambda&gt;)
        &lt;built-in method builtins.isinstance&gt;                --  40000  40000 -- 0.01209 0.01209 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
&lt;built-in method numpy.asanyarray&gt;                           --  20304  20304 -- 0.01500 0.01500 -- ~:0:&lt;built-in method numpy.asanyarray&gt; (&lt;built-in method numpy.asanyarray&gt;)
&lt;method &#39;reduce&#39; of &#39;numpy.ufunc&#39; objects&gt;                   --  20103  20103 -- 0.48831 0.48831 -- ~:0:&lt;method &#39;reduce&#39; of &#39;numpy.ufunc&#39; objects&gt; (&lt;method &#39;reduce&#39; of &#39;numpy.ufunc&#39; objects&gt;)
&lt;built-in method builtins.issubclass&gt;                        --  40206  40206 -- 0.03551 0.03551 -- ~:0:&lt;built-in method builtins.issubclass&gt; (&lt;built-in method builtins.issubclass&gt;)
&lt;method &#39;HasField&#39; of &#39;google...._message.CMessage&#39; objects&gt; --     18     18 -- 0.00006 0.00006 -- ~:0:&lt;method &#39;HasField&#39; of &#39;google.protobuf.pyext._message.CMessage&#39; objects&gt; (&lt;method &#39;HasField&#39; of &#39;google.protobuf.pyext._message.CMessage&#39; objects&gt;)
&lt;built-in method numpy.asarray&gt;                              --     11     11 -- 0.00233 0.00233 -- ~:0:&lt;built-in method numpy.asarray&gt; (&lt;built-in method numpy.asarray&gt;)
&lt;method &#39;get&#39; of &#39;dict&#39; objects&gt;                             --     33     33 -- 0.00003 0.00003 -- ~:0:&lt;method &#39;get&#39; of &#39;dict&#39; objects&gt; (&lt;method &#39;get&#39; of &#39;dict&#39; objects&gt;)
&lt;built-in method posix.fspath&gt;                               --     24     24 -- 0.00001 0.00001 -- ~:0:&lt;built-in method posix.fspath&gt; (&lt;built-in method posix.fspath&gt;)
&lt;built-in method _thread.get_ident&gt;                          --     12     12 -- 0.00001 0.00001 -- ~:0:&lt;built-in method _thread.get_ident&gt; (&lt;built-in method _thread.get_ident&gt;)
&lt;method &#39;rfind&#39; of &#39;str&#39; objects&gt;                            --     18     18 -- 0.00003 0.00003 -- ~:0:&lt;method &#39;rfind&#39; of &#39;str&#39; objects&gt; (&lt;method &#39;rfind&#39; of &#39;str&#39; objects&gt;)
</pre></div>
</div>
</section>
<section id="if-gpu-is-available">
<h2><a class="toc-backref" href="#id3">if GPU is available</a><a class="headerlink" href="#if-gpu-is-available" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">get_device</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;GPU&#39;</span><span class="p">:</span>

    <span class="n">train_session</span> <span class="o">=</span> <span class="n">OrtGradientForwardBackwardOptimizer</span><span class="p">(</span>
        <span class="n">onx</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span>
        <span class="n">warm_start</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>

    <span class="n">benches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">benchmark</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">nn</span><span class="p">,</span>
                   <span class="n">train_session</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;NN-GPU&#39;</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="linear-regression">
<h2><a class="toc-backref" href="#id4">Linear Regression</a><a class="headerlink" href="#linear-regression" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lr</span> <span class="o">=</span> <span class="n">MLPRegressor</span><span class="p">(</span><span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(),</span> <span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span><span class="p">,</span>
                  <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;sgd&#39;</span><span class="p">,</span> <span class="n">learning_rate_init</span><span class="o">=</span><span class="mf">5e-2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                  <span class="n">n_iter_no_change</span><span class="o">=</span><span class="n">max_iter</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
                  <span class="n">nesterovs_momentum</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                  <span class="n">learning_rate</span><span class="o">=</span><span class="s2">&quot;invscaling&quot;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
    <span class="n">lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>


<span class="n">onx</span> <span class="o">=</span> <span class="n">to_onnx</span><span class="p">(</span><span class="n">lr</span><span class="p">,</span> <span class="n">X_train</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="n">target_opset</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="n">train_session</span> <span class="o">=</span> <span class="n">OrtGradientForwardBackwardOptimizer</span><span class="p">(</span>
    <span class="n">onx</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">5e-4</span><span class="p">,</span>
    <span class="n">warm_start</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>

<span class="n">benches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">benchmark</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> <span class="n">train_session</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;LR-CPU&#39;</span><span class="p">))</span>

<span class="k">if</span> <span class="n">get_device</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;GPU&#39;</span><span class="p">:</span>

    <span class="n">train_session</span> <span class="o">=</span> <span class="n">OrtGradientForwardBackwardOptimizer</span><span class="p">(</span>
        <span class="n">onx</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">5e-4</span><span class="p">,</span>
        <span class="n">warm_start</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>

    <span class="n">benches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">benchmark</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">nn</span><span class="p">,</span>
                   <span class="n">train_session</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;LR-GPU&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[benchmark] LR-CPU
/var/lib/jenkins/workspace/onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:692: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (100) reached and the optimization hasn&#39;t converged yet.
  warnings.warn(
[benchmark] skl=100 iterations - 3.7908142767846584 seconds
[benchmark] ort=100 iteration - 4.647024877369404 seconds
</pre></div>
</div>
</section>
<section id="gpu-profiling">
<h2><a class="toc-backref" href="#id5">GPU profiling</a><a class="headerlink" href="#gpu-profiling" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">get_device</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;GPU&#39;</span><span class="p">:</span>
    <span class="n">ps</span> <span class="o">=</span> <span class="n">profile</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">benchmark</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span>
                 <span class="n">lr</span><span class="p">,</span> <span class="n">train_session</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;LR-GPU&#39;</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">root</span><span class="p">,</span> <span class="n">nodes</span> <span class="o">=</span> <span class="n">profile2graph</span><span class="p">(</span><span class="n">ps</span><span class="p">,</span> <span class="n">clean_text</span><span class="o">=</span><span class="n">clean_name</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">to_text</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="graphs">
<h2><a class="toc-backref" href="#id6">Graphs</a><a class="headerlink" href="#graphs" title="Permalink to this headline">¶</a></h2>
<p>Dataframe first.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">benches</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>skl</th>
      <th>ort</th>
      <th>iter_skl</th>
      <th>iter_ort</th>
      <th>losses_skl</th>
      <th>losses_ort</th>
    </tr>
    <tr>
      <th>name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>NN-CPU</th>
      <td>9.955233</td>
      <td>9.524543</td>
      <td>100</td>
      <td>100</td>
      <td>[15617.180048828124, 3498.0628857421875, 2694....</td>
      <td>[23617.93, 18413.504, 17464.355, 16804.654, 14...</td>
    </tr>
    <tr>
      <th>LR-CPU</th>
      <td>3.790814</td>
      <td>4.647025</td>
      <td>100</td>
      <td>100</td>
      <td>[5484.546262207031, 291.9181568908691, 262.192...</td>
      <td>[19660.54, 18797.46, 18704.127, 17870.973, 155...</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<br />
<br /><p>text output</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>             skl  ...                                         losses_ort
name              ...
NN-CPU  9.955233  ...  [23617.93, 18413.504, 17464.355, 16804.654, 14...
LR-CPU  3.790814  ...  [19660.54, 18797.46, 18704.127, 17870.973, 155...

[2 rows x 6 columns]
</pre></div>
</div>
<p>Graphs.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">df</span><span class="p">[[</span><span class="s1">&#39;skl&#39;</span><span class="p">,</span> <span class="s1">&#39;ort&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Processing time&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="k">for</span> <span class="n">bench</span> <span class="ow">in</span> <span class="n">benches</span><span class="p">:</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bench</span><span class="p">[</span><span class="s1">&#39;losses_skl&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;skl-&#39;</span> <span class="o">+</span> <span class="n">bench</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bench</span><span class="p">[</span><span class="s1">&#39;losses_ort&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ort-&#39;</span> <span class="o">+</span> <span class="n">bench</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Losses&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_orttraining_benchmark_fwbw_001.png" srcset="../_images/sphx_glr_plot_orttraining_benchmark_fwbw_001.png" alt="Processing time, Losses" class = "sphx-glr-single-img"/><p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend object at 0x7f5cbef113d0&gt;
</pre></div>
</div>
<p>The gradient update are not exactly the same.
It should be improved for a fair comprison.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># plt.show()</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 1 minutes  7.291 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-gyexamples-plot-orttraining-benchmark-fwbw-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/af1b34d2f3f78a03f0844f1bee9cee56/plot_orttraining_benchmark_fwbw.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_orttraining_benchmark_fwbw.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/99e789a42cb57061421389c80f61e588/plot_orttraining_benchmark_fwbw.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_orttraining_benchmark_fwbw.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="plot_orttraining_nn_gpu_fwbw_nesterov.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Forward backward on a neural network on GPU (Nesterov) and penalty</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="plot_orttraining_benchmark_fwbw_cls.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Benchmark, comparison sklearn - forward-backward - classification</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
    <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2022, Xavier Dupré.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.4.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>