
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Benchmark, comparison scikit-learn - onnxruntime-training &#8212; onnxcustom</title>
    
    <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
  
    
    <link rel="stylesheet"
      href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">
  
    
      
  
    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/pydata-sphinx-theme.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/style_notebook_snippet.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinxtrib-images/LightBox2/lightbox2/css/lightbox.css" />
    <link rel="stylesheet" type="text/css" href="../_static/my-styles.css" />
    
    <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">
  
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script src="../_static/require.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script src="../_static/sphinxtrib-images/LightBox2/lightbox2/js/jquery-1.11.0.min.js"></script>
    <script src="../_static/sphinxtrib-images/LightBox2/lightbox2/js/lightbox.min.js"></script>
    <script src="../_static/sphinxtrib-images/LightBox2/lightbox2_customize/jquery-noconflict.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Partial Training with OrtGradientForwardBackwardOptimizer" href="../tutorials/tutorial_training/tutorial_6_training_partial.html" />
    <link rel="prev" title="Train a scikit-learn neural network with onnxruntime-training on GPU" href="plot_orttraining_nn_gpu.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/project_ico.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../tutorials/index.html">
  Tutorials
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../api/apis.html">
  API
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="index.html">
  Examples Gallery
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../all_notebooks.html">
  Notebooks Gallery
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../other_pages.html">
  Other pages
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../blog/blogindex.html">
  Blog Gallery
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/tutorial_onnx/index.html">
   Introduction to ONNX
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/tutorial_onnxruntime/index.html">
   Introduction to onnxruntime
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/tutorial_skl/index.html">
   scikit-learn to ONNX Tutorial
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../tutorials/tutorial_training/index.html">
   Training Tutorial
  </a>
  <input checked class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="../tutorials/tutorial_training/tutorial_6_training.html">
     Full Training with OrtGradientOptimizer
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3">
      <a class="reference internal" href="plot_orttraining_linear_regression.html">
       Train a linear regression with onnxruntime-training
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="plot_orttraining_linear_regression_cpu.html">
       Train a linear regression with onnxruntime-training in details
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="plot_orttraining_linear_regression_gpu.html">
       Train a linear regression with onnxruntime-training on GPU in details
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="plot_orttraining_nn_gpu.html">
       Train a scikit-learn neural network with onnxruntime-training on GPU
      </a>
     </li>
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       Benchmark, comparison scikit-learn - onnxruntime-training
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/tutorial_training/tutorial_6_training_partial.html">
     Partial Training with OrtGradientForwardBackwardOptimizer
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/tutorial_bench/index.html">
   Benchmarking and profiling Tutorial
  </a>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#first-comparison-neural-network">
   First comparison: neural network
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#profiling">
   Profiling
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#if-gpu-is-available">
   if GPU is available
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#linear-regression">
   Linear Regression
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gpu-profiling">
   GPU profiling
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#graphs">
   Graphs
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-gyexamples-plot-orttraining-benchmark-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="benchmark-comparison-scikit-learn-onnxruntime-training">
<span id="l-orttraining-benchmark"></span><span id="sphx-glr-gyexamples-plot-orttraining-benchmark-py"></span><h1>Benchmark, comparison scikit-learn - onnxruntime-training<a class="headerlink" href="#benchmark-comparison-scikit-learn-onnxruntime-training" title="Permalink to this headline">¶</a></h1>
<p>The benchmark compares the processing time between <a class="reference external" href="https://scikit-learn.org/stable/">scikit-learn</a>
and <a class="reference external" href="https://github.com/microsoft/onnxruntime/tree/master/orttraining">onnxruntime-training</a> on a linear regression and a neural network.
It uses the model trained in <a class="reference internal" href="plot_orttraining_nn_gpu.html#l-orttraining-nn-gpu"><span class="std std-ref">Train a scikit-learn neural network with onnxruntime-training on GPU</span></a>.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#first-comparison-neural-network" id="id1">First comparison: neural network</a></p></li>
<li><p><a class="reference internal" href="#profiling" id="id2">Profiling</a></p></li>
<li><p><a class="reference internal" href="#if-gpu-is-available" id="id3">if GPU is available</a></p></li>
<li><p><a class="reference internal" href="#linear-regression" id="id4">Linear Regression</a></p></li>
<li><p><a class="reference internal" href="#gpu-profiling" id="id5">GPU profiling</a></p></li>
<li><p><a class="reference internal" href="#graphs" id="id6">Graphs</a></p></li>
</ul>
</div>
<section id="first-comparison-neural-network">
<h2><a class="toc-backref" href="#id1">First comparison: neural network</a><a class="headerlink" href="#first-comparison-neural-network" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">DataFrame</span>
<span class="kn">from</span> <span class="nn">onnxruntime</span> <span class="kn">import</span> <span class="n">get_device</span>
<span class="kn">from</span> <span class="nn">pyquickhelper.pycode.profiling</span> <span class="kn">import</span> <span class="n">profile</span><span class="p">,</span> <span class="n">profile2graph</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_regression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPRegressor</span>
<span class="kn">from</span> <span class="nn">mlprodict.onnx_conv</span> <span class="kn">import</span> <span class="n">to_onnx</span>
<span class="kn">from</span> <span class="nn">onnxcustom.utils.orttraining_helper</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">add_loss_output</span><span class="p">,</span> <span class="n">get_train_initializer</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">onnxcustom.training.optimizers</span> <span class="kn">import</span> <span class="n">OrtGradientOptimizer</span>


<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_regression</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>Benchmark function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">benchmark</span><span class="p">(</span><span class="n">skl_model</span><span class="p">,</span> <span class="n">train_session</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :param skl_model: model from scikit-learn</span>
<span class="sd">    :param train_session: instance of OrtGradientOptimizer</span>
<span class="sd">    :param name: experiment name</span>
<span class="sd">    :param verbose: to debug</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[benchmark] </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
    <span class="n">begin</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">skl_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">duration_skl</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">begin</span>
    <span class="n">length_skl</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">skl_model</span><span class="o">.</span><span class="n">loss_curve_</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[benchmark] skl=</span><span class="si">%r</span><span class="s2"> iterations - </span><span class="si">%r</span><span class="s2"> seconds&quot;</span> <span class="o">%</span> <span class="p">(</span>
        <span class="n">length_skl</span><span class="p">,</span> <span class="n">duration_skl</span><span class="p">))</span>

    <span class="n">begin</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">train_session</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">duration_ort</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">begin</span>
    <span class="n">length_ort</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_session</span><span class="o">.</span><span class="n">train_losses_</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[benchmark] ort=</span><span class="si">%r</span><span class="s2"> iterations - </span><span class="si">%r</span><span class="s2"> seconds&quot;</span> <span class="o">%</span> <span class="p">(</span>
        <span class="n">length_ort</span><span class="p">,</span> <span class="n">duration_ort</span><span class="p">))</span>

    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">skl</span><span class="o">=</span><span class="n">duration_skl</span><span class="p">,</span> <span class="n">ort</span><span class="o">=</span><span class="n">duration_ort</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">iter_skl</span><span class="o">=</span><span class="n">length_skl</span><span class="p">,</span> <span class="n">iter_ort</span><span class="o">=</span><span class="n">length_ort</span><span class="p">,</span>
                <span class="n">losses_skl</span><span class="o">=</span><span class="n">skl_model</span><span class="o">.</span><span class="n">loss_curve_</span><span class="p">,</span>
                <span class="n">losses_ort</span><span class="o">=</span><span class="n">train_session</span><span class="o">.</span><span class="n">train_losses_</span><span class="p">)</span>
</pre></div>
</div>
<p>Common parameters and model</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">max_iter</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">nn</span> <span class="o">=</span> <span class="n">MLPRegressor</span><span class="p">(</span><span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span><span class="p">,</span>
                  <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;sgd&#39;</span><span class="p">,</span> <span class="n">learning_rate_init</span><span class="o">=</span><span class="mf">5e-4</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                  <span class="n">n_iter_no_change</span><span class="o">=</span><span class="n">max_iter</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
                  <span class="n">nesterovs_momentum</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                  <span class="n">learning_rate</span><span class="o">=</span><span class="s1">&#39;invscaling&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
<p>Conversion to ONNX and trainer initialization</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">onx</span> <span class="o">=</span> <span class="n">to_onnx</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="n">X_train</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="n">target_opset</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">onx_train</span> <span class="o">=</span> <span class="n">add_loss_output</span><span class="p">(</span><span class="n">onx</span><span class="p">)</span>

<span class="n">weights</span> <span class="o">=</span> <span class="n">get_train_initializer</span><span class="p">(</span><span class="n">onx</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="nb">list</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">weights</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>

<span class="n">train_session</span> <span class="o">=</span> <span class="n">OrtGradientOptimizer</span><span class="p">(</span>
    <span class="n">onx_train</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">weights</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span>
    <span class="n">warm_start</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>


<span class="n">benches</span> <span class="o">=</span> <span class="p">[</span><span class="n">benchmark</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="n">train_session</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;NN-CPU&#39;</span><span class="p">)]</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[(&#39;coefficient&#39;, (100, 50)),
 (&#39;intercepts&#39;, (1, 50)),
 (&#39;coefficient1&#39;, (50, 10)),
 (&#39;intercepts1&#39;, (1, 10)),
 (&#39;coefficient2&#39;, (10, 1)),
 (&#39;intercepts2&#39;, (1, 1))]
[benchmark] NN-CPU
/var/lib/jenkins/workspace/onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:692: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (100) reached and the optimization hasn&#39;t converged yet.
  warnings.warn(
[benchmark] skl=100 iterations - 13.335429698228836 seconds
[benchmark] ort=100 iterations - 4.608651174232364 seconds
</pre></div>
</div>
</section>
<section id="profiling">
<h2><a class="toc-backref" href="#id2">Profiling</a><a class="headerlink" href="#profiling" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">clean_name</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;onnxruntime&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pos</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">text</span><span class="p">[</span><span class="n">pos</span><span class="p">:]</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;onnxcustom&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pos</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">text</span><span class="p">[</span><span class="n">pos</span><span class="p">:]</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;site-packages&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pos</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">text</span><span class="p">[</span><span class="n">pos</span><span class="p">:]</span>
    <span class="k">return</span> <span class="n">text</span>


<span class="n">ps</span> <span class="o">=</span> <span class="n">profile</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">benchmark</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="n">train_session</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;NN-CPU&#39;</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">root</span><span class="p">,</span> <span class="n">nodes</span> <span class="o">=</span> <span class="n">profile2graph</span><span class="p">(</span><span class="n">ps</span><span class="p">,</span> <span class="n">clean_text</span><span class="o">=</span><span class="n">clean_name</span><span class="p">)</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">to_text</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[benchmark] NN-CPU
/var/lib/jenkins/workspace/onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:692: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (100) reached and the optimization hasn&#39;t converged yet.
  warnings.warn(
[benchmark] skl=100 iterations - 15.15220940951258 seconds
[benchmark] ort=100 iterations - 4.6757753398269415 seconds
filter                                                       --     18     18 -- 0.00007 0.00018 -- /usr/local/lib/python3.9/logging/__init__.py:787:filter (filter)
    filter                                                   --     12     12 -- 0.00002 0.00002 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:358:filter (filter)
    filter                                                   --      6      6 -- 0.00005 0.00007 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:491:filter (filter)
        &lt;built-in method builtins.isinstance&gt;                --     18     18 -- 0.00001 0.00001 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
    &lt;built-in method builtins.hasattr&gt;                       --     18     18 -- 0.00002 0.00002 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
acquire                                                      --     30     30 -- 0.00007 0.00012 -- /usr/local/lib/python3.9/logging/__init__.py:892:acquire (acquire)
    &lt;method &#39;acquire&#39; of &#39;_thread.RLock&#39; objects&gt;            --     30     30 -- 0.00005 0.00005 -- ~:0:&lt;method &#39;acquire&#39; of &#39;_thread.RLock&#39; objects&gt; (&lt;method &#39;acquire&#39; of &#39;_thread.RLock&#39; objects&gt;)
release                                                      --     30     30 -- 0.00007 0.00008 -- /usr/local/lib/python3.9/logging/__init__.py:899:release (release)
    &lt;method &#39;release&#39; of &#39;_thread.RLock&#39; objects&gt;            --     30     30 -- 0.00002 0.00002 -- ~:0:&lt;method &#39;release&#39; of &#39;_thread.RLock&#39; objects&gt; (&lt;method &#39;release&#39; of &#39;_thread.RLock&#39; objects&gt;)
emit                                                         --     12     12 -- 0.00009 0.00114 -- /usr/local/lib/python3.9/logging/__init__.py:1067:emit (emit)
    format                                                   --     12     12 -- 0.00004 0.00059 -- /usr/local/lib/python3.9/logging/__init__.py:912:format (format)
        format                                               --     12     12 -- 0.00010 0.00055 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:536:format (format)
            format                                           --     12     12 -- 0.00008 0.00040 -- /usr/local/lib/python3.9/logging/__init__.py:646:format (format)
                usesTime                                     --     12     12 -- 0.00003 0.00009 -- /usr/local/lib/python3.9/logging/__init__.py:624:usesTime (usesTime)
                    usesTime                                 --     12     12 -- 0.00004 0.00006 -- /usr/local/lib/python3.9/logging/__init__.py:417:usesTime (usesTime)
                        &lt;method &#39;find&#39; of &#39;str&#39; objects&gt;     --     12     12 -- 0.00002 0.00002 -- ~:0:&lt;method &#39;find&#39; of &#39;str&#39; objects&gt; (&lt;method &#39;find&#39; of &#39;str&#39; objects&gt;)
                formatMessage                                --     12     12 -- 0.00002 0.00009 -- /usr/local/lib/python3.9/logging/__init__.py:630:formatMessage (formatMessage)
                    format                                   --     12     12 -- 0.00002 0.00007 -- /usr/local/lib/python3.9/logging/__init__.py:428:format (format)
                        _format                              --     12     12 -- 0.00005 0.00005 -- /usr/local/lib/python3.9/logging/__init__.py:425:_format (_format)
                getMessage                                   --     12     12 -- 0.00007 0.00014 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:96:getMessage (getMessage)
                    getMessage                               --     12     12 -- 0.00006 0.00006 -- /usr/local/lib/python3.9/logging/__init__.py:354:getMessage (getMessage)
                    &lt;built-in method builtins.getattr&gt;       --     12     12 -- 0.00001 0.00001 -- ~:0:&lt;built-in method builtins.getattr&gt; (&lt;built-in method builtins.getattr&gt;) +++
            colorize                                         --      2      2 -- 0.00001 0.00003 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/console.py:85:colorize (colorize)
                escseq                                       --      4      4 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/console.py:86:escseq (escseq)
            &lt;built-in method builtins.getattr&gt;               --     12     12 -- 0.00001 0.00001 -- ~:0:&lt;built-in method builtins.getattr&gt; (&lt;built-in method builtins.getattr&gt;) +++
    flush                                                    --     12     12 -- 0.00007 0.00039 -- /usr/local/lib/python3.9/logging/__init__.py:1056:flush (flush)
        acquire                                              --     12     12 -- 0.00002 0.00004 -- /usr/local/lib/python3.9/logging/__init__.py:892:acquire (acquire) +++
        release                                              --     12     12 -- 0.00003 0.00004 -- /usr/local/lib/python3.9/logging/__init__.py:899:release (release) +++
        flush                                                --      6      6 -- 0.00003 0.00023 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:562:flush (flush)
            &lt;method &#39;flush&#39; of &#39;_io.TextIOWrapper&#39; objects&gt;  --      6      6 -- 0.00020 0.00020 -- ~:0:&lt;method &#39;flush&#39; of &#39;_io.TextIOWrapper&#39; objects&gt; (&lt;method &#39;flush&#39; of &#39;_io.TextIOWrapper&#39; objects&gt;)
        &lt;built-in method builtins.hasattr&gt;                   --     12     12 -- 0.00001 0.00001 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
    write                                                    --      6      6 -- 0.00002 0.00003 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:554:write (write)
    write                                                    --      6      6 -- 0.00003 0.00004 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:572:write (write)
isEnabledFor                                                 --     12     12 -- 0.00002 0.00002 -- /usr/local/lib/python3.9/logging/__init__.py:1677:isEnabledFor (isEnabledFor)
__init__                                                     --      2      2 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/warnings.py:403:__init__ (__init__)
&lt;lambda&gt;                                                     --      1      1 -- 0.00001 19.83039 -- onnxcustom/onnxcustom_UT_39_std/_doc/examples/plot_orttraining_benchmark.py:124:&lt;lambda&gt; (&lt;lambda&gt;)
    benchmark                                                --      1      1 -- 0.00014 19.83039 -- onnxcustom/onnxcustom_UT_39_std/_doc/examples/plot_orttraining_benchmark.py:46:benchmark (benchmark)
        fit                                                  --      1      1 -- 0.00750 4.67572 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers.py:79:fit (fit)
            __init__                                         --      1      1 -- 0.00005 0.00011 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/data_loader.py:31:__init__ (__init__)
                get_ort_device                               --      1      1 -- 0.00000 0.00000 -- onnxruntime_helper.py:63:get_ort_device (get_ort_device)
                numpy_to_ort_value                           --      2      2 -- 0.00001 0.00004 -- onnxruntime_helper.py:134:numpy_to_ort_value (numpy_to_ort_value) +++
            &lt;listcomp&gt;                                       --      1      1 -- 0.00003 0.00003 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers.py:96:&lt;listcomp&gt; (&lt;listcomp&gt;)
            &lt;listcomp&gt;                                       --      1      1 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers.py:131:&lt;listcomp&gt; (&lt;listcomp&gt;)
            &lt;listcomp&gt;                                       --      1      1 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers.py:132:&lt;listcomp&gt; (&lt;listcomp&gt;)
            _iteration                                       --    100    100 -- 3.83724 4.64225 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers.py:195:_iteration (_iteration)
                iter_bind                                    --   6800   6800 -- 0.06661 0.76275 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/data_loader.py:188:iter_bind (iter_bind)
                    _next_iter                               --   6700   6700 -- 0.03668 0.35510 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/data_loader.py:98:_next_iter (_next_iter)
                        &lt;method &#39;randint&#39;...mState&#39; objects&gt; --   6700   6700 -- 0.30146 0.30146 -- ~:0:&lt;method &#39;randint&#39; of &#39;numpy.random.mtrand.RandomState&#39; objects&gt; (&lt;method &#39;randint&#39; of &#39;numpy.random.mtrand.RandomState&#39; objects&gt;)
                        &lt;built-in method builtins.len&gt;       --   6700   6700 -- 0.01080 0.01696 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;) +++
                    local_bind                               --   6700   6700 -- 0.29926 0.29926 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/data_loader.py:209:local_bind (local_bind)
                    &lt;built-in method builtins.len&gt;           --   7100   7100 -- 0.02404 0.04177 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;) +++
                _bind_input_ortvalue                         --    100    100 -- 0.00175 0.00185 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers.py:167:_bind_input_ortvalue (_bind_input_ortvalue)
                    &lt;built-in method builtins.isinstance&gt;    --    200    200 -- 0.00010 0.00010 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
                &lt;method &#39;mean&#39; of &#39;numpy.ndarray&#39; objects&gt;   --    100    100 -- 0.00077 0.01698 -- ~:0:&lt;method &#39;mean&#39; of &#39;numpy.ndarray&#39; objects&gt; (&lt;method &#39;mean&#39; of &#39;numpy.ndarray&#39; objects&gt;) +++
                &lt;built-in method numpy.array&gt;                --    100    100 -- 0.01601 0.01601 -- ~:0:&lt;built-in method numpy.array&gt; (&lt;built-in method numpy.array&gt;) +++
                &lt;method &#39;append&#39; of &#39;list&#39; objects&gt;          --   6700   6700 -- 0.00740 0.00740 -- ~:0:&lt;method &#39;append&#39; of &#39;list&#39; objects&gt; (&lt;method &#39;append&#39; of &#39;list&#39; objects&gt;) +++
            _create_training_session                         --      1      1 -- 0.00021 0.01715 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers.py:277:_create_training_session (_create_training_session)
                &lt;dictcomp&gt;                                   --      1      1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers.py:325:&lt;dictcomp&gt; (&lt;dictcomp&gt;)
                &lt;dictcomp&gt;                                   --      1      1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers.py:327:&lt;dictcomp&gt; (&lt;dictcomp&gt;)
                __init__                                     --      1      1 -- 0.01649 0.01659 -- onnxruntime/capi/training/training_session.py:15:__init__ (__init__)
                    check_and_normalize_provider_args        --      1      1 -- 0.00005 0.00009 -- onnxruntime/capi/onnxruntime_inference_collection.py:25:check_and_normalize_provider_args (check_and_normalize_provider_args)
                        set_provider_options                 --      1      1 -- 0.00001 0.00002 -- onnxruntime/capi/onnxruntime_inference_collection.py:53:set_provider_options (set_provider_options)
                            &lt;dictcomp&gt;                       --      1      1 -- 0.00000 0.00000 -- onnxruntime/capi/onnxruntime_inference_collection.py:62:&lt;dictcomp&gt; (&lt;dictcomp&gt;)
                    __init__                                 --      1      1 -- 0.00000 0.00000 -- onnxruntime/capi/onnxruntime_inference_collection.py:101:__init__ (__init__)
                device_to_providers                          --      1      1 -- 0.00002 0.00002 -- onnxruntime_helper.py:150:device_to_providers (device_to_providers)
                &lt;method &#39;SerializeToS...e.CMessage&#39; objects&gt; --      1      1 -- 0.00031 0.00031 -- ~:0:&lt;method &#39;SerializeToString&#39; of &#39;google.protobuf.pyext._message.CMessage&#39; objects&gt; (&lt;method &#39;SerializeToString&#39; of &#39;google.protobuf.pyext._message.CMessage&#39; objects&gt;)
            get_state                                        --      1      1 -- 0.00001 0.00029 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers.py:342:get_state (get_state)
                get_state                                    --      1      1 -- 0.00027 0.00027 -- onnxruntime/capi/training/training_session.py:47:get_state (get_state) +++
            set_state                                        --      1      1 -- 0.00001 0.00010 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers.py:374:set_state (set_state)
                load_state                                   --      1      1 -- 0.00009 0.00009 -- onnxruntime/capi/training/training_session.py:59:load_state (load_state)
            value                                            --    101    101 -- 0.00016 0.00016 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/sgd_learning_rate.py:186:value (value)
            init_learning_rate                               --      1      1 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/sgd_learning_rate.py:205:init_learning_rate (init_learning_rate)
            update_learning_rate                             --    100    100 -- 0.00339 0.00339 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/sgd_learning_rate.py:226:update_learning_rate (update_learning_rate)
            get_inputs                                       --      1      1 -- 0.00000 0.00000 -- onnxruntime/capi/onnxruntime_inference_collection.py:111:get_inputs (get_inputs)
            get_outputs                                      --      1      1 -- 0.00000 0.00000 -- onnxruntime/capi/onnxruntime_inference_collection.py:115:get_outputs (get_outputs)
            io_binding                                       --      1      1 -- 0.00001 0.00002 -- onnxruntime/capi/onnxruntime_inference_collection.py:265:io_binding (io_binding)
                __init__                                     --      1      1 -- 0.00002 0.00002 -- onnxruntime/capi/onnxruntime_inference_collection.py:416:__init__ (__init__)
            __del__                                          --      1      1 -- 0.00001 0.00001 -- onnxruntime/capi/training/training_session.py:43:__del__ (__del__)
            get_state                                        --      1      1 -- 0.00010 0.00010 -- onnxruntime/capi/training/training_session.py:47:get_state (get_state) +++
            numpy_to_ort_value                               --    100    100 -- 0.00053 0.00262 -- onnxruntime_helper.py:134:numpy_to_ort_value (numpy_to_ort_value) +++
            &lt;method &#39;randn&#39; of &#39;num....RandomState&#39; objects&gt; --      6      6 -- 0.00078 0.00078 -- ~:0:&lt;method &#39;randn&#39; of &#39;numpy.random.mtrand.RandomState&#39; objects&gt; (&lt;method &#39;randn&#39; of &#39;numpy.random.mtrand.RandomState&#39; objects&gt;)
            &lt;built-in method numpy.array&gt;                    --    100    100 -- 0.00102 0.00102 -- ~:0:&lt;built-in method numpy.array&gt; (&lt;built-in method numpy.array&gt;) +++
            &lt;method &#39;append&#39; of &#39;list&#39; objects&gt;              --    100    100 -- 0.00009 0.00009 -- ~:0:&lt;method &#39;append&#39; of &#39;list&#39; objects&gt; (&lt;method &#39;append&#39; of &#39;list&#39; objects&gt;) +++
        fit                                                  --      1      1 -- 0.00002 15.15220 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:735:fit (fit)
            _fit                                             --      1      1 -- 0.00016 15.15217 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:376:_fit (_fit)
                any                                          --      1      1 -- 0.00002 0.00011 -- &lt;__array_function__ internals&gt;:177:any (any)
                    _any_dispatcher                          --      1      1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:2300:_any_dispatcher (_any_dispatcher)
                _initialize                                  --      1      1 -- 0.00006 0.00066 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:319:_initialize (_initialize)
                    is_classifier                            --      1      1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/base.py:960:is_classifier (is_classifier)
                    _init_coef                               --      3      3 -- 0.00011 0.00059 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:359:_init_coef (_init_coef)
                        &lt;method &#39;uniform&#39;...mState&#39; objects&gt; --      6      6 -- 0.00041 0.00041 -- ~:0:&lt;method &#39;uniform&#39; of &#39;numpy.random.mtrand.RandomState&#39; objects&gt; (&lt;method &#39;uniform&#39; of &#39;numpy.random.mtrand.RandomState&#39; objects&gt;)
                &lt;listcomp&gt;                                   --      1      1 -- 0.00001 0.00003 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:416:&lt;listcomp&gt; (&lt;listcomp&gt;)
                &lt;listcomp&gt;                                   --      1      1 -- 0.00001 0.00003 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:421:&lt;listcomp&gt; (&lt;listcomp&gt;)
                _validate_hyperparameters                    --      1      1 -- 0.00002 0.00002 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:445:_validate_hyperparameters (_validate_hyperparameters)
                _fit_stochastic                              --      1      1 -- 0.38009 15.14973 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:553:_fit_stochastic (_fit_stochastic)
                    clip                                     --      1      1 -- 0.00001 0.00022 -- &lt;__array_function__ internals&gt;:177:clip (clip)
                        _clip_dispatcher                     --      1      1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:2079:_clip_dispatcher (_clip_dispatcher)
                        &lt;built-in method ..._array_function&gt; --      1      1 -- 0.00000 0.00021 -- ~:0:&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt; (&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt;) +++
                    _backprop                                --   6700   6700 -- 0.82448 10.51713 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:240:_backprop (_backprop)
                        dot                                  --  20100  20100 -- 0.09415 0.39232 -- &lt;__array_function__ internals&gt;:177:dot (dot)
                            dot                              --  20100  20100 -- 0.01701 0.01701 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/multiarray.py:736:dot (dot)
                            &lt;built-in metho...rray_function&gt; --  20100  20100 -- 0.28116 0.28116 -- ~:0:&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt; (&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt;) +++
                        inplace_relu_derivative              --  13400  13400 -- 0.58063 0.58063 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/neural_network/_base.py:132:inplace_relu_derivative (inplace_relu_derivative)
                        squared_loss                         --   6700   6700 -- 0.34088 1.20022 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/neural_network/_base.py:158:squared_loss (squared_loss)
                            &lt;method &#39;mean&#39; ...rray&#39; objects&gt; --   6700   6700 -- 0.03826 0.85934 -- ~:0:&lt;method &#39;mean&#39; of &#39;numpy.ndarray&#39; objects&gt; (&lt;method &#39;mean&#39; of &#39;numpy.ndarray&#39; objects&gt;) +++
                        _forward_pass                        --   6700   6700 -- 0.67786 2.05249 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:118:_forward_pass (_forward_pass)
                            inplace_identity                 --   6700   6700 -- 0.00638 0.00638 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/neural_network/_base.py:13:inplace_identity (inplace_identity)
                            inplace_relu                     --  13400  13400 -- 0.45201 0.45201 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/neural_network/_base.py:47:inplace_relu (inplace_relu)
                            safe_sparse_dot                  --  20100  20100 -- 0.85704 0.91624 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/utils/extmath.py:120:safe_sparse_dot (safe_sparse_dot) +++
                        _compute_loss_grad                   --  20100  20100 -- 1.75325 4.98714 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:176:_compute_loss_grad (_compute_loss_grad)
                            mean                             --  20100  20100 -- 0.10212 2.28254 -- &lt;__array_function__ internals&gt;:177:mean (mean)
                                _mean_dispatcher             --  20100  20100 -- 0.01921 0.01921 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:3351:_mean_dispatcher (_mean_dispatcher)
                                &lt;built-in met...ay_function&gt; --  20100  20100 -- 0.09088 2.16122 -- ~:0:&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt; (&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt;) +++
                            safe_sparse_dot                  --  20100  20100 -- 0.89182 0.95134 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/utils/extmath.py:120:safe_sparse_dot (safe_sparse_dot) +++
                        safe_sparse_dot                      --  13400  13400 -- 0.39417 0.43325 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/utils/extmath.py:120:safe_sparse_dot (safe_sparse_dot) +++
                        &lt;method &#39;ravel&#39; o...darray&#39; objects&gt; --  20100  20100 -- 0.04660 0.04660 -- ~:0:&lt;method &#39;ravel&#39; of &#39;numpy.ndarray&#39; objects&gt; (&lt;method &#39;ravel&#39; of &#39;numpy.ndarray&#39; objects&gt;)
                    _update_no_improvement_count             --    100    100 -- 0.00078 0.00078 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:706:_update_no_improvement_count (_update_no_improvement_count)
                    update_params                            --   6700   6700 -- 0.61115 2.75446 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/neural_network/_stochastic_optimizers.py:29:update_params (update_params)
                        &lt;genexpr&gt;                            --  46900  46900 -- 0.04511 0.04511 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/neural_network/_stochastic_optimizers.py:43:&lt;genexpr&gt; (&lt;genexpr&gt;)
                        _get_updates                         --   6700   6700 -- 0.09547 2.09821 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/neural_network/_stochastic_optimizers.py:169:_get_updates (_get_updates)
                            &lt;listcomp&gt;                       --   6700   6700 -- 2.00274 2.00274 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/neural_network/_stochastic_optimizers.py:183:&lt;listcomp&gt; (&lt;listcomp&gt;)
                    __init__                                 --      1      1 -- 0.00002 0.00042 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/neural_network/_stochastic_optimizers.py:121:__init__ (__init__)
                        __init__                             --      1      1 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/neural_network/_stochastic_optimizers.py:25:__init__ (__init__)
                        &lt;listcomp&gt;                           --      1      1 -- 0.00003 0.00040 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/neural_network/_stochastic_optimizers.py:136:&lt;listcomp&gt; (&lt;listcomp&gt;)
                            zeros_like                       --      6      6 -- 0.00002 0.00037 -- &lt;__array_function__ internals&gt;:177:zeros_like (zeros_like)
                                _zeros_like_dispatcher       --      6      6 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/numeric.py:72:_zeros_like_dispatcher (_zeros_like_dispatcher)
                                &lt;built-in met...ay_function&gt; --      6      6 -- 0.00003 0.00035 -- ~:0:&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt; (&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt;) +++
                    iteration_ends                           --    100    100 -- 0.00116 0.00116 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/neural_network/_stochastic_optimizers.py:138:iteration_ends (iteration_ends)
                    _safe_indexing                           --   6700   6700 -- 0.07372 1.37448 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/utils/__init__.py:307:_safe_indexing (_safe_indexing) +++
                    shuffle                                  --    100    100 -- 0.00118 0.05485 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/utils/__init__.py:602:shuffle (shuffle)
                        resample                             --    100    100 -- 0.00322 0.05367 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/utils/__init__.py:452:resample (resample)
                            &lt;listcomp&gt;                       --    100    100 -- 0.00040 0.00072 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/utils/__init__.py:593:&lt;listcomp&gt; (&lt;listcomp&gt;)
                                isspmatrix                   --    100    100 -- 0.00016 0.00032 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_base.py:1291:isspmatrix (isspmatrix) +++
                            &lt;listcomp&gt;                       --    100    100 -- 0.00037 0.01977 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/utils/__init__.py:594:&lt;listcomp&gt; (&lt;listcomp&gt;)
                                _safe_indexing               --    100    100 -- 0.00102 0.01939 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/utils/__init__.py:307:_safe_indexing (_safe_indexing) +++
                            check_consistent_length          --    100    100 -- 0.00117 0.01697 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/utils/validation.py:318:check_consistent_length (check_consistent_length) +++
                            check_random_state               --    100    100 -- 0.00092 0.00245 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/utils/validation.py:1043:check_random_state (check_random_state) +++
                            &lt;method &#39;shuffl...tate&#39; objects&gt; --    100    100 -- 0.00785 0.00785 -- ~:0:&lt;method &#39;shuffle&#39; of &#39;numpy.random.mtrand.RandomState&#39; objects&gt; (&lt;method &#39;shuffle&#39; of &#39;numpy.random.mtrand.RandomState&#39; objects&gt;)
                            &lt;built-in method numpy.arange&gt;   --    100    100 -- 0.00229 0.00229 -- ~:0:&lt;built-in method numpy.arange&gt; (&lt;built-in method numpy.arange&gt;) +++
                            &lt;built-in metho...ltins.hasattr&gt; --    100    100 -- 0.00023 0.00023 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
                            &lt;built-in method builtins.len&gt;   --    200    200 -- 0.00016 0.00016 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;) +++
                    gen_batches                              --   6800   6800 -- 0.06366 0.06472 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/utils/__init__.py:712:gen_batches (gen_batches)
                        &lt;built-in method ...tins.isinstance&gt; --    100    100 -- 0.00034 0.00105 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
                    &lt;method &#39;append&#39; of &#39;list&#39; objects&gt;      --    100    100 -- 0.00019 0.00019 -- ~:0:&lt;method &#39;append&#39; of &#39;list&#39; objects&gt; (&lt;method &#39;append&#39; of &#39;list&#39; objects&gt;) +++
                    &lt;built-in method _warnings.warn&gt;         --      1      1 -- 0.00007 0.00122 -- ~:0:&lt;built-in method _warnings.warn&gt; (&lt;built-in method _warnings.warn&gt;)
                        _showwarnmsg                         --      1      1 -- 0.00006 0.00114 -- /usr/local/lib/python3.9/warnings.py:96:_showwarnmsg (_showwarnmsg)
                            _showwarning                     --      1      1 -- 0.00001 0.00108 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx_gallery/gen_rst.py:473:_showwarning (_showwarning)
                                formatwarning                --      1      1 -- 0.00001 0.00006 -- /usr/local/lib/python3.9/warnings.py:15:formatwarning (formatwarning)
                                    _formatwarnmsg_impl      --      1      1 -- 0.00004 0.00005 -- /usr/local/lib/python3.9/warnings.py:35:_formatwarnmsg_impl (_formatwarnmsg_impl)
                                        getline              --      1      1 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/linecache.py:26:getline (getline)
                                            getlines         --      1      1 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/linecache.py:36:getlines (getlines)
                                    __init__                 --      1      1 -- 0.00000 0.00000 -- /usr/local/lib/python3.9/warnings.py:403:__init__ (__init__) +++
                                write                        --      1      1 -- 0.00002 0.00100 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx_gallery/gen_rst.py:81:write (write) +++
                        __init__                             --      1      1 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/warnings.py:403:__init__ (__init__) +++
                _validate_input                              --      1      1 -- 0.00002 0.00140 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:1588:_validate_input (_validate_input)
                    _validate_data                           --      1      1 -- 0.00003 0.00138 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/base.py:495:_validate_data (_validate_data)
                        _check_n_features                    --      1      1 -- 0.00001 0.00002 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/base.py:359:_check_n_features (_check_n_features)
                            _num_features                    --      1      1 -- 0.00001 0.00002 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/utils/validation.py:201:_num_features (_num_features)
                        _check_feature_names                 --      1      1 -- 0.00000 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/base.py:405:_check_feature_names (_check_feature_names)
                            _get_feature_names               --      1      1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/utils/validation.py:1653:_get_feature_names (_get_feature_names)
                        check_X_y                            --      1      1 -- 0.00001 0.00132 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/utils/validation.py:845:check_X_y (check_X_y)
                            check_consistent_length          --      1      1 -- 0.00001 0.00021 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/utils/validation.py:318:check_consistent_length (check_consistent_length) +++
                            check_array                      --      1      1 -- 0.00007 0.00074 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/utils/validation.py:494:check_array (check_array) +++
                            _check_y                         --      1      1 -- 0.00001 0.00035 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/utils/validation.py:986:_check_y (_check_y)
                                check_array                  --      1      1 -- 0.00004 0.00035 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/utils/validation.py:494:check_array (check_array) +++
                check_random_state                           --      1      1 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/utils/validation.py:1043:check_random_state (check_random_state) +++
        &lt;built-in method builtins.print&gt;                     --      3      3 -- 0.00004 0.00232 -- ~:0:&lt;built-in method builtins.print&gt; (&lt;built-in method builtins.print&gt;)
            write                                            --      6      6 -- 0.00010 0.00228 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx_gallery/gen_rst.py:81:write (write) +++
_mean                                                        --  26900  26900 -- 1.35147 2.70723 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/_methods.py:162:_mean (_mean)
    _count_reduce_items                                      --  26900  26900 -- 0.51890 0.59270 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/_methods.py:66:_count_reduce_items (_count_reduce_items)
        &lt;built-in method numpy.co...th.normalize_axis_index&gt; --  33800  33800 -- 0.04794 0.04794 -- ~:0:&lt;built-in method numpy.core._multiarray_umath.normalize_axis_index&gt; (&lt;built-in method numpy.core._multiarray_umath.normalize_axis_index&gt;)
        &lt;built-in method builtins.isinstance&gt;                --  20100  20100 -- 0.02586 0.02586 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
    &lt;built-in method numpy.asanyarray&gt;                       --  26900  26900 -- 0.01911 0.01911 -- ~:0:&lt;built-in method numpy.asanyarray&gt; (&lt;built-in method numpy.asanyarray&gt;) +++
    &lt;method &#39;reduce&#39; of &#39;numpy.ufunc&#39; objects&gt;               --  26900  26900 -- 0.65834 0.65834 -- ~:0:&lt;method &#39;reduce&#39; of &#39;numpy.ufunc&#39; objects&gt; (&lt;method &#39;reduce&#39; of &#39;numpy.ufunc&#39; objects&gt;) +++
    &lt;built-in method builtins.hasattr&gt;                       --   6800   6800 -- 0.01237 0.01237 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
    &lt;built-in method builtins.isinstance&gt;                    --  26900  26900 -- 0.02541 0.02541 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
    &lt;built-in method builtins.issubclass&gt;                    --  53800  53800 -- 0.04783 0.04783 -- ~:0:&lt;built-in method builtins.issubclass&gt; (&lt;built-in method builtins.issubclass&gt;) +++
_wrapreduction                                               --      3      3 -- 0.00005 0.00050 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:69:_wrapreduction (_wrapreduction)
    &lt;dictcomp&gt;                                               --      3      3 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:70:&lt;dictcomp&gt; (&lt;dictcomp&gt;)
    &lt;method &#39;reduce&#39; of &#39;numpy.ufunc&#39; objects&gt;               --      3      3 -- 0.00043 0.00043 -- ~:0:&lt;method &#39;reduce&#39; of &#39;numpy.ufunc&#39; objects&gt; (&lt;method &#39;reduce&#39; of &#39;numpy.ufunc&#39; objects&gt;) +++
isspmatrix                                                   --  60502  60502 -- 0.09729 0.17483 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_base.py:1291:isspmatrix (isspmatrix)
    &lt;built-in method builtins.isinstance&gt;                    --  60502  60502 -- 0.07754 0.07754 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
_safe_indexing                                               --   6800   6800 -- 0.07474 1.39388 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/utils/__init__.py:307:_safe_indexing (_safe_indexing)
    _array_indexing                                          --   6800   6800 -- 0.27545 1.13973 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/utils/__init__.py:193:_array_indexing (_array_indexing)
        isspmatrix                                           --   6800   6800 -- 0.00942 0.01670 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_base.py:1291:isspmatrix (isspmatrix) +++
        parse                                                --   6800   6800 -- 0.03466 0.81449 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/externals/_packaging/version.py:65:parse (parse)
            __init__                                         --   6800   6800 -- 0.31266 0.77983 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/externals/_packaging/version.py:284:__init__ (__init__)
                &lt;lambda&gt;                                     --   6800   6800 -- 0.01784 0.03354 -- &lt;string&gt;:1:&lt;lambda&gt; (&lt;lambda&gt;)
                    &lt;built-in method __...at 0x7f5da6713960&gt; --   6800   6800 -- 0.01569 0.01569 -- ~:0:&lt;built-in method __new__ of type object at 0x7f5da6713960&gt; (&lt;built-in method __new__ of type object at 0x7f5da6713960&gt;)
                &lt;genexpr&gt;                                    --  20400  20400 -- 0.05236 0.05236 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/externals/_packaging/version.py:294:&lt;genexpr&gt; (&lt;genexpr&gt;)
                _parse_letter_version                        --  20400  20400 -- 0.01680 0.01680 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/externals/_packaging/version.py:416:_parse_letter_version (_parse_letter_version)
                _parse_local_version                         --   6800   6800 -- 0.00480 0.00480 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/externals/_packaging/version.py:455:_parse_local_version (_parse_local_version)
                _cmpkey                                      --   6800   6800 -- 0.11322 0.12058 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/externals/_packaging/version.py:467:_cmpkey (_cmpkey)
                    &lt;lambda&gt;                                 --   6800   6800 -- 0.00736 0.00736 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/externals/_packaging/version.py:482:&lt;lambda&gt; (&lt;lambda&gt;)
                &lt;method &#39;split&#39; of &#39;str&#39; objects&gt;            --   6800   6800 -- 0.01606 0.01606 -- ~:0:&lt;method &#39;split&#39; of &#39;str&#39; objects&gt; (&lt;method &#39;split&#39; of &#39;str&#39; objects&gt;)
                &lt;method &#39;group&#39; of &#39;re.Match&#39; objects&gt;       --  68000  68000 -- 0.07561 0.07561 -- ~:0:&lt;method &#39;group&#39; of &#39;re.Match&#39; objects&gt; (&lt;method &#39;group&#39; of &#39;re.Match&#39; objects&gt;)
                &lt;method &#39;search&#39; of &#39;re.Pattern&#39; objects&gt;    --   6800   6800 -- 0.14744 0.14744 -- ~:0:&lt;method &#39;search&#39; of &#39;re.Pattern&#39; objects&gt; (&lt;method &#39;search&#39; of &#39;re.Pattern&#39; objects&gt;)
        __lt__                                               --   6800   6800 -- 0.02356 0.02935 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/externals/_packaging/version.py:92:__lt__ (__lt__)
            &lt;built-in method builtins.isinstance&gt;            --   6800   6800 -- 0.00578 0.00578 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
        &lt;built-in method builtins.isinstance&gt;                --   6800   6800 -- 0.00374 0.00374 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
    _determine_key_type                                      --   6800   6800 -- 0.12544 0.16181 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/utils/__init__.py:237:_determine_key_type (_determine_key_type)
        &lt;method &#39;keys&#39; of &#39;dict&#39; objects&gt;                    --   6800   6800 -- 0.00749 0.00749 -- ~:0:&lt;method &#39;keys&#39; of &#39;dict&#39; objects&gt; (&lt;method &#39;keys&#39; of &#39;dict&#39; objects&gt;)
        &lt;built-in method builtins.hasattr&gt;                   --   6800   6800 -- 0.00554 0.00554 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
        &lt;built-in method builtins.isinstance&gt;                --  20400  20400 -- 0.02334 0.02334 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
    &lt;built-in method builtins.hasattr&gt;                       --  13600  13600 -- 0.01760 0.01760 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
safe_sparse_dot                                              --  53600  53600 -- 2.14302 2.30083 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/utils/extmath.py:120:safe_sparse_dot (safe_sparse_dot)
    isspmatrix                                               --  53600  53600 -- 0.08771 0.15780 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_base.py:1291:isspmatrix (isspmatrix) +++
_num_samples                                                 --    104    104 -- 0.00235 0.00453 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/utils/validation.py:254:_num_samples (_num_samples)
    &lt;built-in method builtins.hasattr&gt;                       --    312    312 -- 0.00052 0.00052 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
    &lt;built-in method builtins.isinstance&gt;                    --    104    104 -- 0.00031 0.00159 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
    &lt;built-in method builtins.len&gt;                           --    104    104 -- 0.00006 0.00006 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;) +++
check_consistent_length                                      --    101    101 -- 0.00118 0.01719 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/utils/validation.py:318:check_consistent_length (check_consistent_length)
    unique                                                   --    101    101 -- 0.00056 0.01111 -- &lt;__array_function__ internals&gt;:177:unique (unique)
        _unique_dispatcher                                   --    101    101 -- 0.00010 0.00010 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/lib/arraysetops.py:133:_unique_dispatcher (_unique_dispatcher)
        &lt;built-in method numpy.co...mplement_array_function&gt; --    101    101 -- 0.00073 0.01046 -- ~:0:&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt; (&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt;) +++
    &lt;listcomp&gt;                                               --    101    101 -- 0.00040 0.00483 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/utils/validation.py:329:&lt;listcomp&gt; (&lt;listcomp&gt;)
        _num_samples                                         --    102    102 -- 0.00231 0.00443 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/utils/validation.py:254:_num_samples (_num_samples) +++
    &lt;built-in method builtins.len&gt;                           --    101    101 -- 0.00006 0.00006 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;) +++
check_array                                                  --      2      2 -- 0.00011 0.00109 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/utils/validation.py:494:check_array (check_array)
    simplefilter                                             --      2      2 -- 0.00001 0.00007 -- /usr/local/lib/python3.9/warnings.py:165:simplefilter (simplefilter)
        _add_filter                                          --      2      2 -- 0.00003 0.00005 -- /usr/local/lib/python3.9/warnings.py:181:_add_filter (_add_filter)
    __init__                                                 --      2      2 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/warnings.py:437:__init__ (__init__)
    __enter__                                                --      2      2 -- 0.00003 0.00003 -- /usr/local/lib/python3.9/warnings.py:458:__enter__ (__enter__)
    __exit__                                                 --      2      2 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/warnings.py:477:__exit__ (__exit__)
    isspmatrix                                               --      2      2 -- 0.00000 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_base.py:1291:isspmatrix (isspmatrix) +++
    _assert_all_finite                                       --      2      2 -- 0.00012 0.00072 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/utils/validation.py:90:_assert_all_finite (_assert_all_finite)
        get_config                                           --      2      2 -- 0.00001 0.00003 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/_config.py:24:get_config (get_config)
            _get_threadlocal_config                          --      2      2 -- 0.00000 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/_config.py:16:_get_threadlocal_config (_get_threadlocal_config)
        _safe_accumulator_op                                 --      2      2 -- 0.00003 0.00055 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/utils/extmath.py:869:_safe_accumulator_op (_safe_accumulator_op)
            sum                                              --      2      2 -- 0.00001 0.00048 -- &lt;__array_function__ internals&gt;:177:sum (sum)
                _sum_dispatcher                              --      2      2 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:2155:_sum_dispatcher (_sum_dispatcher)
                &lt;built-in method nump...ment_array_function&gt; --      2      2 -- 0.00001 0.00046 -- ~:0:&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt; (&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt;) +++
            issubdtype                                       --      2      2 -- 0.00002 0.00004 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/numerictypes.py:356:issubdtype (issubdtype)
                issubclass_                                  --      4      4 -- 0.00002 0.00003 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/numerictypes.py:282:issubclass_ (issubclass_)
    _num_samples                                             --      2      2 -- 0.00004 0.00010 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/utils/validation.py:254:_num_samples (_num_samples) +++
    _ensure_no_complex_data                                  --      2      2 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/utils/validation.py:484:_ensure_no_complex_data (_ensure_no_complex_data)
check_random_state                                           --    101    101 -- 0.00093 0.00246 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/utils/validation.py:1043:check_random_state (check_random_state)
    &lt;built-in method builtins.isinstance&gt;                    --    200    200 -- 0.00063 0.00153 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
write                                                        --      7      7 -- 0.00012 0.00328 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx_gallery/gen_rst.py:81:write (write)
    verbose                                                  --      6      6 -- 0.00005 0.00314 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:135:verbose (verbose)
        log                                                  --      6      6 -- 0.00008 0.00309 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:128:log (log)
            log                                              --      6      6 -- 0.00009 0.00300 -- /usr/local/lib/python3.9/logging/__init__.py:1825:log (log)
                log                                          --      6      6 -- 0.00008 0.00282 -- /usr/local/lib/python3.9/logging/__init__.py:1485:log (log)
                    _log                                     --      6      6 -- 0.00006 0.00273 -- /usr/local/lib/python3.9/logging/__init__.py:1553:_log (_log)
                        findCaller                           --      6      6 -- 0.00010 0.00017 -- /usr/local/lib/python3.9/logging/__init__.py:1502:findCaller (findCaller)
                            &lt;lambda&gt;                         --      6      6 -- 0.00002 0.00003 -- /usr/local/lib/python3.9/logging/__init__.py:156:&lt;lambda&gt; (&lt;lambda&gt;)
                            normcase                         --     12     12 -- 0.00002 0.00003 -- /usr/local/lib/python3.9/posixpath.py:52:normcase (normcase)
                                &lt;built-in met...osix.fspath&gt; --     12     12 -- 0.00001 0.00001 -- ~:0:&lt;built-in method posix.fspath&gt; (&lt;built-in method posix.fspath&gt;) +++
                            &lt;built-in metho...ltins.hasattr&gt; --     12     12 -- 0.00001 0.00001 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
                        makeRecord                           --      6      6 -- 0.00006 0.00080 -- /usr/local/lib/python3.9/logging/__init__.py:1538:makeRecord (makeRecord)
                            __init__                         --      6      6 -- 0.00032 0.00074 -- /usr/local/lib/python3.9/logging/__init__.py:278:__init__ (__init__)
                                getLevelName                 --      6      6 -- 0.00005 0.00006 -- /usr/local/lib/python3.9/logging/__init__.py:119:getLevelName (getLevelName)
                                    &lt;method &#39;ge...&#39; objects&gt; --     12     12 -- 0.00001 0.00001 -- ~:0:&lt;method &#39;get&#39; of &#39;dict&#39; objects&gt; (&lt;method &#39;get&#39; of &#39;dict&#39; objects&gt;) +++
                                current_process              --      6      6 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/multiprocessing/process.py:37:current_process (current_process)
                                name                         --      6      6 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/multiprocessing/process.py:189:name (name)
                                splitext                     --      6      6 -- 0.00003 0.00010 -- /usr/local/lib/python3.9/posixpath.py:117:splitext (splitext)
                                    _splitext                --      6      6 -- 0.00004 0.00006 -- /usr/local/lib/python3.9/genericpath.py:121:_splitext (_splitext)
                                        &lt;method &#39;...objects&gt; --     12     12 -- 0.00002 0.00002 -- ~:0:&lt;method &#39;rfind&#39; of &#39;str&#39; objects&gt; (&lt;method &#39;rfind&#39; of &#39;str&#39; objects&gt;) +++
                                basename                     --      6      6 -- 0.00005 0.00009 -- /usr/local/lib/python3.9/posixpath.py:140:basename (basename)
                                    _get_sep                 --      6      6 -- 0.00001 0.00002 -- /usr/local/lib/python3.9/posixpath.py:41:_get_sep (_get_sep)
                                name                         --      6      6 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/threading.py:1053:name (name)
                                current_thread               --      6      6 -- 0.00002 0.00002 -- /usr/local/lib/python3.9/threading.py:1318:current_thread (current_thread)
                        handle                               --      6      6 -- 0.00003 0.00169 -- /usr/local/lib/python3.9/logging/__init__.py:1579:handle (handle)
                            filter                           --      6      6 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/logging/__init__.py:787:filter (filter) +++
                            callHandlers                     --      6      6 -- 0.00007 0.00166 -- /usr/local/lib/python3.9/logging/__init__.py:1633:callHandlers (callHandlers)
                                handle                       --     12     12 -- 0.00008 0.00158 -- /usr/local/lib/python3.9/logging/__init__.py:935:handle (handle)
                                    filter                   --     12     12 -- 0.00006 0.00017 -- /usr/local/lib/python3.9/logging/__init__.py:787:filter (filter) +++
                                    acquire                  --     12     12 -- 0.00004 0.00006 -- /usr/local/lib/python3.9/logging/__init__.py:892:acquire (acquire) +++
                                    release                  --     12     12 -- 0.00002 0.00003 -- /usr/local/lib/python3.9/logging/__init__.py:899:release (release) +++
                                    emit                     --      6      6 -- 0.00004 0.00041 -- /usr/local/lib/python3.9/logging/__init__.py:1067:emit (emit) +++
                                    emit                     --      6      6 -- 0.00006 0.00083 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:158:emit (emit)
                                        acquire              --      6      6 -- 0.00001 0.00002 -- /usr/local/lib/python3.9/logging/__init__.py:892:acquire (acquire) +++
                                        release              --      6      6 -- 0.00001 0.00002 -- /usr/local/lib/python3.9/logging/__init__.py:899:release (release) +++
                                        emit                 --      6      6 -- 0.00005 0.00073 -- /usr/local/lib/python3.9/logging/__init__.py:1067:emit (emit) +++
                    isEnabledFor                             --      6      6 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/logging/__init__.py:1677:isEnabledFor (isEnabledFor) +++
                isEnabledFor                                 --      6      6 -- 0.00002 0.00003 -- /usr/local/lib/python3.9/logging/__init__.py:1834:isEnabledFor (isEnabledFor)
                    isEnabledFor                             --      6      6 -- 0.00002 0.00002 -- /usr/local/lib/python3.9/logging/__init__.py:1677:isEnabledFor (isEnabledFor) +++
                process                                      --      6      6 -- 0.00005 0.00006 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:138:process (process)
get_state                                                    --      2      2 -- 0.00037 0.00037 -- onnxruntime/capi/training/training_session.py:47:get_state (get_state)
numpy_to_ort_value                                           --    102    102 -- 0.00054 0.00267 -- onnxruntime_helper.py:134:numpy_to_ort_value (numpy_to_ort_value)
    &lt;built-in method onnxruntim...state.ortvalue_from_numpy&gt; --    102    102 -- 0.00213 0.00213 -- ~:0:&lt;built-in method onnxruntime.capi.onnxruntime_pybind11_state.ortvalue_from_numpy&gt; (&lt;built-in method onnxruntime.capi.onnxruntime_pybind11_state.ortvalue_from_numpy&gt;)
&lt;built-in method builtins.len&gt;                               --  14329  14329 -- 0.03522 0.05911 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;)
    __len__                                                  --  13600  13600 -- 0.02389 0.02389 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/data_loader.py:94:__len__ (__len__)
&lt;method &#39;astype&#39; of &#39;numpy.ndarray&#39; objects&gt;                 --     12     12 -- 0.00014 0.00014 -- ~:0:&lt;method &#39;astype&#39; of &#39;numpy.ndarray&#39; objects&gt; (&lt;method &#39;astype&#39; of &#39;numpy.ndarray&#39; objects&gt;)
&lt;built-in method numpy.array&gt;                                --    201    201 -- 0.01705 0.01705 -- ~:0:&lt;built-in method numpy.array&gt; (&lt;built-in method numpy.array&gt;)
&lt;method &#39;append&#39; of &#39;list&#39; objects&gt;                          --   6906   6906 -- 0.00768 0.00768 -- ~:0:&lt;method &#39;append&#39; of &#39;list&#39; objects&gt; (&lt;method &#39;append&#39; of &#39;list&#39; objects&gt;)
&lt;built-in method builtins.hasattr&gt;                           --  27687  27687 -- 0.03634 0.03634 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;)
&lt;method &#39;mean&#39; of &#39;numpy.ndarray&#39; objects&gt;                   --   6800   6800 -- 0.03903 0.87632 -- ~:0:&lt;method &#39;mean&#39; of &#39;numpy.ndarray&#39; objects&gt; (&lt;method &#39;mean&#39; of &#39;numpy.ndarray&#39; objects&gt;)
    _mean                                                    --   6800   6800 -- 0.41926 0.83729 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/_methods.py:162:_mean (_mean) +++
&lt;built-in method numpy.empty&gt;                                --    107    107 -- 0.00062 0.00062 -- ~:0:&lt;built-in method numpy.empty&gt; (&lt;built-in method numpy.empty&gt;)
&lt;built-in method builtins.isinstance&gt;                        --  142177  142177 -- 0.16314 0.16609 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;)
    __instancecheck__                                        --    311    311 -- 0.00049 0.00295 -- /usr/local/lib/python3.9/abc.py:96:__instancecheck__ (__instancecheck__)
        &lt;built-in method _abc._abc_instancecheck&gt;            --    311    311 -- 0.00183 0.00247 -- ~:0:&lt;built-in method _abc._abc_instancecheck&gt; (&lt;built-in method _abc._abc_instancecheck&gt;)
            __subclasscheck__                                --    104    104 -- 0.00017 0.00064 -- /usr/local/lib/python3.9/abc.py:100:__subclasscheck__ (__subclasscheck__)
                &lt;built-in method _abc._abc_subclasscheck&gt;    --    104    104 -- 0.00047 0.00047 -- ~:0:&lt;built-in method _abc._abc_subclasscheck&gt; (&lt;built-in method _abc._abc_subclasscheck&gt;)
&lt;built-in method numpy.arange&gt;                               --    101    101 -- 0.00231 0.00231 -- ~:0:&lt;built-in method numpy.arange&gt; (&lt;built-in method numpy.arange&gt;)
&lt;built-in method numpy.core._...th.implement_array_function&gt; --  40311  40325 -- 0.37295 2.45395 -- ~:0:&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt; (&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt;)
    clip                                                     --      1      1 -- 0.00001 0.00021 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:2083:clip (clip)
        _wrapfunc                                            --      1      1 -- 0.00001 0.00020 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:51:_wrapfunc (_wrapfunc)
            _wrapit                                          --      1      1 -- 0.00002 0.00019 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:38:_wrapit (_wrapit)
                &lt;method &#39;clip&#39; of &#39;numpy.ndarray&#39; objects&gt;   --      1      1 -- 0.00001 0.00016 -- ~:0:&lt;method &#39;clip&#39; of &#39;numpy.ndarray&#39; objects&gt; (&lt;method &#39;clip&#39; of &#39;numpy.ndarray&#39; objects&gt;)
                    _clip                                    --      1      1 -- 0.00002 0.00015 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/_methods.py:125:_clip (_clip)
                        _clip_dep_is_scalar_nan              --      2      2 -- 0.00006 0.00011 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/_methods.py:91:_clip_dep_is_scalar_nan (_clip_dep_is_scalar_nan)
                            ndim                             --      2      2 -- 0.00001 0.00005 -- &lt;__array_function__ internals&gt;:177:ndim (ndim)
                                _ndim_dispatcher             --      2      2 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:3160:_ndim_dispatcher (_ndim_dispatcher)
                        _clip_dep_is_byte_swapped            --      2      2 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/_methods.py:101:_clip_dep_is_byte_swapped (_clip_dep_is_byte_swapped)
                        _clip_dep_invoke_with_casting        --      1      1 -- 0.00002 0.00002 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/_methods.py:106:_clip_dep_invoke_with_casting (_clip_dep_invoke_with_casting)
    sum                                                      --      2      2 -- 0.00002 0.00045 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:2160:sum (sum)
        _wrapreduction                                       --      2      2 -- 0.00003 0.00043 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:69:_wrapreduction (_wrapreduction) +++
    any                                                      --      1      1 -- 0.00001 0.00008 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:2305:any (any)
        _wrapreduction                                       --      1      1 -- 0.00002 0.00007 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:69:_wrapreduction (_wrapreduction) +++
    ndim                                                     --      2      2 -- 0.00002 0.00003 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:3164:ndim (ndim)
    mean                                                     --  20100  20100 -- 0.20040 2.07034 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:3356:mean (mean)
        _mean                                                --  20100  20100 -- 0.93221 1.86994 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/_methods.py:162:_mean (_mean) +++
    zeros_like                                               --      6      6 -- 0.00007 0.00032 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/numeric.py:76:zeros_like (zeros_like)
        empty_like                                           --      6      6 -- 0.00004 0.00010 -- &lt;__array_function__ internals&gt;:177:empty_like (empty_like)
            empty_like                                       --      6      6 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/multiarray.py:80:empty_like (empty_like)
        copyto                                               --      6      6 -- 0.00004 0.00010 -- &lt;__array_function__ internals&gt;:177:copyto (copyto)
            copyto                                           --      6      6 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/multiarray.py:1071:copyto (copyto)
    unique                                                   --    101    101 -- 0.00100 0.00973 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/lib/arraysetops.py:138:unique (unique)
        _unpack_tuple                                        --    101    101 -- 0.00025 0.00032 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/lib/arraysetops.py:125:_unpack_tuple (_unpack_tuple)
            &lt;built-in method builtins.len&gt;                   --    101    101 -- 0.00007 0.00007 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;) +++
        _unique1d                                            --    101    101 -- 0.00583 0.00743 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/lib/arraysetops.py:320:_unique1d (_unique1d)
            &lt;method &#39;flatten&#39; of &#39;numpy.ndarray&#39; objects&gt;    --    101    101 -- 0.00079 0.00079 -- ~:0:&lt;method &#39;flatten&#39; of &#39;numpy.ndarray&#39; objects&gt; (&lt;method &#39;flatten&#39; of &#39;numpy.ndarray&#39; objects&gt;)
            &lt;method &#39;sort&#39; of &#39;numpy.ndarray&#39; objects&gt;       --    101    101 -- 0.00018 0.00018 -- ~:0:&lt;method &#39;sort&#39; of &#39;numpy.ndarray&#39; objects&gt; (&lt;method &#39;sort&#39; of &#39;numpy.ndarray&#39; objects&gt;)
            &lt;built-in method numpy.asanyarray&gt;               --    101    101 -- 0.00005 0.00005 -- ~:0:&lt;built-in method numpy.asanyarray&gt; (&lt;built-in method numpy.asanyarray&gt;) +++
            &lt;built-in method numpy.empty&gt;                    --    101    101 -- 0.00058 0.00058 -- ~:0:&lt;built-in method numpy.empty&gt; (&lt;built-in method numpy.empty&gt;) +++
        &lt;built-in method numpy.asanyarray&gt;                   --    101    101 -- 0.00098 0.00098 -- ~:0:&lt;built-in method numpy.asanyarray&gt; (&lt;built-in method numpy.asanyarray&gt;) +++
&lt;built-in method builtins.getattr&gt;                           --     41     41 -- 0.00004 0.00004 -- ~:0:&lt;built-in method builtins.getattr&gt; (&lt;built-in method builtins.getattr&gt;)
&lt;method &#39;get&#39; of &#39;dict&#39; objects&gt;                             --     33     33 -- 0.00003 0.00003 -- ~:0:&lt;method &#39;get&#39; of &#39;dict&#39; objects&gt; (&lt;method &#39;get&#39; of &#39;dict&#39; objects&gt;)
&lt;built-in method numpy.asanyarray&gt;                           --  27104  27104 -- 0.02014 0.02014 -- ~:0:&lt;built-in method numpy.asanyarray&gt; (&lt;built-in method numpy.asanyarray&gt;)
&lt;method &#39;reduce&#39; of &#39;numpy.ufunc&#39; objects&gt;                   --  26903  26903 -- 0.65877 0.65877 -- ~:0:&lt;method &#39;reduce&#39; of &#39;numpy.ufunc&#39; objects&gt; (&lt;method &#39;reduce&#39; of &#39;numpy.ufunc&#39; objects&gt;)
&lt;built-in method builtins.issubclass&gt;                        --  53806  53806 -- 0.04784 0.04784 -- ~:0:&lt;built-in method builtins.issubclass&gt; (&lt;built-in method builtins.issubclass&gt;)
&lt;built-in method posix.fspath&gt;                               --     24     24 -- 0.00001 0.00001 -- ~:0:&lt;built-in method posix.fspath&gt; (&lt;built-in method posix.fspath&gt;)
&lt;built-in method _thread.get_ident&gt;                          --     12     12 -- 0.00001 0.00001 -- ~:0:&lt;built-in method _thread.get_ident&gt; (&lt;built-in method _thread.get_ident&gt;)
&lt;method &#39;rfind&#39; of &#39;str&#39; objects&gt;                            --     18     18 -- 0.00003 0.00003 -- ~:0:&lt;method &#39;rfind&#39; of &#39;str&#39; objects&gt; (&lt;method &#39;rfind&#39; of &#39;str&#39; objects&gt;)
</pre></div>
</div>
</section>
<section id="if-gpu-is-available">
<h2><a class="toc-backref" href="#id3">if GPU is available</a><a class="headerlink" href="#if-gpu-is-available" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">get_device</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;GPU&#39;</span><span class="p">:</span>

    <span class="n">train_session</span> <span class="o">=</span> <span class="n">OrtGradientOptimizer</span><span class="p">(</span>
        <span class="n">onx_train</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">weights</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">5e-4</span><span class="p">,</span>
        <span class="n">warm_start</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>

    <span class="n">benches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">benchmark</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="n">train_session</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;NN-GPU&#39;</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="linear-regression">
<h2><a class="toc-backref" href="#id4">Linear Regression</a><a class="headerlink" href="#linear-regression" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lr</span> <span class="o">=</span> <span class="n">MLPRegressor</span><span class="p">(</span><span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(),</span> <span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span><span class="p">,</span>
                  <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;sgd&#39;</span><span class="p">,</span> <span class="n">learning_rate_init</span><span class="o">=</span><span class="mf">5e-2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                  <span class="n">n_iter_no_change</span><span class="o">=</span><span class="n">max_iter</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
                  <span class="n">nesterovs_momentum</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                  <span class="n">learning_rate</span><span class="o">=</span><span class="s1">&#39;invscaling&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
    <span class="n">lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>


<span class="n">onx</span> <span class="o">=</span> <span class="n">to_onnx</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="n">X_train</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="n">target_opset</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">onx_train</span> <span class="o">=</span> <span class="n">add_loss_output</span><span class="p">(</span><span class="n">onx</span><span class="p">)</span>

<span class="n">inits</span> <span class="o">=</span> <span class="n">get_train_initializer</span><span class="p">(</span><span class="n">onx</span><span class="p">)</span>
<span class="n">weights</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">inits</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="s2">&quot;shape_tensor&quot;</span><span class="p">}</span>
<span class="n">pprint</span><span class="p">(</span><span class="nb">list</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">weights</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>

<span class="n">train_session</span> <span class="o">=</span> <span class="n">OrtGradientOptimizer</span><span class="p">(</span>
    <span class="n">onx_train</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">weights</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span>
    <span class="n">warm_start</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>

<span class="n">benches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">benchmark</span><span class="p">(</span><span class="n">lr</span><span class="p">,</span> <span class="n">train_session</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;LR-CPU&#39;</span><span class="p">))</span>

<span class="k">if</span> <span class="n">get_device</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;GPU&#39;</span><span class="p">:</span>

    <span class="n">train_session</span> <span class="o">=</span> <span class="n">OrtGradientOptimizer</span><span class="p">(</span>
        <span class="n">onx_train</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">weights</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span>
        <span class="n">warm_start</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>

    <span class="n">benches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">benchmark</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="n">train_session</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;LR-GPU&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[(&#39;coefficient&#39;, (100, 50)),
 (&#39;intercepts&#39;, (1, 50)),
 (&#39;coefficient1&#39;, (50, 10)),
 (&#39;intercepts1&#39;, (1, 10)),
 (&#39;coefficient2&#39;, (10, 1)),
 (&#39;intercepts2&#39;, (1, 1))]
[benchmark] LR-CPU
/var/lib/jenkins/workspace/onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:692: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (100) reached and the optimization hasn&#39;t converged yet.
  warnings.warn(
[benchmark] skl=100 iterations - 5.121225359849632 seconds
[benchmark] ort=100 iterations - 4.571064034476876 seconds
</pre></div>
</div>
</section>
<section id="gpu-profiling">
<h2><a class="toc-backref" href="#id5">GPU profiling</a><a class="headerlink" href="#gpu-profiling" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">get_device</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;GPU&#39;</span><span class="p">:</span>
    <span class="n">ps</span> <span class="o">=</span> <span class="n">profile</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">benchmark</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="n">train_session</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;LR-GPU&#39;</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">root</span><span class="p">,</span> <span class="n">nodes</span> <span class="o">=</span> <span class="n">profile2graph</span><span class="p">(</span><span class="n">ps</span><span class="p">,</span> <span class="n">clean_text</span><span class="o">=</span><span class="n">clean_name</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">to_text</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="graphs">
<h2><a class="toc-backref" href="#id6">Graphs</a><a class="headerlink" href="#graphs" title="Permalink to this headline">¶</a></h2>
<p>Dataframe first.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">benches</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>skl</th>
      <th>ort</th>
      <th>iter_skl</th>
      <th>iter_ort</th>
      <th>losses_skl</th>
      <th>losses_ort</th>
    </tr>
    <tr>
      <th>name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>NN-CPU</th>
      <td>13.335430</td>
      <td>4.608651</td>
      <td>100</td>
      <td>100</td>
      <td>[11015.203207092285, 1374.5511935424804, 1011....</td>
      <td>[39370.234, 30754.566, 27981.418, 24108.654, 1...</td>
    </tr>
    <tr>
      <th>LR-CPU</th>
      <td>5.121225</td>
      <td>4.571064</td>
      <td>100</td>
      <td>100</td>
      <td>[3664.9879335403443, 56.35967195987701, 49.071...</td>
      <td>[30004.059, 6631.8145, 3842.7864, 2075.2715, 1...</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<br />
<br /><p>text output</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>              skl  ...                                         losses_ort
name               ...
NN-CPU  13.335430  ...  [39370.234, 30754.566, 27981.418, 24108.654, 1...
LR-CPU   5.121225  ...  [30004.059, 6631.8145, 3842.7864, 2075.2715, 1...

[2 rows x 6 columns]
</pre></div>
</div>
<p>Graphs.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">df</span><span class="p">[[</span><span class="s1">&#39;skl&#39;</span><span class="p">,</span> <span class="s1">&#39;ort&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Processing time&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="k">for</span> <span class="n">bench</span> <span class="ow">in</span> <span class="n">benches</span><span class="p">:</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bench</span><span class="p">[</span><span class="s1">&#39;losses_skl&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;skl-&#39;</span> <span class="o">+</span> <span class="n">bench</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bench</span><span class="p">[</span><span class="s1">&#39;losses_ort&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ort-&#39;</span> <span class="o">+</span> <span class="n">bench</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Losses&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_orttraining_benchmark_001.png" srcset="../_images/sphx_glr_plot_orttraining_benchmark_001.png" alt="Processing time, Losses" class = "sphx-glr-single-img"/><p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend object at 0x7f5cc3f39790&gt;
</pre></div>
</div>
<p>The gradient update are not exactly the same.
It should be improved for a fair comprison.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># plt.show()</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 1 minutes  4.261 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-gyexamples-plot-orttraining-benchmark-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/566c48327bf1d5fdbae9e21b34546411/plot_orttraining_benchmark.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_orttraining_benchmark.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/316a05ecf8308c5f718c1a8ae6536b5c/plot_orttraining_benchmark.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_orttraining_benchmark.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="plot_orttraining_nn_gpu.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Train a scikit-learn neural network with onnxruntime-training on GPU</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../tutorials/tutorial_training/tutorial_6_training_partial.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Partial Training with OrtGradientForwardBackwardOptimizer</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
    <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2022, Xavier Dupré.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.4.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>