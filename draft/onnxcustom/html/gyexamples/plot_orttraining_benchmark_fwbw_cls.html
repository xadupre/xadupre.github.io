
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Benchmark, comparison sklearn - forward-backward - classification &#8212; onnxcustom</title>
    
    <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
  
    
    <link rel="stylesheet"
      href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">
  
    
      
  
    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/pydata-sphinx-theme.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/style_notebook_snippet.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinxtrib-images/LightBox2/lightbox2/css/lightbox.css" />
    <link rel="stylesheet" type="text/css" href="../_static/my-styles.css" />
    
    <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">
  
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script src="../_static/require.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script src="../_static/sphinxtrib-images/LightBox2/lightbox2/js/jquery-1.11.0.min.js"></script>
    <script src="../_static/sphinxtrib-images/LightBox2/lightbox2/js/lightbox.min.js"></script>
    <script src="../_static/sphinxtrib-images/LightBox2/lightbox2_customize/jquery-noconflict.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Compares numpy to onnxruntime on simple functions" href="plot_benchmark_onnx_function.html" />
    <link rel="prev" title="Benchmark, comparison scikit-learn - forward-backward" href="plot_orttraining_benchmark_fwbw.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/project_ico.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../tutorials/index.html">
  Tutorials
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../api/apis.html">
  API
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="index.html">
  Examples Gallery
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../all_notebooks.html">
  Notebooks Gallery
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../other_pages.html">
  Other pages
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../blog/blogindex.html">
  Blog Gallery
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/tutorial_onnx/index.html">
   Introduction to ONNX
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/tutorial_onnxruntime/index.html">
   Introduction to onnxruntime
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/tutorial_skl/index.html">
   scikit-learn to ONNX Tutorial
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../tutorials/tutorial_training/index.html">
   Training Tutorial
  </a>
  <input checked class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/tutorial_training/tutorial_6_training.html">
     Full Training with OrtGradientOptimizer
    </a>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="../tutorials/tutorial_training/tutorial_6_training_partial.html">
     Partial Training with OrtGradientForwardBackwardOptimizer
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3">
      <a class="reference internal" href="plot_orttraining_linear_regression_fwbw.html">
       Train a linear regression with forward backward
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="plot_orttraining_nn_gpu_fwbw.html">
       Forward backward on a neural network on GPU
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="plot_orttraining_nn_gpu_fwbw_nesterov.html">
       Forward backward on a neural network on GPU (Nesterov) and penalty
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="plot_orttraining_benchmark_fwbw.html">
       Benchmark, comparison scikit-learn - forward-backward
      </a>
     </li>
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       Benchmark, comparison sklearn - forward-backward - classification
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="plot_benchmark_onnx_function.html">
       Compares numpy to onnxruntime on simple functions
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/tutorial_bench/index.html">
   Benchmarking and profiling Tutorial
  </a>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#first-comparison-neural-network">
   First comparison: neural network
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#profiling">
   Profiling
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#if-gpu-is-available">
   if GPU is available
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-simple-linear-layer">
   A simple linear layer
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#graphs">
   Graphs
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-gyexamples-plot-orttraining-benchmark-fwbw-cls-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="benchmark-comparison-sklearn-forward-backward-classification">
<span id="l-orttraining-benchmark-fwbw-cls"></span><span id="sphx-glr-gyexamples-plot-orttraining-benchmark-fwbw-cls-py"></span><h1>Benchmark, comparison sklearn - forward-backward - classification<a class="headerlink" href="#benchmark-comparison-sklearn-forward-backward-classification" title="Permalink to this headline">¶</a></h1>
<p>The benchmark compares the processing time between <a class="reference external" href="https://scikit-learn.org/stable/">scikit-learn</a>
and <a class="reference external" href="https://github.com/microsoft/onnxruntime/tree/master/orttraining">onnxruntime-training</a> on a logistic regression regression
and a neural network for classification.
It replicates the benchmark implemented in <a class="reference internal" href="plot_orttraining_benchmark_fwbw.html#l-orttraining-benchmark-fwbw"><span class="std std-ref">Benchmark, comparison scikit-learn - forward-backward</span></a>.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#first-comparison-neural-network" id="id1">First comparison: neural network</a></p></li>
<li><p><a class="reference internal" href="#profiling" id="id2">Profiling</a></p></li>
<li><p><a class="reference internal" href="#if-gpu-is-available" id="id3">if GPU is available</a></p></li>
<li><p><a class="reference internal" href="#a-simple-linear-layer" id="id4">A simple linear layer</a></p></li>
<li><p><a class="reference internal" href="#graphs" id="id5">Graphs</a></p></li>
</ul>
</div>
<section id="first-comparison-neural-network">
<h2><a class="toc-backref" href="#id1">First comparison: neural network</a><a class="headerlink" href="#first-comparison-neural-network" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">DataFrame</span>
<span class="kn">from</span> <span class="nn">onnxruntime</span> <span class="kn">import</span> <span class="n">get_device</span>
<span class="kn">from</span> <span class="nn">pyquickhelper.pycode.profiling</span> <span class="kn">import</span> <span class="n">profile</span><span class="p">,</span> <span class="n">profile2graph</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_classification</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPClassifier</span>
<span class="kn">from</span> <span class="nn">mlprodict.onnx_conv</span> <span class="kn">import</span> <span class="n">to_onnx</span>
<span class="kn">from</span> <span class="nn">mlprodict.plotting.text_plot</span> <span class="kn">import</span> <span class="n">onnx_simple_text_plot</span>
<span class="kn">from</span> <span class="nn">mlprodict.onnx_tools.onnx_manipulations</span> <span class="kn">import</span> <span class="n">select_model_inputs_outputs</span>
<span class="kn">from</span> <span class="nn">onnxcustom.utils.onnx_helper</span> <span class="kn">import</span> <span class="n">onnx_rename_weights</span>
<span class="kn">from</span> <span class="nn">onnxcustom.training.optimizers_partial</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">OrtGradientForwardBackwardOptimizer</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">onnxcustom.training.sgd_learning_rate</span> <span class="kn">import</span> <span class="n">LearningRateSGDNesterov</span>
<span class="kn">from</span> <span class="nn">onnxcustom.training.sgd_learning_loss</span> <span class="kn">import</span> <span class="n">NegLogLearningLoss</span>
<span class="kn">from</span> <span class="nn">onnxcustom.training.sgd_learning_penalty</span> <span class="kn">import</span> <span class="n">ElasticLearningPenalty</span>


<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_classification</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_classes</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>Benchmark function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">benchmark</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">skl_model</span><span class="p">,</span> <span class="n">train_session</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :param skl_model: model from scikit-learn</span>
<span class="sd">    :param train_session: instance of OrtGradientForwardBackwardOptimizer</span>
<span class="sd">    :param name: experiment name</span>
<span class="sd">    :param verbose: to debug</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[benchmark] </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
    <span class="n">begin</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">skl_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">duration_skl</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">begin</span>
    <span class="n">length_skl</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">skl_model</span><span class="o">.</span><span class="n">loss_curve_</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[benchmark] skl=</span><span class="si">%r</span><span class="s2"> iterations - </span><span class="si">%r</span><span class="s2"> seconds&quot;</span> <span class="o">%</span> <span class="p">(</span>
        <span class="n">length_skl</span><span class="p">,</span> <span class="n">duration_skl</span><span class="p">))</span>

    <span class="n">begin</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">train_session</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">duration_ort</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">begin</span>
    <span class="n">length_ort</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_session</span><span class="o">.</span><span class="n">train_losses_</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[benchmark] ort=</span><span class="si">%r</span><span class="s2"> iteration - </span><span class="si">%r</span><span class="s2"> seconds&quot;</span> <span class="o">%</span> <span class="p">(</span>
        <span class="n">length_ort</span><span class="p">,</span> <span class="n">duration_ort</span><span class="p">))</span>

    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">skl</span><span class="o">=</span><span class="n">duration_skl</span><span class="p">,</span> <span class="n">ort</span><span class="o">=</span><span class="n">duration_ort</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">iter_skl</span><span class="o">=</span><span class="n">length_skl</span><span class="p">,</span> <span class="n">iter_ort</span><span class="o">=</span><span class="n">length_ort</span><span class="p">,</span>
                <span class="n">losses_skl</span><span class="o">=</span><span class="n">skl_model</span><span class="o">.</span><span class="n">loss_curve_</span><span class="p">,</span>
                <span class="n">losses_ort</span><span class="o">=</span><span class="n">train_session</span><span class="o">.</span><span class="n">train_losses_</span><span class="p">)</span>
</pre></div>
</div>
<p>Common parameters and model</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">max_iter</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">nn</span> <span class="o">=</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span><span class="p">,</span>
                   <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;sgd&#39;</span><span class="p">,</span> <span class="n">learning_rate_init</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span>
                   <span class="n">n_iter_no_change</span><span class="o">=</span><span class="n">max_iter</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
                   <span class="n">nesterovs_momentum</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
                   <span class="n">learning_rate</span><span class="o">=</span><span class="s2">&quot;invscaling&quot;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
<p>Conversion to ONNX and trainer initialization
It is slightly different from a regression model.
Probabilities usually come from raw scores transformed
through a function such as the sigmoid function.
The gradient of the loss is computed against the raw scores
because it is easier to compute than to let onnxruntime
do it.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">onx</span> <span class="o">=</span> <span class="n">to_onnx</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="n">X_train</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="n">target_opset</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
              <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;zipmap&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>

<span class="k">try</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">onnx_simple_text_plot</span><span class="p">(</span><span class="n">onx</span><span class="p">))</span>
<span class="k">except</span> <span class="ne">RuntimeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;You should upgrade mlprodict.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=14
opset: domain=&#39;ai.onnx.ml&#39; version=1
input: name=&#39;X&#39; type=dtype(&#39;float32&#39;) shape=(0, 100)
init: name=&#39;coefficient&#39; type=dtype(&#39;float32&#39;) shape=(5000,)
init: name=&#39;intercepts&#39; type=dtype(&#39;float32&#39;) shape=(50,)
init: name=&#39;coefficient1&#39; type=dtype(&#39;float32&#39;) shape=(500,)
init: name=&#39;intercepts1&#39; type=dtype(&#39;float32&#39;) shape=(10,)
init: name=&#39;coefficient2&#39; type=dtype(&#39;float32&#39;) shape=(10,)
init: name=&#39;intercepts2&#39; type=dtype(&#39;float32&#39;) shape=(1,) -- array([0.28234306], dtype=float32)
init: name=&#39;unity&#39; type=dtype(&#39;float32&#39;) shape=(1,) -- array([1.], dtype=float32)
init: name=&#39;classes&#39; type=dtype(&#39;int32&#39;) shape=(2,) -- array([0, 1], dtype=int32)
init: name=&#39;shape_tensor&#39; type=dtype(&#39;int64&#39;) shape=(1,) -- array([-1])
Cast(X, to=1) -&gt; cast_input
  MatMul(cast_input, coefficient) -&gt; mul_result
    Add(mul_result, intercepts) -&gt; add_result
      Relu(add_result) -&gt; next_activations
        MatMul(next_activations, coefficient1) -&gt; mul_result1
          Add(mul_result1, intercepts1) -&gt; add_result1
            Relu(add_result1) -&gt; next_activations1
              MatMul(next_activations1, coefficient2) -&gt; mul_result2
                Add(mul_result2, intercepts2) -&gt; add_result2
                  Sigmoid(add_result2) -&gt; out_activations_result
                    Sub(unity, out_activations_result) -&gt; negative_class_proba
                    Concat(negative_class_proba, out_activations_result, axis=1) -&gt; probabilities
                      ArgMax(probabilities, axis=1) -&gt; argmax_output
                        ArrayFeatureExtractor(classes, argmax_output) -&gt; array_feature_extractor_result
                          Reshape(array_feature_extractor_result, shape_tensor) -&gt; reshaped_result
                            Cast(reshaped_result, to=7) -&gt; label
output: name=&#39;label&#39; type=dtype(&#39;int64&#39;) shape=(0,)
output: name=&#39;probabilities&#39; type=dtype(&#39;float32&#39;) shape=(0, 2)
</pre></div>
</div>
<p>Raw scores are the input of operator <em>Sigmoid</em>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">onx</span> <span class="o">=</span> <span class="n">select_model_inputs_outputs</span><span class="p">(</span>
    <span class="n">onx</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;add_result2&quot;</span><span class="p">],</span> <span class="n">infer_shapes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">onnx_simple_text_plot</span><span class="p">(</span><span class="n">onx</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=14
opset: domain=&#39;ai.onnx.ml&#39; version=1
input: name=&#39;X&#39; type=dtype(&#39;float32&#39;) shape=(0, 100)
init: name=&#39;coefficient&#39; type=dtype(&#39;float32&#39;) shape=(5000,)
init: name=&#39;intercepts&#39; type=dtype(&#39;float32&#39;) shape=(50,)
init: name=&#39;coefficient1&#39; type=dtype(&#39;float32&#39;) shape=(500,)
init: name=&#39;intercepts1&#39; type=dtype(&#39;float32&#39;) shape=(10,)
init: name=&#39;coefficient2&#39; type=dtype(&#39;float32&#39;) shape=(10,)
init: name=&#39;intercepts2&#39; type=dtype(&#39;float32&#39;) shape=(1,) -- array([0.28234306], dtype=float32)
Cast(X, to=1) -&gt; cast_input
  MatMul(cast_input, coefficient) -&gt; mul_result
    Add(mul_result, intercepts) -&gt; add_result
      Relu(add_result) -&gt; next_activations
        MatMul(next_activations, coefficient1) -&gt; mul_result1
          Add(mul_result1, intercepts1) -&gt; add_result1
            Relu(add_result1) -&gt; next_activations1
              MatMul(next_activations1, coefficient2) -&gt; mul_result2
                Add(mul_result2, intercepts2) -&gt; add_result2
output: name=&#39;add_result2&#39; type=dtype(&#39;float32&#39;) shape=(0, 1)
</pre></div>
</div>
<p>And the names are renamed to have them follow the
alphabetical order (see <a class="reference internal" href="../onnxcustom/training/ortgradient.html#onnxcustom.training.ortgradient.OrtGradientForwardBackward" title="onnxcustom.training.ortgradient.OrtGradientForwardBackward"><code class="xref py py-class docutils literal notranslate"><span class="pre">OrtGradientForwardBackward</span></code></a>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">onx</span> <span class="o">=</span> <span class="n">onnx_rename_weights</span><span class="p">(</span><span class="n">onx</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">onnx_simple_text_plot</span><span class="p">(</span><span class="n">onx</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=14
opset: domain=&#39;ai.onnx.ml&#39; version=1
input: name=&#39;X&#39; type=dtype(&#39;float32&#39;) shape=(0, 100)
init: name=&#39;I0_coefficient&#39; type=dtype(&#39;float32&#39;) shape=(5000,)
init: name=&#39;I1_intercepts&#39; type=dtype(&#39;float32&#39;) shape=(50,)
init: name=&#39;I2_coefficient1&#39; type=dtype(&#39;float32&#39;) shape=(500,)
init: name=&#39;I3_intercepts1&#39; type=dtype(&#39;float32&#39;) shape=(10,)
init: name=&#39;I4_coefficient2&#39; type=dtype(&#39;float32&#39;) shape=(10,)
init: name=&#39;I5_intercepts2&#39; type=dtype(&#39;float32&#39;) shape=(1,) -- array([0.28234306], dtype=float32)
Cast(X, to=1) -&gt; r7
  MatMul(r7, I0_coefficient) -&gt; r6
    Add(r6, I1_intercepts) -&gt; r5
      Relu(r5) -&gt; r4
        MatMul(r4, I2_coefficient1) -&gt; r3
          Add(r3, I3_intercepts1) -&gt; r2
            Relu(r2) -&gt; r1
              MatMul(r1, I4_coefficient2) -&gt; r0
                Add(r0, I5_intercepts2) -&gt; add_result2
output: name=&#39;add_result2&#39; type=dtype(&#39;float32&#39;) shape=(0, 1)
</pre></div>
</div>
<p>We select the log loss (see <a class="reference internal" href="../onnxcustom/training/sgd_learning_loss.html#onnxcustom.training.sgd_learning_loss.NegLogLearningLoss" title="onnxcustom.training.sgd_learning_loss.NegLogLearningLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">NegLogLearningLoss</span></code></a>,
a simple regularization defined with <a class="reference internal" href="../onnxcustom/training/sgd_learning_penalty.html#onnxcustom.training.sgd_learning_penalty.ElasticLearningPenalty" title="onnxcustom.training.sgd_learning_penalty.ElasticLearningPenalty"><code class="xref py py-class docutils literal notranslate"><span class="pre">ElasticLearningPenalty</span></code></a>,
and the Nesterov algorithm to update the weights with
<cite>LearningRateSGDNesterov
&lt;onnxcustom.training.sgd_learning_rate.LearningRateSGDNesterov&gt;</cite>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">train_session</span> <span class="o">=</span> <span class="n">OrtGradientForwardBackwardOptimizer</span><span class="p">(</span>
    <span class="n">onx</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">,</span> <span class="n">warm_start</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
    <span class="n">learning_loss</span><span class="o">=</span><span class="n">NegLogLearningLoss</span><span class="p">(),</span>
    <span class="n">learning_rate</span><span class="o">=</span><span class="n">LearningRateSGDNesterov</span><span class="p">(</span>
        <span class="mf">1e-7</span><span class="p">,</span> <span class="n">nesterov</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.9</span><span class="p">),</span>
    <span class="n">learning_penalty</span><span class="o">=</span><span class="n">ElasticLearningPenalty</span><span class="p">(</span><span class="n">l1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">l2</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">))</span>


<span class="n">benches</span> <span class="o">=</span> <span class="p">[</span><span class="n">benchmark</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">nn</span><span class="p">,</span> <span class="n">train_session</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;NN-CPU&#39;</span><span class="p">)]</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[benchmark] NN-CPU
/var/lib/jenkins/workspace/onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:692: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (100) reached and the optimization hasn&#39;t converged yet.
  warnings.warn(
[benchmark] skl=100 iterations - 12.829431453719735 seconds
[benchmark] ort=100 iteration - 16.35571615770459 seconds
</pre></div>
</div>
</section>
<section id="profiling">
<h2><a class="toc-backref" href="#id2">Profiling</a><a class="headerlink" href="#profiling" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">clean_name</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;onnxruntime&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pos</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">text</span><span class="p">[</span><span class="n">pos</span><span class="p">:]</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;sklearn&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pos</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">text</span><span class="p">[</span><span class="n">pos</span><span class="p">:]</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;onnxcustom&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pos</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">text</span><span class="p">[</span><span class="n">pos</span><span class="p">:]</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;site-packages&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pos</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">text</span><span class="p">[</span><span class="n">pos</span><span class="p">:]</span>
    <span class="k">return</span> <span class="n">text</span>


<span class="n">ps</span> <span class="o">=</span> <span class="n">profile</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">benchmark</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span>
             <span class="n">nn</span><span class="p">,</span> <span class="n">train_session</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;NN-CPU&#39;</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">root</span><span class="p">,</span> <span class="n">nodes</span> <span class="o">=</span> <span class="n">profile2graph</span><span class="p">(</span><span class="n">ps</span><span class="p">,</span> <span class="n">clean_text</span><span class="o">=</span><span class="n">clean_name</span><span class="p">)</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">to_text</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[benchmark] NN-CPU
/var/lib/jenkins/workspace/onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:692: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (100) reached and the optimization hasn&#39;t converged yet.
  warnings.warn(
[benchmark] skl=100 iterations - 14.402239209972322 seconds
[benchmark] ort=100 iteration - 19.739032081328332 seconds
filter                                                       --      18      18 -- 0.00007 0.00018 -- /usr/local/lib/python3.9/logging/__init__.py:787:filter (filter)
    filter                                                   --      12      12 -- 0.00002 0.00002 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:358:filter (filter)
    filter                                                   --       6       6 -- 0.00005 0.00006 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:491:filter (filter)
        &lt;built-in method builtins.isinstance&gt;                --      18      18 -- 0.00001 0.00001 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
    &lt;built-in method builtins.hasattr&gt;                       --      18      18 -- 0.00002 0.00002 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
acquire                                                      --      30      30 -- 0.00007 0.00011 -- /usr/local/lib/python3.9/logging/__init__.py:892:acquire (acquire)
    &lt;method &#39;acquire&#39; of &#39;_thread.RLock&#39; objects&gt;            --      30      30 -- 0.00005 0.00005 -- ~:0:&lt;method &#39;acquire&#39; of &#39;_thread.RLock&#39; objects&gt; (&lt;method &#39;acquire&#39; of &#39;_thread.RLock&#39; objects&gt;)
release                                                      --      30      30 -- 0.00006 0.00008 -- /usr/local/lib/python3.9/logging/__init__.py:899:release (release)
    &lt;method &#39;release&#39; of &#39;_thread.RLock&#39; objects&gt;            --      30      30 -- 0.00002 0.00002 -- ~:0:&lt;method &#39;release&#39; of &#39;_thread.RLock&#39; objects&gt; (&lt;method &#39;release&#39; of &#39;_thread.RLock&#39; objects&gt;)
emit                                                         --      12      12 -- 0.00009 0.00113 -- /usr/local/lib/python3.9/logging/__init__.py:1067:emit (emit)
    format                                                   --      12      12 -- 0.00004 0.00059 -- /usr/local/lib/python3.9/logging/__init__.py:912:format (format)
        format                                               --      12      12 -- 0.00010 0.00055 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:536:format (format)
            format                                           --      12      12 -- 0.00008 0.00040 -- /usr/local/lib/python3.9/logging/__init__.py:646:format (format)
                usesTime                                     --      12      12 -- 0.00002 0.00009 -- /usr/local/lib/python3.9/logging/__init__.py:624:usesTime (usesTime)
                    usesTime                                 --      12      12 -- 0.00004 0.00006 -- /usr/local/lib/python3.9/logging/__init__.py:417:usesTime (usesTime)
                        &lt;method &#39;find&#39; of &#39;str&#39; objects&gt;     --      12      12 -- 0.00002 0.00002 -- ~:0:&lt;method &#39;find&#39; of &#39;str&#39; objects&gt; (&lt;method &#39;find&#39; of &#39;str&#39; objects&gt;)
                formatMessage                                --      12      12 -- 0.00002 0.00009 -- /usr/local/lib/python3.9/logging/__init__.py:630:formatMessage (formatMessage)
                    format                                   --      12      12 -- 0.00002 0.00007 -- /usr/local/lib/python3.9/logging/__init__.py:428:format (format)
                        _format                              --      12      12 -- 0.00005 0.00005 -- /usr/local/lib/python3.9/logging/__init__.py:425:_format (_format)
                getMessage                                   --      12      12 -- 0.00007 0.00014 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:96:getMessage (getMessage)
                    getMessage                               --      12      12 -- 0.00006 0.00006 -- /usr/local/lib/python3.9/logging/__init__.py:354:getMessage (getMessage)
                    &lt;built-in method builtins.getattr&gt;       --      12      12 -- 0.00001 0.00001 -- ~:0:&lt;built-in method builtins.getattr&gt; (&lt;built-in method builtins.getattr&gt;) +++
            colorize                                         --       2       2 -- 0.00002 0.00003 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/console.py:85:colorize (colorize)
                escseq                                       --       4       4 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/console.py:86:escseq (escseq)
            &lt;built-in method builtins.getattr&gt;               --      12      12 -- 0.00001 0.00001 -- ~:0:&lt;built-in method builtins.getattr&gt; (&lt;built-in method builtins.getattr&gt;) +++
    flush                                                    --      12      12 -- 0.00007 0.00039 -- /usr/local/lib/python3.9/logging/__init__.py:1056:flush (flush)
        acquire                                              --      12      12 -- 0.00002 0.00004 -- /usr/local/lib/python3.9/logging/__init__.py:892:acquire (acquire) +++
        release                                              --      12      12 -- 0.00003 0.00004 -- /usr/local/lib/python3.9/logging/__init__.py:899:release (release) +++
        flush                                                --       6       6 -- 0.00002 0.00023 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:562:flush (flush)
            &lt;method &#39;flush&#39; of &#39;_io.TextIOWrapper&#39; objects&gt;  --       6       6 -- 0.00019 0.00019 -- ~:0:&lt;method &#39;flush&#39; of &#39;_io.TextIOWrapper&#39; objects&gt; (&lt;method &#39;flush&#39; of &#39;_io.TextIOWrapper&#39; objects&gt;)
        &lt;built-in method builtins.hasattr&gt;                   --      12      12 -- 0.00001 0.00001 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
    write                                                    --       6       6 -- 0.00003 0.00003 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:554:write (write)
    write                                                    --       6       6 -- 0.00003 0.00003 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:572:write (write)
isEnabledFor                                                 --      12      12 -- 0.00002 0.00002 -- /usr/local/lib/python3.9/logging/__init__.py:1677:isEnabledFor (isEnabledFor)
inner                                                        --       6       6 -- 0.00002 0.00002 -- /usr/local/lib/python3.9/typing.py:256:inner (inner)
cast                                                         --       6       6 -- 0.00000 0.00000 -- /usr/local/lib/python3.9/typing.py:1326:cast (cast)
simplefilter                                                 --      11      11 -- 0.00005 0.00026 -- /usr/local/lib/python3.9/warnings.py:165:simplefilter (simplefilter)
    _add_filter                                              --      11      11 -- 0.00011 0.00020 -- /usr/local/lib/python3.9/warnings.py:181:_add_filter (_add_filter)
        &lt;method &#39;insert&#39; of &#39;list&#39; objects&gt;                  --      11      11 -- 0.00002 0.00002 -- ~:0:&lt;method &#39;insert&#39; of &#39;list&#39; objects&gt; (&lt;method &#39;insert&#39; of &#39;list&#39; objects&gt;)
        &lt;method &#39;remove&#39; of &#39;list&#39; objects&gt;                  --      11      11 -- 0.00007 0.00007 -- ~:0:&lt;method &#39;remove&#39; of &#39;list&#39; objects&gt; (&lt;method &#39;remove&#39; of &#39;list&#39; objects&gt;)
        &lt;built-in method _warnings._filters_mutated&gt;         --      11      11 -- 0.00001 0.00001 -- ~:0:&lt;built-in method _warnings._filters_mutated&gt; (&lt;built-in method _warnings._filters_mutated&gt;) +++
    &lt;built-in method builtins.isinstance&gt;                    --      11      11 -- 0.00001 0.00001 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
__init__                                                     --       2       2 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/warnings.py:403:__init__ (__init__)
__init__                                                     --      11      11 -- 0.00004 0.00004 -- /usr/local/lib/python3.9/warnings.py:437:__init__ (__init__)
__enter__                                                    --      11      11 -- 0.00009 0.00010 -- /usr/local/lib/python3.9/warnings.py:458:__enter__ (__enter__)
    &lt;built-in method _warnings._filters_mutated&gt;             --      11      11 -- 0.00001 0.00001 -- ~:0:&lt;built-in method _warnings._filters_mutated&gt; (&lt;built-in method _warnings._filters_mutated&gt;) +++
__exit__                                                     --      11      11 -- 0.00006 0.00006 -- /usr/local/lib/python3.9/warnings.py:477:__exit__ (__exit__)
    &lt;built-in method _warnings._filters_mutated&gt;             --      11      11 -- 0.00001 0.00001 -- ~:0:&lt;built-in method _warnings._filters_mutated&gt; (&lt;built-in method _warnings._filters_mutated&gt;) +++
any                                                          --       2       2 -- 0.00002 0.00018 -- &lt;__array_function__ internals&gt;:177:any (any)
    _any_dispatcher                                          --       2       2 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:2300:_any_dispatcher (_any_dispatcher)
    &lt;built-in method numpy.core....implement_array_function&gt; --       2       2 -- 0.00003 0.00015 -- ~:0:&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt; (&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt;) +++
clip                                                         --    5001    5001 -- 0.03248 0.99188 -- &lt;__array_function__ internals&gt;:177:clip (clip)
    _clip_dispatcher                                         --    5001    5001 -- 0.00547 0.00547 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:2079:_clip_dispatcher (_clip_dispatcher)
    &lt;built-in method numpy.core....implement_array_function&gt; --    5001    5001 -- 0.07215 0.95393 -- ~:0:&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt; (&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt;) +++
unique                                                       --     106     106 -- 0.00064 0.01184 -- &lt;__array_function__ internals&gt;:177:unique (unique)
    _unique_dispatcher                                       --     106     106 -- 0.00011 0.00011 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/lib/arraysetops.py:133:_unique_dispatcher (_unique_dispatcher)
    &lt;built-in method numpy.core....implement_array_function&gt; --     106     106 -- 0.00079 0.01109 -- ~:0:&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt; (&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt;) +++
empty_like                                                   --       7       7 -- 0.00004 0.00011 -- &lt;__array_function__ internals&gt;:177:empty_like (empty_like)
    empty_like                                               --       7       7 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/multiarray.py:80:empty_like (empty_like)
&lt;lambda&gt;                                                     --       1       1 -- 0.00001 34.14365 -- onnxcustom/onnxcustom_UT_39_std/_doc/examples/plot_orttraining_benchmark_fwbw_cls.py:168:&lt;lambda&gt; (&lt;lambda&gt;)
    benchmark                                                --       1       1 -- 0.00013 34.14364 -- onnxcustom/onnxcustom_UT_39_std/_doc/examples/plot_orttraining_benchmark_fwbw_cls.py:50:benchmark (benchmark)
        fit                                                  --       1       1 -- 0.00553 19.73899 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers_partial.py:263:fit (fit)
            __init__                                         --       1       1 -- 0.00005 0.00009 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/data_loader.py:31:__init__ (__init__)
                get_ort_device                               --       1       1 -- 0.00000 0.00000 -- onnxruntime_helper.py:63:get_ort_device (get_ort_device)
                numpy_to_ort_value                           --       2       2 -- 0.00001 0.00003 -- onnxruntime_helper.py:134:numpy_to_ort_value (numpy_to_ort_value) +++
            needs_grad                                       --       3       3 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers_partial.py:99:needs_grad (needs_grad)
                needs_grad                                   --       3       3 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/sgd_learning_rate.py:337:needs_grad (needs_grad)
            get_full_state                                   --     101     101 -- 0.00073 0.00327 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers_partial.py:147:get_full_state (get_full_state) +++
            set_state                                        --       4       4 -- 0.00033 0.00112 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers_partial.py:196:set_state (set_state)
                _get_att_state                               --       4       4 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers_partial.py:139:_get_att_state (_get_att_state) +++
                numpy_to_ort_value                           --      24      24 -- 0.00008 0.00041 -- onnxruntime_helper.py:134:numpy_to_ort_value (numpy_to_ort_value) +++
                &lt;built-in method numpy.zeros&gt;                --      12      12 -- 0.00007 0.00007 -- ~:0:&lt;built-in method numpy.zeros&gt; (&lt;built-in method numpy.zeros&gt;) +++
                &lt;method &#39;append&#39; of &#39;list&#39; objects&gt;          --      56      56 -- 0.00003 0.00003 -- ~:0:&lt;method &#39;append&#39; of &#39;list&#39; objects&gt; (&lt;method &#39;append&#39; of &#39;list&#39; objects&gt;) +++
                &lt;built-in method builtins.hasattr&gt;           --       4       4 -- 0.00019 0.00019 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
                &lt;built-in method builtins.isinstance&gt;        --      24      24 -- 0.00002 0.00002 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
            &lt;listcomp&gt;                                       --       1       1 -- 0.00006 0.00360 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers_partial.py:311:&lt;listcomp&gt; (&lt;listcomp&gt;)
                get_initializer                              --       7       7 -- 0.00020 0.00354 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:280:get_initializer (get_initializer) +++
            &lt;listcomp&gt;                                       --       1       1 -- 0.00005 0.00285 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers_partial.py:315:&lt;listcomp&gt; (&lt;listcomp&gt;)
                get_initializer                              --       7       7 -- 0.00020 0.00280 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:280:get_initializer (get_initializer) +++
            _iteration                                       --     100     100 -- 1.79248 19.68066 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers_partial.py:397:_iteration (_iteration)
                iter_ortvalue                                --    5100    5100 -- 0.12190 0.66953 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/data_loader.py:147:iter_ortvalue (iter_ortvalue)
                    _next_iter                               --    5000    5000 -- 0.03942 0.35568 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/data_loader.py:98:_next_iter (_next_iter)
                        &lt;method &#39;randint&#39;...mState&#39; objects&gt; --    5000    5000 -- 0.30333 0.30333 -- ~:0:&lt;method &#39;randint&#39; of &#39;numpy.random.mtrand.RandomState&#39; objects&gt; (&lt;method &#39;randint&#39; of &#39;numpy.random.mtrand.RandomState&#39; objects&gt;)
                        &lt;built-in method builtins.len&gt;       --    5000    5000 -- 0.00767 0.01293 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;) +++
                    numpy_to_ort_value                       --   10000   10000 -- 0.03210 0.15669 -- onnxruntime_helper.py:134:numpy_to_ort_value (numpy_to_ort_value) +++
                    &lt;built-in method builtins.len&gt;           --    5200    5200 -- 0.01746 0.03525 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;) +++
                forward                                      --    5000    5000 -- 1.14285 1.50598 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:655:forward (forward)
                    input_to_ort                             --    5000    5000 -- 0.21496 0.30590 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:578:input_to_ort (input_to_ort) +++
                    save_for_backward                        --    5000    5000 -- 0.04654 0.04654 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:630:save_for_backward (save_for_backward)
                    &lt;method &#39;append&#39; of &#39;list&#39; objects&gt;      --    5000    5000 -- 0.01069 0.01069 -- ~:0:&lt;method &#39;append&#39; of &#39;list&#39; objects&gt; (&lt;method &#39;append&#39; of &#39;list&#39; objects&gt;) +++
                backward                                     --    5000    5000 -- 1.56197 1.76075 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:737:backward (backward)
                    input_to_ort                             --    5000    5000 -- 0.13888 0.18149 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:578:input_to_ort (input_to_ort) +++
                    saved_tensors                            --    5000    5000 -- 0.00685 0.00685 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:642:saved_tensors (saved_tensors)
                    &lt;method &#39;pop&#39; of &#39;list&#39; objects&gt;         --    5000    5000 -- 0.01044 0.01044 -- ~:0:&lt;method &#39;pop&#39; of &#39;list&#39; objects&gt; (&lt;method &#39;pop&#39; of &#39;list&#39; objects&gt;)
                loss_gradient                                --    5000    5000 -- 0.25857 1.34957 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/sgd_learning_loss.py:61:loss_gradient (loss_gradient)
                    clear_binding_inputs                     --    5000    5000 -- 0.02139 0.05011 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/_base_onnx_function.py:147:clear_binding_inputs (clear_binding_inputs)
                        _cache_in_clear                      --    5000    5000 -- 0.02161 0.02872 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/_base_onnx_function.py:136:_cache_in_clear (_cache_in_clear)
                            &lt;built-in method builtins.id&gt;    --    5000    5000 -- 0.00711 0.00711 -- ~:0:&lt;built-in method builtins.id&gt; (&lt;built-in method builtins.id&gt;) +++
                    _bind_input_ortvalue                     --   10000   10000 -- 0.07677 0.33085 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/_base_onnx_function.py:179:_bind_input_ortvalue (_bind_input_ortvalue) +++
                    _call_iobinding                          --    5000    5000 -- 0.69954 0.69954 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/sgd_learning_loss.py:58:_call_iobinding (_call_iobinding)
                    &lt;built-in method builtins.hasattr&gt;       --   10000   10000 -- 0.01049 0.01049 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
                penalty_loss                                 --    5000    5000 -- 0.29701 2.03358 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/sgd_learning_penalty.py:168:penalty_loss (penalty_loss)
                    _bind_input_ortvalue                     --   35000   35000 -- 0.17349 0.56303 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/_base_onnx_function.py:179:_bind_input_ortvalue (_bind_input_ortvalue) +++
                    _bind_output_ortvalue                    --    5000    5000 -- 0.03842 0.14657 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/_base_onnx_function.py:225:_bind_output_ortvalue (_bind_output_ortvalue) +++
                    _call_iobinding                          --    5000    5000 -- 1.01379 1.01379 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/sgd_learning_penalty.py:27:_call_iobinding (_call_iobinding) +++
                    &lt;built-in method builtins.hasattr&gt;       --   10000   10000 -- 0.00876 0.00876 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
                    &lt;built-in method builtins.len&gt;           --   10000   10000 -- 0.00442 0.00442 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;) +++
                update_weights                               --   30000   30000 -- 0.69175 3.17189 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/sgd_learning_penalty.py:198:update_weights (update_weights)
                    _bind_input_ortvalue                     --   30000   30000 -- 0.15196 0.47831 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/_base_onnx_function.py:179:_bind_input_ortvalue (_bind_input_ortvalue) +++
                    _bind_output_ortvalue                    --   30000   30000 -- 0.13885 0.42685 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/_base_onnx_function.py:225:_bind_output_ortvalue (_bind_output_ortvalue) +++
                    _call_iobinding                          --   30000   30000 -- 1.53237 1.53237 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/sgd_learning_penalty.py:27:_call_iobinding (_call_iobinding) +++
                    &lt;built-in method builtins.hasattr&gt;       --   60000   60000 -- 0.04260 0.04260 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
                update_weights                               --   30000   30000 -- 1.77980 7.32196 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/sgd_learning_rate.py:392:update_weights (update_weights)
                    _bind_input_ortvalue                     --  150000  150000 -- 0.70486 2.12471 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/_base_onnx_function.py:179:_bind_input_ortvalue (_bind_input_ortvalue) +++
                    _bind_output_ortvalue                    --   60000   60000 -- 0.32183 0.86631 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/_base_onnx_function.py:225:_bind_output_ortvalue (_bind_output_ortvalue) +++
                    _call_iobinding                          --   30000   30000 -- 1.73590 1.73590 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/sgd_learning_rate.py:33:_call_iobinding (_call_iobinding)
                    value                                    --   30000   30000 -- 0.03628 0.03628 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/sgd_learning_rate.py:186:value (value) +++
                    &lt;built-in method on...tvalue_from_numpy&gt; --   60000   60000 -- 0.72955 0.72955 -- ~:0:&lt;built-in method onnxruntime.capi.onnxruntime_pybind11_state.ortvalue_from_numpy&gt; (&lt;built-in method onnxruntime.capi.onnxruntime_pybind11_state.ortvalue_from_numpy&gt;) +++
                    &lt;built-in method builtins.hasattr&gt;       --   60000   60000 -- 0.04942 0.04942 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
                &lt;method &#39;mean&#39; of &#39;numpy.ndarray&#39; objects&gt;   --     100     100 -- 0.00068 0.01596 -- ~:0:&lt;method &#39;mean&#39; of &#39;numpy.ndarray&#39; objects&gt; (&lt;method &#39;mean&#39; of &#39;numpy.ndarray&#39; objects&gt;)
                    _mean                                    --     100     100 -- 0.00718 0.01528 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/_methods.py:162:_mean (_mean) +++
                &lt;built-in method numpy.array&gt;                --     100     100 -- 0.00854 0.00854 -- ~:0:&lt;built-in method numpy.array&gt; (&lt;built-in method numpy.array&gt;) +++
                &lt;method &#39;append&#39; of &#39;list&#39; objects&gt;          --    5000    5000 -- 0.00603 0.00603 -- ~:0:&lt;method &#39;append&#39; of &#39;list&#39; objects&gt; (&lt;method &#39;append&#39; of &#39;list&#39; objects&gt;) +++
                &lt;built-in method builtins.len&gt;               --   30100   30100 -- 0.04438 0.04438 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;) +++
            _create_training_session                         --       1       1 -- 0.00003 0.03696 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers_partial.py:626:_create_training_session (_create_training_session)
                __init__                                     --       1       1 -- 0.00017 0.03689 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:59:__init__ (__init__)
                    &lt;listcomp&gt;                               --       1       1 -- 0.00003 0.00003 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:96:&lt;listcomp&gt; (&lt;listcomp&gt;)
                    &lt;listcomp&gt;                               --       1       1 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:99:&lt;listcomp&gt; (&lt;listcomp&gt;)
                    &lt;listcomp&gt;                               --       1       1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:118:&lt;listcomp&gt; (&lt;listcomp&gt;)
                    _init_next                               --       1       1 -- 0.00021 0.03665 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:171:_init_next (_init_next)
                        &lt;listcomp&gt;                           --       1       1 -- 0.00003 0.00003 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:181:&lt;listcomp&gt; (&lt;listcomp&gt;)
                        &lt;listcomp&gt;                           --       1       1 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:183:&lt;listcomp&gt; (&lt;listcomp&gt;)
                        &lt;listcomp&gt;                           --       1       1 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:186:&lt;listcomp&gt; (&lt;listcomp&gt;)
                        _create_onnx_graphs                  --       1       1 -- 0.00768 0.03640 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:301:_create_onnx_graphs (_create_onnx_graphs)
                            &lt;listcomp&gt;                       --       1       1 -- 0.00002 0.00002 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:413:&lt;listcomp&gt; (&lt;listcomp&gt;)
                            &lt;listcomp&gt;                       --       1       1 -- 0.00002 0.00002 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:414:&lt;listcomp&gt; (&lt;listcomp&gt;)
                            &lt;listcomp&gt;                       --       1       1 -- 0.00003 0.00004 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:416:&lt;listcomp&gt; (&lt;listcomp&gt;)
                                _provider_nam..._device_type --       1       1 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:271:_provider_name_to_device_type (_provider_name_to_device_type) +++
                            &lt;listcomp&gt;                       --       1       1 -- 0.00008 0.00011 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:421:&lt;listcomp&gt; (&lt;listcomp&gt;)
                                _provider_nam..._device_type --       7       7 -- 0.00001 0.00002 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:271:_provider_name_to_device_type (_provider_name_to_device_type) +++
                            &lt;listcomp&gt;                       --       1       1 -- 0.00001 0.00002 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:427:&lt;listcomp&gt; (&lt;listcomp&gt;)
                                _provider_nam..._device_type --       1       1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:271:_provider_name_to_device_type (_provider_name_to_device_type) +++
                            &lt;listcomp&gt;                       --       1       1 -- 0.00003 0.00003 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:496:&lt;listcomp&gt; (&lt;listcomp&gt;)
                            &lt;listcomp&gt;                       --       1       1 -- 0.00002 0.00002 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:497:&lt;listcomp&gt; (&lt;listcomp&gt;)
                            load_model                       --       2       2 -- 0.00002 0.00118 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/onnx/__init__.py:107:load_model (load_model)
                                _load_bytes                  --       2       2 -- 0.00005 0.00007 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/onnx/__init__.py:30:_load_bytes (_load_bytes)
                                    inner                    --       4       4 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/typing.py:256:inner (inner) +++
                                    cast                     --       4       4 -- 0.00000 0.00000 -- /usr/local/lib/python3.9/typing.py:1326:cast (cast) +++
                                _get_file_path               --       2       2 -- 0.00000 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/onnx/__init__.py:50:_get_file_path (_get_file_path)
                                load_model_from_string       --       2       2 -- 0.00003 0.00109 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/onnx/__init__.py:147:load_model_from_string (load_model_from_string)
                                    _deserialize             --       2       2 -- 0.00004 0.00106 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/onnx/__init__.py:81:_deserialize (_deserialize)
                                        inner                --       2       2 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/typing.py:256:inner (inner) +++
                                        cast                 --       2       2 -- 0.00000 0.00000 -- /usr/local/lib/python3.9/typing.py:1326:cast (cast) +++
                                        &lt;method &#39;...objects&gt; --       2       2 -- 0.00100 0.00100 -- ~:0:&lt;method &#39;ParseFromString&#39; of &#39;google.protobuf.pyext._message.CMessage&#39; objects&gt; (&lt;method &#39;ParseFromString&#39; of &#39;google.protobuf.pyext._message.CMessage&#39; objects&gt;)
                            get_inputs                       --       1       1 -- 0.00000 0.00000 -- onnxruntime/capi/onnxruntime_inference_collection.py:111:get_inputs (get_inputs)
                            get_outputs                      --       1       1 -- 0.00000 0.00000 -- onnxruntime/capi/onnxruntime_inference_collection.py:115:get_outputs (get_outputs)
                            __init__                         --       2       2 -- 0.00009 0.02701 -- onnxruntime/capi/onnxruntime_inference_collection.py:283:__init__ (__init__)
                                get                          --       2       2 -- 0.00002 0.00008 -- /usr/local/lib/python3.9/_collections_abc.py:675:get (get)
                                    __getitem__              --       2       2 -- 0.00003 0.00006 -- /usr/local/lib/python3.9/os.py:674:__getitem__ (__getitem__)
                                        encode               --       2       2 -- 0.00002 0.00003 -- /usr/local/lib/python3.9/os.py:754:encode (encode)
                                __init__                     --       2       2 -- 0.00001 0.00001 -- onnxruntime/capi/onnxruntime_inference_collection.py:101:__init__ (__init__)
                                _create_inference_session    --       2       2 -- 0.02661 0.02682 -- onnxruntime/capi/onnxruntime_inference_collection.py:346:_create_inference_session (_create_inference_session)
                                    check_and_n...vider_args --       2       2 -- 0.00011 0.00019 -- onnxruntime/capi/onnxruntime_inference_collection.py:25:check_and_normalize_provider_args (check_and_normalize_provider_args)
                                        set_provider_options --       2       2 -- 0.00002 0.00002 -- onnxruntime/capi/onnxruntime_inference_collection.py:53:set_provider_options (set_provider_options)
                                            &lt;dictcomp&gt;       --       2       2 -- 0.00000 0.00000 -- onnxruntime/capi/onnxruntime_inference_collection.py:62:&lt;dictcomp&gt; (&lt;dictcomp&gt;)
                                        &lt;listcomp&gt;           --       2       2 -- 0.00001 0.00001 -- onnxruntime/capi/onnxruntime_inference_collection.py:75:&lt;listcomp&gt; (&lt;listcomp&gt;)
                                        &lt;listcomp&gt;           --       2       2 -- 0.00001 0.00001 -- onnxruntime/capi/onnxruntime_inference_collection.py:78:&lt;listcomp&gt; (&lt;listcomp&gt;)
                            &lt;method &#39;Serial...sage&#39; objects&gt; --       1       1 -- 0.00024 0.00024 -- ~:0:&lt;method &#39;SerializeToString&#39; of &#39;google.protobuf.pyext._message.CMessage&#39; objects&gt; (&lt;method &#39;SerializeToString&#39; of &#39;google.protobuf.pyext._message.CMessage&#39; objects&gt;)
                            &lt;built-in method builtins.len&gt;   --      16      16 -- 0.00001 0.00001 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;) +++
                new_instance                                 --       1       1 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:219:new_instance (new_instance)
                    __init__                                 --       1       1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:521:__init__ (__init__)
                device_to_providers                          --       1       1 -- 0.00003 0.00003 -- onnxruntime_helper.py:150:device_to_providers (device_to_providers)
            value                                            --     100     100 -- 0.00013 0.00013 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/sgd_learning_rate.py:186:value (value) +++
            init_learning_rate                               --       1       1 -- 0.00000 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/sgd_learning_rate.py:348:init_learning_rate (init_learning_rate)
                init_learning_rate                           --       1       1 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/sgd_learning_rate.py:205:init_learning_rate (init_learning_rate)
            update_learning_rate                             --     100     100 -- 0.00043 0.00375 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/sgd_learning_rate.py:358:update_learning_rate (update_learning_rate)
                update_learning_rate                         --     100     100 -- 0.00332 0.00332 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/sgd_learning_rate.py:226:update_learning_rate (update_learning_rate)
            proto_type_to_dtype                              --       6       6 -- 0.00002 0.00002 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/utils/onnx_helper.py:61:proto_type_to_dtype (proto_type_to_dtype)
            &lt;method &#39;randn&#39; of &#39;num....RandomState&#39; objects&gt; --       6       6 -- 0.00075 0.00075 -- ~:0:&lt;method &#39;randn&#39; of &#39;numpy.random.mtrand.RandomState&#39; objects&gt; (&lt;method &#39;randn&#39; of &#39;numpy.random.mtrand.RandomState&#39; objects&gt;)
            &lt;method &#39;append&#39; of &#39;list&#39; objects&gt;              --     107     107 -- 0.00010 0.00010 -- ~:0:&lt;method &#39;append&#39; of &#39;list&#39; objects&gt; (&lt;method &#39;append&#39; of &#39;list&#39; objects&gt;) +++
            &lt;built-in method builtins.len&gt;                   --     108     108 -- 0.00007 0.00007 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;) +++
        fit                                                  --       1       1 -- 0.00002 14.40223 -- sklearn/neural_network/_multilayer_perceptron.py:735:fit (fit)
            _fit                                             --       1       1 -- 0.00014 14.40221 -- sklearn/neural_network/_multilayer_perceptron.py:376:_fit (_fit)
                any                                          --       1       1 -- 0.00001 0.00010 -- &lt;__array_function__ internals&gt;:177:any (any) +++
                _initialize                                  --       1       1 -- 0.00006 0.00065 -- sklearn/neural_network/_multilayer_perceptron.py:319:_initialize (_initialize)
                    is_classifier                            --       1       1 -- 0.00000 0.00000 -- sklearn/base.py:960:is_classifier (is_classifier)
                    _init_coef                               --       3       3 -- 0.00010 0.00058 -- sklearn/neural_network/_multilayer_perceptron.py:359:_init_coef (_init_coef)
                        &lt;method &#39;uniform&#39;...mState&#39; objects&gt; --       6       6 -- 0.00041 0.00041 -- ~:0:&lt;method &#39;uniform&#39; of &#39;numpy.random.mtrand.RandomState&#39; objects&gt; (&lt;method &#39;uniform&#39; of &#39;numpy.random.mtrand.RandomState&#39; objects&gt;)
                &lt;listcomp&gt;                                   --       1       1 -- 0.00001 0.00003 -- sklearn/neural_network/_multilayer_perceptron.py:416:&lt;listcomp&gt; (&lt;listcomp&gt;)
                &lt;listcomp&gt;                                   --       1       1 -- 0.00001 0.00003 -- sklearn/neural_network/_multilayer_perceptron.py:421:&lt;listcomp&gt; (&lt;listcomp&gt;)
                _validate_hyperparameters                    --       1       1 -- 0.00002 0.00002 -- sklearn/neural_network/_multilayer_perceptron.py:445:_validate_hyperparameters (_validate_hyperparameters)
                _fit_stochastic                              --       1       1 -- 0.29894 14.39679 -- sklearn/neural_network/_multilayer_perceptron.py:553:_fit_stochastic (_fit_stochastic)
                    clip                                     --       1       1 -- 0.00001 0.00022 -- &lt;__array_function__ internals&gt;:177:clip (clip) +++
                    _backprop                                --    5000    5000 -- 0.69186 9.48382 -- sklearn/neural_network/_multilayer_perceptron.py:240:_backprop (_backprop)
                        dot                                  --   15000   15000 -- 0.06738 0.29225 -- &lt;__array_function__ internals&gt;:177:dot (dot)
                            dot                              --   15000   15000 -- 0.01250 0.01250 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/multiarray.py:736:dot (dot)
                            &lt;built-in metho...rray_function&gt; --   15000   15000 -- 0.21237 0.21237 -- ~:0:&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt; (&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt;) +++
                        inplace_relu_derivative              --   10000   10000 -- 0.43888 0.43888 -- sklearn/neural_network/_base.py:132:inplace_relu_derivative (inplace_relu_derivative)
                        binary_log_loss                      --    5000    5000 -- 0.90724 2.26017 -- sklearn/neural_network/_base.py:205:binary_log_loss (binary_log_loss)
                            clip                             --    5000    5000 -- 0.03247 0.99166 -- &lt;__array_function__ internals&gt;:177:clip (clip) +++
                            __new__                          --    5000    5000 -- 0.04389 0.05317 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/getlimits.py:457:__new__ (__new__)
                                &lt;method &#39;get&#39;...ct&#39; objects&gt; --    5000    5000 -- 0.00928 0.00928 -- ~:0:&lt;method &#39;get&#39; of &#39;dict&#39; objects&gt; (&lt;method &#39;get&#39; of &#39;dict&#39; objects&gt;) +++
                            &lt;method &#39;sum&#39; o...rray&#39; objects&gt; --   10000   10000 -- 0.04512 0.30810 -- ~:0:&lt;method &#39;sum&#39; of &#39;numpy.ndarray&#39; objects&gt; (&lt;method &#39;sum&#39; of &#39;numpy.ndarray&#39; objects&gt;)
                                _sum                         --   10000   10000 -- 0.02075 0.26298 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/_methods.py:46:_sum (_sum)
                                    &lt;method &#39;re...&#39; objects&gt; --   10000   10000 -- 0.24222 0.24222 -- ~:0:&lt;method &#39;reduce&#39; of &#39;numpy.ufunc&#39; objects&gt; (&lt;method &#39;reduce&#39; of &#39;numpy.ufunc&#39; objects&gt;) +++
                        _forward_pass                        --    5000    5000 -- 0.50466 1.61987 -- sklearn/neural_network/_multilayer_perceptron.py:118:_forward_pass (_forward_pass)
                            inplace_logistic                 --    5000    5000 -- 0.08381 0.08381 -- sklearn/neural_network/_base.py:25:inplace_logistic (inplace_logistic)
                            inplace_relu                     --   10000   10000 -- 0.34447 0.34447 -- sklearn/neural_network/_base.py:47:inplace_relu (inplace_relu)
                            safe_sparse_dot                  --   15000   15000 -- 0.64332 0.68693 -- sklearn/utils/extmath.py:120:safe_sparse_dot (safe_sparse_dot) +++
                        _compute_loss_grad                   --   15000   15000 -- 1.33320 3.81843 -- sklearn/neural_network/_multilayer_perceptron.py:176:_compute_loss_grad (_compute_loss_grad)
                            mean                             --   15000   15000 -- 0.07532 1.75372 -- &lt;__array_function__ internals&gt;:177:mean (mean)
                                _mean_dispatcher             --   15000   15000 -- 0.01432 0.01432 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:3351:_mean_dispatcher (_mean_dispatcher)
                                &lt;built-in met...ay_function&gt; --   15000   15000 -- 0.06828 1.66409 -- ~:0:&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt; (&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt;) +++
                            safe_sparse_dot                  --   15000   15000 -- 0.68659 0.73150 -- sklearn/utils/extmath.py:120:safe_sparse_dot (safe_sparse_dot) +++
                        safe_sparse_dot                      --   10000   10000 -- 0.29789 0.32663 -- sklearn/utils/extmath.py:120:safe_sparse_dot (safe_sparse_dot) +++
                        &lt;method &#39;ravel&#39; o...darray&#39; objects&gt; --   15000   15000 -- 0.03573 0.03573 -- ~:0:&lt;method &#39;ravel&#39; of &#39;numpy.ndarray&#39; objects&gt; (&lt;method &#39;ravel&#39; of &#39;numpy.ndarray&#39; objects&gt;) +++
                    _update_no_improvement_count             --     100     100 -- 0.00079 0.00079 -- sklearn/neural_network/_multilayer_perceptron.py:706:_update_no_improvement_count (_update_no_improvement_count)
                    update_params                            --    5000    5000 -- 0.45580 3.48865 -- sklearn/neural_network/_stochastic_optimizers.py:29:update_params (update_params)
                        &lt;genexpr&gt;                            --   35000   35000 -- 0.03327 0.03327 -- sklearn/neural_network/_stochastic_optimizers.py:43:&lt;genexpr&gt; (&lt;genexpr&gt;)
                        _get_updates                         --    5000    5000 -- 0.10949 2.99958 -- sklearn/neural_network/_stochastic_optimizers.py:169:_get_updates (_get_updates)
                            &lt;listcomp&gt;                       --    5000    5000 -- 1.47044 1.47044 -- sklearn/neural_network/_stochastic_optimizers.py:183:&lt;listcomp&gt; (&lt;listcomp&gt;)
                            &lt;listcomp&gt;                       --    5000    5000 -- 1.41965 1.41965 -- sklearn/neural_network/_stochastic_optimizers.py:190:&lt;listcomp&gt; (&lt;listcomp&gt;)
                    __init__                                 --       1       1 -- 0.00002 0.00042 -- sklearn/neural_network/_stochastic_optimizers.py:121:__init__ (__init__)
                        __init__                             --       1       1 -- 0.00001 0.00001 -- sklearn/neural_network/_stochastic_optimizers.py:25:__init__ (__init__)
                        &lt;listcomp&gt;                           --       1       1 -- 0.00003 0.00040 -- sklearn/neural_network/_stochastic_optimizers.py:136:&lt;listcomp&gt; (&lt;listcomp&gt;)
                            zeros_like                       --       6       6 -- 0.00002 0.00037 -- &lt;__array_function__ internals&gt;:177:zeros_like (zeros_like)
                                _zeros_like_dispatcher       --       6       6 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/numeric.py:72:_zeros_like_dispatcher (_zeros_like_dispatcher)
                                &lt;built-in met...ay_function&gt; --       6       6 -- 0.00003 0.00034 -- ~:0:&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt; (&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt;) +++
                    iteration_ends                           --     100     100 -- 0.00124 0.00124 -- sklearn/neural_network/_stochastic_optimizers.py:138:iteration_ends (iteration_ends)
                    _safe_indexing                           --    5000    5000 -- 0.05562 1.01595 -- sklearn/utils/__init__.py:307:_safe_indexing (_safe_indexing) +++
                    shuffle                                  --     100     100 -- 0.00119 0.05295 -- sklearn/utils/__init__.py:602:shuffle (shuffle)
                        resample                             --     100     100 -- 0.00322 0.05176 -- sklearn/utils/__init__.py:452:resample (resample)
                            &lt;listcomp&gt;                       --     100     100 -- 0.00040 0.00072 -- sklearn/utils/__init__.py:593:&lt;listcomp&gt; (&lt;listcomp&gt;)
                                isspmatrix                   --     100     100 -- 0.00016 0.00031 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_base.py:1291:isspmatrix (isspmatrix) +++
                            &lt;listcomp&gt;                       --     100     100 -- 0.00041 0.01952 -- sklearn/utils/__init__.py:594:&lt;listcomp&gt; (&lt;listcomp&gt;)
                                _safe_indexing               --     100     100 -- 0.00101 0.01911 -- sklearn/utils/__init__.py:307:_safe_indexing (_safe_indexing) +++
                            check_consistent_length          --     100     100 -- 0.00121 0.01719 -- sklearn/utils/validation.py:318:check_consistent_length (check_consistent_length) +++
                            check_random_state               --     100     100 -- 0.00096 0.00246 -- sklearn/utils/validation.py:1043:check_random_state (check_random_state) +++
                            &lt;method &#39;shuffl...tate&#39; objects&gt; --     100     100 -- 0.00679 0.00679 -- ~:0:&lt;method &#39;shuffle&#39; of &#39;numpy.random.mtrand.RandomState&#39; objects&gt; (&lt;method &#39;shuffle&#39; of &#39;numpy.random.mtrand.RandomState&#39; objects&gt;)
                            &lt;built-in method numpy.arange&gt;   --     100     100 -- 0.00147 0.00147 -- ~:0:&lt;built-in method numpy.arange&gt; (&lt;built-in method numpy.arange&gt;) +++
                            &lt;built-in metho...ltins.hasattr&gt; --     100     100 -- 0.00023 0.00023 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
                            &lt;built-in method builtins.len&gt;   --     200     200 -- 0.00017 0.00017 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;) +++
                    gen_batches                              --    5100    5100 -- 0.05145 0.05250 -- sklearn/utils/__init__.py:712:gen_batches (gen_batches)
                        &lt;built-in method ...tins.isinstance&gt; --     100     100 -- 0.00034 0.00105 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
                    &lt;method &#39;append&#39; of &#39;list&#39; objects&gt;      --     100     100 -- 0.00013 0.00013 -- ~:0:&lt;method &#39;append&#39; of &#39;list&#39; objects&gt; (&lt;method &#39;append&#39; of &#39;list&#39; objects&gt;) +++
                    &lt;built-in method _warnings.warn&gt;         --       1       1 -- 0.00007 0.00117 -- ~:0:&lt;built-in method _warnings.warn&gt; (&lt;built-in method _warnings.warn&gt;)
                        _showwarnmsg                         --       1       1 -- 0.00002 0.00109 -- /usr/local/lib/python3.9/warnings.py:96:_showwarnmsg (_showwarnmsg)
                            _showwarning                     --       1       1 -- 0.00001 0.00108 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx_gallery/gen_rst.py:473:_showwarning (_showwarning)
                                formatwarning                --       1       1 -- 0.00001 0.00006 -- /usr/local/lib/python3.9/warnings.py:15:formatwarning (formatwarning)
                                    _formatwarnmsg_impl      --       1       1 -- 0.00004 0.00005 -- /usr/local/lib/python3.9/warnings.py:35:_formatwarnmsg_impl (_formatwarnmsg_impl)
                                        getline              --       1       1 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/linecache.py:26:getline (getline)
                                            getlines         --       1       1 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/linecache.py:36:getlines (getlines)
                                    __init__                 --       1       1 -- 0.00000 0.00000 -- /usr/local/lib/python3.9/warnings.py:403:__init__ (__init__) +++
                                write                        --       1       1 -- 0.00002 0.00100 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx_gallery/gen_rst.py:81:write (write) +++
                        __init__                             --       1       1 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/warnings.py:403:__init__ (__init__) +++
                _validate_input                              --       1       1 -- 0.00007 0.00442 -- sklearn/neural_network/_multilayer_perceptron.py:1099:_validate_input (_validate_input)
                    _validate_data                           --       1       1 -- 0.00003 0.00117 -- sklearn/base.py:495:_validate_data (_validate_data)
                        _check_n_features                    --       1       1 -- 0.00001 0.00002 -- sklearn/base.py:359:_check_n_features (_check_n_features)
                            _num_features                    --       1       1 -- 0.00001 0.00002 -- sklearn/utils/validation.py:201:_num_features (_num_features)
                        _check_feature_names                 --       1       1 -- 0.00000 0.00001 -- sklearn/base.py:405:_check_feature_names (_check_feature_names)
                            _get_feature_names               --       1       1 -- 0.00000 0.00000 -- sklearn/utils/validation.py:1653:_get_feature_names (_get_feature_names)
                        check_X_y                            --       1       1 -- 0.00001 0.00111 -- sklearn/utils/validation.py:845:check_X_y (check_X_y)
                            check_consistent_length          --       1       1 -- 0.00001 0.00024 -- sklearn/utils/validation.py:318:check_consistent_length (check_consistent_length) +++
                            check_array                      --       1       1 -- 0.00006 0.00066 -- sklearn/utils/validation.py:494:check_array (check_array) +++
                            _check_y                         --       1       1 -- 0.00001 0.00020 -- sklearn/utils/validation.py:986:_check_y (_check_y)
                                check_array                  --       1       1 -- 0.00004 0.00019 -- sklearn/utils/validation.py:494:check_array (check_array) +++
                    __init__                                 --       1       1 -- 0.00000 0.00000 -- sklearn/preprocessing/_label.py:258:__init__ (__init__)
                    fit                                      --       1       1 -- 0.00002 0.00081 -- sklearn/preprocessing/_label.py:278:fit (fit)
                        isspmatrix                           --       1       1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_base.py:1291:isspmatrix (isspmatrix) +++
                        unique_labels                        --       1       1 -- 0.00008 0.00048 -- sklearn/utils/multiclass.py:40:unique_labels (unique_labels)
                            &lt;genexpr&gt;                        --       2       2 -- 0.00000 0.00025 -- sklearn/utils/multiclass.py:75:&lt;genexpr&gt; (&lt;genexpr&gt;)
                                type_of_target               --       1       1 -- 0.00004 0.00025 -- sklearn/utils/multiclass.py:200:type_of_target (type_of_target) +++
                            &lt;genexpr&gt;                        --       2       2 -- 0.00000 0.00012 -- sklearn/utils/multiclass.py:103:&lt;genexpr&gt; (&lt;genexpr&gt;)
                                _unique_multiclass           --       1       1 -- 0.00001 0.00011 -- sklearn/utils/multiclass.py:22:_unique_multiclass (_unique_multiclass)
                                    unique                   --       1       1 -- 0.00000 0.00010 -- &lt;__array_function__ internals&gt;:177:unique (unique) +++
                            &lt;genexpr&gt;                        --       3       3 -- 0.00000 0.00001 -- sklearn/utils/multiclass.py:106:&lt;genexpr&gt; (&lt;genexpr&gt;)
                        type_of_target                       --       1       1 -- 0.00005 0.00028 -- sklearn/utils/multiclass.py:200:type_of_target (type_of_target) +++
                        _num_samples                         --       1       1 -- 0.00002 0.00003 -- sklearn/utils/validation.py:254:_num_samples (_num_samples) +++
                    transform                                --       1       1 -- 0.00002 0.00235 -- sklearn/preprocessing/_label.py:326:transform (transform)
                        label_binarize                       --       1       1 -- 0.00014 0.00202 -- sklearn/preprocessing/_label.py:415:label_binarize (label_binarize)
                            in1d                             --       1       1 -- 0.00000 0.00015 -- &lt;__array_function__ internals&gt;:177:in1d (in1d)
                                _in1d_dispatcher             --       1       1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/lib/arraysetops.py:515:_in1d_dispatcher (_in1d_dispatcher)
                                &lt;built-in met...ay_function&gt; --       1       1 -- 0.00001 0.00014 -- ~:0:&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt; (&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt;) +++
                            sort                             --       1       1 -- 0.00001 0.00004 -- &lt;__array_function__ internals&gt;:177:sort (sort)
                                _sort_dispatcher             --       1       1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:848:_sort_dispatcher (_sort_dispatcher)
                            searchsorted                     --       1       1 -- 0.00001 0.00006 -- &lt;__array_function__ internals&gt;:177:searchsorted (searchsorted)
                                _searchsorted_dispatcher     --       1       1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:1315:_searchsorted_dispatcher (_searchsorted_dispatcher)
                            any                              --       1       1 -- 0.00001 0.00007 -- &lt;__array_function__ internals&gt;:177:any (any) +++
                            cumsum                           --       1       1 -- 0.00000 0.00007 -- &lt;__array_function__ internals&gt;:177:cumsum (cumsum)
                                _cumsum_dispatcher           --       1       1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:2491:_cumsum_dispatcher (_cumsum_dispatcher)
                            hstack                           --       1       1 -- 0.00000 0.00011 -- &lt;__array_function__ internals&gt;:177:hstack (hstack)
                                _vhstack_dispatcher          --       1       1 -- 0.00000 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/shape_base.py:218:_vhstack_dispatcher (_vhstack_dispatcher)
                                    _arrays_for...dispatcher --       1       1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/shape_base.py:207:_arrays_for_stack_dispatcher (_arrays_for_stack_dispatcher)
                            empty_like                       --       1       1 -- 0.00001 0.00001 -- &lt;__array_function__ internals&gt;:177:empty_like (empty_like) +++
                            isspmatrix                       --       1       1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_base.py:1291:isspmatrix (isspmatrix) +++
                            __init__                         --       1       1 -- 0.00004 0.00080 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_compressed.py:26:__init__ (__init__)
                                isspmatrix                   --       1       1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_base.py:1291:isspmatrix (isspmatrix) +++
                                check_format                 --       1       1 -- 0.00015 0.00034 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_compressed.py:136:check_format (check_format)
                                    get_shape                --       1       1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_base.py:119:get_shape (get_shape) +++
                                    prune                    --       1       1 -- 0.00003 0.00007 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_compressed.py:1168:prune (prune)
                                        _prune_array         --       2       2 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/_lib/_util.py:142:_prune_array (_prune_array)
                                        get_shape            --       1       1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_base.py:119:get_shape (get_shape) +++
                                        nnz                  --       4       4 -- 0.00001 0.00003 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_base.py:291:nnz (nnz)
                                            getnnz           --       4       4 -- 0.00002 0.00002 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_compressed.py:108:getnnz (getnnz)
                                        _swap                --       1       1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_csr.py:231:_swap (_swap) +++
                                    _swap                    --       2       2 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_csr.py:231:_swap (_swap) +++
                                    to_native                --       1       1 -- 0.00001 0.00002 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_sputils.py:91:to_native (to_native)
                                    get_index_dtype          --       1       1 -- 0.00003 0.00009 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_sputils.py:131:get_index_dtype (get_index_dtype) +++
                                __init__                     --       1       1 -- 0.00000 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_data.py:20:__init__ (__init__)
                                    __init__                 --       1       1 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_base.py:105:__init__ (__init__)
                                get_index_dtype              --       1       1 -- 0.00008 0.00032 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_sputils.py:131:get_index_dtype (get_index_dtype) +++
                                isshape                      --       1       1 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_sputils.py:220:isshape (isshape)
                                check_shape                  --       1       1 -- 0.00003 0.00005 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_sputils.py:277:check_shape (check_shape)
                                    &lt;genexpr&gt;                --       3       3 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_sputils.py:290:&lt;genexpr&gt; (&lt;genexpr&gt;)
                            toarray                          --       1       1 -- 0.00003 0.00007 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_compressed.py:1048:toarray (toarray)
                                get_shape                    --       1       1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_base.py:119:get_shape (get_shape) +++
                                _process_toarray_args        --       1       1 -- 0.00001 0.00002 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_base.py:1277:_process_toarray_args (_process_toarray_args)
                                    get_shape                --       1       1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_base.py:119:get_shape (get_shape) +++
                                    _get_dtype               --       1       1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_data.py:23:_get_dtype (_get_dtype)
                                tocsr                        --       1       1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_csr.py:164:tocsr (tocsr)
                                _swap                        --       2       2 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_csr.py:231:_swap (_swap) +++
                            type_of_target                   --       1       1 -- 0.00004 0.00025 -- sklearn/utils/multiclass.py:200:type_of_target (type_of_target) +++
                            check_array                      --       1       1 -- 0.00004 0.00017 -- sklearn/utils/validation.py:494:check_array (check_array) +++
                            column_or_1d                     --       1       1 -- 0.00001 0.00005 -- sklearn/utils/validation.py:1002:column_or_1d (column_or_1d)
                                ravel                        --       1       1 -- 0.00000 0.00002 -- &lt;__array_function__ internals&gt;:177:ravel (ravel)
                                    _ravel_dispatcher        --       1       1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:1751:_ravel_dispatcher (_ravel_dispatcher)
                                shape                        --       1       1 -- 0.00000 0.00001 -- &lt;__array_function__ internals&gt;:177:shape (shape)
                                    _shape_dispatcher        --       1       1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:1961:_shape_dispatcher (_shape_dispatcher)
                        type_of_target                       --       1       1 -- 0.00004 0.00026 -- sklearn/utils/multiclass.py:200:type_of_target (type_of_target) +++
                        check_is_fitted                      --       1       1 -- 0.00002 0.00006 -- sklearn/utils/validation.py:1153:check_is_fitted (check_is_fitted)
                            isclass                          --       1       1 -- 0.00000 0.00000 -- /usr/local/lib/python3.9/inspect.py:73:isclass (isclass)
                            &lt;listcomp&gt;                       --       1       1 -- 0.00002 0.00003 -- sklearn/utils/validation.py:1217:&lt;listcomp&gt; (&lt;listcomp&gt;)
                check_random_state                           --       1       1 -- 0.00001 0.00001 -- sklearn/utils/validation.py:1043:check_random_state (check_random_state) +++
        &lt;built-in method builtins.print&gt;                     --       3       3 -- 0.00004 0.00228 -- ~:0:&lt;built-in method builtins.print&gt; (&lt;built-in method builtins.print&gt;)
            write                                            --       6       6 -- 0.00010 0.00224 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx_gallery/gen_rst.py:81:write (write) +++
_bio_cache                                                   --  320000  320000 -- 1.01550 1.25964 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/_base_onnx_function.py:158:_bio_cache (_bio_cache)
    &lt;built-in method builtins.id&gt;                            --  320000  320000 -- 0.24414 0.24414 -- ~:0:&lt;built-in method builtins.id&gt; (&lt;built-in method builtins.id&gt;) +++
_bio_ptr                                                     --  320000  320000 -- 1.63802 1.63802 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/_base_onnx_function.py:175:_bio_ptr (_bio_ptr)
_bind_input_ortvalue                                         --  225000  225000 -- 1.10708 3.49690 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/_base_onnx_function.py:179:_bind_input_ortvalue (_bind_input_ortvalue)
    _bio_cache                                               --  225000  225000 -- 0.72184 0.89661 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/_base_onnx_function.py:158:_bio_cache (_bio_cache) +++
    _bio_do_bind_in                                          --   15614   15614 -- 0.20549 0.20549 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/_base_onnx_function.py:171:_bio_do_bind_in (_bio_do_bind_in)
    _bio_ptr                                                 --  225000  225000 -- 1.16621 1.16621 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/_base_onnx_function.py:175:_bio_ptr (_bio_ptr) +++
    &lt;built-in method builtins.isinstance&gt;                    --  225000  225000 -- 0.12150 0.12150 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
_bind_output_ortvalue                                        --   95000   95000 -- 0.49910 1.43974 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/_base_onnx_function.py:225:_bind_output_ortvalue (_bind_output_ortvalue)
    _bio_cache                                               --   95000   95000 -- 0.29367 0.36303 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/_base_onnx_function.py:158:_bio_cache (_bio_cache) +++
    _bio_ptr                                                 --   95000   95000 -- 0.47181 0.47181 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/_base_onnx_function.py:175:_bio_ptr (_bio_ptr) +++
    _bio_do_bind_out                                         --    5017    5017 -- 0.05687 0.05687 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/_base_onnx_function.py:221:_bio_do_bind_out (_bio_do_bind_out)
    &lt;built-in method builtins.isinstance&gt;                    --   95000   95000 -- 0.04892 0.04892 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
_get_att_state                                               --     205     205 -- 0.00024 0.00024 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers_partial.py:139:_get_att_state (_get_att_state)
get_full_state                                               --     101     301 -- 0.00156 0.00327 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers_partial.py:147:get_full_state (get_full_state)
    _get_att_state                                           --     201     201 -- 0.00023 0.00023 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers_partial.py:139:_get_att_state (_get_att_state) +++
    &lt;listcomp&gt;                                               --     100     100 -- 0.00082 0.00247 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers_partial.py:152:&lt;listcomp&gt; (&lt;listcomp&gt;)
        get_full_state                                       --     200     200 -- 0.00082 0.00165 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/optimizers_partial.py:147:get_full_state (get_full_state) +++
    &lt;built-in method builtins.getattr&gt;                       --     201     201 -- 0.00012 0.00012 -- ~:0:&lt;built-in method builtins.getattr&gt; (&lt;built-in method builtins.getattr&gt;) +++
    &lt;built-in method builtins.hasattr&gt;                       --     201     201 -- 0.00015 0.00015 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
    &lt;built-in method builtins.isinstance&gt;                    --     301     301 -- 0.00039 0.00039 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
_provider_name_to_device_type                                --       9       9 -- 0.00002 0.00003 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:271:_provider_name_to_device_type (_provider_name_to_device_type)
get_initializer                                              --      14      14 -- 0.00039 0.00634 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:280:get_initializer (get_initializer)
    to_array                                                 --      12      12 -- 0.00100 0.00594 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/onnx/numpy_helper.py:21:to_array (to_array)
        uses_external_data                                   --      12      12 -- 0.00004 0.00008 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/onnx/external_data_helper.py:224:uses_external_data (uses_external_data)
            &lt;method &#39;HasField&#39; of &#39;...age.CMessage&#39; objects&gt; --      12      12 -- 0.00004 0.00004 -- ~:0:&lt;method &#39;HasField&#39; of &#39;google.protobuf.pyext._message.CMessage&#39; objects&gt; (&lt;method &#39;HasField&#39; of &#39;google.protobuf.pyext._message.CMessage&#39; objects&gt;) +++
        &lt;method &#39;HasField&#39; of &#39;go...ssage.CMessage&#39; objects&gt; --      24      24 -- 0.00008 0.00008 -- ~:0:&lt;method &#39;HasField&#39; of &#39;google.protobuf.pyext._message.CMessage&#39; objects&gt; (&lt;method &#39;HasField&#39; of &#39;google.protobuf.pyext._message.CMessage&#39; objects&gt;) +++
        &lt;method &#39;astype&#39; of &#39;numpy.ndarray&#39; objects&gt;         --      12      12 -- 0.00011 0.00011 -- ~:0:&lt;method &#39;astype&#39; of &#39;numpy.ndarray&#39; objects&gt; (&lt;method &#39;astype&#39; of &#39;numpy.ndarray&#39; objects&gt;) +++
        &lt;method &#39;reshape&#39; of &#39;numpy.ndarray&#39; objects&gt;        --      12      12 -- 0.00009 0.00009 -- ~:0:&lt;method &#39;reshape&#39; of &#39;numpy.ndarray&#39; objects&gt; (&lt;method &#39;reshape&#39; of &#39;numpy.ndarray&#39; objects&gt;) +++
        &lt;built-in method numpy.asarray&gt;                      --      12      12 -- 0.00455 0.00455 -- ~:0:&lt;built-in method numpy.asarray&gt; (&lt;built-in method numpy.asarray&gt;) +++
        &lt;built-in method builtins.getattr&gt;                   --      12      12 -- 0.00003 0.00003 -- ~:0:&lt;built-in method builtins.getattr&gt; (&lt;built-in method builtins.getattr&gt;) +++
input_to_ort                                                 --   10000   10000 -- 0.35384 0.48738 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:578:input_to_ort (input_to_ort)
    &lt;built-in method builtins.all&gt;                           --   10000   10000 -- 0.04446 0.09059 -- ~:0:&lt;built-in method builtins.all&gt; (&lt;built-in method builtins.all&gt;) +++
    &lt;built-in method builtins.isinstance&gt;                    --   10000   10000 -- 0.03533 0.03533 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
    &lt;built-in method builtins.len&gt;                           --   10000   10000 -- 0.00762 0.00762 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;) +++
_call_iobinding                                              --   35000   35000 -- 2.54616 2.54616 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/sgd_learning_penalty.py:27:_call_iobinding (_call_iobinding)
value                                                        --   30100   30100 -- 0.03640 0.03640 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/sgd_learning_rate.py:186:value (value)
_mean                                                        --   15100   15100 -- 0.72528 1.45931 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/_methods.py:162:_mean (_mean)
    _count_reduce_items                                      --   15100   15100 -- 0.27440 0.31784 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/_methods.py:66:_count_reduce_items (_count_reduce_items)
        &lt;built-in method numpy.co...th.normalize_axis_index&gt; --   15200   15200 -- 0.02385 0.02385 -- ~:0:&lt;built-in method numpy.core._multiarray_umath.normalize_axis_index&gt; (&lt;built-in method numpy.core._multiarray_umath.normalize_axis_index&gt;)
        &lt;built-in method builtins.isinstance&gt;                --   15000   15000 -- 0.01959 0.01959 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
    &lt;built-in method numpy.asanyarray&gt;                       --   15100   15100 -- 0.01208 0.01208 -- ~:0:&lt;built-in method numpy.asanyarray&gt; (&lt;built-in method numpy.asanyarray&gt;) +++
    &lt;method &#39;reduce&#39; of &#39;numpy.ufunc&#39; objects&gt;               --   15100   15100 -- 0.36575 0.36575 -- ~:0:&lt;method &#39;reduce&#39; of &#39;numpy.ufunc&#39; objects&gt; (&lt;method &#39;reduce&#39; of &#39;numpy.ufunc&#39; objects&gt;) +++
    &lt;built-in method builtins.hasattr&gt;                       --     100     100 -- 0.00020 0.00020 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
    &lt;built-in method builtins.isinstance&gt;                    --   15100   15100 -- 0.01086 0.01086 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
    &lt;built-in method builtins.issubclass&gt;                    --   30200   30200 -- 0.02730 0.02730 -- ~:0:&lt;built-in method builtins.issubclass&gt; (&lt;built-in method builtins.issubclass&gt;) +++
_wrapfunc                                                    --    5003    5003 -- 0.02595 0.84355 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:51:_wrapfunc (_wrapfunc)
    _wrapit                                                  --       1       1 -- 0.00002 0.00019 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:38:_wrapit (_wrapit)
        &lt;method &#39;clip&#39; of &#39;numpy.ndarray&#39; objects&gt;           --       1       1 -- 0.00001 0.00016 -- ~:0:&lt;method &#39;clip&#39; of &#39;numpy.ndarray&#39; objects&gt; (&lt;method &#39;clip&#39; of &#39;numpy.ndarray&#39; objects&gt;) +++
    &lt;method &#39;clip&#39; of &#39;numpy.ndarray&#39; objects&gt;               --    5000    5000 -- 0.02850 0.80698 -- ~:0:&lt;method &#39;clip&#39; of &#39;numpy.ndarray&#39; objects&gt; (&lt;method &#39;clip&#39; of &#39;numpy.ndarray&#39; objects&gt;) +++
    &lt;built-in method builtins.getattr&gt;                       --    5003    5003 -- 0.01035 0.01035 -- ~:0:&lt;built-in method builtins.getattr&gt; (&lt;built-in method builtins.getattr&gt;) +++
_wrapreduction                                               --       3       3 -- 0.00005 0.00038 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:69:_wrapreduction (_wrapreduction)
    &lt;dictcomp&gt;                                               --       3       3 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:70:&lt;dictcomp&gt; (&lt;dictcomp&gt;)
    &lt;method &#39;reduce&#39; of &#39;numpy.ufunc&#39; objects&gt;               --       3       3 -- 0.00032 0.00032 -- ~:0:&lt;method &#39;reduce&#39; of &#39;numpy.ufunc&#39; objects&gt; (&lt;method &#39;reduce&#39; of &#39;numpy.ufunc&#39; objects&gt;) +++
issubdtype                                                   --       3       3 -- 0.00002 0.00006 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/numerictypes.py:356:issubdtype (issubdtype)
    issubclass_                                              --       6       6 -- 0.00002 0.00003 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/numerictypes.py:282:issubclass_ (issubclass_)
get_shape                                                    --       4       4 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_base.py:119:get_shape (get_shape)
isspmatrix                                                   --   45210   45210 -- 0.07292 0.13031 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_base.py:1291:isspmatrix (isspmatrix)
    &lt;built-in method builtins.isinstance&gt;                    --   45210   45210 -- 0.05740 0.05740 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
_swap                                                        --       5       5 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_csr.py:231:_swap (_swap)
get_index_dtype                                              --       2       2 -- 0.00011 0.00041 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_sputils.py:131:get_index_dtype (get_index_dtype)
    can_cast                                                 --       4       4 -- 0.00002 0.00006 -- &lt;__array_function__ internals&gt;:177:can_cast (can_cast)
        can_cast                                             --       4       4 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/multiarray.py:498:can_cast (can_cast)
    __init__                                                 --       4       4 -- 0.00005 0.00005 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/getlimits.py:647:__init__ (__init__)
    min                                                      --       2       2 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/getlimits.py:658:min (min)
    max                                                      --       2       2 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/getlimits.py:671:max (max)
    issubdtype                                               --       2       2 -- 0.00001 0.00003 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/numerictypes.py:356:issubdtype (issubdtype) +++
write                                                        --       7       7 -- 0.00013 0.00324 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx_gallery/gen_rst.py:81:write (write)
    verbose                                                  --       6       6 -- 0.00005 0.00309 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:135:verbose (verbose)
        log                                                  --       6       6 -- 0.00008 0.00304 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:128:log (log)
            log                                              --       6       6 -- 0.00009 0.00296 -- /usr/local/lib/python3.9/logging/__init__.py:1825:log (log)
                log                                          --       6       6 -- 0.00008 0.00278 -- /usr/local/lib/python3.9/logging/__init__.py:1485:log (log)
                    _log                                     --       6       6 -- 0.00006 0.00269 -- /usr/local/lib/python3.9/logging/__init__.py:1553:_log (_log)
                        findCaller                           --       6       6 -- 0.00009 0.00017 -- /usr/local/lib/python3.9/logging/__init__.py:1502:findCaller (findCaller)
                            &lt;lambda&gt;                         --       6       6 -- 0.00002 0.00003 -- /usr/local/lib/python3.9/logging/__init__.py:156:&lt;lambda&gt; (&lt;lambda&gt;)
                            normcase                         --      12      12 -- 0.00002 0.00003 -- /usr/local/lib/python3.9/posixpath.py:52:normcase (normcase)
                                &lt;built-in met...osix.fspath&gt; --      12      12 -- 0.00001 0.00001 -- ~:0:&lt;built-in method posix.fspath&gt; (&lt;built-in method posix.fspath&gt;) +++
                            &lt;built-in metho...ltins.hasattr&gt; --      12      12 -- 0.00001 0.00001 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
                        makeRecord                           --       6       6 -- 0.00006 0.00078 -- /usr/local/lib/python3.9/logging/__init__.py:1538:makeRecord (makeRecord)
                            __init__                         --       6       6 -- 0.00031 0.00073 -- /usr/local/lib/python3.9/logging/__init__.py:278:__init__ (__init__)
                                getLevelName                 --       6       6 -- 0.00005 0.00005 -- /usr/local/lib/python3.9/logging/__init__.py:119:getLevelName (getLevelName)
                                    &lt;method &#39;ge...&#39; objects&gt; --      12      12 -- 0.00001 0.00001 -- ~:0:&lt;method &#39;get&#39; of &#39;dict&#39; objects&gt; (&lt;method &#39;get&#39; of &#39;dict&#39; objects&gt;) +++
                                current_process              --       6       6 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/multiprocessing/process.py:37:current_process (current_process)
                                name                         --       6       6 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/multiprocessing/process.py:189:name (name)
                                splitext                     --       6       6 -- 0.00003 0.00010 -- /usr/local/lib/python3.9/posixpath.py:117:splitext (splitext)
                                    _splitext                --       6       6 -- 0.00004 0.00006 -- /usr/local/lib/python3.9/genericpath.py:121:_splitext (_splitext)
                                        &lt;method &#39;...objects&gt; --      12      12 -- 0.00001 0.00001 -- ~:0:&lt;method &#39;rfind&#39; of &#39;str&#39; objects&gt; (&lt;method &#39;rfind&#39; of &#39;str&#39; objects&gt;) +++
                                basename                     --       6       6 -- 0.00005 0.00009 -- /usr/local/lib/python3.9/posixpath.py:140:basename (basename)
                                    _get_sep                 --       6       6 -- 0.00001 0.00002 -- /usr/local/lib/python3.9/posixpath.py:41:_get_sep (_get_sep)
                                name                         --       6       6 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/threading.py:1053:name (name)
                                current_thread               --       6       6 -- 0.00002 0.00002 -- /usr/local/lib/python3.9/threading.py:1318:current_thread (current_thread)
                        handle                               --       6       6 -- 0.00002 0.00168 -- /usr/local/lib/python3.9/logging/__init__.py:1579:handle (handle)
                            filter                           --       6       6 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/logging/__init__.py:787:filter (filter) +++
                            callHandlers                     --       6       6 -- 0.00007 0.00164 -- /usr/local/lib/python3.9/logging/__init__.py:1633:callHandlers (callHandlers)
                                handle                       --      12      12 -- 0.00008 0.00157 -- /usr/local/lib/python3.9/logging/__init__.py:935:handle (handle)
                                    filter                   --      12      12 -- 0.00006 0.00017 -- /usr/local/lib/python3.9/logging/__init__.py:787:filter (filter) +++
                                    acquire                  --      12      12 -- 0.00003 0.00006 -- /usr/local/lib/python3.9/logging/__init__.py:892:acquire (acquire) +++
                                    release                  --      12      12 -- 0.00002 0.00003 -- /usr/local/lib/python3.9/logging/__init__.py:899:release (release) +++
                                    emit                     --       6       6 -- 0.00004 0.00040 -- /usr/local/lib/python3.9/logging/__init__.py:1067:emit (emit) +++
                                    emit                     --       6       6 -- 0.00006 0.00083 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:158:emit (emit)
                                        acquire              --       6       6 -- 0.00001 0.00002 -- /usr/local/lib/python3.9/logging/__init__.py:892:acquire (acquire) +++
                                        release              --       6       6 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/logging/__init__.py:899:release (release) +++
                                        emit                 --       6       6 -- 0.00005 0.00073 -- /usr/local/lib/python3.9/logging/__init__.py:1067:emit (emit) +++
                    isEnabledFor                             --       6       6 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/logging/__init__.py:1677:isEnabledFor (isEnabledFor) +++
                isEnabledFor                                 --       6       6 -- 0.00002 0.00003 -- /usr/local/lib/python3.9/logging/__init__.py:1834:isEnabledFor (isEnabledFor)
                    isEnabledFor                             --       6       6 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/logging/__init__.py:1677:isEnabledFor (isEnabledFor) +++
                process                                      --       6       6 -- 0.00005 0.00006 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sphinx/util/logging.py:138:process (process)
numpy_to_ort_value                                           --   10026   10026 -- 0.03218 0.15713 -- onnxruntime_helper.py:134:numpy_to_ort_value (numpy_to_ort_value)
    &lt;built-in method onnxruntim...state.ortvalue_from_numpy&gt; --   10026   10026 -- 0.12495 0.12495 -- ~:0:&lt;built-in method onnxruntime.capi.onnxruntime_pybind11_state.ortvalue_from_numpy&gt; (&lt;built-in method onnxruntime.capi.onnxruntime_pybind11_state.ortvalue_from_numpy&gt;) +++
_safe_indexing                                               --    5100    5100 -- 0.05663 1.03506 -- sklearn/utils/__init__.py:307:_safe_indexing (_safe_indexing)
    _array_indexing                                          --    5100    5100 -- 0.20046 0.83872 -- sklearn/utils/__init__.py:193:_array_indexing (_array_indexing)
        isspmatrix                                           --    5100    5100 -- 0.00730 0.01271 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_base.py:1291:isspmatrix (isspmatrix) +++
        parse                                                --    5100    5100 -- 0.02751 0.60001 -- sklearn/externals/_packaging/version.py:65:parse (parse)
            __init__                                         --    5100    5100 -- 0.23946 0.57251 -- sklearn/externals/_packaging/version.py:284:__init__ (__init__)
                &lt;lambda&gt;                                     --    5100    5100 -- 0.01281 0.02426 -- &lt;string&gt;:1:&lt;lambda&gt; (&lt;lambda&gt;)
                    &lt;built-in method __...at 0x7f5da6713960&gt; --    5100    5100 -- 0.01145 0.01145 -- ~:0:&lt;built-in method __new__ of type object at 0x7f5da6713960&gt; (&lt;built-in method __new__ of type object at 0x7f5da6713960&gt;)
                &lt;genexpr&gt;                                    --   15300   15300 -- 0.04081 0.04081 -- sklearn/externals/_packaging/version.py:294:&lt;genexpr&gt; (&lt;genexpr&gt;)
                _parse_letter_version                        --   15300   15300 -- 0.01230 0.01230 -- sklearn/externals/_packaging/version.py:416:_parse_letter_version (_parse_letter_version)
                _parse_local_version                         --    5100    5100 -- 0.00353 0.00353 -- sklearn/externals/_packaging/version.py:455:_parse_local_version (_parse_local_version)
                _cmpkey                                      --    5100    5100 -- 0.08785 0.09319 -- sklearn/externals/_packaging/version.py:467:_cmpkey (_cmpkey)
                    &lt;lambda&gt;                                 --    5100    5100 -- 0.00533 0.00533 -- sklearn/externals/_packaging/version.py:482:&lt;lambda&gt; (&lt;lambda&gt;)
                &lt;method &#39;split&#39; of &#39;str&#39; objects&gt;            --    5100    5100 -- 0.01298 0.01298 -- ~:0:&lt;method &#39;split&#39; of &#39;str&#39; objects&gt; (&lt;method &#39;split&#39; of &#39;str&#39; objects&gt;)
                &lt;method &#39;group&#39; of &#39;re.Match&#39; objects&gt;       --   51000   51000 -- 0.05913 0.05913 -- ~:0:&lt;method &#39;group&#39; of &#39;re.Match&#39; objects&gt; (&lt;method &#39;group&#39; of &#39;re.Match&#39; objects&gt;)
                &lt;method &#39;search&#39; of &#39;re.Pattern&#39; objects&gt;    --    5100    5100 -- 0.08686 0.08686 -- ~:0:&lt;method &#39;search&#39; of &#39;re.Pattern&#39; objects&gt; (&lt;method &#39;search&#39; of &#39;re.Pattern&#39; objects&gt;)
        __lt__                                               --    5100    5100 -- 0.01831 0.02272 -- sklearn/externals/_packaging/version.py:92:__lt__ (__lt__)
            &lt;built-in method builtins.isinstance&gt;            --    5100    5100 -- 0.00440 0.00440 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
        &lt;built-in method builtins.isinstance&gt;                --    5100    5100 -- 0.00282 0.00282 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
    _determine_key_type                                      --    5100    5100 -- 0.09773 0.12558 -- sklearn/utils/__init__.py:237:_determine_key_type (_determine_key_type)
        &lt;method &#39;keys&#39; of &#39;dict&#39; objects&gt;                    --    5100    5100 -- 0.00580 0.00580 -- ~:0:&lt;method &#39;keys&#39; of &#39;dict&#39; objects&gt; (&lt;method &#39;keys&#39; of &#39;dict&#39; objects&gt;)
        &lt;built-in method builtins.hasattr&gt;                   --    5100    5100 -- 0.00446 0.00446 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
        &lt;built-in method builtins.isinstance&gt;                --   15300   15300 -- 0.01758 0.01758 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
    &lt;built-in method builtins.hasattr&gt;                       --   10200   10200 -- 0.01413 0.01413 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
safe_sparse_dot                                              --   40000   40000 -- 1.62780 1.74506 -- sklearn/utils/extmath.py:120:safe_sparse_dot (safe_sparse_dot)
    isspmatrix                                               --   40000   40000 -- 0.06544 0.11727 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_base.py:1291:isspmatrix (isspmatrix) +++
type_of_target                                               --       4       4 -- 0.00016 0.00104 -- sklearn/utils/multiclass.py:200:type_of_target (type_of_target)
    simplefilter                                             --       4       4 -- 0.00002 0.00008 -- /usr/local/lib/python3.9/warnings.py:165:simplefilter (simplefilter) +++
    __init__                                                 --       4       4 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/warnings.py:437:__init__ (__init__) +++
    __enter__                                                --       4       4 -- 0.00002 0.00003 -- /usr/local/lib/python3.9/warnings.py:458:__enter__ (__enter__) +++
    __exit__                                                 --       4       4 -- 0.00002 0.00002 -- /usr/local/lib/python3.9/warnings.py:477:__exit__ (__exit__) +++
    unique                                                   --       4       4 -- 0.00002 0.00044 -- &lt;__array_function__ internals&gt;:177:unique (unique) +++
    isspmatrix                                               --       4       4 -- 0.00000 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_base.py:1291:isspmatrix (isspmatrix) +++
    is_multilabel                                            --       4       4 -- 0.00008 0.00024 -- sklearn/utils/multiclass.py:116:is_multilabel (is_multilabel)
        simplefilter                                         --       4       4 -- 0.00002 0.00009 -- /usr/local/lib/python3.9/warnings.py:165:simplefilter (simplefilter) +++
        __init__                                             --       4       4 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/warnings.py:437:__init__ (__init__) +++
        __enter__                                            --       4       4 -- 0.00003 0.00003 -- /usr/local/lib/python3.9/warnings.py:458:__enter__ (__enter__) +++
        __exit__                                             --       4       4 -- 0.00002 0.00002 -- /usr/local/lib/python3.9/warnings.py:477:__exit__ (__exit__) +++
_num_samples                                                 --     106     106 -- 0.00242 0.00459 -- sklearn/utils/validation.py:254:_num_samples (_num_samples)
    &lt;built-in method builtins.hasattr&gt;                       --     318     318 -- 0.00048 0.00048 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;) +++
    &lt;built-in method builtins.isinstance&gt;                    --     106     106 -- 0.00031 0.00163 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
    &lt;built-in method builtins.len&gt;                           --     106     106 -- 0.00007 0.00007 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;) +++
check_consistent_length                                      --     101     101 -- 0.00122 0.01742 -- sklearn/utils/validation.py:318:check_consistent_length (check_consistent_length)
    unique                                                   --     101     101 -- 0.00062 0.01130 -- &lt;__array_function__ internals&gt;:177:unique (unique) +++
    &lt;listcomp&gt;                                               --     101     101 -- 0.00040 0.00483 -- sklearn/utils/validation.py:329:&lt;listcomp&gt; (&lt;listcomp&gt;)
        _num_samples                                         --     102     102 -- 0.00235 0.00443 -- sklearn/utils/validation.py:254:_num_samples (_num_samples) +++
    &lt;built-in method builtins.len&gt;                           --     101     101 -- 0.00007 0.00007 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;) +++
check_array                                                  --       3       3 -- 0.00014 0.00102 -- sklearn/utils/validation.py:494:check_array (check_array)
    simplefilter                                             --       3       3 -- 0.00002 0.00009 -- /usr/local/lib/python3.9/warnings.py:165:simplefilter (simplefilter) +++
    __init__                                                 --       3       3 -- 0.00001 0.00001 -- /usr/local/lib/python3.9/warnings.py:437:__init__ (__init__) +++
    __enter__                                                --       3       3 -- 0.00004 0.00004 -- /usr/local/lib/python3.9/warnings.py:458:__enter__ (__enter__) +++
    __exit__                                                 --       3       3 -- 0.00002 0.00002 -- /usr/local/lib/python3.9/warnings.py:477:__exit__ (__exit__) +++
    isspmatrix                                               --       3       3 -- 0.00000 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/scipy/sparse/_base.py:1291:isspmatrix (isspmatrix) +++
    _assert_all_finite                                       --       3       3 -- 0.00014 0.00055 -- sklearn/utils/validation.py:90:_assert_all_finite (_assert_all_finite)
        get_config                                           --       3       3 -- 0.00002 0.00003 -- sklearn/_config.py:24:get_config (get_config)
            _get_threadlocal_config                          --       3       3 -- 0.00001 0.00001 -- sklearn/_config.py:16:_get_threadlocal_config (_get_threadlocal_config)
        _safe_accumulator_op                                 --       1       1 -- 0.00002 0.00035 -- sklearn/utils/extmath.py:869:_safe_accumulator_op (_safe_accumulator_op)
            sum                                              --       1       1 -- 0.00001 0.00030 -- &lt;__array_function__ internals&gt;:177:sum (sum)
                _sum_dispatcher                              --       1       1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:2155:_sum_dispatcher (_sum_dispatcher)
                &lt;built-in method nump...ment_array_function&gt; --       1       1 -- 0.00001 0.00030 -- ~:0:&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt; (&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt;) +++
            issubdtype                                       --       1       1 -- 0.00001 0.00002 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/numerictypes.py:356:issubdtype (issubdtype) +++
    _num_samples                                             --       3       3 -- 0.00006 0.00012 -- sklearn/utils/validation.py:254:_num_samples (_num_samples) +++
    _ensure_no_complex_data                                  --       3       3 -- 0.00001 0.00001 -- sklearn/utils/validation.py:484:_ensure_no_complex_data (_ensure_no_complex_data)
check_random_state                                           --     101     101 -- 0.00096 0.00247 -- sklearn/utils/validation.py:1043:check_random_state (check_random_state)
    &lt;built-in method builtins.isinstance&gt;                    --     200     200 -- 0.00063 0.00150 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
&lt;built-in method builtins.len&gt;                               --   60991   60991 -- 0.08205 0.10510 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;)
    __len__                                                  --   10200   10200 -- 0.02305 0.02305 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/data_loader.py:94:__len__ (__len__)
&lt;method &#39;astype&#39; of &#39;numpy.ndarray&#39; objects&gt;                 --      26      26 -- 0.00026 0.00026 -- ~:0:&lt;method &#39;astype&#39; of &#39;numpy.ndarray&#39; objects&gt; (&lt;method &#39;astype&#39; of &#39;numpy.ndarray&#39; objects&gt;)
&lt;method &#39;append&#39; of &#39;list&#39; objects&gt;                          --   10283   10283 -- 0.01700 0.01700 -- ~:0:&lt;method &#39;append&#39; of &#39;list&#39; objects&gt; (&lt;method &#39;append&#39; of &#39;list&#39; objects&gt;)
&lt;built-in method builtins.hasattr&gt;                           --  156138  156138 -- 0.13126 0.13126 -- ~:0:&lt;built-in method builtins.hasattr&gt; (&lt;built-in method builtins.hasattr&gt;)
&lt;built-in method builtins.isinstance&gt;                        --  481660  481660 -- 0.34062 0.34361 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;)
    __instancecheck__                                        --     320     320 -- 0.00050 0.00298 -- /usr/local/lib/python3.9/abc.py:96:__instancecheck__ (__instancecheck__)
        &lt;built-in method _abc._abc_instancecheck&gt;            --     320     320 -- 0.00182 0.00249 -- ~:0:&lt;built-in method _abc._abc_instancecheck&gt; (&lt;built-in method _abc._abc_instancecheck&gt;)
            __subclasscheck__                                --     106     106 -- 0.00019 0.00066 -- /usr/local/lib/python3.9/abc.py:100:__subclasscheck__ (__subclasscheck__)
                &lt;built-in method _abc._abc_subclasscheck&gt;    --     106     106 -- 0.00048 0.00048 -- ~:0:&lt;built-in method _abc._abc_subclasscheck&gt; (&lt;built-in method _abc._abc_subclasscheck&gt;)
&lt;method &#39;reshape&#39; of &#39;numpy.ndarray&#39; objects&gt;                --      16      16 -- 0.00012 0.00012 -- ~:0:&lt;method &#39;reshape&#39; of &#39;numpy.ndarray&#39; objects&gt; (&lt;method &#39;reshape&#39; of &#39;numpy.ndarray&#39; objects&gt;)
&lt;built-in method builtins.getattr&gt;                           --    5257    5257 -- 0.01054 0.01054 -- ~:0:&lt;built-in method builtins.getattr&gt; (&lt;built-in method builtins.getattr&gt;)
&lt;built-in method numpy.array&gt;                                --     105     105 -- 0.00859 0.00859 -- ~:0:&lt;built-in method numpy.array&gt; (&lt;built-in method numpy.array&gt;)
&lt;built-in method numpy.zeros&gt;                                --      20      20 -- 0.00014 0.00014 -- ~:0:&lt;built-in method numpy.zeros&gt; (&lt;built-in method numpy.zeros&gt;)
&lt;built-in method onnxruntime....1_state.ortvalue_from_numpy&gt; --   70026   70026 -- 0.85450 0.85450 -- ~:0:&lt;built-in method onnxruntime.capi.onnxruntime_pybind11_state.ortvalue_from_numpy&gt; (&lt;built-in method onnxruntime.capi.onnxruntime_pybind11_state.ortvalue_from_numpy&gt;)
&lt;built-in method builtins.id&gt;                                --  325001  325001 -- 0.25124 0.25124 -- ~:0:&lt;built-in method builtins.id&gt; (&lt;built-in method builtins.id&gt;)
&lt;built-in method numpy.empty&gt;                                --     112     112 -- 0.00065 0.00065 -- ~:0:&lt;built-in method numpy.empty&gt; (&lt;built-in method numpy.empty&gt;)
&lt;built-in method numpy.arange&gt;                               --     101     101 -- 0.00149 0.00149 -- ~:0:&lt;built-in method numpy.arange&gt; (&lt;built-in method numpy.arange&gt;)
&lt;built-in method numpy.core._...th.implement_array_function&gt; --   35128   45144 -- 0.43922 2.84274 -- ~:0:&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt; (&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt;)
    sort                                                     --       1       1 -- 0.00001 0.00003 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:852:sort (sort)
    searchsorted                                             --       1       1 -- 0.00001 0.00005 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:1319:searchsorted (searchsorted)
        _wrapfunc                                            --       1       1 -- 0.00001 0.00004 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:51:_wrapfunc (_wrapfunc) +++
    ravel                                                    --       1       1 -- 0.00001 0.00001 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:1755:ravel (ravel)
    shape                                                    --       1       1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:1965:shape (shape)
    clip                                                     --    5001    5001 -- 0.03834 0.88179 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:2083:clip (clip)
        _wrapfunc                                            --    5001    5001 -- 0.02593 0.84344 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:51:_wrapfunc (_wrapfunc) +++
    sum                                                      --       1       1 -- 0.00001 0.00029 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:2160:sum (sum)
        _wrapreduction                                       --       1       1 -- 0.00001 0.00028 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:69:_wrapreduction (_wrapreduction) +++
    any                                                      --       2       2 -- 0.00002 0.00013 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:2305:any (any)
        _wrapreduction                                       --       2       2 -- 0.00004 0.00011 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:69:_wrapreduction (_wrapreduction) +++
    cumsum                                                   --       1       1 -- 0.00001 0.00006 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:2495:cumsum (cumsum)
        _wrapfunc                                            --       1       1 -- 0.00001 0.00006 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:51:_wrapfunc (_wrapfunc) +++
    ndim                                                     --   10002   10002 -- 0.01796 0.01797 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:3164:ndim (ndim)
    mean                                                     --   15000   15000 -- 0.15178 1.59581 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:3356:mean (mean)
        _mean                                                --   15000   15000 -- 0.71810 1.44402 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/_methods.py:162:_mean (_mean) +++
    zeros_like                                               --       6       6 -- 0.00007 0.00032 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/numeric.py:76:zeros_like (zeros_like)
        empty_like                                           --       6       6 -- 0.00004 0.00010 -- &lt;__array_function__ internals&gt;:177:empty_like (empty_like) +++
        copyto                                               --       6       6 -- 0.00004 0.00010 -- &lt;__array_function__ internals&gt;:177:copyto (copyto)
            copyto                                           --       6       6 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/multiarray.py:1071:copyto (copyto)
    atleast_1d                                               --       1       1 -- 0.00002 0.00004 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/shape_base.py:23:atleast_1d (atleast_1d)
    hstack                                                   --       1       1 -- 0.00001 0.00009 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/shape_base.py:285:hstack (hstack)
        atleast_1d                                           --       1       1 -- 0.00000 0.00005 -- &lt;__array_function__ internals&gt;:177:atleast_1d (atleast_1d)
            _atleast_1d_dispatcher                           --       1       1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/shape_base.py:19:_atleast_1d_dispatcher (_atleast_1d_dispatcher)
        concatenate                                          --       1       1 -- 0.00001 0.00003 -- &lt;__array_function__ internals&gt;:177:concatenate (concatenate)
            concatenate                                      --       1       1 -- 0.00000 0.00000 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/multiarray.py:148:concatenate (concatenate)
    unique                                                   --     106     106 -- 0.00101 0.01031 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/lib/arraysetops.py:138:unique (unique)
        _unpack_tuple                                        --     106     106 -- 0.00026 0.00033 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/lib/arraysetops.py:125:_unpack_tuple (_unpack_tuple)
            &lt;built-in method builtins.len&gt;                   --     106     106 -- 0.00007 0.00007 -- ~:0:&lt;built-in method builtins.len&gt; (&lt;built-in method builtins.len&gt;) +++
        _unique1d                                            --     106     106 -- 0.00613 0.00794 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/lib/arraysetops.py:320:_unique1d (_unique1d)
            &lt;method &#39;flatten&#39; of &#39;numpy.ndarray&#39; objects&gt;    --     106     106 -- 0.00084 0.00084 -- ~:0:&lt;method &#39;flatten&#39; of &#39;numpy.ndarray&#39; objects&gt; (&lt;method &#39;flatten&#39; of &#39;numpy.ndarray&#39; objects&gt;)
            &lt;method &#39;sort&#39; of &#39;numpy.ndarray&#39; objects&gt;       --     106     106 -- 0.00031 0.00031 -- ~:0:&lt;method &#39;sort&#39; of &#39;numpy.ndarray&#39; objects&gt; (&lt;method &#39;sort&#39; of &#39;numpy.ndarray&#39; objects&gt;) +++
            &lt;built-in method numpy.asanyarray&gt;               --     106     106 -- 0.00005 0.00005 -- ~:0:&lt;built-in method numpy.asanyarray&gt; (&lt;built-in method numpy.asanyarray&gt;) +++
            &lt;built-in method numpy.empty&gt;                    --     106     106 -- 0.00062 0.00062 -- ~:0:&lt;built-in method numpy.empty&gt; (&lt;built-in method numpy.empty&gt;) +++
        &lt;built-in method numpy.asanyarray&gt;                   --     106     106 -- 0.00103 0.00103 -- ~:0:&lt;built-in method numpy.asanyarray&gt; (&lt;built-in method numpy.asanyarray&gt;) +++
    in1d                                                     --       1       1 -- 0.00012 0.00014 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/lib/arraysetops.py:519:in1d (in1d)
&lt;method &#39;HasField&#39; of &#39;google...._message.CMessage&#39; objects&gt; --      36      36 -- 0.00012 0.00012 -- ~:0:&lt;method &#39;HasField&#39; of &#39;google.protobuf.pyext._message.CMessage&#39; objects&gt; (&lt;method &#39;HasField&#39; of &#39;google.protobuf.pyext._message.CMessage&#39; objects&gt;)
&lt;built-in method numpy.asarray&gt;                              --      38      38 -- 0.00458 0.00458 -- ~:0:&lt;built-in method numpy.asarray&gt; (&lt;built-in method numpy.asarray&gt;)
&lt;built-in method builtins.all&gt;                               --   10004   10004 -- 0.04447 0.09059 -- ~:0:&lt;built-in method builtins.all&gt; (&lt;built-in method builtins.all&gt;)
    &lt;lambda&gt;                                                 --   40000   40000 -- 0.03384 0.04612 -- onnxcustom/onnxcustom_UT_39_std/_doc/sphinxdoc/source/onnxcustom/training/ortgradient.py:598:&lt;lambda&gt; (&lt;lambda&gt;)
        &lt;built-in method builtins.isinstance&gt;                --   40000   40000 -- 0.01229 0.01229 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
&lt;built-in method numpy.asanyarray&gt;                           --   15319   15319 -- 0.01317 0.01317 -- ~:0:&lt;built-in method numpy.asanyarray&gt; (&lt;built-in method numpy.asanyarray&gt;)
&lt;method &#39;reduce&#39; of &#39;numpy.ufunc&#39; objects&gt;                   --   25107   25107 -- 0.60839 0.60839 -- ~:0:&lt;method &#39;reduce&#39; of &#39;numpy.ufunc&#39; objects&gt; (&lt;method &#39;reduce&#39; of &#39;numpy.ufunc&#39; objects&gt;)
&lt;built-in method builtins.issubclass&gt;                        --   30209   30209 -- 0.02731 0.02731 -- ~:0:&lt;built-in method builtins.issubclass&gt; (&lt;built-in method builtins.issubclass&gt;)
&lt;method &#39;ravel&#39; of &#39;numpy.ndarray&#39; objects&gt;                  --   15003   15003 -- 0.03573 0.03573 -- ~:0:&lt;method &#39;ravel&#39; of &#39;numpy.ndarray&#39; objects&gt; (&lt;method &#39;ravel&#39; of &#39;numpy.ndarray&#39; objects&gt;)
&lt;method &#39;get&#39; of &#39;dict&#39; objects&gt;                             --    5034    5034 -- 0.00931 0.00931 -- ~:0:&lt;method &#39;get&#39; of &#39;dict&#39; objects&gt; (&lt;method &#39;get&#39; of &#39;dict&#39; objects&gt;)
&lt;method &#39;sort&#39; of &#39;numpy.ndarray&#39; objects&gt;                   --     107     107 -- 0.00032 0.00032 -- ~:0:&lt;method &#39;sort&#39; of &#39;numpy.ndarray&#39; objects&gt; (&lt;method &#39;sort&#39; of &#39;numpy.ndarray&#39; objects&gt;)
&lt;built-in method _warnings._filters_mutated&gt;                 --      33      33 -- 0.00002 0.00002 -- ~:0:&lt;built-in method _warnings._filters_mutated&gt; (&lt;built-in method _warnings._filters_mutated&gt;)
&lt;method &#39;clip&#39; of &#39;numpy.ndarray&#39; objects&gt;                   --    5001    5001 -- 0.02851 0.80713 -- ~:0:&lt;method &#39;clip&#39; of &#39;numpy.ndarray&#39; objects&gt; (&lt;method &#39;clip&#39; of &#39;numpy.ndarray&#39; objects&gt;)
    _clip                                                    --    5001    5001 -- 0.08146 0.77863 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/_methods.py:125:_clip (_clip)
        _clip_dep_is_scalar_nan                              --   10002   10002 -- 0.33568 0.48824 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/_methods.py:91:_clip_dep_is_scalar_nan (_clip_dep_is_scalar_nan)
            ndim                                             --   10002   10002 -- 0.04046 0.15256 -- &lt;__array_function__ internals&gt;:177:ndim (ndim)
                _ndim_dispatcher                             --   10002   10002 -- 0.00877 0.00877 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/fromnumeric.py:3160:_ndim_dispatcher (_ndim_dispatcher)
                &lt;built-in method nump...ment_array_function&gt; --   10002   10002 -- 0.08536 0.10333 -- ~:0:&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt; (&lt;built-in method numpy.core._multiarray_umath.implement_array_function&gt;) +++
        _clip_dep_is_byte_swapped                            --   10002   10002 -- 0.02773 0.03583 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/_methods.py:101:_clip_dep_is_byte_swapped (_clip_dep_is_byte_swapped)
            &lt;built-in method builtins.isinstance&gt;            --   10002   10002 -- 0.00810 0.00810 -- ~:0:&lt;built-in method builtins.isinstance&gt; (&lt;built-in method builtins.isinstance&gt;) +++
        _clip_dep_invoke_with_casting                        --    5001    5001 -- 0.17309 0.17309 -- onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/numpy/core/_methods.py:106:_clip_dep_invoke_with_casting (_clip_dep_invoke_with_casting)
&lt;built-in method posix.fspath&gt;                               --      24      24 -- 0.00001 0.00001 -- ~:0:&lt;built-in method posix.fspath&gt; (&lt;built-in method posix.fspath&gt;)
&lt;built-in method _thread.get_ident&gt;                          --      12      12 -- 0.00001 0.00001 -- ~:0:&lt;built-in method _thread.get_ident&gt; (&lt;built-in method _thread.get_ident&gt;)
&lt;method &#39;rfind&#39; of &#39;str&#39; objects&gt;                            --      18      18 -- 0.00003 0.00003 -- ~:0:&lt;method &#39;rfind&#39; of &#39;str&#39; objects&gt; (&lt;method &#39;rfind&#39; of &#39;str&#39; objects&gt;)
</pre></div>
</div>
</section>
<section id="if-gpu-is-available">
<h2><a class="toc-backref" href="#id3">if GPU is available</a><a class="headerlink" href="#if-gpu-is-available" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">get_device</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;GPU&#39;</span><span class="p">:</span>

    <span class="n">train_session</span> <span class="o">=</span> <span class="n">OrtGradientForwardBackwardOptimizer</span><span class="p">(</span>
        <span class="n">onx</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">,</span> <span class="n">warm_start</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
        <span class="n">learning_loss</span><span class="o">=</span><span class="n">NegLogLearningLoss</span><span class="p">(),</span>
        <span class="n">learning_rate</span><span class="o">=</span><span class="n">LearningRateSGDNesterov</span><span class="p">(</span>
            <span class="mf">1e-7</span><span class="p">,</span> <span class="n">nesterov</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.9</span><span class="p">),</span>
        <span class="n">learning_penalty</span><span class="o">=</span><span class="n">ElasticLearningPenalty</span><span class="p">(</span><span class="n">l1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">l2</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">))</span>

    <span class="n">benches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">benchmark</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">nn</span><span class="p">,</span>
                   <span class="n">train_session</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;NN-GPU&#39;</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="a-simple-linear-layer">
<h2><a class="toc-backref" href="#id4">A simple linear layer</a><a class="headerlink" href="#a-simple-linear-layer" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nn</span> <span class="o">=</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(),</span> <span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span><span class="p">,</span>
                   <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;sgd&#39;</span><span class="p">,</span> <span class="n">learning_rate_init</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span>
                   <span class="n">n_iter_no_change</span><span class="o">=</span><span class="n">max_iter</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
                   <span class="n">nesterovs_momentum</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
                   <span class="n">learning_rate</span><span class="o">=</span><span class="s2">&quot;invscaling&quot;</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;identity&#39;</span><span class="p">)</span>


<span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">onx</span> <span class="o">=</span> <span class="n">to_onnx</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="n">X_train</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="n">target_opset</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
              <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;zipmap&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;nocl&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">onx</span> <span class="o">=</span> <span class="n">select_model_inputs_outputs</span><span class="p">(</span>
    <span class="n">onx</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;add_result&quot;</span><span class="p">],</span> <span class="n">infer_shapes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">onx</span> <span class="o">=</span> <span class="n">onnx_rename_weights</span><span class="p">(</span><span class="n">onx</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">onnx_simple_text_plot</span><span class="p">(</span><span class="n">onx</span><span class="p">))</span>
<span class="k">except</span> <span class="ne">RuntimeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;You should upgrade mlprodict.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

<span class="n">train_session</span> <span class="o">=</span> <span class="n">OrtGradientForwardBackwardOptimizer</span><span class="p">(</span>
    <span class="n">onx</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">,</span> <span class="n">warm_start</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
    <span class="n">learning_loss</span><span class="o">=</span><span class="n">NegLogLearningLoss</span><span class="p">(),</span>
    <span class="n">learning_rate</span><span class="o">=</span><span class="n">LearningRateSGDNesterov</span><span class="p">(</span>
        <span class="mf">1e-5</span><span class="p">,</span> <span class="n">nesterov</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.9</span><span class="p">),</span>
    <span class="n">learning_penalty</span><span class="o">=</span><span class="n">ElasticLearningPenalty</span><span class="p">(</span><span class="n">l1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">l2</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">))</span>


<span class="n">benches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">benchmark</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">nn</span><span class="p">,</span> <span class="n">train_session</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;LR-CPU&#39;</span><span class="p">))</span>

<span class="k">if</span> <span class="n">get_device</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;GPU&#39;</span><span class="p">:</span>

    <span class="n">train_session</span> <span class="o">=</span> <span class="n">OrtGradientForwardBackwardOptimizer</span><span class="p">(</span>
        <span class="n">onx</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">,</span> <span class="n">warm_start</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
        <span class="n">learning_loss</span><span class="o">=</span><span class="n">NegLogLearningLoss</span><span class="p">(),</span>
        <span class="n">learning_rate</span><span class="o">=</span><span class="n">LearningRateSGDNesterov</span><span class="p">(</span>
            <span class="mf">1e-5</span><span class="p">,</span> <span class="n">nesterov</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.9</span><span class="p">),</span>
        <span class="n">learning_penalty</span><span class="o">=</span><span class="n">ElasticLearningPenalty</span><span class="p">(</span><span class="n">l1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">l2</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">))</span>

    <span class="n">benches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">benchmark</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">nn</span><span class="p">,</span>
                   <span class="n">train_session</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;LR-GPU&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>opset: domain=&#39;&#39; version=13
opset: domain=&#39;ai.onnx.ml&#39; version=1
input: name=&#39;X&#39; type=dtype(&#39;float32&#39;) shape=(0, 100)
init: name=&#39;I0_coefficient&#39; type=dtype(&#39;float32&#39;) shape=(100,)
init: name=&#39;I1_intercepts&#39; type=dtype(&#39;float32&#39;) shape=(1,) -- array([0.03688538], dtype=float32)
Cast(X, to=1) -&gt; r1
  MatMul(r1, I0_coefficient) -&gt; r0
    Add(r0, I1_intercepts) -&gt; add_result
output: name=&#39;add_result&#39; type=dtype(&#39;float32&#39;) shape=(0, 1)
[benchmark] LR-CPU
/var/lib/jenkins/workspace/onnxcustom/onnxcustom_UT_39_std/_venv/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:692: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (100) reached and the optimization hasn&#39;t converged yet.
  warnings.warn(
[benchmark] skl=100 iterations - 5.613140130415559 seconds
[benchmark] ort=100 iteration - 7.722520655952394 seconds
</pre></div>
</div>
</section>
<section id="graphs">
<h2><a class="toc-backref" href="#id5">Graphs</a><a class="headerlink" href="#graphs" title="Permalink to this headline">¶</a></h2>
<p>Dataframe first.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">benches</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>skl</th>
      <th>ort</th>
      <th>iter_skl</th>
      <th>iter_ort</th>
      <th>losses_skl</th>
      <th>losses_ort</th>
    </tr>
    <tr>
      <th>name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>NN-CPU</th>
      <td>12.829431</td>
      <td>16.355716</td>
      <td>100</td>
      <td>100</td>
      <td>[0.41287999617866916, 0.2522761647106059, 0.17...</td>
      <td>[6.6074824, 6.316644, 6.900415, 6.697754, 6.46...</td>
    </tr>
    <tr>
      <th>LR-CPU</th>
      <td>5.613140</td>
      <td>7.722521</td>
      <td>100</td>
      <td>100</td>
      <td>[0.4443032878062298, 0.294423522234488, 0.2895...</td>
      <td>[2.4641361, 2.9571128, 2.4631786, 2.4621465, 2...</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<br />
<br /><p>text output</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>              skl  ...                                         losses_ort
name               ...
NN-CPU  12.829431  ...  [6.6074824, 6.316644, 6.900415, 6.697754, 6.46...
LR-CPU   5.613140  ...  [2.4641361, 2.9571128, 2.4631786, 2.4621465, 2...

[2 rows x 6 columns]
</pre></div>
</div>
<p>Graphs.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">df</span><span class="p">[[</span><span class="s1">&#39;skl&#39;</span><span class="p">,</span> <span class="s1">&#39;ort&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Processing time&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="k">for</span> <span class="n">bench</span> <span class="ow">in</span> <span class="n">benches</span><span class="p">:</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bench</span><span class="p">[</span><span class="s1">&#39;losses_skl&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;skl-&#39;</span> <span class="o">+</span> <span class="n">bench</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bench</span><span class="p">[</span><span class="s1">&#39;losses_ort&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ort-&#39;</span> <span class="o">+</span> <span class="n">bench</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Losses&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_orttraining_benchmark_fwbw_cls_001.png" srcset="../_images/sphx_glr_plot_orttraining_benchmark_fwbw_cls_001.png" alt="Processing time, Losses" class = "sphx-glr-single-img"/><p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend object at 0x7f5cdc06d0a0&gt;
</pre></div>
</div>
<p>The gradient update are not exactly the same.
It should be improved for a fair comprison.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># plt.show()</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 1 minutes  37.506 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-gyexamples-plot-orttraining-benchmark-fwbw-cls-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/5b67384f12e4cd6d1239c6465716fb65/plot_orttraining_benchmark_fwbw_cls.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_orttraining_benchmark_fwbw_cls.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/65245217dbbeda89cb4f5f17dcd56890/plot_orttraining_benchmark_fwbw_cls.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_orttraining_benchmark_fwbw_cls.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="plot_orttraining_benchmark_fwbw.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Benchmark, comparison scikit-learn - forward-backward</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="plot_benchmark_onnx_function.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Compares numpy to onnxruntime on simple functions</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
    <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2022, Xavier Dupré.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.4.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>