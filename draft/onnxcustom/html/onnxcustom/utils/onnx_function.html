
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>module utils.onnx_function &#8212; onnxcustom</title>
    
    <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
  
    
    <link rel="stylesheet"
      href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">
  
    
      
  
    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/pydata-sphinx-theme.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/style_notebook_snippet.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinxtrib-images/LightBox2/lightbox2/css/lightbox.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/my-styles.css" />
    
    <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">
  
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/thebelab-helper.js"></script>
    <script src="../../_static/require.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script src="../../_static/sphinxtrib-images/LightBox2/lightbox2/js/jquery-1.11.0.min.js"></script>
    <script src="../../_static/sphinxtrib-images/LightBox2/lightbox2/js/lightbox.min.js"></script>
    <script src="../../_static/sphinxtrib-images/LightBox2/lightbox2_customize/jquery-noconflict.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="module utils.onnx_helper" href="onnx_helper.html" />
    <link rel="prev" title="module utils.nvprof2json" href="nvprof2json.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../index.html">
  <img src="../../_static/project_ico.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../tutorials/index.html">
  Tutorials
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../api/apis.html">
  API
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../gyexamples/index.html">
  Examples Gallery
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../all_notebooks.html">
  Notebooks Gallery
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../../other_pages.html">
  Other pages
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../blog/blogindex.html">
  Blog Gallery
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../doc.html">
   Agility
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../i_ex.html">
   Short examples
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../i_faq.html">
   FAQ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../i_cmd.html">
   Command lines
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../HISTORY.html">
   History
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../README.html">
   onnxcustom: custom ONNX
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../all_indexes.html">
   All indexes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../all_report.html">
   Statistics on code
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../filechanges.html">
   Changes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../index_class.html">
   Classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../index_function.html">
   Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../index_method.html">
   Methods
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../../index_module.html">
   Modules
  </a>
  <input checked class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="../__init__.html">
     module
     <code class="docutils literal notranslate">
      <span class="pre">
       __init__
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../__main__.html">
     module
     <code class="docutils literal notranslate">
      <span class="pre">
       __main__
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cli/__init__.html">
     module
     <code class="docutils literal notranslate">
      <span class="pre">
       cli
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cli/profiling.html">
     module
     <code class="docutils literal notranslate">
      <span class="pre">
       cli.profiling
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../plotting/__init__.html">
     module
     <code class="docutils literal notranslate">
      <span class="pre">
       plotting
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../plotting/plotting_onnx.html">
     module
     <code class="docutils literal notranslate">
      <span class="pre">
       plotting.plotting_onnx
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../training/__init__.html">
     module
     <code class="docutils literal notranslate">
      <span class="pre">
       training
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../training/_base.html">
     module
     <code class="docutils literal notranslate">
      <span class="pre">
       training._base
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../training/_base_estimator.html">
     module
     <code class="docutils literal notranslate">
      <span class="pre">
       training._base_estimator
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../training/_base_onnx_function.html">
     module
     <code class="docutils literal notranslate">
      <span class="pre">
       training._base_onnx_function
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../training/data_loader.html">
     module
     <code class="docutils literal notranslate">
      <span class="pre">
       training.data_loader
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../training/excs.html">
     module
     <code class="docutils literal notranslate">
      <span class="pre">
       training.excs
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../training/grad_helper.html">
     module
     <code class="docutils literal notranslate">
      <span class="pre">
       training.grad_helper
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../training/optimizers.html">
     module
     <code class="docutils literal notranslate">
      <span class="pre">
       training.optimizers
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../training/optimizers_partial.html">
     module
     <code class="docutils literal notranslate">
      <span class="pre">
       training.optimizers_partial
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../training/ortgradient.html">
     module
     <code class="docutils literal notranslate">
      <span class="pre">
       training.ortgradient
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../training/sgd_learning_loss.html">
     module
     <code class="docutils literal notranslate">
      <span class="pre">
       training.sgd_learning_loss
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../training/sgd_learning_penalty.html">
     module
     <code class="docutils literal notranslate">
      <span class="pre">
       training.sgd_learning_penalty
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../training/sgd_learning_rate.html">
     module
     <code class="docutils literal notranslate">
      <span class="pre">
       training.sgd_learning_rate
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="__init__.html">
     module
     <code class="docutils literal notranslate">
      <span class="pre">
       utils
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="benchmark.html">
     module
     <code class="docutils literal notranslate">
      <span class="pre">
       utils.benchmark
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="doc_helper.html">
     module
     <code class="docutils literal notranslate">
      <span class="pre">
       utils.doc_helper
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="imagenet_classes.html">
     module
     <code class="docutils literal notranslate">
      <span class="pre">
       utils.imagenet_classes
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nvprof2json.html">
     module
     <code class="docutils literal notranslate">
      <span class="pre">
       utils.nvprof2json
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     module
     <code class="docutils literal notranslate">
      <span class="pre">
       utils.onnx_function
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx_helper.html">
     module
     <code class="docutils literal notranslate">
      <span class="pre">
       utils.onnx_helper
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx_rewriter.html">
     module
     <code class="docutils literal notranslate">
      <span class="pre">
       utils.onnx_rewriter
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnxruntime_helper.html">
     module
     <code class="docutils literal notranslate">
      <span class="pre">
       utils.onnxruntime_helper
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="orttraining_helper.html">
     module
     <code class="docutils literal notranslate">
      <span class="pre">
       utils.orttraining_helper
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="print_helper.html">
     module
     <code class="docutils literal notranslate">
      <span class="pre">
       utils.print_helper
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../index_staticmethod.html">
   Static Methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../blog/blogindex.html">
   Blog Gallery
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../license.html">
   License
  </a>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#short-summary">
   Short summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#functions">
   Functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-onnxcustom.utils.onnx_function">
   Documentation
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="module-utils-onnx-function">
<span id="f-onnxfunction"></span><h1>module <code class="docutils literal notranslate"><span class="pre">utils.onnx_function</span></code><a class="headerlink" href="#module-utils-onnx-function" title="Permalink to this headline">¶</a></h1>
<section id="short-summary">
<h2>Short summary<a class="headerlink" href="#short-summary" title="Permalink to this headline">¶</a></h2>
<p>module <code class="docutils literal notranslate"><span class="pre">onnxcustom.utils.onnx_function</span></code></p>
<p>Onnx helper.</p>
<p><a class="reference external" href="https://github.com/sdpython/onnxcustom/blob/master/onnxcustom/utils/onnx_function.py#L6">source on GitHub</a></p>
</section>
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<table class="table">
<colgroup>
<col style="width: 42%" />
<col style="width: 58%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>function</p></th>
<th class="head"><p>truncated documentation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#onnxcustom.utils.onnx_function._onnx_axpy" title="onnxcustom.utils.onnx_function._onnx_axpy"><code class="xref py py-func docutils literal notranslate"><span class="pre">_onnx_axpy</span></code></a></p></td>
<td><p>Returns the ONNX graph for function <img class="math" src="../../_images/math/a1b5f40c45564a485bc620e91c1c80cf336589b7.svg" alt="Y = f(X1, X2, \alpha) = \alpha X1 + X2"/>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#onnxcustom.utils.onnx_function._onnx_axpyw" title="onnxcustom.utils.onnx_function._onnx_axpyw"><code class="xref py py-func docutils literal notranslate"><span class="pre">_onnx_axpyw</span></code></a></p></td>
<td><p>Returns the ONNX graph for function <img class="math" src="../../_images/math/b0236330dfad444e53e590680f30523f9e0d7f4d.svg" alt="Y, Z = f(X1, X2, G, \alpha, \beta) = (Y, Z)"/> where <img class="math" src="../../_images/math/fefbd6622f90e3be598bda000a7528dd9a1da434.svg" alt="Z = \beta G + \alpha X1"/> …</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#onnxcustom.utils.onnx_function._onnx_axpyw2" title="onnxcustom.utils.onnx_function._onnx_axpyw2"><code class="xref py py-func docutils literal notranslate"><span class="pre">_onnx_axpyw2</span></code></a></p></td>
<td><p>Returns the ONNX graph for function <img class="math" src="../../_images/math/b0236330dfad444e53e590680f30523f9e0d7f4d.svg" alt="Y, Z = f(X1, X2, G, \alpha, \beta) = (Y, Z)"/> where <img class="math" src="../../_images/math/fefbd6622f90e3be598bda000a7528dd9a1da434.svg" alt="Z = \beta G + \alpha X1"/> …</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#onnxcustom.utils.onnx_function._onnx_copy" title="onnxcustom.utils.onnx_function._onnx_copy"><code class="xref py py-func docutils literal notranslate"><span class="pre">_onnx_copy</span></code></a></p></td>
<td><p>Returns the ONNX graph for function <img class="math" src="../../_images/math/5d77c08315c3e749f350b4ef6675b988fa44b6c0.svg" alt="Y = X"/>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#onnxcustom.utils.onnx_function._onnx_grad_loss_absolute_error" title="onnxcustom.utils.onnx_function._onnx_grad_loss_absolute_error"><code class="xref py py-func docutils literal notranslate"><span class="pre">_onnx_grad_loss_absolute_error</span></code></a></p></td>
<td><p>Returns the ONNX graph for function <img class="math" src="../../_images/math/9107d2357809bcf88d34442b8e9e88f1f066aa53.svg" alt="Y = f(X1, X2) = \lVert X1 - X2 \rVert"/> or <img class="math" src="../../_images/math/7c880fec23cca018b945573b62c1167b7e99a705.svg" alt="Y = f(X1, X2) = \lVert (X1 - X2)w \rVert"/> …</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#onnxcustom.utils.onnx_function._onnx_grad_loss_elastic_error" title="onnxcustom.utils.onnx_function._onnx_grad_loss_elastic_error"><code class="xref py py-func docutils literal notranslate"><span class="pre">_onnx_grad_loss_elastic_error</span></code></a></p></td>
<td><p>Returns the ONNX graph for function <img class="math" src="../../_images/math/31ca32aa8313bf505d0d969edc1da53ed797b379.svg" alt="Y = f(X1, X2) = \beta \lVert X1 - X2 \rVert + \alpha \lVert X1 - X2 \rVert^2"/> …</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#onnxcustom.utils.onnx_function._onnx_grad_loss_square_error" title="onnxcustom.utils.onnx_function._onnx_grad_loss_square_error"><code class="xref py py-func docutils literal notranslate"><span class="pre">_onnx_grad_loss_square_error</span></code></a></p></td>
<td><p>Returns the ONNX graph for function <img class="math" src="../../_images/math/6f74a01b5a6ad17d50349b3dcbda0085e678d94a.svg" alt="Y = f(X1, X2) = \lVert (X1 - X2) \rVert ^2"/> or <img class="math" src="../../_images/math/84cbd891b48bad073736f0deec0f17a82c2e4bcc.svg" alt="Y = f(X1, X2) = \lVert (\sqrt{w}(X1 - X2) \rVert ^2 w"/> …</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#onnxcustom.utils.onnx_function._onnx_grad_penalty_elastic_error" title="onnxcustom.utils.onnx_function._onnx_grad_penalty_elastic_error"><code class="xref py py-func docutils literal notranslate"><span class="pre">_onnx_grad_penalty_elastic_error</span></code></a></p></td>
<td><p>Returns the ONNX graph for function <img class="math" src="../../_images/math/f622d8c8b44dac5fe971576f11e781730af34e60.svg" alt="Y = f(W) = \beta \lVert W \rVert + \alpha \lVert W \rVert^2"/> <em>l1_weight</em> …</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#onnxcustom.utils.onnx_function._onnx_grad_sigmoid_neg_log_loss_error" title="onnxcustom.utils.onnx_function._onnx_grad_sigmoid_neg_log_loss_error"><code class="xref py py-func docutils literal notranslate"><span class="pre">_onnx_grad_sigmoid_neg_log_loss_error</span></code></a></p></td>
<td><p>The function the raw scores from a classifier, uses the sigmoid function to compute probabilities, then the log function …</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#onnxcustom.utils.onnx_function._onnx_grad_square_error" title="onnxcustom.utils.onnx_function._onnx_grad_square_error"><code class="xref py py-func docutils literal notranslate"><span class="pre">_onnx_grad_square_error</span></code></a></p></td>
<td><p>Returns the ONNX graph for the gradient of function <img class="math" src="../../_images/math/3b2f13f102e298d027f206c95f45e8e813836897.svg" alt="Y = f(X1, X2) = \lVert X1 - X2 \rVert ^2"/> or <img class="math" src="../../_images/math/13d365ede299c8d42b95bb9d09e6577e284175be.svg" alt="Y = f(X1, X2) = \lVert X1 - X2 \rVert ^2 w"/> …</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#onnxcustom.utils.onnx_function._onnx_linear_regression" title="onnxcustom.utils.onnx_function._onnx_linear_regression"><code class="xref py py-func docutils literal notranslate"><span class="pre">_onnx_linear_regression</span></code></a></p></td>
<td><p>Returns the ONNX graph for function <img class="math" src="../../_images/math/dcf33b9e51e392f7716738465e77076e7179424e.svg" alt="Y = f(X, A, B) = A X + B"/>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#onnxcustom.utils.onnx_function._onnx_n_penalty_elastic_error" title="onnxcustom.utils.onnx_function._onnx_n_penalty_elastic_error"><code class="xref py py-func docutils literal notranslate"><span class="pre">_onnx_n_penalty_elastic_error</span></code></a></p></td>
<td><p>Returns the ONNX graph for function <img class="math" src="../../_images/math/f622d8c8b44dac5fe971576f11e781730af34e60.svg" alt="Y = f(W) = \beta \lVert W \rVert + \alpha \lVert W \rVert^2"/> <em>l1_weight</em> …</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#onnxcustom.utils.onnx_function._onnx_square_error" title="onnxcustom.utils.onnx_function._onnx_square_error"><code class="xref py py-func docutils literal notranslate"><span class="pre">_onnx_square_error</span></code></a></p></td>
<td><p>Returns the ONNX graph for function <img class="math" src="../../_images/math/3b2f13f102e298d027f206c95f45e8e813836897.svg" alt="Y = f(X1, X2) = \lVert X1 - X2 \rVert ^2"/> or <img class="math" src="../../_images/math/13d365ede299c8d42b95bb9d09e6577e284175be.svg" alt="Y = f(X1, X2) = \lVert X1 - X2 \rVert ^2 w"/> …</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#onnxcustom.utils.onnx_function._onnx_update_penalty_elastic_error" title="onnxcustom.utils.onnx_function._onnx_update_penalty_elastic_error"><code class="xref py py-func docutils literal notranslate"><span class="pre">_onnx_update_penalty_elastic_error</span></code></a></p></td>
<td><p>Returns the ONNX graph for function <img class="math" src="../../_images/math/f29329c678cb190134a14d51b279d5178d027ec2.svg" alt="Y = f(W) = W - 2 \beta W - \alpha sign(W)"/> <em>l1</em> is <img class="math" src="../../_images/math/8fd96498a01957a1ce6cb102fc544d7e32ae2973.svg" alt="\beta"/> and …</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#onnxcustom.utils.onnx_function._onnx_zero" title="onnxcustom.utils.onnx_function._onnx_zero"><code class="xref py py-func docutils literal notranslate"><span class="pre">_onnx_zero</span></code></a></p></td>
<td><p>Returns the ONNX graph for function <img class="math" src="../../_images/math/593d75ede57175b6fe812377998b407f63960a50.svg" alt="Y = X * 0"/>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#onnxcustom.utils.onnx_function.function_onnx_graph" title="onnxcustom.utils.onnx_function.function_onnx_graph"><code class="xref py py-func docutils literal notranslate"><span class="pre">function_onnx_graph</span></code></a></p></td>
<td><p>Returns the ONNX graph corresponding to a function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#onnxcustom.utils.onnx_function.get_supported_functions" title="onnxcustom.utils.onnx_function.get_supported_functions"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_supported_functions</span></code></a></p></td>
<td><p>Returns the list of supported function by <code class="xref py py-func docutils literal notranslate"><span class="pre">function_onnx_graph()</span></code>.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="module-onnxcustom.utils.onnx_function">
<span id="documentation"></span><h2>Documentation<a class="headerlink" href="#module-onnxcustom.utils.onnx_function" title="Permalink to this headline">¶</a></h2>
<p>Onnx helper.</p>
<p><a class="reference external" href="https://github.com/sdpython/onnxcustom/blob/master/onnxcustom/utils/onnx_function.py#L6">source on GitHub</a></p>
<dl class="py function">
<dt class="sig sig-object py" id="onnxcustom.utils.onnx_function._onnx_axpy">
<span class="sig-prename descclassname"><span class="pre">onnxcustom.utils.onnx_function.</span></span><span class="sig-name descname"><span class="pre">_onnx_axpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_opset=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#onnxcustom.utils.onnx_function._onnx_axpy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the ONNX graph for function
<img class="math" src="../../_images/math/a1b5f40c45564a485bc620e91c1c80cf336589b7.svg" alt="Y = f(X1, X2, \alpha) = \alpha X1 + X2"/>.</p>

    <div id="gdot-140034927212624-cont"><div id="gdot-140034927212624" style="width:100%;height:100%;"></div>
    <script>

    require(['../../_static/viz.js'], function() { var svgGraph = Viz(" digraph{\n  size=7;\n  orientation=portrait;\n  nodesep=0.05;\n  ranksep=0.25;\n\n  X1 [shape=box color=red label=\"X1\\nfloat(('?',))\" fontsize=10];\n  X2 [shape=box color=red label=\"X2\\nfloat(('?',))\" fontsize=10];\n  alpha [shape=box color=red label=\"alpha\\nfloat((1,))\" fontsize=10];\n\n  Y [shape=box color=green label=\"Y\\nfloat(('?',))\" fontsize=10];\n\n\n  Mu_C0 [shape=box label=\"Mu_C0\" fontsize=10];\n  Mu_Mul [shape=box style=\"filled,rounded\" color=orange label=\"Mul\\n(Mu_Mul)\" fontsize=10];\n  X1 -> Mu_Mul;\n  alpha -> Mu_Mul;\n  Mu_Mul -> Mu_C0;\n\n  Ad_Add [shape=box style=\"filled,rounded\" color=orange label=\"Add\\n(Ad_Add)\" fontsize=10];\n  Mu_C0 -> Ad_Add;\n  X2 -> Ad_Add;\n  Ad_Add -> Y;\n}\n");
    document.getElementById('gdot-140034927212624').innerHTML = svgGraph; });
    
</script>
</div><p><a class="reference external" href="https://github.com/sdpython/onnxcustom/blob/master/onnxcustom/utils/onnx_function.py#L108">source on GitHub</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="onnxcustom.utils.onnx_function._onnx_axpyw">
<span class="sig-prename descclassname"><span class="pre">onnxcustom.utils.onnx_function.</span></span><span class="sig-name descname"><span class="pre">_onnx_axpyw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_opset=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#onnxcustom.utils.onnx_function._onnx_axpyw" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the ONNX graph for function
<img class="math" src="../../_images/math/b0236330dfad444e53e590680f30523f9e0d7f4d.svg" alt="Y, Z = f(X1, X2, G, \alpha, \beta) = (Y, Z)"/>
where <img class="math" src="../../_images/math/fefbd6622f90e3be598bda000a7528dd9a1da434.svg" alt="Z = \beta G + \alpha X1"/> and
<img class="math" src="../../_images/math/52d6715d201f5b213b3d76ff62d9753fd00ae4df.svg" alt="Y = Z + X2"/>.</p>

    <div id="gdot-140034591912672-cont"><div id="gdot-140034591912672" style="width:100%;height:100%;"></div>
    <script>

    require(['../../_static/viz.js'], function() { var svgGraph = Viz(" digraph{\n  size=7;\n  orientation=portrait;\n  nodesep=0.05;\n  ranksep=0.25;\n\n  X1 [shape=box color=red label=\"X1\\nfloat(('?',))\" fontsize=10];\n  X2 [shape=box color=red label=\"X2\\nfloat(('?',))\" fontsize=10];\n  alpha [shape=box color=red label=\"alpha\\nfloat((1,))\" fontsize=10];\n\n  Y [shape=box color=green label=\"Y\\nfloat(('?',))\" fontsize=10];\n\n\n  Mu_C0 [shape=box label=\"Mu_C0\" fontsize=10];\n  Mu_Mul [shape=box style=\"filled,rounded\" color=orange label=\"Mul\\n(Mu_Mul)\" fontsize=10];\n  X1 -> Mu_Mul;\n  alpha -> Mu_Mul;\n  Mu_Mul -> Mu_C0;\n\n  Ad_Add [shape=box style=\"filled,rounded\" color=orange label=\"Add\\n(Ad_Add)\" fontsize=10];\n  Mu_C0 -> Ad_Add;\n  X2 -> Ad_Add;\n  Ad_Add -> Y;\n}\n");
    document.getElementById('gdot-140034591912672').innerHTML = svgGraph; });
    
</script>
</div><p><a class="reference external" href="https://github.com/sdpython/onnxcustom/blob/master/onnxcustom/utils/onnx_function.py#L137">source on GitHub</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="onnxcustom.utils.onnx_function._onnx_axpyw2">
<span class="sig-prename descclassname"><span class="pre">onnxcustom.utils.onnx_function.</span></span><span class="sig-name descname"><span class="pre">_onnx_axpyw2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_opset=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#onnxcustom.utils.onnx_function._onnx_axpyw2" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the ONNX graph for function
<img class="math" src="../../_images/math/b0236330dfad444e53e590680f30523f9e0d7f4d.svg" alt="Y, Z = f(X1, X2, G, \alpha, \beta) = (Y, Z)"/>
where <img class="math" src="../../_images/math/fefbd6622f90e3be598bda000a7528dd9a1da434.svg" alt="Z = \beta G + \alpha X1"/> and
<img class="math" src="../../_images/math/6da7b97b4d9f5431c352efcad9a6d983686d7a50.svg" alt="Y = \beta * Z + \alpha X1 + X2"/>.</p>

    <div id="gdot-140034591915504-cont"><div id="gdot-140034591915504" style="width:100%;height:100%;"></div>
    <script>

    require(['../../_static/viz.js'], function() { var svgGraph = Viz(" digraph{\n  size=7;\n  orientation=portrait;\n  nodesep=0.05;\n  ranksep=0.25;\n\n  X1 [shape=box color=red label=\"X1\\nfloat(('?',))\" fontsize=10];\n  X2 [shape=box color=red label=\"X2\\nfloat(('?',))\" fontsize=10];\n  alpha [shape=box color=red label=\"alpha\\nfloat((1,))\" fontsize=10];\n\n  Y [shape=box color=green label=\"Y\\nfloat(('?',))\" fontsize=10];\n\n\n  Mu_C0 [shape=box label=\"Mu_C0\" fontsize=10];\n  Mu_Mul [shape=box style=\"filled,rounded\" color=orange label=\"Mul\\n(Mu_Mul)\" fontsize=10];\n  X1 -> Mu_Mul;\n  alpha -> Mu_Mul;\n  Mu_Mul -> Mu_C0;\n\n  Ad_Add [shape=box style=\"filled,rounded\" color=orange label=\"Add\\n(Ad_Add)\" fontsize=10];\n  Mu_C0 -> Ad_Add;\n  X2 -> Ad_Add;\n  Ad_Add -> Y;\n}\n");
    document.getElementById('gdot-140034591915504').innerHTML = svgGraph; });
    
</script>
</div><p><a class="reference external" href="https://github.com/sdpython/onnxcustom/blob/master/onnxcustom/utils/onnx_function.py#L171">source on GitHub</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="onnxcustom.utils.onnx_function._onnx_copy">
<span class="sig-prename descclassname"><span class="pre">onnxcustom.utils.onnx_function.</span></span><span class="sig-name descname"><span class="pre">_onnx_copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_opset=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#onnxcustom.utils.onnx_function._onnx_copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the ONNX graph for function
<img class="math" src="../../_images/math/5d77c08315c3e749f350b4ef6675b988fa44b6c0.svg" alt="Y = X"/>.</p>

    <div id="gdot-140034935033760-cont"><div id="gdot-140034935033760" style="width:100%;height:100%;"></div>
    <script>

    require(['../../_static/viz.js'], function() { var svgGraph = Viz(" digraph{\n  size=7;\n  orientation=portrait;\n  nodesep=0.05;\n  ranksep=0.25;\n\n  X [shape=box color=red label=\"X\\nfloat(('?',))\" fontsize=10];\n\n  Y [shape=box color=green label=\"Y\\nfloat(('?',))\" fontsize=10];\n\n\n  Id_Identity [shape=box style=\"filled,rounded\" color=orange label=\"Identity\\n(Id_Identity)\" fontsize=10];\n  X -> Id_Identity;\n  Id_Identity -> Y;\n}\n");
    document.getElementById('gdot-140034935033760').innerHTML = svgGraph; });
    
</script>
</div><p><a class="reference external" href="https://github.com/sdpython/onnxcustom/blob/master/onnxcustom/utils/onnx_function.py#L298">source on GitHub</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="onnxcustom.utils.onnx_function._onnx_grad_loss_absolute_error">
<span class="sig-prename descclassname"><span class="pre">onnxcustom.utils.onnx_function.</span></span><span class="sig-name descname"><span class="pre">_onnx_grad_loss_absolute_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_opset=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_name=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#onnxcustom.utils.onnx_function._onnx_grad_loss_absolute_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the ONNX graph for function
<img class="math" src="../../_images/math/9107d2357809bcf88d34442b8e9e88f1f066aa53.svg" alt="Y = f(X1, X2) = \lVert X1 - X2 \rVert"/> or
<img class="math" src="../../_images/math/7c880fec23cca018b945573b62c1167b7e99a705.svg" alt="Y = f(X1, X2) = \lVert (X1 - X2)w \rVert"/> if
<em>weight_name</em> is not None and its gradient.</p>

    <div id="gdot-140034935031504-cont"><div id="gdot-140034935031504" style="width:100%;height:100%;"></div>
    <script>

    require(['../../_static/viz.js'], function() { var svgGraph = Viz(" digraph{\n  size=7;\n  orientation=portrait;\n  nodesep=0.05;\n  ranksep=0.25;\n\n  X1 [shape=box color=red label=\"X1\\nfloat((0, 0))\" fontsize=10];\n  X2 [shape=box color=red label=\"X2\\nfloat((0, 0))\" fontsize=10];\n\n  Y [shape=box color=green label=\"Y\\nfloat(('?',))\" fontsize=10];\n  Y_grad [shape=box color=green label=\"Y_grad\\nfloat(('?',))\" fontsize=10];\n\n  Re_Reshapecst [shape=box label=\"Re_Reshapecst\\nint64((1,))\\n[-1]\" fontsize=10];\n\n  Su_C0 [shape=box label=\"Su_C0\" fontsize=10];\n  Su_Sub [shape=box style=\"filled,rounded\" color=orange label=\"Sub\\n(Su_Sub)\" fontsize=10];\n  X1 -> Su_Sub;\n  X2 -> Su_Sub;\n  Su_Sub -> Su_C0;\n\n  Ab_Y0 [shape=box label=\"Ab_Y0\" fontsize=10];\n  Ab_Abs [shape=box style=\"filled,rounded\" color=orange label=\"Abs\\n(Ab_Abs)\" fontsize=10];\n  Su_C0 -> Ab_Abs;\n  Ab_Abs -> Ab_Y0;\n\n  Si_Sign [shape=box style=\"filled,rounded\" color=orange label=\"Sign\\n(Si_Sign)\" fontsize=10];\n  Su_C0 -> Si_Sign;\n  Si_Sign -> Y_grad;\n\n  Re_reduced0 [shape=box label=\"Re_reduced0\" fontsize=10];\n  Re_ReduceSum [shape=box style=\"filled,rounded\" color=orange label=\"ReduceSum\\n(Re_ReduceSum)\" fontsize=10];\n  Ab_Y0 -> Re_ReduceSum;\n  Re_ReduceSum -> Re_reduced0;\n\n  Re_Reshape [shape=box style=\"filled,rounded\" color=orange label=\"Reshape\\n(Re_Reshape)\" fontsize=10];\n  Re_reduced0 -> Re_Reshape;\n  Re_Reshapecst -> Re_Reshape;\n  Re_Reshape -> Y;\n}\n");
    document.getElementById('gdot-140034935031504').innerHTML = svgGraph; });
    
</script>
</div><p><a class="reference external" href="https://github.com/sdpython/onnxcustom/blob/master/onnxcustom/utils/onnx_function.py#L449">source on GitHub</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="onnxcustom.utils.onnx_function._onnx_grad_loss_elastic_error">
<span class="sig-prename descclassname"><span class="pre">onnxcustom.utils.onnx_function.</span></span><span class="sig-name descname"><span class="pre">_onnx_grad_loss_elastic_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_opset=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_name=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l1_weight=0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2_weight=0.01</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#onnxcustom.utils.onnx_function._onnx_grad_loss_elastic_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the ONNX graph for function
<img class="math" src="../../_images/math/f3fe32d89d8e8f397acd7f02c07275a8a7cd2573.svg" alt="Y = f(X1, X2) = \beta \lVert X1 - X2 \rVert +
\alpha \lVert X1 - X2 \rVert^2"/> or
<img class="math" src="../../_images/math/125a1ab10d2ab38b7e17bdfcde0f4e79d99506b5.svg" alt="Y = f(X1, X2) = \beta \lVert w(X1 - X2) \rVert +
\alpha \lVert (\sqrt{w})(X1 - X2) \rVert^2"/> if
<em>weight_name</em> is not None and its gradient.
<em>l1_weight</em> is <img class="math" src="../../_images/math/8fd96498a01957a1ce6cb102fc544d7e32ae2973.svg" alt="\beta"/> and
<em>l2_weight</em> is <img class="math" src="../../_images/math/35093c7ccc735c18e6452789bcb7ec50e0cb0c43.svg" alt="\alpha"/>.</p>

    <div id="gdot-140034934070240-cont"><div id="gdot-140034934070240" style="width:100%;height:100%;"></div>
    <script>

    require(['../../_static/viz.js'], function() { var svgGraph = Viz(" digraph{\n  size=7;\n  orientation=portrait;\n  nodesep=0.05;\n  ranksep=0.25;\n\n  X1 [shape=box color=red label=\"X1\\nfloat((0, 0))\" fontsize=10];\n  X2 [shape=box color=red label=\"X2\\nfloat((0, 0))\" fontsize=10];\n\n  Y [shape=box color=green label=\"Y\\nfloat(('?',))\" fontsize=10];\n  Y_grad [shape=box color=green label=\"Y_grad\\nfloat(('?',))\" fontsize=10];\n\n  Mu_Mulcst [shape=box label=\"Mu_Mulcst\\nfloat32((1,))\\n[0.01]\" fontsize=10];\n  Re_Reshapecst [shape=box label=\"Re_Reshapecst\\nint64((1,))\\n[-1]\" fontsize=10];\n  Mu_Mulcst3 [shape=box label=\"Mu_Mulcst3\\nfloat32((1,))\\n[-0.02]\" fontsize=10];\n\n  Mu_Mulcst2 [shape=box label=\"Mu_Mulcst2\" fontsize=10];\n  Mu_Mulcst2_op [shape=box style=\"filled,rounded\" color=orange label=\"Identity\\n(Mu_Mulcst2_op)\" fontsize=10];\n  Mu_Mulcst -> Mu_Mulcst2_op;\n  Mu_Mulcst2_op -> Mu_Mulcst2;\n\n  Su_C0 [shape=box label=\"Su_C0\" fontsize=10];\n  Su_Sub [shape=box style=\"filled,rounded\" color=orange label=\"Sub\\n(Su_Sub)\" fontsize=10];\n  X1 -> Su_Sub;\n  X2 -> Su_Sub;\n  Su_Sub -> Su_C0;\n\n  Mu_Mulcst1 [shape=box label=\"Mu_Mulcst1\" fontsize=10];\n  Mu_Mulcst1_op [shape=box style=\"filled,rounded\" color=orange label=\"Identity\\n(Mu_Mulcst1_op)\" fontsize=10];\n  Mu_Mulcst -> Mu_Mulcst1_op;\n  Mu_Mulcst1_op -> Mu_Mulcst1;\n\n  Mu_C05 [shape=box label=\"Mu_C05\" fontsize=10];\n  Mu_Mul4 [shape=box style=\"filled,rounded\" color=orange label=\"Mul\\n(Mu_Mul4)\" fontsize=10];\n  Su_C0 -> Mu_Mul4;\n  Mu_Mulcst3 -> Mu_Mul4;\n  Mu_Mul4 -> Mu_C05;\n\n  Ab_Y0 [shape=box label=\"Ab_Y0\" fontsize=10];\n  Ab_Abs [shape=box style=\"filled,rounded\" color=orange label=\"Abs\\n(Ab_Abs)\" fontsize=10];\n  Su_C0 -> Ab_Abs;\n  Ab_Abs -> Ab_Y0;\n\n  Mu_C03 [shape=box label=\"Mu_C03\" fontsize=10];\n  Mu_Mul1 [shape=box style=\"filled,rounded\" color=orange label=\"Mul\\n(Mu_Mul1)\" fontsize=10];\n  Su_C0 -> Mu_Mul1;\n  Su_C0 -> Mu_Mul1;\n  Mu_Mul1 -> Mu_C03;\n\n  Si_output0 [shape=box label=\"Si_output0\" fontsize=10];\n  Si_Sign [shape=box style=\"filled,rounded\" color=orange label=\"Sign\\n(Si_Sign)\" fontsize=10];\n  Su_C0 -> Si_Sign;\n  Si_Sign -> Si_output0;\n\n  Mu_C0 [shape=box label=\"Mu_C0\" fontsize=10];\n  Mu_Mul [shape=box style=\"filled,rounded\" color=orange label=\"Mul\\n(Mu_Mul)\" fontsize=10];\n  Ab_Y0 -> Mu_Mul;\n  Mu_Mulcst -> Mu_Mul;\n  Mu_Mul -> Mu_C0;\n\n  Mu_C02 [shape=box label=\"Mu_C02\" fontsize=10];\n  Mu_Mul2 [shape=box style=\"filled,rounded\" color=orange label=\"Mul\\n(Mu_Mul2)\" fontsize=10];\n  Mu_C03 -> Mu_Mul2;\n  Mu_Mulcst1 -> Mu_Mul2;\n  Mu_Mul2 -> Mu_C02;\n\n  Mu_C04 [shape=box label=\"Mu_C04\" fontsize=10];\n  Mu_Mul3 [shape=box style=\"filled,rounded\" color=orange label=\"Mul\\n(Mu_Mul3)\" fontsize=10];\n  Si_output0 -> Mu_Mul3;\n  Mu_Mulcst2 -> Mu_Mul3;\n  Mu_Mul3 -> Mu_C04;\n\n  Ad_C0 [shape=box label=\"Ad_C0\" fontsize=10];\n  Ad_Add [shape=box style=\"filled,rounded\" color=orange label=\"Add\\n(Ad_Add)\" fontsize=10];\n  Mu_C0 -> Ad_Add;\n  Mu_C02 -> Ad_Add;\n  Ad_Add -> Ad_C0;\n\n  Ad_C02 [shape=box label=\"Ad_C02\" fontsize=10];\n  Ad_Add1 [shape=box style=\"filled,rounded\" color=orange label=\"Add\\n(Ad_Add1)\" fontsize=10];\n  Mu_C04 -> Ad_Add1;\n  Mu_C05 -> Ad_Add1;\n  Ad_Add1 -> Ad_C02;\n\n  Id_Identity [shape=box style=\"filled,rounded\" color=orange label=\"Identity\\n(Id_Identity)\" fontsize=10];\n  Ad_C02 -> Id_Identity;\n  Id_Identity -> Y_grad;\n\n  Re_reduced0 [shape=box label=\"Re_reduced0\" fontsize=10];\n  Re_ReduceSum [shape=box style=\"filled,rounded\" color=orange label=\"ReduceSum\\n(Re_ReduceSum)\" fontsize=10];\n  Ad_C0 -> Re_ReduceSum;\n  Re_ReduceSum -> Re_reduced0;\n\n  Re_Reshape [shape=box style=\"filled,rounded\" color=orange label=\"Reshape\\n(Re_Reshape)\" fontsize=10];\n  Re_reduced0 -> Re_Reshape;\n  Re_Reshapecst -> Re_Reshape;\n  Re_Reshape -> Y;\n}\n");
    document.getElementById('gdot-140034934070240').innerHTML = svgGraph; });
    
</script>
</div><p><a class="reference external" href="https://github.com/sdpython/onnxcustom/blob/master/onnxcustom/utils/onnx_function.py#L509">source on GitHub</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="onnxcustom.utils.onnx_function._onnx_grad_loss_square_error">
<span class="sig-prename descclassname"><span class="pre">onnxcustom.utils.onnx_function.</span></span><span class="sig-name descname"><span class="pre">_onnx_grad_loss_square_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_opset=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_name=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiply=2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#onnxcustom.utils.onnx_function._onnx_grad_loss_square_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the ONNX graph for function
<img class="math" src="../../_images/math/6f74a01b5a6ad17d50349b3dcbda0085e678d94a.svg" alt="Y = f(X1, X2) = \lVert (X1 - X2) \rVert ^2"/> or
<img class="math" src="../../_images/math/84cbd891b48bad073736f0deec0f17a82c2e4bcc.svg" alt="Y = f(X1, X2) = \lVert (\sqrt{w}(X1 - X2) \rVert ^2 w"/> if
<em>weight_name</em> is not None and its gradient.</p>

    <div id="gdot-140034591384960-cont"><div id="gdot-140034591384960" style="width:100%;height:100%;"></div>
    <script>

    require(['../../_static/viz.js'], function() { var svgGraph = Viz(" digraph{\n  size=7;\n  orientation=portrait;\n  nodesep=0.05;\n  ranksep=0.25;\n\n  X1 [shape=box color=red label=\"X1\\nfloat((0, 0))\" fontsize=10];\n  X2 [shape=box color=red label=\"X2\\nfloat((0, 0))\" fontsize=10];\n\n  Y [shape=box color=green label=\"Y\\nfloat(('?',))\" fontsize=10];\n  Y_grad [shape=box color=green label=\"Y_grad\\nfloat(('?',))\" fontsize=10];\n\n  Mu_Mulcst [shape=box label=\"Mu_Mulcst\\nfloat32((1,))\\n[1.]\" fontsize=10];\n  Re_Reshapecst [shape=box label=\"Re_Reshapecst\\nint64((1,))\\n[-1]\" fontsize=10];\n  Mu_Mulcst1 [shape=box label=\"Mu_Mulcst1\\nfloat32((1,))\\n[-2.]\" fontsize=10];\n\n  Su_C0 [shape=box label=\"Su_C0\" fontsize=10];\n  Su_Sub [shape=box style=\"filled,rounded\" color=orange label=\"Sub\\n(Su_Sub)\" fontsize=10];\n  X1 -> Su_Sub;\n  X2 -> Su_Sub;\n  Su_Sub -> Su_C0;\n\n  Re_reduced0 [shape=box label=\"Re_reduced0\" fontsize=10];\n  Re_ReduceSumSquare [shape=box style=\"filled,rounded\" color=orange label=\"ReduceSumSquare\\n(Re_ReduceSumSquare)\" fontsize=10];\n  Su_C0 -> Re_ReduceSumSquare;\n  Re_ReduceSumSquare -> Re_reduced0;\n\n  Mu_Mul1 [shape=box style=\"filled,rounded\" color=orange label=\"Mul\\n(Mu_Mul1)\" fontsize=10];\n  Su_C0 -> Mu_Mul1;\n  Mu_Mulcst1 -> Mu_Mul1;\n  Mu_Mul1 -> Y_grad;\n\n  Mu_C0 [shape=box label=\"Mu_C0\" fontsize=10];\n  Mu_Mul [shape=box style=\"filled,rounded\" color=orange label=\"Mul\\n(Mu_Mul)\" fontsize=10];\n  Re_reduced0 -> Mu_Mul;\n  Mu_Mulcst -> Mu_Mul;\n  Mu_Mul -> Mu_C0;\n\n  Re_Reshape [shape=box style=\"filled,rounded\" color=orange label=\"Reshape\\n(Re_Reshape)\" fontsize=10];\n  Mu_C0 -> Re_Reshape;\n  Re_Reshapecst -> Re_Reshape;\n  Re_Reshape -> Y;\n}\n");
    document.getElementById('gdot-140034591384960').innerHTML = svgGraph; });
    
</script>
</div><p><a class="reference external" href="https://github.com/sdpython/onnxcustom/blob/master/onnxcustom/utils/onnx_function.py#L386">source on GitHub</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="onnxcustom.utils.onnx_function._onnx_grad_penalty_elastic_error">
<span class="sig-prename descclassname"><span class="pre">onnxcustom.utils.onnx_function.</span></span><span class="sig-name descname"><span class="pre">_onnx_grad_penalty_elastic_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_opset=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l1_weight=0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2_weight=0.01</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#onnxcustom.utils.onnx_function._onnx_grad_penalty_elastic_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the ONNX graph for function
<img class="math" src="../../_images/math/bc32869601fdf6da777897b62d8bfef898364298.svg" alt="Y = f(W) = \beta \lVert W \rVert +
\alpha \lVert W \rVert^2"/>
<em>l1_weight</em> is <img class="math" src="../../_images/math/8fd96498a01957a1ce6cb102fc544d7e32ae2973.svg" alt="\beta"/> and
<em>l2_weight</em> is <img class="math" src="../../_images/math/35093c7ccc735c18e6452789bcb7ec50e0cb0c43.svg" alt="\alpha"/>.</p>

    <div id="gdot-140034938290576-cont"><div id="gdot-140034938290576" style="width:100%;height:100%;"></div>
    <script>

    require(['../../_static/viz.js'], function() { var svgGraph = Viz(" digraph{\n  size=7;\n  orientation=portrait;\n  nodesep=0.05;\n  ranksep=0.25;\n\n  X [shape=box color=red label=\"X\\nfloat((0, 0))\" fontsize=10];\n\n  Y [shape=box color=green label=\"Y\\nfloat((0,))\" fontsize=10];\n  Y_grad [shape=box color=green label=\"Y_grad\\nfloat(('?',))\" fontsize=10];\n\n  Mu_Mulcst [shape=box label=\"Mu_Mulcst\\nfloat32((1,))\\n[0.01]\" fontsize=10];\n  Re_Reshapecst [shape=box label=\"Re_Reshapecst\\nint64((1,))\\n[-1]\" fontsize=10];\n  Mu_Mulcst3 [shape=box label=\"Mu_Mulcst3\\nfloat32((1,))\\n[0.02]\" fontsize=10];\n\n  Mu_C04 [shape=box label=\"Mu_C04\" fontsize=10];\n  Mu_Mul3 [shape=box style=\"filled,rounded\" color=orange label=\"Mul\\n(Mu_Mul3)\" fontsize=10];\n  X -> Mu_Mul3;\n  Mu_Mulcst3 -> Mu_Mul3;\n  Mu_Mul3 -> Mu_C04;\n\n  Mu_Mulcst2 [shape=box label=\"Mu_Mulcst2\" fontsize=10];\n  Mu_Mulcst2_op [shape=box style=\"filled,rounded\" color=orange label=\"Identity\\n(Mu_Mulcst2_op)\" fontsize=10];\n  Mu_Mulcst -> Mu_Mulcst2_op;\n  Mu_Mulcst2_op -> Mu_Mulcst2;\n\n  Re_reduced02 [shape=box label=\"Re_reduced02\" fontsize=10];\n  Re_ReduceSumSquare [shape=box style=\"filled,rounded\" color=orange label=\"ReduceSumSquare\\n(Re_ReduceSumSquare)\" fontsize=10];\n  X -> Re_ReduceSumSquare;\n  Re_ReduceSumSquare -> Re_reduced02;\n\n  Ab_Y0 [shape=box label=\"Ab_Y0\" fontsize=10];\n  Ab_Abs [shape=box style=\"filled,rounded\" color=orange label=\"Abs\\n(Ab_Abs)\" fontsize=10];\n  X -> Ab_Abs;\n  Ab_Abs -> Ab_Y0;\n\n  Mu_Mulcst1 [shape=box label=\"Mu_Mulcst1\" fontsize=10];\n  Mu_Mulcst1_op [shape=box style=\"filled,rounded\" color=orange label=\"Identity\\n(Mu_Mulcst1_op)\" fontsize=10];\n  Mu_Mulcst -> Mu_Mulcst1_op;\n  Mu_Mulcst1_op -> Mu_Mulcst1;\n\n  Si_output0 [shape=box label=\"Si_output0\" fontsize=10];\n  Si_Sign [shape=box style=\"filled,rounded\" color=orange label=\"Sign\\n(Si_Sign)\" fontsize=10];\n  X -> Si_Sign;\n  Si_Sign -> Si_output0;\n\n  Re_reduced0 [shape=box label=\"Re_reduced0\" fontsize=10];\n  Re_ReduceSum [shape=box style=\"filled,rounded\" color=orange label=\"ReduceSum\\n(Re_ReduceSum)\" fontsize=10];\n  Ab_Y0 -> Re_ReduceSum;\n  Re_ReduceSum -> Re_reduced0;\n\n  Mu_C02 [shape=box label=\"Mu_C02\" fontsize=10];\n  Mu_Mul1 [shape=box style=\"filled,rounded\" color=orange label=\"Mul\\n(Mu_Mul1)\" fontsize=10];\n  Re_reduced02 -> Mu_Mul1;\n  Mu_Mulcst1 -> Mu_Mul1;\n  Mu_Mul1 -> Mu_C02;\n\n  Mu_C03 [shape=box label=\"Mu_C03\" fontsize=10];\n  Mu_Mul2 [shape=box style=\"filled,rounded\" color=orange label=\"Mul\\n(Mu_Mul2)\" fontsize=10];\n  Si_output0 -> Mu_Mul2;\n  Mu_Mulcst2 -> Mu_Mul2;\n  Mu_Mul2 -> Mu_C03;\n\n  Mu_C0 [shape=box label=\"Mu_C0\" fontsize=10];\n  Mu_Mul [shape=box style=\"filled,rounded\" color=orange label=\"Mul\\n(Mu_Mul)\" fontsize=10];\n  Re_reduced0 -> Mu_Mul;\n  Mu_Mulcst -> Mu_Mul;\n  Mu_Mul -> Mu_C0;\n\n  Ad_Add1 [shape=box style=\"filled,rounded\" color=orange label=\"Add\\n(Ad_Add1)\" fontsize=10];\n  Mu_C03 -> Ad_Add1;\n  Mu_C04 -> Ad_Add1;\n  Ad_Add1 -> Y_grad;\n\n  Ad_C0 [shape=box label=\"Ad_C0\" fontsize=10];\n  Ad_Add [shape=box style=\"filled,rounded\" color=orange label=\"Add\\n(Ad_Add)\" fontsize=10];\n  Mu_C0 -> Ad_Add;\n  Mu_C02 -> Ad_Add;\n  Ad_Add -> Ad_C0;\n\n  Re_Reshape [shape=box style=\"filled,rounded\" color=orange label=\"Reshape\\n(Re_Reshape)\" fontsize=10];\n  Ad_C0 -> Re_Reshape;\n  Re_Reshapecst -> Re_Reshape;\n  Re_Reshape -> Y;\n}\n");
    document.getElementById('gdot-140034938290576').innerHTML = svgGraph; });
    
</script>
</div><p><a class="reference external" href="https://github.com/sdpython/onnxcustom/blob/master/onnxcustom/utils/onnx_function.py#L587">source on GitHub</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="onnxcustom.utils.onnx_function._onnx_grad_sigmoid_neg_log_loss_error">
<span class="sig-prename descclassname"><span class="pre">onnxcustom.utils.onnx_function.</span></span><span class="sig-name descname"><span class="pre">_onnx_grad_sigmoid_neg_log_loss_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_opset=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps=1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_name=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#onnxcustom.utils.onnx_function._onnx_grad_sigmoid_neg_log_loss_error" title="Permalink to this definition">¶</a></dt>
<dd><p>The function the raw scores from a classifier, uses the
sigmoid function to compute probabilities, then the log function
to compute the loss. It creates the ONNX graph for this function
and the associated gradient of the loss against the raw scores.</p>
<p>Probabilites (class 1): <img class="math" src="../../_images/math/e52bd8c3cffa8ddbeadd9e375ddfbc28e56753c8.svg" alt="p(s) = \frac{1}{1 + \exp(-s)}"/>.
Loss (for two classes): <img class="math" src="../../_images/math/c32b57ce99d4775a8ed8070cf969d18f1c8c7eef.svg" alt="L(y, s) = (1 - y)\log(1 - p(s)) +
y \log(p(s))"/>.
Gradient <img class="math" src="../../_images/math/aa9b86ffad03af261e30eb1bacddad96ded0e544.svg" alt="\frac{dL(y, s)}{ds} = y - p(s)"/>.
To avoid nan values, probabilies are clipped:
<img class="math" src="../../_images/math/e79aab40d1692099e79f901624d0a561df22dcc7.svg" alt="p(s) = \max(\min(p(s), 1 - \epsilon), \epsilon)"/>.
<img class="math" src="../../_images/math/e77ea2c9275f0cf5d96fc3fcb43a803eef3ff13d.svg" alt="y \in \{0, 1\}"/> (integer). <em>s</em> is a float.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>eps</strong> – to clip probabilities and avoid computing <cite>log(0)</cite></p>
</dd>
</dl>

    <div id="gdot-140034592383712-cont"><div id="gdot-140034592383712" style="width:100%;height:100%;"></div>
    <script>

    require(['../../_static/viz.js'], function() { var svgGraph = Viz(" digraph{\n  size=7;\n  orientation=portrait;\n  nodesep=0.05;\n  ranksep=0.25;\n\n  X1 [shape=box color=red label=\"X1\\nint64((0, 0))\" fontsize=10];\n  X2 [shape=box color=red label=\"X2\\nfloat((0, 0))\" fontsize=10];\n\n  Y [shape=box color=green label=\"Y\\nfloat(('?',))\" fontsize=10];\n  Y_grad [shape=box color=green label=\"Y_grad\\nfloat(('?',))\" fontsize=10];\n\n  Su_Subcst [shape=box label=\"Su_Subcst\\nfloat32((1,))\\n[1.]\" fontsize=10];\n  Cl_Clipcst [shape=box label=\"Cl_Clipcst\\nfloat32((1,))\\n[1.e-05]\" fontsize=10];\n  Cl_Clipcst1 [shape=box label=\"Cl_Clipcst1\\nfloat32((1,))\\n[1.]\" fontsize=10];\n  Re_Reshapecst [shape=box label=\"Re_Reshapecst\\nint64((1,))\\n[-1]\" fontsize=10];\n\n  Su_Subcst1 [shape=box label=\"Su_Subcst1\" fontsize=10];\n  Su_Subcst1_op [shape=box style=\"filled,rounded\" color=orange label=\"Identity\\n(Su_Subcst1_op)\" fontsize=10];\n  Su_Subcst -> Su_Subcst1_op;\n  Su_Subcst1_op -> Su_Subcst1;\n\n  Ca_output0 [shape=box label=\"Ca_output0\" fontsize=10];\n  Ca_Cast [shape=box style=\"filled,rounded\" color=orange label=\"Cast\\n(Ca_Cast)\\nto=1\" fontsize=10];\n  X1 -> Ca_Cast;\n  Ca_Cast -> Ca_output0;\n\n  Si_Y0 [shape=box label=\"Si_Y0\" fontsize=10];\n  Si_Sigmoid [shape=box style=\"filled,rounded\" color=orange label=\"Sigmoid\\n(Si_Sigmoid)\" fontsize=10];\n  X2 -> Si_Sigmoid;\n  Si_Sigmoid -> Si_Y0;\n\n  Cl_output0 [shape=box label=\"Cl_output0\" fontsize=10];\n  Cl_Clip [shape=box style=\"filled,rounded\" color=orange label=\"Clip\\n(Cl_Clip)\" fontsize=10];\n  Si_Y0 -> Cl_Clip;\n  Cl_Clipcst -> Cl_Clip;\n  Cl_Clipcst1 -> Cl_Clip;\n  Cl_Clip -> Cl_output0;\n\n  Su_C0 [shape=box label=\"Su_C0\" fontsize=10];\n  Su_Sub [shape=box style=\"filled,rounded\" color=orange label=\"Sub\\n(Su_Sub)\" fontsize=10];\n  Su_Subcst -> Su_Sub;\n  Ca_output0 -> Su_Sub;\n  Su_Sub -> Su_C0;\n\n  Su_Sub2 [shape=box style=\"filled,rounded\" color=orange label=\"Sub\\n(Su_Sub2)\" fontsize=10];\n  Cl_output0 -> Su_Sub2;\n  Ca_output0 -> Su_Sub2;\n  Su_Sub2 -> Y_grad;\n\n  Lo_output02 [shape=box label=\"Lo_output02\" fontsize=10];\n  Lo_Log1 [shape=box style=\"filled,rounded\" color=orange label=\"Log\\n(Lo_Log1)\" fontsize=10];\n  Cl_output0 -> Lo_Log1;\n  Lo_Log1 -> Lo_output02;\n\n  Su_C02 [shape=box label=\"Su_C02\" fontsize=10];\n  Su_Sub1 [shape=box style=\"filled,rounded\" color=orange label=\"Sub\\n(Su_Sub1)\" fontsize=10];\n  Su_Subcst1 -> Su_Sub1;\n  Cl_output0 -> Su_Sub1;\n  Su_Sub1 -> Su_C02;\n\n  Lo_output0 [shape=box label=\"Lo_output0\" fontsize=10];\n  Lo_Log [shape=box style=\"filled,rounded\" color=orange label=\"Log\\n(Lo_Log)\" fontsize=10];\n  Su_C02 -> Lo_Log;\n  Lo_Log -> Lo_output0;\n\n  Mu_C02 [shape=box label=\"Mu_C02\" fontsize=10];\n  Mu_Mul1 [shape=box style=\"filled,rounded\" color=orange label=\"Mul\\n(Mu_Mul1)\" fontsize=10];\n  Ca_output0 -> Mu_Mul1;\n  Lo_output02 -> Mu_Mul1;\n  Mu_Mul1 -> Mu_C02;\n\n  Mu_C0 [shape=box label=\"Mu_C0\" fontsize=10];\n  Mu_Mul [shape=box style=\"filled,rounded\" color=orange label=\"Mul\\n(Mu_Mul)\" fontsize=10];\n  Su_C0 -> Mu_Mul;\n  Lo_output0 -> Mu_Mul;\n  Mu_Mul -> Mu_C0;\n\n  Ad_C0 [shape=box label=\"Ad_C0\" fontsize=10];\n  Ad_Add [shape=box style=\"filled,rounded\" color=orange label=\"Add\\n(Ad_Add)\" fontsize=10];\n  Mu_C0 -> Ad_Add;\n  Mu_C02 -> Ad_Add;\n  Ad_Add -> Ad_C0;\n\n  Ne_Y0 [shape=box label=\"Ne_Y0\" fontsize=10];\n  Ne_Neg [shape=box style=\"filled,rounded\" color=orange label=\"Neg\\n(Ne_Neg)\" fontsize=10];\n  Ad_C0 -> Ne_Neg;\n  Ne_Neg -> Ne_Y0;\n\n  Re_reduced0 [shape=box label=\"Re_reduced0\" fontsize=10];\n  Re_ReduceSum [shape=box style=\"filled,rounded\" color=orange label=\"ReduceSum\\n(Re_ReduceSum)\" fontsize=10];\n  Ne_Y0 -> Re_ReduceSum;\n  Re_ReduceSum -> Re_reduced0;\n\n  Re_Reshape [shape=box style=\"filled,rounded\" color=orange label=\"Reshape\\n(Re_Reshape)\" fontsize=10];\n  Re_reduced0 -> Re_Reshape;\n  Re_Reshapecst -> Re_Reshape;\n  Re_Reshape -> Y;\n}\n");
    document.getElementById('gdot-140034592383712').innerHTML = svgGraph; });
    
</script>
</div><p><a class="reference external" href="https://github.com/sdpython/onnxcustom/blob/master/onnxcustom/utils/onnx_function.py#L762">source on GitHub</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="onnxcustom.utils.onnx_function._onnx_grad_square_error">
<span class="sig-prename descclassname"><span class="pre">onnxcustom.utils.onnx_function.</span></span><span class="sig-name descname"><span class="pre">_onnx_grad_square_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_opset=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_name=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#onnxcustom.utils.onnx_function._onnx_grad_square_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the ONNX graph for the gradient of function
<img class="math" src="../../_images/math/3b2f13f102e298d027f206c95f45e8e813836897.svg" alt="Y = f(X1, X2) = \lVert X1 - X2 \rVert ^2"/> or
<img class="math" src="../../_images/math/13d365ede299c8d42b95bb9d09e6577e284175be.svg" alt="Y = f(X1, X2) = \lVert X1 - X2 \rVert ^2 w"/> if
<em>weight_name</em> is not None</p>

    <div id="gdot-140034593991744-cont"><div id="gdot-140034593991744" style="width:100%;height:100%;"></div>
    <script>

    require(['../../_static/viz.js'], function() { var svgGraph = Viz(" digraph{\n  size=7;\n  orientation=portrait;\n  nodesep=0.05;\n  ranksep=0.25;\n\n  X1 [shape=box color=red label=\"X1\\nfloat((0, 0))\" fontsize=10];\n  X2 [shape=box color=red label=\"X2\\nfloat((0, 0))\" fontsize=10];\n\n  Y_grad [shape=box color=green label=\"Y_grad\\nfloat(('?',))\" fontsize=10];\n\n  Mu_Mulcst [shape=box label=\"Mu_Mulcst\\nfloat32((1,))\\n[-2.]\" fontsize=10];\n\n  Su_C0 [shape=box label=\"Su_C0\" fontsize=10];\n  Su_Sub [shape=box style=\"filled,rounded\" color=orange label=\"Sub\\n(Su_Sub)\" fontsize=10];\n  X1 -> Su_Sub;\n  X2 -> Su_Sub;\n  Su_Sub -> Su_C0;\n\n  Mu_Mul [shape=box style=\"filled,rounded\" color=orange label=\"Mul\\n(Mu_Mul)\" fontsize=10];\n  Su_C0 -> Mu_Mul;\n  Mu_Mulcst -> Mu_Mul;\n  Mu_Mul -> Y_grad;\n}\n");
    document.getElementById('gdot-140034593991744').innerHTML = svgGraph; });
    
</script>
</div><p><a class="reference external" href="https://github.com/sdpython/onnxcustom/blob/master/onnxcustom/utils/onnx_function.py#L257">source on GitHub</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="onnxcustom.utils.onnx_function._onnx_linear_regression">
<span class="sig-prename descclassname"><span class="pre">onnxcustom.utils.onnx_function.</span></span><span class="sig-name descname"><span class="pre">_onnx_linear_regression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_opset=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#onnxcustom.utils.onnx_function._onnx_linear_regression" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the ONNX graph for function
<img class="math" src="../../_images/math/dcf33b9e51e392f7716738465e77076e7179424e.svg" alt="Y = f(X, A, B) = A X + B"/>.</p>

    <div id="gdot-140034595291728-cont"><div id="gdot-140034595291728" style="width:100%;height:100%;"></div>
    <script>

    require(['../../_static/viz.js'], function() { var svgGraph = Viz(" digraph{\n  size=7;\n  orientation=portrait;\n  nodesep=0.05;\n  ranksep=0.25;\n\n  X [shape=box color=red label=\"X\\nfloat((0, 0))\" fontsize=10];\n  A [shape=box color=red label=\"A\\nfloat((0, 0))\" fontsize=10];\n  B [shape=box color=red label=\"B\\nfloat((0, 0))\" fontsize=10];\n\n  Y [shape=box color=green label=\"Y\\nfloat(('?',))\" fontsize=10];\n\n\n  Ma_Y0 [shape=box label=\"Ma_Y0\" fontsize=10];\n  Ma_MatMul [shape=box style=\"filled,rounded\" color=orange label=\"MatMul\\n(Ma_MatMul)\" fontsize=10];\n  X -> Ma_MatMul;\n  A -> Ma_MatMul;\n  Ma_MatMul -> Ma_Y0;\n\n  Ad_Add [shape=box style=\"filled,rounded\" color=orange label=\"Add\\n(Ad_Add)\" fontsize=10];\n  Ma_Y0 -> Ad_Add;\n  B -> Ad_Add;\n  Ad_Add -> Y;\n}\n");
    document.getElementById('gdot-140034595291728').innerHTML = svgGraph; });
    
</script>
</div><p><a class="reference external" href="https://github.com/sdpython/onnxcustom/blob/master/onnxcustom/utils/onnx_function.py#L351">source on GitHub</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="onnxcustom.utils.onnx_function._onnx_n_penalty_elastic_error">
<span class="sig-prename descclassname"><span class="pre">onnxcustom.utils.onnx_function.</span></span><span class="sig-name descname"><span class="pre">_onnx_n_penalty_elastic_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_opset=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_name=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l1_weight=0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2_weight=0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_tensors=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_shape=(1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#onnxcustom.utils.onnx_function._onnx_n_penalty_elastic_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the ONNX graph for function
<img class="math" src="../../_images/math/bc32869601fdf6da777897b62d8bfef898364298.svg" alt="Y = f(W) = \beta \lVert W \rVert +
\alpha \lVert W \rVert^2"/>
<em>l1_weight</em> is <img class="math" src="../../_images/math/8fd96498a01957a1ce6cb102fc544d7e32ae2973.svg" alt="\beta"/> and
<em>l2_weight</em> is <img class="math" src="../../_images/math/35093c7ccc735c18e6452789bcb7ec50e0cb0c43.svg" alt="\alpha"/>.
It does that for <em>n_tensors</em> and adds all of the results
to an input loss.</p>

    <div id="gdot-140034513880064-cont"><div id="gdot-140034513880064" style="width:100%;height:100%;"></div>
    <script>

    require(['../../_static/viz.js'], function() { var svgGraph = Viz(" digraph{\n  size=7;\n  orientation=portrait;\n  nodesep=0.05;\n  ranksep=0.25;\n\n  loss [shape=box color=red label=\"loss\\nfloat((1, 1))\" fontsize=10];\n  W0 [shape=box color=red label=\"W0\\nfloat(('?',))\" fontsize=10];\n  W1 [shape=box color=red label=\"W1\\nfloat(('?',))\" fontsize=10];\n\n  Y [shape=box color=green label=\"Y\\nfloat((0,))\" fontsize=10];\n\n  Mu_Mulcst [shape=box label=\"Mu_Mulcst\\nfloat32((1,))\\n[0.01]\" fontsize=10];\n  Re_Reshapecst [shape=box label=\"Re_Reshapecst\\nint64((1,))\\n[-1]\" fontsize=10];\n\n  Mu_Mulcst3 [shape=box label=\"Mu_Mulcst3\" fontsize=10];\n  Mu_Mulcst3_op [shape=box style=\"filled,rounded\" color=orange label=\"Identity\\n(Mu_Mulcst3_op)\" fontsize=10];\n  Mu_Mulcst -> Mu_Mulcst3_op;\n  Mu_Mulcst3_op -> Mu_Mulcst3;\n\n  Mu_Mulcst1 [shape=box label=\"Mu_Mulcst1\" fontsize=10];\n  Mu_Mulcst1_op [shape=box style=\"filled,rounded\" color=orange label=\"Identity\\n(Mu_Mulcst1_op)\" fontsize=10];\n  Mu_Mulcst -> Mu_Mulcst1_op;\n  Mu_Mulcst1_op -> Mu_Mulcst1;\n\n  Re_reduced04 [shape=box label=\"Re_reduced04\" fontsize=10];\n  Re_ReduceSumSquare1 [shape=box style=\"filled,rounded\" color=orange label=\"ReduceSumSquare\\n(Re_ReduceSumSquare1)\" fontsize=10];\n  W1 -> Re_ReduceSumSquare1;\n  Re_ReduceSumSquare1 -> Re_reduced04;\n\n  Re_reduced02 [shape=box label=\"Re_reduced02\" fontsize=10];\n  Re_ReduceSumSquare [shape=box style=\"filled,rounded\" color=orange label=\"ReduceSumSquare\\n(Re_ReduceSumSquare)\" fontsize=10];\n  W0 -> Re_ReduceSumSquare;\n  Re_ReduceSumSquare -> Re_reduced02;\n\n  Mu_Mulcst2 [shape=box label=\"Mu_Mulcst2\" fontsize=10];\n  Mu_Mulcst2_op [shape=box style=\"filled,rounded\" color=orange label=\"Identity\\n(Mu_Mulcst2_op)\" fontsize=10];\n  Mu_Mulcst -> Mu_Mulcst2_op;\n  Mu_Mulcst2_op -> Mu_Mulcst2;\n\n  Ab_Y02 [shape=box label=\"Ab_Y02\" fontsize=10];\n  Ab_Abs1 [shape=box style=\"filled,rounded\" color=orange label=\"Abs\\n(Ab_Abs1)\" fontsize=10];\n  W1 -> Ab_Abs1;\n  Ab_Abs1 -> Ab_Y02;\n\n  Ab_Y0 [shape=box label=\"Ab_Y0\" fontsize=10];\n  Ab_Abs [shape=box style=\"filled,rounded\" color=orange label=\"Abs\\n(Ab_Abs)\" fontsize=10];\n  W0 -> Ab_Abs;\n  Ab_Abs -> Ab_Y0;\n\n  Re_reduced0 [shape=box label=\"Re_reduced0\" fontsize=10];\n  Re_ReduceSum [shape=box style=\"filled,rounded\" color=orange label=\"ReduceSum\\n(Re_ReduceSum)\" fontsize=10];\n  Ab_Y0 -> Re_ReduceSum;\n  Re_ReduceSum -> Re_reduced0;\n\n  Mu_C04 [shape=box label=\"Mu_C04\" fontsize=10];\n  Mu_Mul3 [shape=box style=\"filled,rounded\" color=orange label=\"Mul\\n(Mu_Mul3)\" fontsize=10];\n  Re_reduced04 -> Mu_Mul3;\n  Mu_Mulcst3 -> Mu_Mul3;\n  Mu_Mul3 -> Mu_C04;\n\n  Mu_C02 [shape=box label=\"Mu_C02\" fontsize=10];\n  Mu_Mul1 [shape=box style=\"filled,rounded\" color=orange label=\"Mul\\n(Mu_Mul1)\" fontsize=10];\n  Re_reduced02 -> Mu_Mul1;\n  Mu_Mulcst1 -> Mu_Mul1;\n  Mu_Mul1 -> Mu_C02;\n\n  Re_reduced03 [shape=box label=\"Re_reduced03\" fontsize=10];\n  Re_ReduceSum1 [shape=box style=\"filled,rounded\" color=orange label=\"ReduceSum\\n(Re_ReduceSum1)\" fontsize=10];\n  Ab_Y02 -> Re_ReduceSum1;\n  Re_ReduceSum1 -> Re_reduced03;\n\n  Mu_C0 [shape=box label=\"Mu_C0\" fontsize=10];\n  Mu_Mul [shape=box style=\"filled,rounded\" color=orange label=\"Mul\\n(Mu_Mul)\" fontsize=10];\n  Re_reduced0 -> Mu_Mul;\n  Mu_Mulcst -> Mu_Mul;\n  Mu_Mul -> Mu_C0;\n\n  Mu_C03 [shape=box label=\"Mu_C03\" fontsize=10];\n  Mu_Mul2 [shape=box style=\"filled,rounded\" color=orange label=\"Mul\\n(Mu_Mul2)\" fontsize=10];\n  Re_reduced03 -> Mu_Mul2;\n  Mu_Mulcst2 -> Mu_Mul2;\n  Mu_Mul2 -> Mu_C03;\n\n  Ad_C03 [shape=box label=\"Ad_C03\" fontsize=10];\n  Ad_Add1 [shape=box style=\"filled,rounded\" color=orange label=\"Add\\n(Ad_Add1)\" fontsize=10];\n  Mu_C03 -> Ad_Add1;\n  Mu_C04 -> Ad_Add1;\n  Ad_Add1 -> Ad_C03;\n\n  Ad_C02 [shape=box label=\"Ad_C02\" fontsize=10];\n  Ad_Add [shape=box style=\"filled,rounded\" color=orange label=\"Add\\n(Ad_Add)\" fontsize=10];\n  Mu_C0 -> Ad_Add;\n  Mu_C02 -> Ad_Add;\n  Ad_Add -> Ad_C02;\n\n  Ad_C01 [shape=box label=\"Ad_C01\" fontsize=10];\n  Ad_Add2 [shape=box style=\"filled,rounded\" color=orange label=\"Add\\n(Ad_Add2)\" fontsize=10];\n  Ad_C02 -> Ad_Add2;\n  Ad_C03 -> Ad_Add2;\n  Ad_Add2 -> Ad_C01;\n\n  Ad_C0 [shape=box label=\"Ad_C0\" fontsize=10];\n  Ad_Add3 [shape=box style=\"filled,rounded\" color=orange label=\"Add\\n(Ad_Add3)\" fontsize=10];\n  loss -> Ad_Add3;\n  Ad_C01 -> Ad_Add3;\n  Ad_Add3 -> Ad_C0;\n\n  Re_Reshape [shape=box style=\"filled,rounded\" color=orange label=\"Reshape\\n(Re_Reshape)\" fontsize=10];\n  Ad_C0 -> Re_Reshape;\n  Re_Reshapecst -> Re_Reshape;\n  Re_Reshape -> Y;\n}\n");
    document.getElementById('gdot-140034513880064').innerHTML = svgGraph; });
    
</script>
</div><p><a class="reference external" href="https://github.com/sdpython/onnxcustom/blob/master/onnxcustom/utils/onnx_function.py#L647">source on GitHub</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="onnxcustom.utils.onnx_function._onnx_square_error">
<span class="sig-prename descclassname"><span class="pre">onnxcustom.utils.onnx_function.</span></span><span class="sig-name descname"><span class="pre">_onnx_square_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_opset=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_name=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#onnxcustom.utils.onnx_function._onnx_square_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the ONNX graph for function
<img class="math" src="../../_images/math/3b2f13f102e298d027f206c95f45e8e813836897.svg" alt="Y = f(X1, X2) = \lVert X1 - X2 \rVert ^2"/> or
<img class="math" src="../../_images/math/13d365ede299c8d42b95bb9d09e6577e284175be.svg" alt="Y = f(X1, X2) = \lVert X1 - X2 \rVert ^2 w"/> if
<em>weight_name</em> is not None</p>

    <div id="gdot-140034590746464-cont"><div id="gdot-140034590746464" style="width:100%;height:100%;"></div>
    <script>

    require(['../../_static/viz.js'], function() { var svgGraph = Viz(" digraph{\n  size=7;\n  orientation=portrait;\n  nodesep=0.05;\n  ranksep=0.25;\n\n  X1 [shape=box color=red label=\"X1\\nfloat((0, 0))\" fontsize=10];\n  X2 [shape=box color=red label=\"X2\\nfloat((0, 0))\" fontsize=10];\n\n  Y [shape=box color=green label=\"Y\\nfloat(('?',))\" fontsize=10];\n\n  Re_Reshapecst [shape=box label=\"Re_Reshapecst\\nint64((1,))\\n[-1]\" fontsize=10];\n\n  Su_C0 [shape=box label=\"Su_C0\" fontsize=10];\n  Su_Sub [shape=box style=\"filled,rounded\" color=orange label=\"Sub\\n(Su_Sub)\" fontsize=10];\n  X1 -> Su_Sub;\n  X2 -> Su_Sub;\n  Su_Sub -> Su_C0;\n\n  Re_reduced0 [shape=box label=\"Re_reduced0\" fontsize=10];\n  Re_ReduceSumSquare [shape=box style=\"filled,rounded\" color=orange label=\"ReduceSumSquare\\n(Re_ReduceSumSquare)\" fontsize=10];\n  Su_C0 -> Re_ReduceSumSquare;\n  Re_ReduceSumSquare -> Re_reduced0;\n\n  Re_Reshape [shape=box style=\"filled,rounded\" color=orange label=\"Reshape\\n(Re_Reshape)\" fontsize=10];\n  Re_reduced0 -> Re_Reshape;\n  Re_Reshapecst -> Re_Reshape;\n  Re_Reshape -> Y;\n}\n");
    document.getElementById('gdot-140034590746464').innerHTML = svgGraph; });
    
</script>
</div><p><a class="reference external" href="https://github.com/sdpython/onnxcustom/blob/master/onnxcustom/utils/onnx_function.py#L208">source on GitHub</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="onnxcustom.utils.onnx_function._onnx_update_penalty_elastic_error">
<span class="sig-prename descclassname"><span class="pre">onnxcustom.utils.onnx_function.</span></span><span class="sig-name descname"><span class="pre">_onnx_update_penalty_elastic_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_opset=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l1=0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2=0.0001</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#onnxcustom.utils.onnx_function._onnx_update_penalty_elastic_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the ONNX graph for function
<img class="math" src="../../_images/math/f29329c678cb190134a14d51b279d5178d027ec2.svg" alt="Y = f(W) = W - 2 \beta W - \alpha sign(W)"/>
<em>l1</em> is <img class="math" src="../../_images/math/8fd96498a01957a1ce6cb102fc544d7e32ae2973.svg" alt="\beta"/> and
<em>l2</em> is <img class="math" src="../../_images/math/35093c7ccc735c18e6452789bcb7ec50e0cb0c43.svg" alt="\alpha"/>.</p>

    <div id="gdot-140034934279520-cont"><div id="gdot-140034934279520" style="width:100%;height:100%;"></div>
    <script>

    require(['../../_static/viz.js'], function() { var svgGraph = Viz(" digraph{\n  size=7;\n  orientation=portrait;\n  nodesep=0.05;\n  ranksep=0.25;\n\n  X [shape=box color=red label=\"X\\nfloat(('?',))\" fontsize=10];\n\n  Y [shape=box color=green label=\"Y\\nfloat(('?',))\" fontsize=10];\n\n  Mu_Mulcst [shape=box label=\"Mu_Mulcst\\nfloat32((1,))\\n[1.]\" fontsize=10];\n  Mu_Mulcst1 [shape=box label=\"Mu_Mulcst1\\nfloat32((1,))\\n[1.e-04]\" fontsize=10];\n\n  Mu_C0 [shape=box label=\"Mu_C0\" fontsize=10];\n  Mu_Mul [shape=box style=\"filled,rounded\" color=orange label=\"Mul\\n(Mu_Mul)\" fontsize=10];\n  X -> Mu_Mul;\n  Mu_Mulcst -> Mu_Mul;\n  Mu_Mul -> Mu_C0;\n\n  Si_output0 [shape=box label=\"Si_output0\" fontsize=10];\n  Si_Sign [shape=box style=\"filled,rounded\" color=orange label=\"Sign\\n(Si_Sign)\" fontsize=10];\n  X -> Si_Sign;\n  Si_Sign -> Si_output0;\n\n  Mu_C02 [shape=box label=\"Mu_C02\" fontsize=10];\n  Mu_Mul1 [shape=box style=\"filled,rounded\" color=orange label=\"Mul\\n(Mu_Mul1)\" fontsize=10];\n  Si_output0 -> Mu_Mul1;\n  Mu_Mulcst1 -> Mu_Mul1;\n  Mu_Mul1 -> Mu_C02;\n\n  Su_Sub [shape=box style=\"filled,rounded\" color=orange label=\"Sub\\n(Su_Sub)\" fontsize=10];\n  Mu_C0 -> Su_Sub;\n  Mu_C02 -> Su_Sub;\n  Su_Sub -> Y;\n}\n");
    document.getElementById('gdot-140034934279520').innerHTML = svgGraph; });
    
</script>
</div><p><a class="reference external" href="https://github.com/sdpython/onnxcustom/blob/master/onnxcustom/utils/onnx_function.py#L711">source on GitHub</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="onnxcustom.utils.onnx_function._onnx_zero">
<span class="sig-prename descclassname"><span class="pre">onnxcustom.utils.onnx_function.</span></span><span class="sig-name descname"><span class="pre">_onnx_zero</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_opset=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#onnxcustom.utils.onnx_function._onnx_zero" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the ONNX graph for function
<img class="math" src="../../_images/math/593d75ede57175b6fe812377998b407f63960a50.svg" alt="Y = X * 0"/>.</p>

    <div id="gdot-140034934278416-cont"><div id="gdot-140034934278416" style="width:100%;height:100%;"></div>
    <script>

    require(['../../_static/viz.js'], function() { var svgGraph = Viz(" digraph{\n  size=7;\n  orientation=portrait;\n  nodesep=0.05;\n  ranksep=0.25;\n\n  X [shape=box color=red label=\"X\\nfloat(('?',))\" fontsize=10];\n\n  Y [shape=box color=green label=\"Y\\nfloat(('?',))\" fontsize=10];\n\n  Mu_Mulcst [shape=box label=\"Mu_Mulcst\\nfloat32((1,))\\n[0.]\" fontsize=10];\n\n  Mu_Mul [shape=box style=\"filled,rounded\" color=orange label=\"Mul\\n(Mu_Mul)\" fontsize=10];\n  X -> Mu_Mul;\n  Mu_Mulcst -> Mu_Mul;\n  Mu_Mul -> Y;\n}\n");
    document.getElementById('gdot-140034934278416').innerHTML = svgGraph; });
    
</script>
</div><p><a class="reference external" href="https://github.com/sdpython/onnxcustom/blob/master/onnxcustom/utils/onnx_function.py#L324">source on GitHub</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="onnxcustom.utils.onnx_function.function_onnx_graph">
<span class="sig-prename descclassname"><span class="pre">onnxcustom.utils.onnx_function.</span></span><span class="sig-name descname"><span class="pre">function_onnx_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_opset=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_name=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#onnxcustom.utils.onnx_function.function_onnx_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the ONNX graph corresponding to a function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – name</p></li>
<li><p><strong>target_opset</strong> – opset version, if None, <em>target_opset</em>
is replaced by the latest supported opset defined
in the main <cite>__init__.py</cite> of this package in
<cite>__max_supported_opset__</cite></p></li>
<li><p><strong>dtype</strong> – computation type</p></li>
<li><p><strong>weight_name</strong> – weight name if any</p></li>
<li><p><strong>kwargs</strong> – additional parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ONNX graph</p>
</dd>
</dl>
<p>A wrong name will raise an exception giving the whole of
supported function. One example with function <cite>square_error</cite>:</p>

    <div id="gdot-140034941815056-cont"><div id="gdot-140034941815056" style="width:100%;height:100%;"></div>
    <script>

    require(['../../_static/viz.js'], function() { var svgGraph = Viz(" digraph{\n  size=7;\n  orientation=portrait;\n  nodesep=0.05;\n  ranksep=0.25;\n\n  X1 [shape=box color=red label=\"X1\\nfloat((0, 0))\" fontsize=10];\n  X2 [shape=box color=red label=\"X2\\nfloat((0, 0))\" fontsize=10];\n\n  Y [shape=box color=green label=\"Y\\nfloat(('?',))\" fontsize=10];\n\n  Re_Reshapecst [shape=box label=\"Re_Reshapecst\\nint64((1,))\\n[-1]\" fontsize=10];\n\n  Su_C0 [shape=box label=\"Su_C0\" fontsize=10];\n  Su_Sub [shape=box style=\"filled,rounded\" color=orange label=\"Sub\\n(Su_Sub)\" fontsize=10];\n  X1 -> Su_Sub;\n  X2 -> Su_Sub;\n  Su_Sub -> Su_C0;\n\n  Re_reduced0 [shape=box label=\"Re_reduced0\" fontsize=10];\n  Re_ReduceSumSquare [shape=box style=\"filled,rounded\" color=orange label=\"ReduceSumSquare\\n(Re_ReduceSumSquare)\" fontsize=10];\n  Su_C0 -> Re_ReduceSumSquare;\n  Re_ReduceSumSquare -> Re_reduced0;\n\n  Re_Reshape [shape=box style=\"filled,rounded\" color=orange label=\"Reshape\\n(Re_Reshape)\" fontsize=10];\n  Re_reduced0 -> Re_Reshape;\n  Re_Reshapecst -> Re_Reshape;\n  Re_Reshape -> Y;\n}\n");
    document.getElementById('gdot-140034941815056').innerHTML = svgGraph; });
    
</script>
</div><p>An example on how to use it:</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">onnxruntime</span> <span class="kn">import</span> <span class="n">InferenceSession</span>
<span class="kn">from</span> <span class="nn">onnxcustom.utils.onnx_function</span> <span class="kn">import</span> <span class="n">function_onnx_graph</span>

<span class="n">model_onnx</span> <span class="o">=</span> <span class="n">function_onnx_graph</span><span class="p">(</span><span class="s1">&#39;square_error&#39;</span><span class="p">)</span>
<span class="n">sess</span> <span class="o">=</span> <span class="n">InferenceSession</span><span class="p">(</span><span class="n">model_onnx</span><span class="o">.</span><span class="n">SerializeToString</span><span class="p">())</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="p">{</span>
    <span class="s1">&#39;X1&#39;</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
    <span class="s1">&#39;X2&#39;</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="p">[</span><span class="mf">2.</span><span class="p">]</span>
</pre></div>
</div>
<p>List of supported functions:</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">onnxcustom.utils.onnx_function</span> <span class="kn">import</span> <span class="n">get_supported_functions</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">get_supported_functions</span><span class="p">())))</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">axpy</span>
    <span class="n">axpyw</span>
    <span class="n">axpyw2</span>
    <span class="n">copy</span>
    <span class="n">grad_loss_absolute_error</span>
    <span class="n">grad_loss_elastic_error</span>
    <span class="n">grad_loss_square_error</span>
    <span class="n">grad_penalty_elastic_error</span>
    <span class="n">grad_sigmoid_neg_log_loss_error</span>
    <span class="n">grad_square_error</span>
    <span class="n">linear_regression</span>
    <span class="n">n_penalty_elastic_error</span>
    <span class="n">square_error</span>
    <span class="n">update_penalty_elastic_error</span>
    <span class="n">zero</span>
</pre></div>
</div>
<p><a class="reference external" href="https://github.com/sdpython/onnxcustom/blob/master/onnxcustom/utils/onnx_function.py#L76">source on GitHub</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="onnxcustom.utils.onnx_function.get_supported_functions">
<span class="sig-prename descclassname"><span class="pre">onnxcustom.utils.onnx_function.</span></span><span class="sig-name descname"><span class="pre">get_supported_functions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#onnxcustom.utils.onnx_function.get_supported_functions" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of supported function by <a class="reference internal" href="#onnxcustom.utils.onnx_function.function_onnx_graph" title="onnxcustom.utils.onnx_function.function_onnx_graph"><code class="xref py py-func docutils literal notranslate"><span class="pre">function_onnx_graph</span></code></a>.</p>
<p><a class="reference external" href="https://github.com/sdpython/onnxcustom/blob/master/onnxcustom/utils/onnx_function.py#L14">source on GitHub</a></p>
</dd></dl>

</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="nvprof2json.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">module <code class="docutils literal notranslate"><span class="pre">utils.nvprof2json</span></code></p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="onnx_helper.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">module <code class="docutils literal notranslate"><span class="pre">utils.onnx_helper</span></code></p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
    <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2022, Xavier Dupré.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.4.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>