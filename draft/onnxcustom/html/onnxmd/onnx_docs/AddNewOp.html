
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Table of Contents &#8212; onnxcustom</title>
    
    <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
  
    
    <link rel="stylesheet"
      href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">
  
    
      
  
    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/pydata-sphinx-theme.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/style_notebook_snippet.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinxtrib-images/LightBox2/lightbox2/css/lightbox.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/my-styles.css" />
    
    <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">
  
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/thebelab-helper.js"></script>
    <script src="../../_static/require.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script src="../../_static/sphinxtrib-images/LightBox2/lightbox2/js/jquery-1.11.0.min.js"></script>
    <script src="../../_static/sphinxtrib-images/LightBox2/lightbox2/js/lightbox.min.js"></script>
    <script src="../../_static/sphinxtrib-images/LightBox2/lightbox2_customize/jquery-noconflict.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../index.html">
  <img src="../../_static/project_ico.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../tutorials/index.html">
  Tutorials
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../api/apis.html">
  API
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../gyexamples/index.html">
  Examples Gallery
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../all_notebooks.html">
  Notebooks Gallery
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../other_pages.html">
  Other pages
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../blog/blogindex.html">
  Blog Gallery
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Overview.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="IR.html">
   Open Neural Network Exchange Intermediate Representation (ONNX IR) Specification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="PythonAPIOverview.html">
   Python API Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="OpConventions.html">
   Operator Conventions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="DimensionDenotation.html">
   Dimension Denotation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Broadcasting.html">
   Broadcasting in ONNX
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ExternalData.html">
   External Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Hub.html">
   ONNX Model Hub
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../onnx_metadata.html">
   Metatdata
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ShapeInference.html">
   ONNX Shape Inference
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="CIPipelines.html">
   ONNX CI Pipelines
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Syntax.html">
   Overview
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Versioning.html">
   ONNX Versioning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="VersionConverter.html">
   ONNX Version Converter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Relicensing.html">
   Relicensing MIT to Apache-2.0
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../onnx_releases.html">
   Onnx Releases
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../onnx_operators.html">
   ONNX Operators
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../onnx_operators_ml.html">
   ONNX ML Operators
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../onnx_changelog.html">
   Change Logs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../onnx_changelog_ml.html">
   ML Change Logs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../onnx_test_coverage.html">
   Test Coverage (Operators)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../onnx_test_coverage_ml.html">
   Test Coverage (ML Operators)
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../onnx_contributing.html">
   Contributing
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../onnx_add_new_op.html">
   Adding a new operator
  </a>
  <input checked class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Table of Contents
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ImplementingAnOnnxBackend.html">
   Implementing an ONNX backend
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="OnnxBackendTest.html">
   ONNX Backend Test
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../onnx_managing.html">
   Onnx Releases
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ONNXIFI.html">
   ONNX Interface for Framework Integration (ONNXIFI)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ONNXTypes.html">
   Optional Type
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="TypeAnnotations.html">
   Type annotations for ONNX
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="TypeDenotation.html">
   Type Denotation
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="DefineDifferentiability.html">
   A Short Guide on the Differentiability Tag for ONNX Operators
  </a>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Table of Contents
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#proposing-and-submitting-a-new-operator-or-function-to-onnx-a-name-new-operator-or-function-a">
   Proposing and submitting a new operator or function to ONNX
   <a name="new_operator_or_function">
   </a>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#steps-to-add-an-operator-a-name-steps-to-add-an-operator-a">
     4 steps to add an operator
     <a name="steps_to_add_an_operator">
     </a>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-1-proposing-a-new-operator-function-a-name-step1-new-operator-or-function-a">
     Step 1: Proposing a new operator/function
     <a name="step1_new_operator_or_function">
     </a>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-2-submit-pr-a-name-step2-new-operator-or-function-a">
     Step 2: Submit PR
     <a name="step2_new_operator_or_function">
     </a>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-to-follow">
       Example to Follow
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-3-pr-review-by-operators-sig-a-name-step3-new-operator-or-function-a">
     Step 3: PR Review by Operators SIG
     <a name="step3_new_operator_or_function">
     </a>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sign-off">
       Sign-off
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-4-onnx-release-a-name-step4-new-operator-or-function-a">
     Step 4: ONNX release
     <a name="step4_new_operator_or_function">
     </a>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#removing-operator-or-function-a-name-removing-operator-or-function-a">
   Removing operator or function
   <a name="removing_operator_or_function">
   </a>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#removing-operator-a-name-removing-operator-a">
     Removing operator
     <a name="removing_operator">
     </a>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#removing-function-a-name-removing-function-a">
     Removing function
     <a name="removing_function">
     </a>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#document-removing-operator-or-function-a-name-document-removing-operator-or-function-a">
     Document removing operator or function
     <a name="document_removing_operator_or_function">
     </a>
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <!--- SPDX-License-Identifier: Apache-2.0 -->
<section id="table-of-contents">
<h1>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this headline">¶</a></h1>
<ol class="arabic simple">
<li><p><span class="xref myst">New Operator or Function</span></p>
<ol class="arabic simple">
<li><p><span class="xref myst">Step 1: Proposing a new operator/function</span></p></li>
<li><p><span class="xref myst">Step 2: Submit PR</span></p></li>
<li><p><span class="xref myst">Step 3: PR Review by Operators SIG</span></p></li>
<li><p><span class="xref myst">Step 4: ONNX release</span></p></li>
</ol>
</li>
<li><p><span class="xref myst">Removing Operator or Function</span></p>
<ol class="arabic simple">
<li><p><span class="xref myst">Removing operator</span></p></li>
<li><p><span class="xref myst">Removing function</span></p></li>
<li><p><span class="xref myst">Document removing operator or function</span></p></li>
</ol>
</li>
</ol>
</section>
<section id="proposing-and-submitting-a-new-operator-or-function-to-onnx-a-name-new-operator-or-function-a">
<h1>Proposing and submitting a new operator or function to ONNX <a name="new_operator_or_function"></a><a class="headerlink" href="#proposing-and-submitting-a-new-operator-or-function-to-onnx-a-name-new-operator-or-function-a" title="Permalink to this headline">¶</a></h1>
<p>Operators are the basic building blocks that define ONNX model. With a rich set of operators, ONNX can describe most DNN and ML models from various frameworks. Functions allow for composing complex operators from more primitive operators. The ONNX specification includes a core set of operators that enable many models. It is a non-goal to add all possible operators, however more operators are added as needed to cover evolving needs.</p>
<p>In this document, we describe the process of accepting a new proposed operator and how to properly submit a new operator as part of ONNX standard. The goal is to improve on what we currently have based on our experience, learning and feedbacks we gathered from the community.</p>
<section id="steps-to-add-an-operator-a-name-steps-to-add-an-operator-a">
<h2>4 steps to add an operator <a name="steps_to_add_an_operator"></a><a class="headerlink" href="#steps-to-add-an-operator-a-name-steps-to-add-an-operator-a" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>Decide what to propose</p></li>
<li><p>Submit PR for new operator/function</p></li>
<li><p>Review of PR by Operators SIG</p></li>
<li><p>Merging of PR and inclusion in next ONNX release</p></li>
</ol>
</section>
<section id="step-1-proposing-a-new-operator-function-a-name-step1-new-operator-or-function-a">
<h2>Step 1: Proposing a new operator/function <a name="step1_new_operator_or_function"></a><a class="headerlink" href="#step-1-proposing-a-new-operator-function-a-name-step1-new-operator-or-function-a" title="Permalink to this headline">¶</a></h2>
<p>In order to propose a new operator/function, the following is needed:</p>
<ol class="arabic simple">
<li><p>If the operator can be composed by other ONNX operators, then it should be a function and not an operator (we have a function in ONNX : MeanVarianceNormalization).</p></li>
<li><p>If the operators can be split to new primitives, propose those primitives instead and make the operator a function.</p></li>
<li><p>Based on a model. This will help us understand the usage and that it solves an actual problem. For the case of the model being private or IP and can’t be shared, the operator doesn’t belong to the standard and should be implemented as custom OP.</p></li>
<li><p>The operator needs to be implemented by at-least one (well-known) framework. This help us to understand the actual behavior of the operator and its usage.</p></li>
<li><p>Operator signature and behavior:</p>
<ol class="arabic simple">
<li><p>If the operator is available in numpy, prefer numpy semantics.</p></li>
<li><p>If the operator is available in more than one frameworks, make sure that your design is general and cover those frameworks.</p></li>
</ol>
</li>
<li><p>Prefer attributes over inputs.</p></li>
</ol>
</section>
<section id="step-2-submit-pr-a-name-step2-new-operator-or-function-a">
<h2>Step 2: Submit PR <a name="step2_new_operator_or_function"></a><a class="headerlink" href="#step-2-submit-pr-a-name-step2-new-operator-or-function-a" title="Permalink to this headline">¶</a></h2>
<p>Once the criteria of proposing new operator/function has been satisfied, you will need to submit a PR for the new operator/function. Here the expectation of what the PR should include. The reviewer is expected to verify the completeness of the PR before signoff.</p>
<ol class="arabic simple">
<li><p>Description:</p>
<ol class="arabic simple">
<li><p>Write a detailed description about the operator, and its expected behavior. Pretty much, the description should be clear enough to avoid confusion between implementors.</p></li>
<li><p>Add an example in the description to illustrate the usage.</p></li>
<li><p>Add reference to the source of the operator in the corresponding framework in the description (if possible).</p></li>
<li><p>Write the mathematic formula or a pseudocode in the description. The core algorithm needs to be very clear.</p></li>
</ol>
</li>
<li><p>Write a reference implementation in Python, this reference implementation should cover all the expected behavior of the operator. Only in extremely rare case, we will waive this requirement.</p></li>
<li><p>Operator version: check out our
<span class="xref myst">versioning doc</span></p></li>
<li><p>Write unit test, that cover main usage and corner cases.</p>
<ol class="arabic simple">
<li><p>The testing examples will be extracted to the doc.</p></li>
<li><p>We also generate binary data for it.</p></li>
<li><p>Example: <span class="xref myst">onnx/backend/test/case/node/abs.py</span></p></li>
</ol>
</li>
<li><p>Add at least one automatic upgrade test for your operator in <span class="xref myst">onnx/test/automatic_upgrade_test.py</span> using <code class="docutils literal notranslate"><span class="pre">_test_op_upgrade</span></code>. These tests create a given operator at a given opset version (usually the version the operator was introduced in) and test that the version converter is able to convert them to the highest available version. So for a new operator <code class="docutils literal notranslate"><span class="pre">_test_op_upgrade</span></code> will not test anything, but as soon as the operator gets updated in a future opset the test will autoamtically become nontrivial.</p></li>
<li><p>Update the documentation and generate the test data.</p>
<ol class="arabic simple">
<li><p>Running <span class="xref myst">the script</span>
to update the doc and generate the test data.</p></li>
</ol>
</li>
<li><p>Shape Inference function</p>
<ol class="arabic simple">
<li><p>Please provide a shape inference function in cases where it is meaningful and applicable.</p></li>
<li><p>In cases where shape inference is not possible, it must have logic to perform
rank inference at the very least (adding right amount of dimensions to the output shape)</p></li>
<li><p>Shape inference functions must be accompanied by unit tests (<span class="xref myst">onnx/test/shape_inference_test.py</span>).</p></li>
<li><p>You can refer to the shape inference function for the <code class="docutils literal notranslate"><span class="pre">TopK</span></code> operator while implementing your own function (<span class="xref myst">onnx/defs/math/defs.cc</span>)</p></li>
</ol>
</li>
</ol>
<section id="example-to-follow">
<h3>Example to Follow<a class="headerlink" href="#example-to-follow" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://github.com/onnx/onnx/pull/1959">PR 1959</a> is a good example to follow.</p>
</section>
</section>
<section id="step-3-pr-review-by-operators-sig-a-name-step3-new-operator-or-function-a">
<h2>Step 3: PR Review by Operators SIG <a name="step3_new_operator_or_function"></a><a class="headerlink" href="#step-3-pr-review-by-operators-sig-a-name-step3-new-operator-or-function-a" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="https://github.com/onnx/sigs/tree/main/operators">Operators SIG</a> is responsible for the operators/functions in the ONNX specification. The SIG regularly meets and reviews PRs.</p>
<section id="sign-off">
<h3>Sign-off<a class="headerlink" href="#sign-off" title="Permalink to this headline">¶</a></h3>
<p>At least two sign-off from the Operators SIG <a class="reference external" href="https://github.com/onnx/onnx/tree/main/community#community-roles">contributors</a>.</p>
</section>
</section>
<section id="step-4-onnx-release-a-name-step4-new-operator-or-function-a">
<h2>Step 4: ONNX release <a name="step4_new_operator_or_function"></a><a class="headerlink" href="#step-4-onnx-release-a-name-step4-new-operator-or-function-a" title="Permalink to this headline">¶</a></h2>
<p>Once the PR is reviewed and signed off by the Operators SIG, it will be merged. Your new operator/function will be part of the main branch and available to anyone building from source. These are not official releases. ONNX periodically releases official new versions that are a snapshot of the main branch. Your new operator/function will be part of that release.</p>
</section>
</section>
<section id="removing-operator-or-function-a-name-removing-operator-or-function-a">
<h1>Removing operator or function <a name="removing_operator_or_function"></a><a class="headerlink" href="#removing-operator-or-function-a-name-removing-operator-or-function-a" title="Permalink to this headline">¶</a></h1>
<p>There are a lot of reasons for removing existing ONNX operator or function, such us being replaced with different operator or can be decomposed by a set of other operators. This document describes the criteria of removing an existing ONNX operator from the standard.</p>
<section id="removing-operator-a-name-removing-operator-a">
<h2>Removing operator <a name="removing_operator"></a><a class="headerlink" href="#removing-operator-a-name-removing-operator-a" title="Permalink to this headline">¶</a></h2>
<p>Any operator in ONNX was added because it was required by a model and/or framework. In order to deprecate such an operator we need to do the following.</p>
<ul class="simple">
<li><p>Operator can’t be deprecated unless there is a replacement.</p>
<ul>
<li><p>Replacement can be a more general operator that supersedes the old one.</p></li>
<li><p>Or a set of primitive operators that together can implement the same functionality and behavior of the deprecated operator (Function).</p></li>
</ul>
</li>
<li><p>If the deprecated operator can be decomposed by existing operators then it must be converted to a function.</p></li>
<li><p>If replacement isn’t in ONNX standard yet, then add the replacement operator or set of operators first.</p></li>
<li><p>Add a version adapter which turns the operator into its replacement for the version converter. Example: <span class="xref myst">onnx/version_converter/adapters/upsample_9_10.h</span></p></li>
<li><p>No grace period is needed for deprecated operators.</p></li>
</ul>
</section>
<section id="removing-function-a-name-removing-function-a">
<h2>Removing function <a name="removing_function"></a><a class="headerlink" href="#removing-function-a-name-removing-function-a" title="Permalink to this headline">¶</a></h2>
<p>Function, by definition, is composed of ONNX primitives; however, function could have been accelerated by framework or runtime that support ONNX. So, removing function is not recommended, with the exception of adding another single function which supersede its functionality.</p>
</section>
<section id="document-removing-operator-or-function-a-name-document-removing-operator-or-function-a">
<h2>Document removing operator or function <a name="document_removing_operator_or_function"></a><a class="headerlink" href="#document-removing-operator-or-function-a-name-document-removing-operator-or-function-a" title="Permalink to this headline">¶</a></h2>
<p>To make sure everyone is aware of the deprecation, the following need to happen:</p>
<ul class="simple">
<li><p>Any removed operator or function from ONNX need to be mentioned in the release note.</p></li>
<li><p>Their old documentation needs to be updated to show the new replacement and the mapping between the old to the new.</p>
<ul>
<li><p>Only <code class="docutils literal notranslate"><span class="pre">def.cc</span></code> need to be remove, <code class="docutils literal notranslate"><span class="pre">old.cc</span></code> will remain.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">old.cc</span></code> need to be updated with the mapping to the replacement.</p></li>
</ul>
</li>
<li><p>ONNX checker need to be updated to error with a proper message.</p></li>
<li><p>All removed operators need to be appended at the end of the <code class="docutils literal notranslate"><span class="pre">operator.md</span></code> file.</p></li>
</ul>
</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
              
          </main>
          

      </div>
    </div>
  
    <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2022, Xavier Dupré.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.4.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>