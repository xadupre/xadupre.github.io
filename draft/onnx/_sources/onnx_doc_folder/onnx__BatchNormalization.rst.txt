
.. _l-onnx-doc-BatchNormalization:

==================
BatchNormalization
==================

.. contents::
    :local:


.. _l-onnx-op-batchnormalization-15:

BatchNormalization - 15
=======================

**Version**

* **name**: `BatchNormalization (GitHub) <https://github.com/onnx/onnx/blob/main/docs/Operators.md#BatchNormalization>`_
* **domain**: **main**
* **since_version**: **15**
* **function**: False
* **support_level**: SupportType.COMMON
* **shape inference**: True

This version of the operator has been available
**since version 15**.

**Summary**

Carries out batch normalization as described in the paper
https://arxiv.org/abs/1502.03167. Depending on the mode it is being run,
There are five required inputs 'X', 'scale', 'B', 'input_mean' and
'input_var'.
Note that 'input_mean' and 'input_var' are expected to be the estimated
statistics in inference mode (training_mode=False, default),
and the running statistics in training mode (training_mode=True).
There are multiple cases for the number of outputs, which we list below:

Output case #1: Y, running_mean, running_var (training_mode=True)
Output case #2: Y (training_mode=False)

When training_mode=False, extra outputs are invalid.
The outputs are updated as follows when training_mode=True:
::

    running_mean = input_mean * momentum + current_mean * (1 - momentum)
    running_var = input_var * momentum + current_var * (1 - momentum)

    Y = (X - current_mean) / sqrt(current_var + epsilon) * scale + B

    where:

    current_mean = ReduceMean(X, axis=all_except_channel_index)
    current_var =  ReduceVar(X, axis=all_except_channel_index)

    Notice that ReduceVar refers to the population variance, and it equals to
    sum(sqrd(x_i - x_avg)) / N
    where N is the population size (this formula does not use sample size N - 1).

The computation of ReduceMean and ReduceVar uses float to avoid overflow for float16 inputs.

When training_mode=False:
::

    Y = (X - input_mean) / sqrt(input_var + epsilon) * scale + B

For previous (depreciated) non-spatial cases, implementors are suggested
to flatten the input shape to (N x C * D1 * D2 * ... * Dn) before a BatchNormalization Op.
This operator has **optional** inputs/outputs. See `ONNX <https://github.com/onnx/onnx/blob/master/docs/IR.md>`_ for more details about the representation of optional arguments. An empty string may be used in the place of an actual argument's name to indicate a missing argument. Trailing optional arguments (those not followed by an argument that is present) may also be simply omitted.

**Attributes**

* **epsilon**:
  The epsilon value to use to avoid division by zero.
* **momentum**:
  Factor used in computing the running mean and variance.e.g.,
  running_mean = running_mean * momentum + mean * (1 - momentum).
* **training_mode**:
  If set to true, it indicates BatchNormalization is being used for
  training, and outputs 1, 2, 3, and 4 would be populated.

**Inputs**

* **X** (heterogeneous) - **T**:
  Input data tensor from the previous operator; dimensions are in the
  form of (N x C x D1 x D2 ... Dn), where N is the batch size, C is
  the number of channels. Statistics are computed for every channel of
  C over N and D1 to Dn dimensions. For image data, input dimensions
  become (N x C x H x W). The op also accepts single dimension input
  of size N in which case C is assumed to be 1
* **scale** (heterogeneous) - **T1**:
  Scale tensor of shape (C).
* **B** (heterogeneous) - **T1**:
  Bias tensor of shape (C).
* **input_mean** (heterogeneous) - **T2**:
  running (training) or estimated (testing) mean tensor of shape (C).
* **input_var** (heterogeneous) - **T2**:
  running (training) or estimated (testing) variance tensor of shape
  (C).

**Outputs**

Between 1 and 3 outputs.

* **Y** (heterogeneous) - **T**:
  The output tensor of the same shape as X
* **running_mean** (optional, heterogeneous) - **T2**:
  The running mean after the BatchNormalization operator.
* **running_var** (optional, heterogeneous) - **T2**:
  The running variance after the BatchNormalization operator. This op
  uses the population size (N) for calculating variance, and not the
  sample size N-1.

**Type Constraints**

* **T** in (
  tensor(bfloat16),
  tensor(double),
  tensor(float),
  tensor(float16)
  ):
  Constrain input and output types to float tensors.
* **T1** in (
  tensor(bfloat16),
  tensor(double),
  tensor(float),
  tensor(float16)
  ):
  Constrain scale and bias types to float tensors.
* **T2** in (
  tensor(bfloat16),
  tensor(double),
  tensor(float),
  tensor(float16)
  ):
  Constrain mean and variance types to float tensors.

**Examples**

**Differences**

.. raw:: html

        <table class="diff" id="difflib_chg_to16__top"
               cellspacing="0" cellpadding="0" rules="groups" >
            <colgroup></colgroup> <colgroup></colgroup> <colgroup></colgroup>
            <colgroup></colgroup> <colgroup></colgroup> <colgroup></colgroup>

            <tbody>
                <tr><td class="diff_next"><a href="#difflib_chg_to16__0">f</a></td><td class="diff_header" id="from16_1">1</td><td nowrap="nowrap">Carries&nbsp;out&nbsp;batch&nbsp;normalization&nbsp;as&nbsp;described&nbsp;in&nbsp;the&nbsp;paper</td><td class="diff_next"><a href="#difflib_chg_to16__0">f</a></td><td class="diff_header" id="to16_1">1</td><td nowrap="nowrap">Carries&nbsp;out&nbsp;batch&nbsp;normalization&nbsp;as&nbsp;described&nbsp;in&nbsp;the&nbsp;paper</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_2">2</td><td nowrap="nowrap">https://arxiv.org/abs/1502.03167.&nbsp;Depending&nbsp;on&nbsp;the&nbsp;mode&nbsp;it&nbsp;is&nbsp;being&nbsp;run,</td><td class="diff_next"></td><td class="diff_header" id="to16_2">2</td><td nowrap="nowrap">https://arxiv.org/abs/1502.03167.&nbsp;Depending&nbsp;on&nbsp;the&nbsp;mode&nbsp;it&nbsp;is&nbsp;being&nbsp;run,</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_3">3</td><td nowrap="nowrap">There&nbsp;are&nbsp;five&nbsp;required&nbsp;inputs&nbsp;'X',&nbsp;'scale',&nbsp;'B',&nbsp;'input_mean'&nbsp;and</td><td class="diff_next"></td><td class="diff_header" id="to16_3">3</td><td nowrap="nowrap">There&nbsp;are&nbsp;five&nbsp;required&nbsp;inputs&nbsp;'X',&nbsp;'scale',&nbsp;'B',&nbsp;'input_mean'&nbsp;and</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_4">4</td><td nowrap="nowrap">'input_var'.</td><td class="diff_next"></td><td class="diff_header" id="to16_4">4</td><td nowrap="nowrap">'input_var'.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_5">5</td><td nowrap="nowrap">Note&nbsp;that&nbsp;'input_mean'&nbsp;and&nbsp;'input_var'&nbsp;are&nbsp;expected&nbsp;to&nbsp;be&nbsp;the&nbsp;estimated</td><td class="diff_next"></td><td class="diff_header" id="to16_5">5</td><td nowrap="nowrap">Note&nbsp;that&nbsp;'input_mean'&nbsp;and&nbsp;'input_var'&nbsp;are&nbsp;expected&nbsp;to&nbsp;be&nbsp;the&nbsp;estimated</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_6">6</td><td nowrap="nowrap">statistics&nbsp;in&nbsp;inference&nbsp;mode&nbsp;(training_mode=False,&nbsp;default),</td><td class="diff_next"></td><td class="diff_header" id="to16_6">6</td><td nowrap="nowrap">statistics&nbsp;in&nbsp;inference&nbsp;mode&nbsp;(training_mode=False,&nbsp;default),</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_7">7</td><td nowrap="nowrap">and&nbsp;the&nbsp;running&nbsp;statistics&nbsp;in&nbsp;training&nbsp;mode&nbsp;(training_mode=True).</td><td class="diff_next"></td><td class="diff_header" id="to16_7">7</td><td nowrap="nowrap">and&nbsp;the&nbsp;running&nbsp;statistics&nbsp;in&nbsp;training&nbsp;mode&nbsp;(training_mode=True).</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_8">8</td><td nowrap="nowrap">There&nbsp;are&nbsp;multiple&nbsp;cases&nbsp;for&nbsp;the&nbsp;number&nbsp;of&nbsp;outputs,&nbsp;which&nbsp;we&nbsp;list&nbsp;below:</td><td class="diff_next"></td><td class="diff_header" id="to16_8">8</td><td nowrap="nowrap">There&nbsp;are&nbsp;multiple&nbsp;cases&nbsp;for&nbsp;the&nbsp;number&nbsp;of&nbsp;outputs,&nbsp;which&nbsp;we&nbsp;list&nbsp;below:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_9">9</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to16_9">9</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_10">10</td><td nowrap="nowrap">Output&nbsp;case&nbsp;#1:&nbsp;Y,&nbsp;running_mean,&nbsp;running_var&nbsp;(training_mode=True)</td><td class="diff_next"></td><td class="diff_header" id="to16_10">10</td><td nowrap="nowrap">Output&nbsp;case&nbsp;#1:&nbsp;Y,&nbsp;running_mean,&nbsp;running_var&nbsp;(training_mode=True)</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_11">11</td><td nowrap="nowrap">Output&nbsp;case&nbsp;#2:&nbsp;Y&nbsp;(training_mode=False)</td><td class="diff_next"></td><td class="diff_header" id="to16_11">11</td><td nowrap="nowrap">Output&nbsp;case&nbsp;#2:&nbsp;Y&nbsp;(training_mode=False)</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_12">12</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to16_12">12</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_13">13</td><td nowrap="nowrap">When&nbsp;training_mode=False,&nbsp;extra&nbsp;outputs&nbsp;are&nbsp;invalid.</td><td class="diff_next"></td><td class="diff_header" id="to16_13">13</td><td nowrap="nowrap">When&nbsp;training_mode=False,&nbsp;extra&nbsp;outputs&nbsp;are&nbsp;invalid.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_14">14</td><td nowrap="nowrap">The&nbsp;outputs&nbsp;are&nbsp;updated&nbsp;as&nbsp;follows&nbsp;when&nbsp;training_mode=True:</td><td class="diff_next"></td><td class="diff_header" id="to16_14">14</td><td nowrap="nowrap">The&nbsp;outputs&nbsp;are&nbsp;updated&nbsp;as&nbsp;follows&nbsp;when&nbsp;training_mode=True:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_15">15</td><td nowrap="nowrap">::</td><td class="diff_next"></td><td class="diff_header" id="to16_15">15</td><td nowrap="nowrap">::</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_16">16</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to16_16">16</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_17">17</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;running_mean&nbsp;=&nbsp;input_mean&nbsp;*&nbsp;momentum&nbsp;+&nbsp;current_mean&nbsp;*&nbsp;(1&nbsp;-&nbsp;momentum)</td><td class="diff_next"></td><td class="diff_header" id="to16_17">17</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;running_mean&nbsp;=&nbsp;input_mean&nbsp;*&nbsp;momentum&nbsp;+&nbsp;current_mean&nbsp;*&nbsp;(1&nbsp;-&nbsp;momentum)</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_18">18</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;running_var&nbsp;=&nbsp;input_var&nbsp;*&nbsp;momentum&nbsp;+&nbsp;current_var&nbsp;*&nbsp;(1&nbsp;-&nbsp;momentum)</td><td class="diff_next"></td><td class="diff_header" id="to16_18">18</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;running_var&nbsp;=&nbsp;input_var&nbsp;*&nbsp;momentum&nbsp;+&nbsp;current_var&nbsp;*&nbsp;(1&nbsp;-&nbsp;momentum)</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_19">19</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to16_19">19</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_20">20</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;Y&nbsp;=&nbsp;(X&nbsp;-&nbsp;current_mean)&nbsp;/&nbsp;sqrt(current_var&nbsp;+&nbsp;epsilon)&nbsp;*&nbsp;scale&nbsp;+&nbsp;B</td><td class="diff_next"></td><td class="diff_header" id="to16_20">20</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;Y&nbsp;=&nbsp;(X&nbsp;-&nbsp;current_mean)&nbsp;/&nbsp;sqrt(current_var&nbsp;+&nbsp;epsilon)&nbsp;*&nbsp;scale&nbsp;+&nbsp;B</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_21">21</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to16_21">21</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_22">22</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;where:</td><td class="diff_next"></td><td class="diff_header" id="to16_22">22</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;where:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_23">23</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to16_23">23</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_24">24</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;current_mean&nbsp;=&nbsp;ReduceMean(X,&nbsp;axis=all_except_channel_index)</td><td class="diff_next"></td><td class="diff_header" id="to16_24">24</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;current_mean&nbsp;=&nbsp;ReduceMean(X,&nbsp;axis=all_except_channel_index)</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_25">25</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;current_var&nbsp;=&nbsp;&nbsp;ReduceVar(X,&nbsp;axis=all_except_channel_index)</td><td class="diff_next"></td><td class="diff_header" id="to16_25">25</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;current_var&nbsp;=&nbsp;&nbsp;ReduceVar(X,&nbsp;axis=all_except_channel_index)</td></tr>
                <tr><td class="diff_next" id="difflib_chg_to16__0"></td><td class="diff_header" id="from16_26">26</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to16_26">26</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_27">27</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;Notice&nbsp;that&nbsp;ReduceVar&nbsp;refers&nbsp;to&nbsp;the&nbsp;population&nbsp;variance,&nbsp;and&nbsp;it&nbsp;equals&nbsp;to</td><td class="diff_next"></td><td class="diff_header" id="to16_27">27</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;Notice&nbsp;that&nbsp;ReduceVar&nbsp;refers&nbsp;to&nbsp;the&nbsp;population&nbsp;variance,&nbsp;and&nbsp;it&nbsp;equals&nbsp;to</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_28">28</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;sum(sqrd(x_i&nbsp;-&nbsp;x_avg))&nbsp;/&nbsp;N</td><td class="diff_next"></td><td class="diff_header" id="to16_28">28</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;sum(sqrd(x_i&nbsp;-&nbsp;x_avg))&nbsp;/&nbsp;N</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_29">29</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;N&nbsp;is&nbsp;the&nbsp;population&nbsp;size&nbsp;(this&nbsp;formula&nbsp;does&nbsp;not&nbsp;use&nbsp;sample&nbsp;size&nbsp;N&nbsp;-&nbsp;1).</td><td class="diff_next"></td><td class="diff_header" id="to16_29">29</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;N&nbsp;is&nbsp;the&nbsp;population&nbsp;size&nbsp;(this&nbsp;formula&nbsp;does&nbsp;not&nbsp;use&nbsp;sample&nbsp;size&nbsp;N&nbsp;-&nbsp;1).</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_30">30</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to16_30">30</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to16__1">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to16__1">n</a></td><td class="diff_header" id="to16_31">31</td><td nowrap="nowrap"><span class="diff_add">The&nbsp;computation&nbsp;of&nbsp;ReduceMean&nbsp;and&nbsp;ReduceVar&nbsp;uses&nbsp;float&nbsp;to&nbsp;avoid&nbsp;overflow&nbsp;for&nbsp;float16&nbsp;inputs.</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to16_32">32</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_31">31</td><td nowrap="nowrap">When&nbsp;training_mode=False:</td><td class="diff_next"></td><td class="diff_header" id="to16_33">33</td><td nowrap="nowrap">When&nbsp;training_mode=False:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_32">32</td><td nowrap="nowrap">::</td><td class="diff_next"></td><td class="diff_header" id="to16_34">34</td><td nowrap="nowrap">::</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_33">33</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to16_35">35</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_34">34</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;Y&nbsp;=&nbsp;(X&nbsp;-&nbsp;input_mean)&nbsp;/&nbsp;sqrt(input_var&nbsp;+&nbsp;epsilon)&nbsp;*&nbsp;scale&nbsp;+&nbsp;B</td><td class="diff_next"></td><td class="diff_header" id="to16_36">36</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;Y&nbsp;=&nbsp;(X&nbsp;-&nbsp;input_mean)&nbsp;/&nbsp;sqrt(input_var&nbsp;+&nbsp;epsilon)&nbsp;*&nbsp;scale&nbsp;+&nbsp;B</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_35">35</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to16_37">37</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_36">36</td><td nowrap="nowrap">For&nbsp;previous&nbsp;(depreciated)&nbsp;non-spatial&nbsp;cases,&nbsp;implementors&nbsp;are&nbsp;suggested</td><td class="diff_next"></td><td class="diff_header" id="to16_38">38</td><td nowrap="nowrap">For&nbsp;previous&nbsp;(depreciated)&nbsp;non-spatial&nbsp;cases,&nbsp;implementors&nbsp;are&nbsp;suggested</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_37">37</td><td nowrap="nowrap">to&nbsp;flatten&nbsp;the&nbsp;input&nbsp;shape&nbsp;to&nbsp;(N&nbsp;x&nbsp;C&nbsp;*&nbsp;D1&nbsp;*&nbsp;D2&nbsp;*&nbsp;...&nbsp;*&nbsp;Dn)&nbsp;before&nbsp;a&nbsp;BatchNormalization&nbsp;Op.</td><td class="diff_next"></td><td class="diff_header" id="to16_39">39</td><td nowrap="nowrap">to&nbsp;flatten&nbsp;the&nbsp;input&nbsp;shape&nbsp;to&nbsp;(N&nbsp;x&nbsp;C&nbsp;*&nbsp;D1&nbsp;*&nbsp;D2&nbsp;*&nbsp;...&nbsp;*&nbsp;Dn)&nbsp;before&nbsp;a&nbsp;BatchNormalization&nbsp;Op.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_38">38</td><td nowrap="nowrap">This&nbsp;operator&nbsp;has&nbsp;**optional**&nbsp;inputs/outputs.&nbsp;See&nbsp;ONNX&nbsp;&lt;https://github.com/onnx/onnx/blob/master/docs/IR.md&gt;_&nbsp;for&nbsp;more&nbsp;details&nbsp;about&nbsp;the&nbsp;representation&nbsp;of&nbsp;optional&nbsp;arguments.&nbsp;An&nbsp;empty&nbsp;string&nbsp;may&nbsp;be&nbsp;used&nbsp;in&nbsp;the&nbsp;place&nbsp;of&nbsp;an&nbsp;actual&nbsp;argument's&nbsp;name&nbsp;to&nbsp;indicate&nbsp;a&nbsp;missing&nbsp;argument.&nbsp;Trailing&nbsp;optional&nbsp;arguments&nbsp;(those&nbsp;not&nbsp;followed&nbsp;by&nbsp;an&nbsp;argument&nbsp;that&nbsp;is&nbsp;present)&nbsp;may&nbsp;also&nbsp;be&nbsp;simply&nbsp;omitted.</td><td class="diff_next"></td><td class="diff_header" id="to16_40">40</td><td nowrap="nowrap">This&nbsp;operator&nbsp;has&nbsp;**optional**&nbsp;inputs/outputs.&nbsp;See&nbsp;ONNX&nbsp;&lt;https://github.com/onnx/onnx/blob/master/docs/IR.md&gt;_&nbsp;for&nbsp;more&nbsp;details&nbsp;about&nbsp;the&nbsp;representation&nbsp;of&nbsp;optional&nbsp;arguments.&nbsp;An&nbsp;empty&nbsp;string&nbsp;may&nbsp;be&nbsp;used&nbsp;in&nbsp;the&nbsp;place&nbsp;of&nbsp;an&nbsp;actual&nbsp;argument's&nbsp;name&nbsp;to&nbsp;indicate&nbsp;a&nbsp;missing&nbsp;argument.&nbsp;Trailing&nbsp;optional&nbsp;arguments&nbsp;(those&nbsp;not&nbsp;followed&nbsp;by&nbsp;an&nbsp;argument&nbsp;that&nbsp;is&nbsp;present)&nbsp;may&nbsp;also&nbsp;be&nbsp;simply&nbsp;omitted.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_39">39</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to16_41">41</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_40">40</td><td nowrap="nowrap">**Attributes**</td><td class="diff_next"></td><td class="diff_header" id="to16_42">42</td><td nowrap="nowrap">**Attributes**</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_41">41</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to16_43">43</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_42">42</td><td nowrap="nowrap">*&nbsp;**epsilon**:</td><td class="diff_next"></td><td class="diff_header" id="to16_44">44</td><td nowrap="nowrap">*&nbsp;**epsilon**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_43">43</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;epsilon&nbsp;value&nbsp;to&nbsp;use&nbsp;to&nbsp;avoid&nbsp;division&nbsp;by&nbsp;zero.</td><td class="diff_next"></td><td class="diff_header" id="to16_45">45</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;epsilon&nbsp;value&nbsp;to&nbsp;use&nbsp;to&nbsp;avoid&nbsp;division&nbsp;by&nbsp;zero.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_44">44</td><td nowrap="nowrap">*&nbsp;**momentum**:</td><td class="diff_next"></td><td class="diff_header" id="to16_46">46</td><td nowrap="nowrap">*&nbsp;**momentum**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_45">45</td><td nowrap="nowrap">&nbsp;&nbsp;Factor&nbsp;used&nbsp;in&nbsp;computing&nbsp;the&nbsp;running&nbsp;mean&nbsp;and&nbsp;variance.e.g.,</td><td class="diff_next"></td><td class="diff_header" id="to16_47">47</td><td nowrap="nowrap">&nbsp;&nbsp;Factor&nbsp;used&nbsp;in&nbsp;computing&nbsp;the&nbsp;running&nbsp;mean&nbsp;and&nbsp;variance.e.g.,</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_46">46</td><td nowrap="nowrap">&nbsp;&nbsp;running_mean&nbsp;=&nbsp;running_mean&nbsp;*&nbsp;momentum&nbsp;+&nbsp;mean&nbsp;*&nbsp;(1&nbsp;-&nbsp;momentum).</td><td class="diff_next"></td><td class="diff_header" id="to16_48">48</td><td nowrap="nowrap">&nbsp;&nbsp;running_mean&nbsp;=&nbsp;running_mean&nbsp;*&nbsp;momentum&nbsp;+&nbsp;mean&nbsp;*&nbsp;(1&nbsp;-&nbsp;momentum).</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_47">47</td><td nowrap="nowrap">*&nbsp;**training_mode**:</td><td class="diff_next"></td><td class="diff_header" id="to16_49">49</td><td nowrap="nowrap">*&nbsp;**training_mode**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_48">48</td><td nowrap="nowrap">&nbsp;&nbsp;If&nbsp;set&nbsp;to&nbsp;true,&nbsp;it&nbsp;indicates&nbsp;BatchNormalization&nbsp;is&nbsp;being&nbsp;used&nbsp;for</td><td class="diff_next"></td><td class="diff_header" id="to16_50">50</td><td nowrap="nowrap">&nbsp;&nbsp;If&nbsp;set&nbsp;to&nbsp;true,&nbsp;it&nbsp;indicates&nbsp;BatchNormalization&nbsp;is&nbsp;being&nbsp;used&nbsp;for</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_49">49</td><td nowrap="nowrap">&nbsp;&nbsp;training,&nbsp;and&nbsp;outputs&nbsp;1,&nbsp;2,&nbsp;3,&nbsp;and&nbsp;4&nbsp;would&nbsp;be&nbsp;populated.</td><td class="diff_next"></td><td class="diff_header" id="to16_51">51</td><td nowrap="nowrap">&nbsp;&nbsp;training,&nbsp;and&nbsp;outputs&nbsp;1,&nbsp;2,&nbsp;3,&nbsp;and&nbsp;4&nbsp;would&nbsp;be&nbsp;populated.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_50">50</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to16_52">52</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_51">51</td><td nowrap="nowrap">**Inputs**</td><td class="diff_next"></td><td class="diff_header" id="to16_53">53</td><td nowrap="nowrap">**Inputs**</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_52">52</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to16_54">54</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_53">53</td><td nowrap="nowrap">*&nbsp;**X**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to16_55">55</td><td nowrap="nowrap">*&nbsp;**X**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_54">54</td><td nowrap="nowrap">&nbsp;&nbsp;Input&nbsp;data&nbsp;tensor&nbsp;from&nbsp;the&nbsp;previous&nbsp;operator;&nbsp;dimensions&nbsp;are&nbsp;in&nbsp;the</td><td class="diff_next"></td><td class="diff_header" id="to16_56">56</td><td nowrap="nowrap">&nbsp;&nbsp;Input&nbsp;data&nbsp;tensor&nbsp;from&nbsp;the&nbsp;previous&nbsp;operator;&nbsp;dimensions&nbsp;are&nbsp;in&nbsp;the</td></tr>
                <tr><td class="diff_next" id="difflib_chg_to16__1"></td><td class="diff_header" id="from16_55">55</td><td nowrap="nowrap">&nbsp;&nbsp;form&nbsp;of&nbsp;(N&nbsp;x&nbsp;C&nbsp;x&nbsp;D1&nbsp;x&nbsp;D2&nbsp;...&nbsp;Dn),&nbsp;where&nbsp;N&nbsp;is&nbsp;the&nbsp;batch&nbsp;size,&nbsp;C&nbsp;is</td><td class="diff_next"></td><td class="diff_header" id="to16_57">57</td><td nowrap="nowrap">&nbsp;&nbsp;form&nbsp;of&nbsp;(N&nbsp;x&nbsp;C&nbsp;x&nbsp;D1&nbsp;x&nbsp;D2&nbsp;...&nbsp;Dn),&nbsp;where&nbsp;N&nbsp;is&nbsp;the&nbsp;batch&nbsp;size,&nbsp;C&nbsp;is</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_56">56</td><td nowrap="nowrap">&nbsp;&nbsp;the&nbsp;number&nbsp;of&nbsp;channels.&nbsp;Statistics&nbsp;are&nbsp;computed&nbsp;for&nbsp;every&nbsp;channel&nbsp;of</td><td class="diff_next"></td><td class="diff_header" id="to16_58">58</td><td nowrap="nowrap">&nbsp;&nbsp;the&nbsp;number&nbsp;of&nbsp;channels.&nbsp;Statistics&nbsp;are&nbsp;computed&nbsp;for&nbsp;every&nbsp;channel&nbsp;of</td></tr>
                <tr><td class="diff_next" id="difflib_chg_to16__2"></td><td class="diff_header" id="from16_57">57</td><td nowrap="nowrap">&nbsp;&nbsp;C&nbsp;over&nbsp;N&nbsp;and&nbsp;D1&nbsp;to&nbsp;Dn&nbsp;dimensions.&nbsp;For&nbsp;image&nbsp;data,&nbsp;input&nbsp;dimensions</td><td class="diff_next"></td><td class="diff_header" id="to16_59">59</td><td nowrap="nowrap">&nbsp;&nbsp;C&nbsp;over&nbsp;N&nbsp;and&nbsp;D1&nbsp;to&nbsp;Dn&nbsp;dimensions.&nbsp;For&nbsp;image&nbsp;data,&nbsp;input&nbsp;dimensions</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_58">58</td><td nowrap="nowrap">&nbsp;&nbsp;become&nbsp;(N&nbsp;x&nbsp;C&nbsp;x&nbsp;H&nbsp;x&nbsp;W).&nbsp;The&nbsp;op&nbsp;also&nbsp;accepts&nbsp;single&nbsp;dimension&nbsp;input</td><td class="diff_next"></td><td class="diff_header" id="to16_60">60</td><td nowrap="nowrap">&nbsp;&nbsp;become&nbsp;(N&nbsp;x&nbsp;C&nbsp;x&nbsp;H&nbsp;x&nbsp;W).&nbsp;The&nbsp;op&nbsp;also&nbsp;accepts&nbsp;single&nbsp;dimension&nbsp;input</td></tr>
                <tr><td class="diff_next" id="difflib_chg_to16__3"></td><td class="diff_header" id="from16_59">59</td><td nowrap="nowrap">&nbsp;&nbsp;of&nbsp;size&nbsp;N&nbsp;in&nbsp;which&nbsp;case&nbsp;C&nbsp;is&nbsp;assumed&nbsp;to&nbsp;be&nbsp;1</td><td class="diff_next"></td><td class="diff_header" id="to16_61">61</td><td nowrap="nowrap">&nbsp;&nbsp;of&nbsp;size&nbsp;N&nbsp;in&nbsp;which&nbsp;case&nbsp;C&nbsp;is&nbsp;assumed&nbsp;to&nbsp;be&nbsp;1</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to16__2">n</a></td><td class="diff_header" id="from16_60">60</td><td nowrap="nowrap">*&nbsp;**scale**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"><a href="#difflib_chg_to16__2">n</a></td><td class="diff_header" id="to16_62">62</td><td nowrap="nowrap">*&nbsp;**scale**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T<span class="diff_add">1</span>**:</td></tr>
                <tr><td class="diff_next" id="difflib_chg_to16__4"></td><td class="diff_header" id="from16_61">61</td><td nowrap="nowrap">&nbsp;&nbsp;Scale&nbsp;tensor&nbsp;of&nbsp;shape&nbsp;(C).</td><td class="diff_next"></td><td class="diff_header" id="to16_63">63</td><td nowrap="nowrap">&nbsp;&nbsp;Scale&nbsp;tensor&nbsp;of&nbsp;shape&nbsp;(C).</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to16__3">n</a></td><td class="diff_header" id="from16_62">62</td><td nowrap="nowrap">*&nbsp;**B**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"><a href="#difflib_chg_to16__3">n</a></td><td class="diff_header" id="to16_64">64</td><td nowrap="nowrap">*&nbsp;**B**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T<span class="diff_add">1</span>**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_63">63</td><td nowrap="nowrap">&nbsp;&nbsp;Bias&nbsp;tensor&nbsp;of&nbsp;shape&nbsp;(C).</td><td class="diff_next"></td><td class="diff_header" id="to16_65">65</td><td nowrap="nowrap">&nbsp;&nbsp;Bias&nbsp;tensor&nbsp;of&nbsp;shape&nbsp;(C).</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to16__4">n</a></td><td class="diff_header" id="from16_64">64</td><td nowrap="nowrap">*&nbsp;**input_mean**&nbsp;(heterogeneous)&nbsp;-&nbsp;**<span class="diff_chg">U</span>**:</td><td class="diff_next"><a href="#difflib_chg_to16__4">n</a></td><td class="diff_header" id="to16_66">66</td><td nowrap="nowrap">*&nbsp;**input_mean**&nbsp;(heterogeneous)&nbsp;-&nbsp;**<span class="diff_chg">T2</span>**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_65">65</td><td nowrap="nowrap">&nbsp;&nbsp;running&nbsp;(training)&nbsp;or&nbsp;estimated&nbsp;(testing)&nbsp;mean&nbsp;tensor&nbsp;of&nbsp;shape&nbsp;(C).</td><td class="diff_next"></td><td class="diff_header" id="to16_67">67</td><td nowrap="nowrap">&nbsp;&nbsp;running&nbsp;(training)&nbsp;or&nbsp;estimated&nbsp;(testing)&nbsp;mean&nbsp;tensor&nbsp;of&nbsp;shape&nbsp;(C).</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to16__5">n</a></td><td class="diff_header" id="from16_66">66</td><td nowrap="nowrap">*&nbsp;**input_var**&nbsp;(heterogeneous)&nbsp;-&nbsp;**<span class="diff_chg">U</span>**:</td><td class="diff_next"><a href="#difflib_chg_to16__5">n</a></td><td class="diff_header" id="to16_68">68</td><td nowrap="nowrap">*&nbsp;**input_var**&nbsp;(heterogeneous)&nbsp;-&nbsp;**<span class="diff_chg">T2</span>**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_67">67</td><td nowrap="nowrap">&nbsp;&nbsp;running&nbsp;(training)&nbsp;or&nbsp;estimated&nbsp;(testing)&nbsp;variance&nbsp;tensor&nbsp;of&nbsp;shape</td><td class="diff_next"></td><td class="diff_header" id="to16_69">69</td><td nowrap="nowrap">&nbsp;&nbsp;running&nbsp;(training)&nbsp;or&nbsp;estimated&nbsp;(testing)&nbsp;variance&nbsp;tensor&nbsp;of&nbsp;shape</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_68">68</td><td nowrap="nowrap">&nbsp;&nbsp;(C).</td><td class="diff_next"></td><td class="diff_header" id="to16_70">70</td><td nowrap="nowrap">&nbsp;&nbsp;(C).</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_69">69</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to16_71">71</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_70">70</td><td nowrap="nowrap">**Outputs**</td><td class="diff_next"></td><td class="diff_header" id="to16_72">72</td><td nowrap="nowrap">**Outputs**</td></tr>
                <tr><td class="diff_next" id="difflib_chg_to16__5"></td><td class="diff_header" id="from16_71">71</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to16_73">73</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_72">72</td><td nowrap="nowrap">Between&nbsp;1&nbsp;and&nbsp;3&nbsp;outputs.</td><td class="diff_next"></td><td class="diff_header" id="to16_74">74</td><td nowrap="nowrap">Between&nbsp;1&nbsp;and&nbsp;3&nbsp;outputs.</td></tr>
                <tr><td class="diff_next" id="difflib_chg_to16__6"></td><td class="diff_header" id="from16_73">73</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to16_75">75</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_74">74</td><td nowrap="nowrap">*&nbsp;**Y**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to16_76">76</td><td nowrap="nowrap">*&nbsp;**Y**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_75">75</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;output&nbsp;tensor&nbsp;of&nbsp;the&nbsp;same&nbsp;shape&nbsp;as&nbsp;X</td><td class="diff_next"></td><td class="diff_header" id="to16_77">77</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;output&nbsp;tensor&nbsp;of&nbsp;the&nbsp;same&nbsp;shape&nbsp;as&nbsp;X</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to16__6">n</a></td><td class="diff_header" id="from16_76">76</td><td nowrap="nowrap">*&nbsp;**running_mean**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**<span class="diff_chg">U</span>**:</td><td class="diff_next"><a href="#difflib_chg_to16__6">n</a></td><td class="diff_header" id="to16_78">78</td><td nowrap="nowrap">*&nbsp;**running_mean**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**<span class="diff_chg">T2</span>**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_77">77</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;running&nbsp;mean&nbsp;after&nbsp;the&nbsp;BatchNormalization&nbsp;operator.</td><td class="diff_next"></td><td class="diff_header" id="to16_79">79</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;running&nbsp;mean&nbsp;after&nbsp;the&nbsp;BatchNormalization&nbsp;operator.</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to16__7">n</a></td><td class="diff_header" id="from16_78">78</td><td nowrap="nowrap">*&nbsp;**running_var**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**<span class="diff_chg">U</span>**:</td><td class="diff_next"><a href="#difflib_chg_to16__7">n</a></td><td class="diff_header" id="to16_80">80</td><td nowrap="nowrap">*&nbsp;**running_var**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**<span class="diff_chg">T2</span>**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_79">79</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;running&nbsp;variance&nbsp;after&nbsp;the&nbsp;BatchNormalization&nbsp;operator.&nbsp;This&nbsp;op</td><td class="diff_next"></td><td class="diff_header" id="to16_81">81</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;running&nbsp;variance&nbsp;after&nbsp;the&nbsp;BatchNormalization&nbsp;operator.&nbsp;This&nbsp;op</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_80">80</td><td nowrap="nowrap">&nbsp;&nbsp;uses&nbsp;the&nbsp;population&nbsp;size&nbsp;(N)&nbsp;for&nbsp;calculating&nbsp;variance,&nbsp;and&nbsp;not&nbsp;the</td><td class="diff_next"></td><td class="diff_header" id="to16_82">82</td><td nowrap="nowrap">&nbsp;&nbsp;uses&nbsp;the&nbsp;population&nbsp;size&nbsp;(N)&nbsp;for&nbsp;calculating&nbsp;variance,&nbsp;and&nbsp;not&nbsp;the</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_81">81</td><td nowrap="nowrap">&nbsp;&nbsp;sample&nbsp;size&nbsp;N-1.</td><td class="diff_next"></td><td class="diff_header" id="to16_83">83</td><td nowrap="nowrap">&nbsp;&nbsp;sample&nbsp;size&nbsp;N-1.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_82">82</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to16_84">84</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_83">83</td><td nowrap="nowrap">**Type&nbsp;Constraints**</td><td class="diff_next"></td><td class="diff_header" id="to16_85">85</td><td nowrap="nowrap">**Type&nbsp;Constraints**</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_84">84</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to16_86">86</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_85">85</td><td nowrap="nowrap">*&nbsp;**T**&nbsp;in&nbsp;(</td><td class="diff_next"></td><td class="diff_header" id="to16_87">87</td><td nowrap="nowrap">*&nbsp;**T**&nbsp;in&nbsp;(</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_86">86</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(bfloat16),</td><td class="diff_next"></td><td class="diff_header" id="to16_88">88</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(bfloat16),</td></tr>
                <tr><td class="diff_next" id="difflib_chg_to16__7"></td><td class="diff_header" id="from16_87">87</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(double),</td><td class="diff_next"></td><td class="diff_header" id="to16_89">89</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(double),</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_88">88</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(float),</td><td class="diff_next"></td><td class="diff_header" id="to16_90">90</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(float),</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_89">89</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(float16)</td><td class="diff_next"></td><td class="diff_header" id="to16_91">91</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(float16)</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_90">90</td><td nowrap="nowrap">&nbsp;&nbsp;):</td><td class="diff_next"></td><td class="diff_header" id="to16_92">92</td><td nowrap="nowrap">&nbsp;&nbsp;):</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_91">91</td><td nowrap="nowrap">&nbsp;&nbsp;Constrain&nbsp;input&nbsp;and&nbsp;output&nbsp;types&nbsp;to&nbsp;float&nbsp;tensors.</td><td class="diff_next"></td><td class="diff_header" id="to16_93">93</td><td nowrap="nowrap">&nbsp;&nbsp;Constrain&nbsp;input&nbsp;and&nbsp;output&nbsp;types&nbsp;to&nbsp;float&nbsp;tensors.</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to16__8">n</a></td><td class="diff_header" id="from16_92">92</td><td nowrap="nowrap">*&nbsp;**<span class="diff_chg">U</span>**&nbsp;in&nbsp;(</td><td class="diff_next"><a href="#difflib_chg_to16__8">n</a></td><td class="diff_header" id="to16_94">94</td><td nowrap="nowrap">*&nbsp;**<span class="diff_chg">T1</span>**&nbsp;in&nbsp;(</td></tr>
                <tr><td class="diff_next" id="difflib_chg_to16__8"></td><td class="diff_header" id="from16_93">93</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(bfloat16),</td><td class="diff_next"></td><td class="diff_header" id="to16_95">95</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(bfloat16),</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_94">94</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(double),</td><td class="diff_next"></td><td class="diff_header" id="to16_96">96</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(double),</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_95">95</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(float),</td><td class="diff_next"></td><td class="diff_header" id="to16_97">97</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(float),</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_96">96</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(float16)</td><td class="diff_next"></td><td class="diff_header" id="to16_98">98</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(float16)</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_97">97</td><td nowrap="nowrap">&nbsp;&nbsp;):</td><td class="diff_next"></td><td class="diff_header" id="to16_99">99</td><td nowrap="nowrap">&nbsp;&nbsp;):</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to16__top">t</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to16__top">t</a></td><td class="diff_header" id="to16_100">100</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;Constrain&nbsp;scale&nbsp;and&nbsp;bias&nbsp;types&nbsp;to&nbsp;float&nbsp;tensors.</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to16_101">101</td><td nowrap="nowrap"><span class="diff_add">*&nbsp;**T2**&nbsp;in&nbsp;(</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to16_102">102</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;tensor(bfloat16),</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to16_103">103</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;tensor(double),</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to16_104">104</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;tensor(float),</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to16_105">105</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;tensor(float16)</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to16_106">106</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;):</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_98">98</td><td nowrap="nowrap">&nbsp;&nbsp;Constrain&nbsp;mean&nbsp;and&nbsp;variance&nbsp;types&nbsp;to&nbsp;float&nbsp;tensors.<span class="diff_sub">&nbsp;It&nbsp;allows&nbsp;all</span></td><td class="diff_next"></td><td class="diff_header" id="to16_107">107</td><td nowrap="nowrap">&nbsp;&nbsp;Constrain&nbsp;mean&nbsp;and&nbsp;variance&nbsp;types&nbsp;to&nbsp;float&nbsp;tensors.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from16_99">99</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;float&nbsp;type&nbsp;for&nbsp;U.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            </tbody>
        </table>

.. _l-onnx-op-batchnormalization-14:

BatchNormalization - 14
=======================

**Version**

* **name**: `BatchNormalization (GitHub) <https://github.com/onnx/onnx/blob/main/docs/Operators.md#BatchNormalization>`_
* **domain**: **main**
* **since_version**: **14**
* **function**: False
* **support_level**: SupportType.COMMON
* **shape inference**: True

This version of the operator has been available
**since version 14**.

**Summary**

Carries out batch normalization as described in the paper
https://arxiv.org/abs/1502.03167. Depending on the mode it is being run,
There are five required inputs 'X', 'scale', 'B', 'input_mean' and
'input_var'.
Note that 'input_mean' and 'input_var' are expected to be the estimated
statistics in inference mode (training_mode=False, default),
and the running statistics in training mode (training_mode=True).
There are multiple cases for the number of outputs, which we list below:

Output case #1: Y, running_mean, running_var (training_mode=True)
Output case #2: Y (training_mode=False)

When training_mode=False, extra outputs are invalid.
The outputs are updated as follows when training_mode=True:
::

    running_mean = input_mean * momentum + current_mean * (1 - momentum)
    running_var = input_var * momentum + current_var * (1 - momentum)

    Y = (X - current_mean) / sqrt(current_var + epsilon) * scale + B

    where:

    current_mean = ReduceMean(X, axis=all_except_channel_index)
    current_var =  ReduceVar(X, axis=all_except_channel_index)

    Notice that ReduceVar refers to the population variance, and it equals to
    sum(sqrd(x_i - x_avg)) / N
    where N is the population size (this formula does not use sample size N - 1).

When training_mode=False:
::

    Y = (X - input_mean) / sqrt(input_var + epsilon) * scale + B

For previous (depreciated) non-spatial cases, implementors are suggested
to flatten the input shape to (N x C * D1 * D2 * ... * Dn) before a BatchNormalization Op.
This operator has **optional** inputs/outputs. See `ONNX <https://github.com/onnx/onnx/blob/master/docs/IR.md>`_ for more details about the representation of optional arguments. An empty string may be used in the place of an actual argument's name to indicate a missing argument. Trailing optional arguments (those not followed by an argument that is present) may also be simply omitted.

**Attributes**

* **epsilon**:
  The epsilon value to use to avoid division by zero.
* **momentum**:
  Factor used in computing the running mean and variance.e.g.,
  running_mean = running_mean * momentum + mean * (1 - momentum).
* **training_mode**:
  If set to true, it indicates BatchNormalization is being used for
  training, and outputs 1, 2, 3, and 4 would be populated.

**Inputs**

* **X** (heterogeneous) - **T**:
  Input data tensor from the previous operator; dimensions are in the
  form of (N x C x D1 x D2 ... Dn), where N is the batch size, C is
  the number of channels. Statistics are computed for every channel of
  C over N and D1 to Dn dimensions. For image data, input dimensions
  become (N x C x H x W). The op also accepts single dimension input
  of size N in which case C is assumed to be 1
* **scale** (heterogeneous) - **T**:
  Scale tensor of shape (C).
* **B** (heterogeneous) - **T**:
  Bias tensor of shape (C).
* **input_mean** (heterogeneous) - **U**:
  running (training) or estimated (testing) mean tensor of shape (C).
* **input_var** (heterogeneous) - **U**:
  running (training) or estimated (testing) variance tensor of shape
  (C).

**Outputs**

Between 1 and 3 outputs.

* **Y** (heterogeneous) - **T**:
  The output tensor of the same shape as X
* **running_mean** (optional, heterogeneous) - **U**:
  The running mean after the BatchNormalization operator.
* **running_var** (optional, heterogeneous) - **U**:
  The running variance after the BatchNormalization operator. This op
  uses the population size (N) for calculating variance, and not the
  sample size N-1.

**Type Constraints**

* **T** in (
  tensor(bfloat16),
  tensor(double),
  tensor(float),
  tensor(float16)
  ):
  Constrain input and output types to float tensors.
* **U** in (
  tensor(bfloat16),
  tensor(double),
  tensor(float),
  tensor(float16)
  ):
  Constrain mean and variance types to float tensors. It allows all
  float type for U.

**Differences**

.. raw:: html

        <table class="diff" id="difflib_chg_to17__top"
               cellspacing="0" cellpadding="0" rules="groups" >
            <colgroup></colgroup> <colgroup></colgroup> <colgroup></colgroup>
            <colgroup></colgroup> <colgroup></colgroup> <colgroup></colgroup>

            <tbody>
                <tr><td class="diff_next" id="difflib_chg_to17__0"><a href="#difflib_chg_to17__0">f</a></td><td class="diff_header" id="from17_1">1</td><td nowrap="nowrap">Carries&nbsp;out&nbsp;batch&nbsp;normalization&nbsp;as&nbsp;described&nbsp;in&nbsp;the&nbsp;paper</td><td class="diff_next"><a href="#difflib_chg_to17__0">f</a></td><td class="diff_header" id="to17_1">1</td><td nowrap="nowrap">Carries&nbsp;out&nbsp;batch&nbsp;normalization&nbsp;as&nbsp;described&nbsp;in&nbsp;the&nbsp;paper</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_2">2</td><td nowrap="nowrap">https://arxiv.org/abs/1502.03167.&nbsp;Depending&nbsp;on&nbsp;the&nbsp;mode&nbsp;it&nbsp;is&nbsp;being&nbsp;run,</td><td class="diff_next"></td><td class="diff_header" id="to17_2">2</td><td nowrap="nowrap">https://arxiv.org/abs/1502.03167.&nbsp;Depending&nbsp;on&nbsp;the&nbsp;mode&nbsp;it&nbsp;is&nbsp;being&nbsp;run,</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to17__1">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to17__1">n</a></td><td class="diff_header" id="to17_3">3</td><td nowrap="nowrap"><span class="diff_add">There&nbsp;are&nbsp;five&nbsp;required&nbsp;inputs&nbsp;'X',&nbsp;'scale',&nbsp;'B',&nbsp;'input_mean'&nbsp;and</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_4">4</td><td nowrap="nowrap"><span class="diff_add">'input_var'.</span></td></tr>
                <tr><td class="diff_next" id="difflib_chg_to17__1"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_5">5</td><td nowrap="nowrap"><span class="diff_add">Note&nbsp;that&nbsp;'input_mean'&nbsp;and&nbsp;'input_var'&nbsp;are&nbsp;expected&nbsp;to&nbsp;be&nbsp;the&nbsp;estimated</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_6">6</td><td nowrap="nowrap"><span class="diff_add">statistics&nbsp;in&nbsp;inference&nbsp;mode&nbsp;(training_mode=False,&nbsp;default),</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_7">7</td><td nowrap="nowrap"><span class="diff_add">and&nbsp;the&nbsp;running&nbsp;statistics&nbsp;in&nbsp;training&nbsp;mode&nbsp;(training_mode=True).</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_3">3</td><td nowrap="nowrap"><span class="diff_chg">t</span>here&nbsp;are&nbsp;multiple&nbsp;cases&nbsp;for&nbsp;the&nbsp;number&nbsp;of&nbsp;outputs,&nbsp;which&nbsp;we&nbsp;list&nbsp;below:</td><td class="diff_next"></td><td class="diff_header" id="to17_8">8</td><td nowrap="nowrap"><span class="diff_chg">T</span>here&nbsp;are&nbsp;multiple&nbsp;cases&nbsp;for&nbsp;the&nbsp;number&nbsp;of&nbsp;outputs,&nbsp;which&nbsp;we&nbsp;list&nbsp;below:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_4">4</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_9">9</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to17__2">n</a></td><td class="diff_header" id="from17_5">5</td><td nowrap="nowrap"><span class="diff_sub">Output&nbsp;case&nbsp;#1:&nbsp;Y,&nbsp;mean,&nbsp;var,&nbsp;saved_mean,&nbsp;saved_var&nbsp;(training&nbsp;mode)</span></td><td class="diff_next"><a href="#difflib_chg_to17__2">n</a></td><td class="diff_header" id="to17_10">10</td><td nowrap="nowrap"><span class="diff_add">Output&nbsp;case&nbsp;#1:&nbsp;Y,&nbsp;running_mean,&nbsp;running_var&nbsp;(training_mode=True)</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_6">6</td><td nowrap="nowrap"><span class="diff_sub">Output&nbsp;case&nbsp;#2:&nbsp;Y&nbsp;(test&nbsp;mode)</span></td><td class="diff_next"></td><td class="diff_header" id="to17_11">11</td><td nowrap="nowrap"><span class="diff_add">Output&nbsp;case&nbsp;#2:&nbsp;Y&nbsp;(training_mode=False)</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_12">12</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_13">13</td><td nowrap="nowrap"><span class="diff_add">When&nbsp;training_mode=False,&nbsp;extra&nbsp;outputs&nbsp;are&nbsp;invalid.</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_14">14</td><td nowrap="nowrap"><span class="diff_add">The&nbsp;outputs&nbsp;are&nbsp;updated&nbsp;as&nbsp;follows&nbsp;when&nbsp;training_mode=True:</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_15">15</td><td nowrap="nowrap"><span class="diff_add">::</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_16">16</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_17">17</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;running_mean&nbsp;=&nbsp;input_mean&nbsp;*&nbsp;momentum&nbsp;+&nbsp;current_mean&nbsp;*&nbsp;(1&nbsp;-&nbsp;momentum)</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_18">18</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;running_var&nbsp;=&nbsp;input_var&nbsp;*&nbsp;momentum&nbsp;+&nbsp;current_var&nbsp;*&nbsp;(1&nbsp;-&nbsp;momentum)</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_19">19</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_20">20</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;Y&nbsp;=&nbsp;(X&nbsp;-&nbsp;current_mean)&nbsp;/&nbsp;sqrt(current_var&nbsp;+&nbsp;epsilon)&nbsp;*&nbsp;scale&nbsp;+&nbsp;B</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_21">21</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_22">22</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;where:</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_23">23</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_24">24</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;current_mean&nbsp;=&nbsp;ReduceMean(X,&nbsp;axis=all_except_channel_index)</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_25">25</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;current_var&nbsp;=&nbsp;&nbsp;ReduceVar(X,&nbsp;axis=all_except_channel_index)</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_26">26</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_27">27</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;Notice&nbsp;that&nbsp;ReduceVar&nbsp;refers&nbsp;to&nbsp;the&nbsp;population&nbsp;variance,&nbsp;and&nbsp;it&nbsp;equals&nbsp;to</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_28">28</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;sum(sqrd(x_i&nbsp;-&nbsp;x_avg))&nbsp;/&nbsp;N</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_29">29</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;N&nbsp;is&nbsp;the&nbsp;population&nbsp;size&nbsp;(this&nbsp;formula&nbsp;does&nbsp;not&nbsp;use&nbsp;sample&nbsp;size&nbsp;N&nbsp;-&nbsp;1).</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_30">30</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_31">31</td><td nowrap="nowrap"><span class="diff_add">When&nbsp;training_mode=False:</span></td></tr>
                <tr><td class="diff_next" id="difflib_chg_to17__2"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_32">32</td><td nowrap="nowrap"><span class="diff_add">::</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_33">33</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_34">34</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;Y&nbsp;=&nbsp;(X&nbsp;-&nbsp;input_mean)&nbsp;/&nbsp;sqrt(input_var&nbsp;+&nbsp;epsilon)&nbsp;*&nbsp;scale&nbsp;+&nbsp;B</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_7">7</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_35">35</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_8">8</td><td nowrap="nowrap">For&nbsp;previous&nbsp;(depreciated)&nbsp;non-spatial&nbsp;cases,&nbsp;implementors&nbsp;are&nbsp;suggested</td><td class="diff_next"></td><td class="diff_header" id="to17_36">36</td><td nowrap="nowrap">For&nbsp;previous&nbsp;(depreciated)&nbsp;non-spatial&nbsp;cases,&nbsp;implementors&nbsp;are&nbsp;suggested</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to17__3">n</a></td><td class="diff_header" id="from17_9">9</td><td nowrap="nowrap">to&nbsp;flatten&nbsp;the&nbsp;input&nbsp;shape&nbsp;to&nbsp;(N&nbsp;x&nbsp;C*D1*D2&nbsp;..*Dn)&nbsp;before&nbsp;a&nbsp;BatchNormalization&nbsp;Op.</td><td class="diff_next"><a href="#difflib_chg_to17__3">n</a></td><td class="diff_header" id="to17_37">37</td><td nowrap="nowrap">to&nbsp;flatten&nbsp;the&nbsp;input&nbsp;shape&nbsp;to&nbsp;(N&nbsp;x&nbsp;C<span class="diff_add">&nbsp;</span>*<span class="diff_add">&nbsp;</span>D1<span class="diff_add">&nbsp;</span>*<span class="diff_add">&nbsp;</span>D2&nbsp;<span class="diff_add">*&nbsp;</span>..<span class="diff_add">.&nbsp;</span>*<span class="diff_add">&nbsp;</span>Dn)&nbsp;before&nbsp;a&nbsp;BatchNormalization&nbsp;Op.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_10">10</td><td nowrap="nowrap">This&nbsp;operator&nbsp;has&nbsp;**optional**&nbsp;inputs/outputs.&nbsp;See&nbsp;ONNX&nbsp;&lt;https://github.com/onnx/onnx/blob/master/docs/IR.md&gt;_&nbsp;for&nbsp;more&nbsp;details&nbsp;about&nbsp;the&nbsp;representation&nbsp;of&nbsp;optional&nbsp;arguments.&nbsp;An&nbsp;empty&nbsp;string&nbsp;may&nbsp;be&nbsp;used&nbsp;in&nbsp;the&nbsp;place&nbsp;of&nbsp;an&nbsp;actual&nbsp;argument's&nbsp;name&nbsp;to&nbsp;indicate&nbsp;a&nbsp;missing&nbsp;argument.&nbsp;Trailing&nbsp;optional&nbsp;arguments&nbsp;(those&nbsp;not&nbsp;followed&nbsp;by&nbsp;an&nbsp;argument&nbsp;that&nbsp;is&nbsp;present)&nbsp;may&nbsp;also&nbsp;be&nbsp;simply&nbsp;omitted.</td><td class="diff_next"></td><td class="diff_header" id="to17_38">38</td><td nowrap="nowrap">This&nbsp;operator&nbsp;has&nbsp;**optional**&nbsp;inputs/outputs.&nbsp;See&nbsp;ONNX&nbsp;&lt;https://github.com/onnx/onnx/blob/master/docs/IR.md&gt;_&nbsp;for&nbsp;more&nbsp;details&nbsp;about&nbsp;the&nbsp;representation&nbsp;of&nbsp;optional&nbsp;arguments.&nbsp;An&nbsp;empty&nbsp;string&nbsp;may&nbsp;be&nbsp;used&nbsp;in&nbsp;the&nbsp;place&nbsp;of&nbsp;an&nbsp;actual&nbsp;argument's&nbsp;name&nbsp;to&nbsp;indicate&nbsp;a&nbsp;missing&nbsp;argument.&nbsp;Trailing&nbsp;optional&nbsp;arguments&nbsp;(those&nbsp;not&nbsp;followed&nbsp;by&nbsp;an&nbsp;argument&nbsp;that&nbsp;is&nbsp;present)&nbsp;may&nbsp;also&nbsp;be&nbsp;simply&nbsp;omitted.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_11">11</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_39">39</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_12">12</td><td nowrap="nowrap">**Attributes**</td><td class="diff_next"></td><td class="diff_header" id="to17_40">40</td><td nowrap="nowrap">**Attributes**</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_13">13</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_41">41</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next" id="difflib_chg_to17__3"></td><td class="diff_header" id="from17_14">14</td><td nowrap="nowrap">*&nbsp;**epsilon**:</td><td class="diff_next"></td><td class="diff_header" id="to17_42">42</td><td nowrap="nowrap">*&nbsp;**epsilon**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_15">15</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;epsilon&nbsp;value&nbsp;to&nbsp;use&nbsp;to&nbsp;avoid&nbsp;division&nbsp;by&nbsp;zero.</td><td class="diff_next"></td><td class="diff_header" id="to17_43">43</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;epsilon&nbsp;value&nbsp;to&nbsp;use&nbsp;to&nbsp;avoid&nbsp;division&nbsp;by&nbsp;zero.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_16">16</td><td nowrap="nowrap">*&nbsp;**momentum**:</td><td class="diff_next"></td><td class="diff_header" id="to17_44">44</td><td nowrap="nowrap">*&nbsp;**momentum**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_17">17</td><td nowrap="nowrap">&nbsp;&nbsp;Factor&nbsp;used&nbsp;in&nbsp;computing&nbsp;the&nbsp;running&nbsp;mean&nbsp;and&nbsp;variance.e.g.,</td><td class="diff_next"></td><td class="diff_header" id="to17_45">45</td><td nowrap="nowrap">&nbsp;&nbsp;Factor&nbsp;used&nbsp;in&nbsp;computing&nbsp;the&nbsp;running&nbsp;mean&nbsp;and&nbsp;variance.e.g.,</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_18">18</td><td nowrap="nowrap">&nbsp;&nbsp;running_mean&nbsp;=&nbsp;running_mean&nbsp;*&nbsp;momentum&nbsp;+&nbsp;mean&nbsp;*&nbsp;(1&nbsp;-&nbsp;momentum).</td><td class="diff_next"></td><td class="diff_header" id="to17_46">46</td><td nowrap="nowrap">&nbsp;&nbsp;running_mean&nbsp;=&nbsp;running_mean&nbsp;*&nbsp;momentum&nbsp;+&nbsp;mean&nbsp;*&nbsp;(1&nbsp;-&nbsp;momentum).</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to17__4">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to17__4">n</a></td><td class="diff_header" id="to17_47">47</td><td nowrap="nowrap"><span class="diff_add">*&nbsp;**training_mode**:</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_48">48</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;If&nbsp;set&nbsp;to&nbsp;true,&nbsp;it&nbsp;indicates&nbsp;BatchNormalization&nbsp;is&nbsp;being&nbsp;used&nbsp;for</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_49">49</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;training,&nbsp;and&nbsp;outputs&nbsp;1,&nbsp;2,&nbsp;3,&nbsp;and&nbsp;4&nbsp;would&nbsp;be&nbsp;populated.</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_19">19</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_50">50</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_20">20</td><td nowrap="nowrap">**Inputs**</td><td class="diff_next"></td><td class="diff_header" id="to17_51">51</td><td nowrap="nowrap">**Inputs**</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_21">21</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_52">52</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_22">22</td><td nowrap="nowrap">*&nbsp;**X**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to17_53">53</td><td nowrap="nowrap">*&nbsp;**X**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_23">23</td><td nowrap="nowrap">&nbsp;&nbsp;Input&nbsp;data&nbsp;tensor&nbsp;from&nbsp;the&nbsp;previous&nbsp;operator;&nbsp;dimensions&nbsp;are&nbsp;in&nbsp;the</td><td class="diff_next"></td><td class="diff_header" id="to17_54">54</td><td nowrap="nowrap">&nbsp;&nbsp;Input&nbsp;data&nbsp;tensor&nbsp;from&nbsp;the&nbsp;previous&nbsp;operator;&nbsp;dimensions&nbsp;are&nbsp;in&nbsp;the</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_24">24</td><td nowrap="nowrap">&nbsp;&nbsp;form&nbsp;of&nbsp;(N&nbsp;x&nbsp;C&nbsp;x&nbsp;D1&nbsp;x&nbsp;D2&nbsp;...&nbsp;Dn),&nbsp;where&nbsp;N&nbsp;is&nbsp;the&nbsp;batch&nbsp;size,&nbsp;C&nbsp;is</td><td class="diff_next"></td><td class="diff_header" id="to17_55">55</td><td nowrap="nowrap">&nbsp;&nbsp;form&nbsp;of&nbsp;(N&nbsp;x&nbsp;C&nbsp;x&nbsp;D1&nbsp;x&nbsp;D2&nbsp;...&nbsp;Dn),&nbsp;where&nbsp;N&nbsp;is&nbsp;the&nbsp;batch&nbsp;size,&nbsp;C&nbsp;is</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_25">25</td><td nowrap="nowrap">&nbsp;&nbsp;the&nbsp;number&nbsp;of&nbsp;channels.&nbsp;Statistics&nbsp;are&nbsp;computed&nbsp;for&nbsp;every&nbsp;channel&nbsp;of</td><td class="diff_next"></td><td class="diff_header" id="to17_56">56</td><td nowrap="nowrap">&nbsp;&nbsp;the&nbsp;number&nbsp;of&nbsp;channels.&nbsp;Statistics&nbsp;are&nbsp;computed&nbsp;for&nbsp;every&nbsp;channel&nbsp;of</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_26">26</td><td nowrap="nowrap">&nbsp;&nbsp;C&nbsp;over&nbsp;N&nbsp;and&nbsp;D1&nbsp;to&nbsp;Dn&nbsp;dimensions.&nbsp;For&nbsp;image&nbsp;data,&nbsp;input&nbsp;dimensions</td><td class="diff_next"></td><td class="diff_header" id="to17_57">57</td><td nowrap="nowrap">&nbsp;&nbsp;C&nbsp;over&nbsp;N&nbsp;and&nbsp;D1&nbsp;to&nbsp;Dn&nbsp;dimensions.&nbsp;For&nbsp;image&nbsp;data,&nbsp;input&nbsp;dimensions</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_27">27</td><td nowrap="nowrap">&nbsp;&nbsp;become&nbsp;(N&nbsp;x&nbsp;C&nbsp;x&nbsp;H&nbsp;x&nbsp;W).&nbsp;The&nbsp;op&nbsp;also&nbsp;accepts&nbsp;single&nbsp;dimension&nbsp;input</td><td class="diff_next"></td><td class="diff_header" id="to17_58">58</td><td nowrap="nowrap">&nbsp;&nbsp;become&nbsp;(N&nbsp;x&nbsp;C&nbsp;x&nbsp;H&nbsp;x&nbsp;W).&nbsp;The&nbsp;op&nbsp;also&nbsp;accepts&nbsp;single&nbsp;dimension&nbsp;input</td></tr>
                <tr><td class="diff_next" id="difflib_chg_to17__4"></td><td class="diff_header" id="from17_28">28</td><td nowrap="nowrap">&nbsp;&nbsp;of&nbsp;size&nbsp;N&nbsp;in&nbsp;which&nbsp;case&nbsp;C&nbsp;is&nbsp;assumed&nbsp;to&nbsp;be&nbsp;1</td><td class="diff_next"></td><td class="diff_header" id="to17_59">59</td><td nowrap="nowrap">&nbsp;&nbsp;of&nbsp;size&nbsp;N&nbsp;in&nbsp;which&nbsp;case&nbsp;C&nbsp;is&nbsp;assumed&nbsp;to&nbsp;be&nbsp;1</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_29">29</td><td nowrap="nowrap">*&nbsp;**scale**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to17_60">60</td><td nowrap="nowrap">*&nbsp;**scale**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next" id="difflib_chg_to17__5"></td><td class="diff_header" id="from17_30">30</td><td nowrap="nowrap">&nbsp;&nbsp;Scale&nbsp;tensor&nbsp;of&nbsp;shape&nbsp;(C).</td><td class="diff_next"></td><td class="diff_header" id="to17_61">61</td><td nowrap="nowrap">&nbsp;&nbsp;Scale&nbsp;tensor&nbsp;of&nbsp;shape&nbsp;(C).</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_31">31</td><td nowrap="nowrap">*&nbsp;**B**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to17_62">62</td><td nowrap="nowrap">*&nbsp;**B**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_32">32</td><td nowrap="nowrap">&nbsp;&nbsp;Bias&nbsp;tensor&nbsp;of&nbsp;shape&nbsp;(C).</td><td class="diff_next"></td><td class="diff_header" id="to17_63">63</td><td nowrap="nowrap">&nbsp;&nbsp;Bias&nbsp;tensor&nbsp;of&nbsp;shape&nbsp;(C).</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to17__5">n</a></td><td class="diff_header" id="from17_33">33</td><td nowrap="nowrap">*&nbsp;**mean**&nbsp;(heterogeneous)&nbsp;-&nbsp;**<span class="diff_chg">T</span>**:</td><td class="diff_next"><a href="#difflib_chg_to17__5">n</a></td><td class="diff_header" id="to17_64">64</td><td nowrap="nowrap">*&nbsp;**<span class="diff_add">input_</span>mean**&nbsp;(heterogeneous)&nbsp;-&nbsp;**<span class="diff_chg">U</span>**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_34">34</td><td nowrap="nowrap">&nbsp;&nbsp;running&nbsp;(training)&nbsp;or&nbsp;estimated&nbsp;(testing)&nbsp;mean&nbsp;tensor&nbsp;of&nbsp;shape&nbsp;(C).</td><td class="diff_next"></td><td class="diff_header" id="to17_65">65</td><td nowrap="nowrap">&nbsp;&nbsp;running&nbsp;(training)&nbsp;or&nbsp;estimated&nbsp;(testing)&nbsp;mean&nbsp;tensor&nbsp;of&nbsp;shape&nbsp;(C).</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to17__6">n</a></td><td class="diff_header" id="from17_35">35</td><td nowrap="nowrap">*&nbsp;**var**&nbsp;(heterogeneous)&nbsp;-&nbsp;**<span class="diff_chg">T</span>**:</td><td class="diff_next"><a href="#difflib_chg_to17__6">n</a></td><td class="diff_header" id="to17_66">66</td><td nowrap="nowrap">*&nbsp;**<span class="diff_add">input_</span>var**&nbsp;(heterogeneous)&nbsp;-&nbsp;**<span class="diff_chg">U</span>**:</td></tr>
                <tr><td class="diff_next" id="difflib_chg_to17__6"></td><td class="diff_header" id="from17_36">36</td><td nowrap="nowrap">&nbsp;&nbsp;running&nbsp;(training)&nbsp;or&nbsp;estimated&nbsp;(testing)&nbsp;variance&nbsp;tensor&nbsp;of&nbsp;shape</td><td class="diff_next"></td><td class="diff_header" id="to17_67">67</td><td nowrap="nowrap">&nbsp;&nbsp;running&nbsp;(training)&nbsp;or&nbsp;estimated&nbsp;(testing)&nbsp;variance&nbsp;tensor&nbsp;of&nbsp;shape</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_37">37</td><td nowrap="nowrap">&nbsp;&nbsp;(C).</td><td class="diff_next"></td><td class="diff_header" id="to17_68">68</td><td nowrap="nowrap">&nbsp;&nbsp;(C).</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_38">38</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_69">69</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_39">39</td><td nowrap="nowrap">**Outputs**</td><td class="diff_next"></td><td class="diff_header" id="to17_70">70</td><td nowrap="nowrap">**Outputs**</td></tr>
                <tr><td class="diff_next" id="difflib_chg_to17__7"></td><td class="diff_header" id="from17_40">40</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_71">71</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to17__7">n</a></td><td class="diff_header" id="from17_41">41</td><td nowrap="nowrap">Between&nbsp;1&nbsp;and&nbsp;<span class="diff_chg">5</span>&nbsp;outputs.</td><td class="diff_next"><a href="#difflib_chg_to17__7">n</a></td><td class="diff_header" id="to17_72">72</td><td nowrap="nowrap">Between&nbsp;1&nbsp;and&nbsp;<span class="diff_chg">3</span>&nbsp;outputs.</td></tr>
                <tr><td class="diff_next" id="difflib_chg_to17__8"></td><td class="diff_header" id="from17_42">42</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_73">73</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_43">43</td><td nowrap="nowrap">*&nbsp;**Y**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to17_74">74</td><td nowrap="nowrap">*&nbsp;**Y**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_44">44</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;output&nbsp;tensor&nbsp;of&nbsp;the&nbsp;same&nbsp;shape&nbsp;as&nbsp;X</td><td class="diff_next"></td><td class="diff_header" id="to17_75">75</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;output&nbsp;tensor&nbsp;of&nbsp;the&nbsp;same&nbsp;shape&nbsp;as&nbsp;X</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to17__8">n</a></td><td class="diff_header" id="from17_45">45</td><td nowrap="nowrap">*&nbsp;**mean**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**<span class="diff_chg">T</span>**:</td><td class="diff_next"><a href="#difflib_chg_to17__8">n</a></td><td class="diff_header" id="to17_76">76</td><td nowrap="nowrap">*&nbsp;**<span class="diff_add">running_</span>mean**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**<span class="diff_chg">U</span>**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_46">46</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;running&nbsp;mean&nbsp;after&nbsp;the&nbsp;BatchNormalization&nbsp;operator.</td><td class="diff_next"></td><td class="diff_header" id="to17_77">77</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;running&nbsp;mean&nbsp;after&nbsp;the&nbsp;BatchNormalization&nbsp;operator.</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to17__9">n</a></td><td class="diff_header" id="from17_47">47</td><td nowrap="nowrap">*&nbsp;**var**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**<span class="diff_chg">T</span>**:</td><td class="diff_next"><a href="#difflib_chg_to17__9">n</a></td><td class="diff_header" id="to17_78">78</td><td nowrap="nowrap">*&nbsp;**<span class="diff_add">running_</span>var**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**<span class="diff_chg">U</span>**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_48">48</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;running&nbsp;variance&nbsp;after&nbsp;the&nbsp;BatchNormalization&nbsp;operator.</td><td class="diff_next"></td><td class="diff_header" id="to17_79">79</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;running&nbsp;variance&nbsp;after&nbsp;the&nbsp;BatchNormalization&nbsp;operator.<span class="diff_add">&nbsp;This&nbsp;op</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_49">49</td><td nowrap="nowrap"><span class="diff_sub">*&nbsp;**saved_mean**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**T**:</span></td><td class="diff_next"></td><td class="diff_header" id="to17_80">80</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;uses&nbsp;the&nbsp;population&nbsp;size&nbsp;(N)&nbsp;for&nbsp;calculating&nbsp;variance,&nbsp;and&nbsp;not&nbsp;the</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_50">50</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;Saved&nbsp;mean&nbsp;used&nbsp;during&nbsp;training&nbsp;to&nbsp;speed&nbsp;up&nbsp;gradient&nbsp;computation.</span></td><td class="diff_next"></td><td class="diff_header" id="to17_81">81</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;sample&nbsp;size&nbsp;N-1.</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_51">51</td><td nowrap="nowrap"><span class="diff_sub">*&nbsp;**saved_var**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**T**:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_52">52</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;Saved&nbsp;variance&nbsp;used&nbsp;during&nbsp;training&nbsp;to&nbsp;speed&nbsp;up&nbsp;gradient</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next" id="difflib_chg_to17__9"></td><td class="diff_header" id="from17_53">53</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;computation.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_54">54</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_82">82</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_55">55</td><td nowrap="nowrap">**Type&nbsp;Constraints**</td><td class="diff_next"></td><td class="diff_header" id="to17_83">83</td><td nowrap="nowrap">**Type&nbsp;Constraints**</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_56">56</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_84">84</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_57">57</td><td nowrap="nowrap">*&nbsp;**T**&nbsp;in&nbsp;(</td><td class="diff_next"></td><td class="diff_header" id="to17_85">85</td><td nowrap="nowrap">*&nbsp;**T**&nbsp;in&nbsp;(</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to17__10">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to17__10">n</a></td><td class="diff_header" id="to17_86">86</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;tensor(bfloat16),</span></td></tr>
                <tr><td class="diff_next" id="difflib_chg_to17__10"></td><td class="diff_header" id="from17_58">58</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(double),</td><td class="diff_next"></td><td class="diff_header" id="to17_87">87</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(double),</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_59">59</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(float),</td><td class="diff_next"></td><td class="diff_header" id="to17_88">88</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(float),</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_60">60</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(float16)</td><td class="diff_next"></td><td class="diff_header" id="to17_89">89</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(float16)</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_61">61</td><td nowrap="nowrap">&nbsp;&nbsp;):</td><td class="diff_next"></td><td class="diff_header" id="to17_90">90</td><td nowrap="nowrap">&nbsp;&nbsp;):</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from17_62">62</td><td nowrap="nowrap">&nbsp;&nbsp;Constrain&nbsp;input&nbsp;and&nbsp;output&nbsp;types&nbsp;to&nbsp;float&nbsp;tensors.</td><td class="diff_next"></td><td class="diff_header" id="to17_91">91</td><td nowrap="nowrap">&nbsp;&nbsp;Constrain&nbsp;input&nbsp;and&nbsp;output&nbsp;types&nbsp;to&nbsp;float&nbsp;tensors.</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to17__top">t</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to17__top">t</a></td><td class="diff_header" id="to17_92">92</td><td nowrap="nowrap"><span class="diff_add">*&nbsp;**U**&nbsp;in&nbsp;(</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_93">93</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;tensor(bfloat16),</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_94">94</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;tensor(double),</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_95">95</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;tensor(float),</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_96">96</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;tensor(float16)</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_97">97</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;):</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_98">98</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;Constrain&nbsp;mean&nbsp;and&nbsp;variance&nbsp;types&nbsp;to&nbsp;float&nbsp;tensors.&nbsp;It&nbsp;allows&nbsp;all</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to17_99">99</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;float&nbsp;type&nbsp;for&nbsp;U.</span></td></tr>
            </tbody>
        </table>

.. _l-onnx-op-batchnormalization-9:

BatchNormalization - 9
======================

**Version**

* **name**: `BatchNormalization (GitHub) <https://github.com/onnx/onnx/blob/main/docs/Operators.md#BatchNormalization>`_
* **domain**: **main**
* **since_version**: **9**
* **function**: False
* **support_level**: SupportType.COMMON
* **shape inference**: True

This version of the operator has been available
**since version 9**.

**Summary**

Carries out batch normalization as described in the paper
https://arxiv.org/abs/1502.03167. Depending on the mode it is being run,
there are multiple cases for the number of outputs, which we list below:

Output case #1: Y, mean, var, saved_mean, saved_var (training mode)
Output case #2: Y (test mode)

For previous (depreciated) non-spatial cases, implementors are suggested
to flatten the input shape to (N x C*D1*D2 ..*Dn) before a BatchNormalization Op.
This operator has **optional** inputs/outputs. See `ONNX <https://github.com/onnx/onnx/blob/master/docs/IR.md>`_ for more details about the representation of optional arguments. An empty string may be used in the place of an actual argument's name to indicate a missing argument. Trailing optional arguments (those not followed by an argument that is present) may also be simply omitted.

**Attributes**

* **epsilon**:
  The epsilon value to use to avoid division by zero.
* **momentum**:
  Factor used in computing the running mean and variance.e.g.,
  running_mean = running_mean * momentum + mean * (1 - momentum).

**Inputs**

* **X** (heterogeneous) - **T**:
  Input data tensor from the previous operator; dimensions are in the
  form of (N x C x D1 x D2 ... Dn), where N is the batch size, C is
  the number of channels. Statistics are computed for every channel of
  C over N and D1 to Dn dimensions. For image data, input dimensions
  become (N x C x H x W). The op also accepts single dimension input
  of size N in which case C is assumed to be 1
* **scale** (heterogeneous) - **T**:
  Scale tensor of shape (C).
* **B** (heterogeneous) - **T**:
  Bias tensor of shape (C).
* **mean** (heterogeneous) - **T**:
  running (training) or estimated (testing) mean tensor of shape (C).
* **var** (heterogeneous) - **T**:
  running (training) or estimated (testing) variance tensor of shape
  (C).

**Outputs**

Between 1 and 5 outputs.

* **Y** (heterogeneous) - **T**:
  The output tensor of the same shape as X
* **mean** (optional, heterogeneous) - **T**:
  The running mean after the BatchNormalization operator.
* **var** (optional, heterogeneous) - **T**:
  The running variance after the BatchNormalization operator.
* **saved_mean** (optional, heterogeneous) - **T**:
  Saved mean used during training to speed up gradient computation.
* **saved_var** (optional, heterogeneous) - **T**:
  Saved variance used during training to speed up gradient
  computation.

**Type Constraints**

* **T** in (
  tensor(double),
  tensor(float),
  tensor(float16)
  ):
  Constrain input and output types to float tensors.

**Differences**

.. raw:: html

        <table class="diff" id="difflib_chg_to18__top"
               cellspacing="0" cellpadding="0" rules="groups" >
            <colgroup></colgroup> <colgroup></colgroup> <colgroup></colgroup>
            <colgroup></colgroup> <colgroup></colgroup> <colgroup></colgroup>

            <tbody>
                <tr><td class="diff_next"><a href="#difflib_chg_to18__0">f</a></td><td class="diff_header" id="from18_1">1</td><td nowrap="nowrap">Carries&nbsp;out&nbsp;batch&nbsp;normalization&nbsp;as&nbsp;described&nbsp;in&nbsp;the&nbsp;paper</td><td class="diff_next"><a href="#difflib_chg_to18__0">f</a></td><td class="diff_header" id="to18_1">1</td><td nowrap="nowrap">Carries&nbsp;out&nbsp;batch&nbsp;normalization&nbsp;as&nbsp;described&nbsp;in&nbsp;the&nbsp;paper</td></tr>
                <tr><td class="diff_next" id="difflib_chg_to18__0"></td><td class="diff_header" id="from18_2">2</td><td nowrap="nowrap">https://arxiv.org/abs/1502.03167.&nbsp;Depending&nbsp;on&nbsp;the&nbsp;mode&nbsp;it&nbsp;is&nbsp;being&nbsp;run,</td><td class="diff_next"></td><td class="diff_header" id="to18_2">2</td><td nowrap="nowrap">https://arxiv.org/abs/1502.03167.&nbsp;Depending&nbsp;on&nbsp;the&nbsp;mode&nbsp;it&nbsp;is&nbsp;being&nbsp;run,</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_3">3</td><td nowrap="nowrap">there&nbsp;are&nbsp;multiple&nbsp;cases&nbsp;for&nbsp;the&nbsp;number&nbsp;of&nbsp;outputs,&nbsp;which&nbsp;we&nbsp;list&nbsp;below:</td><td class="diff_next"></td><td class="diff_header" id="to18_3">3</td><td nowrap="nowrap">there&nbsp;are&nbsp;multiple&nbsp;cases&nbsp;for&nbsp;the&nbsp;number&nbsp;of&nbsp;outputs,&nbsp;which&nbsp;we&nbsp;list&nbsp;below:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_4">4</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to18_4">4</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_5">5</td><td nowrap="nowrap">Output&nbsp;case&nbsp;#1:&nbsp;Y,&nbsp;mean,&nbsp;var,&nbsp;saved_mean,&nbsp;saved_var&nbsp;(training&nbsp;mode)</td><td class="diff_next"></td><td class="diff_header" id="to18_5">5</td><td nowrap="nowrap">Output&nbsp;case&nbsp;#1:&nbsp;Y,&nbsp;mean,&nbsp;var,&nbsp;saved_mean,&nbsp;saved_var&nbsp;(training&nbsp;mode)</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_6">6</td><td nowrap="nowrap">Output&nbsp;case&nbsp;#2:&nbsp;Y&nbsp;(test&nbsp;mode)</td><td class="diff_next"></td><td class="diff_header" id="to18_6">6</td><td nowrap="nowrap">Output&nbsp;case&nbsp;#2:&nbsp;Y&nbsp;(test&nbsp;mode)</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to18__1">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to18__1">n</a></td><td class="diff_header" id="to18_7">7</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to18_8">8</td><td nowrap="nowrap"><span class="diff_add">For&nbsp;previous&nbsp;(depreciated)&nbsp;non-spatial&nbsp;cases,&nbsp;implementors&nbsp;are&nbsp;suggested</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to18_9">9</td><td nowrap="nowrap"><span class="diff_add">to&nbsp;flatten&nbsp;the&nbsp;input&nbsp;shape&nbsp;to&nbsp;(N&nbsp;x&nbsp;C*D1*D2&nbsp;..*Dn)&nbsp;before&nbsp;a&nbsp;BatchNormalization&nbsp;Op.</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_7">7</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;</span>This&nbsp;operator&nbsp;has&nbsp;**optional**&nbsp;inputs/outputs.&nbsp;See&nbsp;ONNX&nbsp;&lt;https://github.com/onnx/onnx/blob/master/docs/IR.md&gt;_&nbsp;for&nbsp;more&nbsp;details&nbsp;about&nbsp;the&nbsp;representation&nbsp;of&nbsp;optional&nbsp;arguments.&nbsp;An&nbsp;empty&nbsp;string&nbsp;may&nbsp;be&nbsp;used&nbsp;in&nbsp;the&nbsp;place&nbsp;of&nbsp;an&nbsp;actual&nbsp;argument's&nbsp;name&nbsp;to&nbsp;indicate&nbsp;a&nbsp;missing&nbsp;argument.&nbsp;Trailing&nbsp;optional&nbsp;arguments&nbsp;(those&nbsp;not&nbsp;followed&nbsp;by&nbsp;an&nbsp;argument&nbsp;that&nbsp;is&nbsp;present)&nbsp;may&nbsp;also&nbsp;be&nbsp;simply&nbsp;omitted.</td><td class="diff_next"></td><td class="diff_header" id="to18_10">10</td><td nowrap="nowrap">This&nbsp;operator&nbsp;has&nbsp;**optional**&nbsp;inputs/outputs.&nbsp;See&nbsp;ONNX&nbsp;&lt;https://github.com/onnx/onnx/blob/master/docs/IR.md&gt;_&nbsp;for&nbsp;more&nbsp;details&nbsp;about&nbsp;the&nbsp;representation&nbsp;of&nbsp;optional&nbsp;arguments.&nbsp;An&nbsp;empty&nbsp;string&nbsp;may&nbsp;be&nbsp;used&nbsp;in&nbsp;the&nbsp;place&nbsp;of&nbsp;an&nbsp;actual&nbsp;argument's&nbsp;name&nbsp;to&nbsp;indicate&nbsp;a&nbsp;missing&nbsp;argument.&nbsp;Trailing&nbsp;optional&nbsp;arguments&nbsp;(those&nbsp;not&nbsp;followed&nbsp;by&nbsp;an&nbsp;argument&nbsp;that&nbsp;is&nbsp;present)&nbsp;may&nbsp;also&nbsp;be&nbsp;simply&nbsp;omitted.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_8">8</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to18_11">11</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_9">9</td><td nowrap="nowrap">**Attributes**</td><td class="diff_next"></td><td class="diff_header" id="to18_12">12</td><td nowrap="nowrap">**Attributes**</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_10">10</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to18_13">13</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next" id="difflib_chg_to18__1"></td><td class="diff_header" id="from18_11">11</td><td nowrap="nowrap">*&nbsp;**epsilon**:</td><td class="diff_next"></td><td class="diff_header" id="to18_14">14</td><td nowrap="nowrap">*&nbsp;**epsilon**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_12">12</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;epsilon&nbsp;value&nbsp;to&nbsp;use&nbsp;to&nbsp;avoid&nbsp;division&nbsp;by&nbsp;zero.</td><td class="diff_next"></td><td class="diff_header" id="to18_15">15</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;epsilon&nbsp;value&nbsp;to&nbsp;use&nbsp;to&nbsp;avoid&nbsp;division&nbsp;by&nbsp;zero.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_13">13</td><td nowrap="nowrap">*&nbsp;**momentum**:</td><td class="diff_next"></td><td class="diff_header" id="to18_16">16</td><td nowrap="nowrap">*&nbsp;**momentum**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_14">14</td><td nowrap="nowrap">&nbsp;&nbsp;Factor&nbsp;used&nbsp;in&nbsp;computing&nbsp;the&nbsp;running&nbsp;mean&nbsp;and&nbsp;variance.e.g.,</td><td class="diff_next"></td><td class="diff_header" id="to18_17">17</td><td nowrap="nowrap">&nbsp;&nbsp;Factor&nbsp;used&nbsp;in&nbsp;computing&nbsp;the&nbsp;running&nbsp;mean&nbsp;and&nbsp;variance.e.g.,</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_15">15</td><td nowrap="nowrap">&nbsp;&nbsp;running_mean&nbsp;=&nbsp;running_mean&nbsp;*&nbsp;momentum&nbsp;+&nbsp;mean&nbsp;*&nbsp;(1&nbsp;-&nbsp;momentum).</td><td class="diff_next"></td><td class="diff_header" id="to18_18">18</td><td nowrap="nowrap">&nbsp;&nbsp;running_mean&nbsp;=&nbsp;running_mean&nbsp;*&nbsp;momentum&nbsp;+&nbsp;mean&nbsp;*&nbsp;(1&nbsp;-&nbsp;momentum).</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to18__2">n</a></td><td class="diff_header" id="from18_16">16</td><td nowrap="nowrap"><span class="diff_sub">*&nbsp;**spatial**:</span></td><td class="diff_next"><a href="#difflib_chg_to18__2">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_17">17</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;If&nbsp;true,&nbsp;compute&nbsp;the&nbsp;mean&nbsp;and&nbsp;variance&nbsp;across&nbsp;per&nbsp;activation.&nbsp;If</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_18">18</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;false,&nbsp;compute&nbsp;the&nbsp;mean&nbsp;and&nbsp;variance&nbsp;across&nbsp;per&nbsp;feature&nbsp;over&nbsp;each</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next" id="difflib_chg_to18__2"></td><td class="diff_header" id="from18_19">19</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;mini-batch.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_20">20</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to18_19">19</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_21">21</td><td nowrap="nowrap">**Inputs**</td><td class="diff_next"></td><td class="diff_header" id="to18_20">20</td><td nowrap="nowrap">**Inputs**</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_22">22</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to18_21">21</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_23">23</td><td nowrap="nowrap">*&nbsp;**X**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to18_22">22</td><td nowrap="nowrap">*&nbsp;**X**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to18__3">n</a></td><td class="diff_header" id="from18_24">24</td><td nowrap="nowrap">&nbsp;&nbsp;Input&nbsp;data&nbsp;tensor&nbsp;from&nbsp;the&nbsp;previous&nbsp;operator;&nbsp;dimensions&nbsp;<span class="diff_chg">fo</span>r&nbsp;i<span class="diff_chg">mag</span>e</td><td class="diff_next"><a href="#difflib_chg_to18__3">n</a></td><td class="diff_header" id="to18_23">23</td><td nowrap="nowrap">&nbsp;&nbsp;Input&nbsp;data&nbsp;tensor&nbsp;from&nbsp;the&nbsp;previous&nbsp;operator;&nbsp;dimensions&nbsp;<span class="diff_chg">a</span>r<span class="diff_add">e</span>&nbsp;i<span class="diff_chg">n&nbsp;th</span>e</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_25">25</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;case&nbsp;are&nbsp;(N&nbsp;x&nbsp;C&nbsp;x&nbsp;H&nbsp;x&nbsp;W),&nbsp;where&nbsp;N&nbsp;is&nbsp;the&nbsp;batch&nbsp;size,&nbsp;C&nbsp;is&nbsp;the&nbsp;number</span></td><td class="diff_next"></td><td class="diff_header" id="to18_24">24</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;form&nbsp;of&nbsp;(N&nbsp;x&nbsp;C&nbsp;x&nbsp;D1&nbsp;x&nbsp;D2&nbsp;...&nbsp;Dn),&nbsp;where&nbsp;N&nbsp;is&nbsp;the&nbsp;batch&nbsp;size,&nbsp;C&nbsp;is</span></td></tr>
                <tr><td class="diff_next" id="difflib_chg_to18__3"></td><td class="diff_header" id="from18_26">26</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;of&nbsp;channels,&nbsp;and&nbsp;H&nbsp;and&nbsp;W&nbsp;are&nbsp;the&nbsp;height&nbsp;and&nbsp;the&nbsp;width&nbsp;of&nbsp;the&nbsp;data.</span></td><td class="diff_next"></td><td class="diff_header" id="to18_25">25</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;the&nbsp;number&nbsp;of&nbsp;channels.&nbsp;Statistics&nbsp;are&nbsp;computed&nbsp;for&nbsp;every&nbsp;channel&nbsp;of</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_27">27</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;For&nbsp;non&nbsp;image&nbsp;case,&nbsp;the&nbsp;dimensions&nbsp;are&nbsp;in&nbsp;the&nbsp;form&nbsp;of&nbsp;(N&nbsp;x&nbsp;C&nbsp;x&nbsp;D1&nbsp;x</span></td><td class="diff_next"></td><td class="diff_header" id="to18_26">26</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;C&nbsp;over&nbsp;N&nbsp;and&nbsp;D1&nbsp;to&nbsp;Dn&nbsp;dimensions.&nbsp;For&nbsp;image&nbsp;data,&nbsp;input&nbsp;dimensions</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_28">28</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;D2&nbsp;...&nbsp;Dn),&nbsp;where&nbsp;N&nbsp;is&nbsp;the&nbsp;batch&nbsp;size.</span></td><td class="diff_next"></td><td class="diff_header" id="to18_27">27</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;become&nbsp;(N&nbsp;x&nbsp;C&nbsp;x&nbsp;H&nbsp;x&nbsp;W).&nbsp;The&nbsp;op&nbsp;also&nbsp;accepts&nbsp;single&nbsp;dimension&nbsp;input</span></td></tr>
                <tr><td class="diff_next" id="difflib_chg_to18__4"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to18_28">28</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;of&nbsp;size&nbsp;N&nbsp;in&nbsp;which&nbsp;case&nbsp;C&nbsp;is&nbsp;assumed&nbsp;to&nbsp;be&nbsp;1</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_29">29</td><td nowrap="nowrap">*&nbsp;**scale**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to18_29">29</td><td nowrap="nowrap">*&nbsp;**scale**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to18__4">n</a></td><td class="diff_header" id="from18_30">30</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;If&nbsp;spatial&nbsp;is&nbsp;true,&nbsp;the&nbsp;dimension&nbsp;of&nbsp;scale&nbsp;is&nbsp;(C).&nbsp;If&nbsp;spatial&nbsp;is</span></td><td class="diff_next"><a href="#difflib_chg_to18__4">n</a></td><td class="diff_header" id="to18_30">30</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;Scale&nbsp;tensor&nbsp;of&nbsp;shape&nbsp;(C).</span></td></tr>
                <tr><td class="diff_next" id="difflib_chg_to18__5"></td><td class="diff_header" id="from18_31">31</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;false,&nbsp;the&nbsp;dimensions&nbsp;of&nbsp;scale&nbsp;are&nbsp;(C&nbsp;x&nbsp;D1&nbsp;x&nbsp;...&nbsp;x&nbsp;Dn)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_32">32</td><td nowrap="nowrap">*&nbsp;**B**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to18_31">31</td><td nowrap="nowrap">*&nbsp;**B**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to18__5">n</a></td><td class="diff_header" id="from18_33">33</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;If&nbsp;spatial&nbsp;is&nbsp;true,&nbsp;the&nbsp;dimension&nbsp;of&nbsp;bias&nbsp;is&nbsp;(C).&nbsp;If&nbsp;spatial&nbsp;is</span></td><td class="diff_next"><a href="#difflib_chg_to18__5">n</a></td><td class="diff_header" id="to18_32">32</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;Bias&nbsp;tensor&nbsp;of&nbsp;shape&nbsp;(C).</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_34">34</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;false,&nbsp;the&nbsp;dimensions&nbsp;of&nbsp;bias&nbsp;are&nbsp;(C&nbsp;x&nbsp;D1&nbsp;x&nbsp;...&nbsp;x&nbsp;Dn)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_35">35</td><td nowrap="nowrap">*&nbsp;**mean**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to18_33">33</td><td nowrap="nowrap">*&nbsp;**mean**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next" id="difflib_chg_to18__6"><a href="#difflib_chg_to18__6">n</a></td><td class="diff_header" id="from18_36">36</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;If&nbsp;spatial&nbsp;is&nbsp;true,&nbsp;the&nbsp;dimension&nbsp;of&nbsp;the&nbsp;running&nbsp;mean&nbsp;(training)&nbsp;or</span></td><td class="diff_next"><a href="#difflib_chg_to18__6">n</a></td><td class="diff_header" id="to18_34">34</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;running&nbsp;(training)&nbsp;or&nbsp;estimated&nbsp;(testing)&nbsp;mean&nbsp;tensor&nbsp;of&nbsp;shape&nbsp;(C).</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_37">37</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;the&nbsp;estimated&nbsp;mean&nbsp;(testing)&nbsp;is&nbsp;(C).&nbsp;If&nbsp;spatial&nbsp;is&nbsp;false,&nbsp;the</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_38">38</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;dimensions&nbsp;of&nbsp;the&nbsp;running&nbsp;mean&nbsp;(training)&nbsp;or&nbsp;the&nbsp;estimated&nbsp;mean</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_39">39</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;(testing)&nbsp;are&nbsp;(C&nbsp;x&nbsp;D1&nbsp;x&nbsp;...&nbsp;x&nbsp;Dn).</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_40">40</td><td nowrap="nowrap">*&nbsp;**var**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to18_35">35</td><td nowrap="nowrap">*&nbsp;**var**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to18__top">t</a></td><td class="diff_header" id="from18_41">41</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;If&nbsp;spatial&nbsp;is&nbsp;true,&nbsp;the&nbsp;dimension&nbsp;of&nbsp;the&nbsp;running&nbsp;variance(training)</span></td><td class="diff_next"><a href="#difflib_chg_to18__top">t</a></td><td class="diff_header" id="to18_36">36</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;running&nbsp;(training)&nbsp;or&nbsp;estimated&nbsp;(testing)&nbsp;variance&nbsp;tensor&nbsp;of&nbsp;shape</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_42">42</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;or&nbsp;the&nbsp;estimated&nbsp;variance&nbsp;(testing)&nbsp;is&nbsp;(C).&nbsp;If&nbsp;spatial&nbsp;is&nbsp;false,&nbsp;the</span></td><td class="diff_next"></td><td class="diff_header" id="to18_37">37</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;(C).</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_43">43</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;dimensions&nbsp;of&nbsp;the&nbsp;running&nbsp;variance(training)&nbsp;or&nbsp;the&nbsp;estimated</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_44">44</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;variance&nbsp;(testing)&nbsp;are&nbsp;(C&nbsp;x&nbsp;D1&nbsp;x&nbsp;...&nbsp;x&nbsp;Dn).</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_45">45</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to18_38">38</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_46">46</td><td nowrap="nowrap">**Outputs**</td><td class="diff_next"></td><td class="diff_header" id="to18_39">39</td><td nowrap="nowrap">**Outputs**</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_47">47</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to18_40">40</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_48">48</td><td nowrap="nowrap">Between&nbsp;1&nbsp;and&nbsp;5&nbsp;outputs.</td><td class="diff_next"></td><td class="diff_header" id="to18_41">41</td><td nowrap="nowrap">Between&nbsp;1&nbsp;and&nbsp;5&nbsp;outputs.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_49">49</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to18_42">42</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_50">50</td><td nowrap="nowrap">*&nbsp;**Y**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to18_43">43</td><td nowrap="nowrap">*&nbsp;**Y**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_51">51</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;output&nbsp;tensor&nbsp;of&nbsp;the&nbsp;same&nbsp;shape&nbsp;as&nbsp;X</td><td class="diff_next"></td><td class="diff_header" id="to18_44">44</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;output&nbsp;tensor&nbsp;of&nbsp;the&nbsp;same&nbsp;shape&nbsp;as&nbsp;X</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_52">52</td><td nowrap="nowrap">*&nbsp;**mean**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to18_45">45</td><td nowrap="nowrap">*&nbsp;**mean**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_53">53</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;running&nbsp;mean&nbsp;after&nbsp;the&nbsp;BatchNormalization&nbsp;operator.</td><td class="diff_next"></td><td class="diff_header" id="to18_46">46</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;running&nbsp;mean&nbsp;after&nbsp;the&nbsp;BatchNormalization&nbsp;operator.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_54">54</td><td nowrap="nowrap">*&nbsp;**var**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to18_47">47</td><td nowrap="nowrap">*&nbsp;**var**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_55">55</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;running&nbsp;variance&nbsp;after&nbsp;the&nbsp;BatchNormalization&nbsp;operator.</td><td class="diff_next"></td><td class="diff_header" id="to18_48">48</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;running&nbsp;variance&nbsp;after&nbsp;the&nbsp;BatchNormalization&nbsp;operator.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_56">56</td><td nowrap="nowrap">*&nbsp;**saved_mean**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to18_49">49</td><td nowrap="nowrap">*&nbsp;**saved_mean**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_57">57</td><td nowrap="nowrap">&nbsp;&nbsp;Saved&nbsp;mean&nbsp;used&nbsp;during&nbsp;training&nbsp;to&nbsp;speed&nbsp;up&nbsp;gradient&nbsp;computation.</td><td class="diff_next"></td><td class="diff_header" id="to18_50">50</td><td nowrap="nowrap">&nbsp;&nbsp;Saved&nbsp;mean&nbsp;used&nbsp;during&nbsp;training&nbsp;to&nbsp;speed&nbsp;up&nbsp;gradient&nbsp;computation.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_58">58</td><td nowrap="nowrap">*&nbsp;**saved_var**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to18_51">51</td><td nowrap="nowrap">*&nbsp;**saved_var**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_59">59</td><td nowrap="nowrap">&nbsp;&nbsp;Saved&nbsp;variance&nbsp;used&nbsp;during&nbsp;training&nbsp;to&nbsp;speed&nbsp;up&nbsp;gradient</td><td class="diff_next"></td><td class="diff_header" id="to18_52">52</td><td nowrap="nowrap">&nbsp;&nbsp;Saved&nbsp;variance&nbsp;used&nbsp;during&nbsp;training&nbsp;to&nbsp;speed&nbsp;up&nbsp;gradient</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_60">60</td><td nowrap="nowrap">&nbsp;&nbsp;computation.</td><td class="diff_next"></td><td class="diff_header" id="to18_53">53</td><td nowrap="nowrap">&nbsp;&nbsp;computation.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_61">61</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to18_54">54</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_62">62</td><td nowrap="nowrap">**Type&nbsp;Constraints**</td><td class="diff_next"></td><td class="diff_header" id="to18_55">55</td><td nowrap="nowrap">**Type&nbsp;Constraints**</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_63">63</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to18_56">56</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_64">64</td><td nowrap="nowrap">*&nbsp;**T**&nbsp;in&nbsp;(</td><td class="diff_next"></td><td class="diff_header" id="to18_57">57</td><td nowrap="nowrap">*&nbsp;**T**&nbsp;in&nbsp;(</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_65">65</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(double),</td><td class="diff_next"></td><td class="diff_header" id="to18_58">58</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(double),</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_66">66</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(float),</td><td class="diff_next"></td><td class="diff_header" id="to18_59">59</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(float),</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_67">67</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(float16)</td><td class="diff_next"></td><td class="diff_header" id="to18_60">60</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(float16)</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_68">68</td><td nowrap="nowrap">&nbsp;&nbsp;):</td><td class="diff_next"></td><td class="diff_header" id="to18_61">61</td><td nowrap="nowrap">&nbsp;&nbsp;):</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from18_69">69</td><td nowrap="nowrap">&nbsp;&nbsp;Constrain&nbsp;input&nbsp;and&nbsp;output&nbsp;types&nbsp;to&nbsp;float&nbsp;tensors.</td><td class="diff_next"></td><td class="diff_header" id="to18_62">62</td><td nowrap="nowrap">&nbsp;&nbsp;Constrain&nbsp;input&nbsp;and&nbsp;output&nbsp;types&nbsp;to&nbsp;float&nbsp;tensors.</td></tr>
            </tbody>
        </table>

.. _l-onnx-op-batchnormalization-7:

BatchNormalization - 7
======================

**Version**

* **name**: `BatchNormalization (GitHub) <https://github.com/onnx/onnx/blob/main/docs/Operators.md#BatchNormalization>`_
* **domain**: **main**
* **since_version**: **7**
* **function**: False
* **support_level**: SupportType.COMMON
* **shape inference**: True

This version of the operator has been available
**since version 7**.

**Summary**

Carries out batch normalization as described in the paper
https://arxiv.org/abs/1502.03167. Depending on the mode it is being run,
there are multiple cases for the number of outputs, which we list below:

Output case #1: Y, mean, var, saved_mean, saved_var (training mode)
Output case #2: Y (test mode)
    This operator has **optional** inputs/outputs. See `ONNX <https://github.com/onnx/onnx/blob/master/docs/IR.md>`_ for more details about the representation of optional arguments. An empty string may be used in the place of an actual argument's name to indicate a missing argument. Trailing optional arguments (those not followed by an argument that is present) may also be simply omitted.

**Attributes**

* **epsilon**:
  The epsilon value to use to avoid division by zero.
* **momentum**:
  Factor used in computing the running mean and variance.e.g.,
  running_mean = running_mean * momentum + mean * (1 - momentum).
* **spatial**:
  If true, compute the mean and variance across per activation. If
  false, compute the mean and variance across per feature over each
  mini-batch.

**Inputs**

* **X** (heterogeneous) - **T**:
  Input data tensor from the previous operator; dimensions for image
  case are (N x C x H x W), where N is the batch size, C is the number
  of channels, and H and W are the height and the width of the data.
  For non image case, the dimensions are in the form of (N x C x D1 x
  D2 ... Dn), where N is the batch size.
* **scale** (heterogeneous) - **T**:
  If spatial is true, the dimension of scale is (C). If spatial is
  false, the dimensions of scale are (C x D1 x ... x Dn)
* **B** (heterogeneous) - **T**:
  If spatial is true, the dimension of bias is (C). If spatial is
  false, the dimensions of bias are (C x D1 x ... x Dn)
* **mean** (heterogeneous) - **T**:
  If spatial is true, the dimension of the running mean (training) or
  the estimated mean (testing) is (C). If spatial is false, the
  dimensions of the running mean (training) or the estimated mean
  (testing) are (C x D1 x ... x Dn).
* **var** (heterogeneous) - **T**:
  If spatial is true, the dimension of the running variance(training)
  or the estimated variance (testing) is (C). If spatial is false, the
  dimensions of the running variance(training) or the estimated
  variance (testing) are (C x D1 x ... x Dn).

**Outputs**

Between 1 and 5 outputs.

* **Y** (heterogeneous) - **T**:
  The output tensor of the same shape as X
* **mean** (optional, heterogeneous) - **T**:
  The running mean after the BatchNormalization operator.
* **var** (optional, heterogeneous) - **T**:
  The running variance after the BatchNormalization operator.
* **saved_mean** (optional, heterogeneous) - **T**:
  Saved mean used during training to speed up gradient computation.
* **saved_var** (optional, heterogeneous) - **T**:
  Saved variance used during training to speed up gradient
  computation.

**Type Constraints**

* **T** in (
  tensor(double),
  tensor(float),
  tensor(float16)
  ):
  Constrain input and output types to float tensors.

**Differences**

.. raw:: html

        <table class="diff" id="difflib_chg_to19__top"
               cellspacing="0" cellpadding="0" rules="groups" >
            <colgroup></colgroup> <colgroup></colgroup> <colgroup></colgroup>
            <colgroup></colgroup> <colgroup></colgroup> <colgroup></colgroup>

            <tbody>
                <tr><td class="diff_next"><a href="#difflib_chg_to19__0">f</a></td><td class="diff_header" id="from19_1">1</td><td nowrap="nowrap">Carries&nbsp;out&nbsp;batch&nbsp;normalization&nbsp;as&nbsp;described&nbsp;in&nbsp;the&nbsp;paper</td><td class="diff_next"><a href="#difflib_chg_to19__0">f</a></td><td class="diff_header" id="to19_1">1</td><td nowrap="nowrap">Carries&nbsp;out&nbsp;batch&nbsp;normalization&nbsp;as&nbsp;described&nbsp;in&nbsp;the&nbsp;paper</td></tr>
                <tr><td class="diff_next" id="difflib_chg_to19__0"></td><td class="diff_header" id="from19_2">2</td><td nowrap="nowrap">https://arxiv.org/abs/1502.03167.&nbsp;Depending&nbsp;on&nbsp;the&nbsp;mode&nbsp;it&nbsp;is&nbsp;being&nbsp;run,</td><td class="diff_next"></td><td class="diff_header" id="to19_2">2</td><td nowrap="nowrap">https://arxiv.org/abs/1502.03167.&nbsp;Depending&nbsp;on&nbsp;the&nbsp;mode&nbsp;it&nbsp;is&nbsp;being&nbsp;run,</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_3">3</td><td nowrap="nowrap">there&nbsp;are&nbsp;multiple&nbsp;cases&nbsp;for&nbsp;the&nbsp;number&nbsp;of&nbsp;outputs,&nbsp;which&nbsp;we&nbsp;list&nbsp;below:</td><td class="diff_next"></td><td class="diff_header" id="to19_3">3</td><td nowrap="nowrap">there&nbsp;are&nbsp;multiple&nbsp;cases&nbsp;for&nbsp;the&nbsp;number&nbsp;of&nbsp;outputs,&nbsp;which&nbsp;we&nbsp;list&nbsp;below:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_4">4</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to19_4">4</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_5">5</td><td nowrap="nowrap">Output&nbsp;case&nbsp;#1:&nbsp;Y,&nbsp;mean,&nbsp;var,&nbsp;saved_mean,&nbsp;saved_var&nbsp;(training&nbsp;mode)</td><td class="diff_next"></td><td class="diff_header" id="to19_5">5</td><td nowrap="nowrap">Output&nbsp;case&nbsp;#1:&nbsp;Y,&nbsp;mean,&nbsp;var,&nbsp;saved_mean,&nbsp;saved_var&nbsp;(training&nbsp;mode)</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_6">6</td><td nowrap="nowrap">Output&nbsp;case&nbsp;#2:&nbsp;Y&nbsp;(test&nbsp;mode)</td><td class="diff_next"></td><td class="diff_header" id="to19_6">6</td><td nowrap="nowrap">Output&nbsp;case&nbsp;#2:&nbsp;Y&nbsp;(test&nbsp;mode)</td></tr>
                <tr><td class="diff_next" id="difflib_chg_to19__1"><a href="#difflib_chg_to19__1">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to19__1">n</a></td><td class="diff_header" id="to19_7">7</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;operator&nbsp;has&nbsp;**optional**&nbsp;inputs/outputs.&nbsp;See&nbsp;ONNX&nbsp;&lt;https://github.com/onnx/onnx/blob/master/docs/IR.md&gt;_&nbsp;for&nbsp;more&nbsp;details&nbsp;about&nbsp;the&nbsp;representation&nbsp;of&nbsp;optional&nbsp;arguments.&nbsp;An&nbsp;empty&nbsp;string&nbsp;may&nbsp;be&nbsp;used&nbsp;in&nbsp;the&nbsp;place&nbsp;of&nbsp;an&nbsp;actual&nbsp;argument's&nbsp;name&nbsp;to&nbsp;indicate&nbsp;a&nbsp;missing&nbsp;argument.&nbsp;Trailing&nbsp;optional&nbsp;arguments&nbsp;(those&nbsp;not&nbsp;followed&nbsp;by&nbsp;an&nbsp;argument&nbsp;that&nbsp;is&nbsp;present)&nbsp;may&nbsp;also&nbsp;be&nbsp;simply&nbsp;omitted.</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_7">7</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to19_8">8</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_8">8</td><td nowrap="nowrap">**Attributes**</td><td class="diff_next"></td><td class="diff_header" id="to19_9">9</td><td nowrap="nowrap">**Attributes**</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_9">9</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to19_10">10</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_10">10</td><td nowrap="nowrap">*&nbsp;**epsilon**:</td><td class="diff_next"></td><td class="diff_header" id="to19_11">11</td><td nowrap="nowrap">*&nbsp;**epsilon**:</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to19__2">n</a></td><td class="diff_header" id="from19_11">11</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;epsilon&nbsp;value&nbsp;to&nbsp;use&nbsp;to&nbsp;avoid&nbsp;division&nbsp;by&nbsp;zero<span class="diff_chg">,&nbsp;default&nbsp;is</span></td><td class="diff_next"><a href="#difflib_chg_to19__2">n</a></td><td class="diff_header" id="to19_12">12</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;epsilon&nbsp;value&nbsp;to&nbsp;use&nbsp;to&nbsp;avoid&nbsp;division&nbsp;by&nbsp;zero<span class="diff_chg">.</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_12">12</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;1e-5f.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next" id="difflib_chg_to19__2"></td><td class="diff_header" id="from19_13">13</td><td nowrap="nowrap"><span class="diff_sub">*&nbsp;**is_test**:</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_14">14</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;If&nbsp;set&nbsp;to&nbsp;nonzero,&nbsp;run&nbsp;spatial&nbsp;batch&nbsp;normalization&nbsp;in&nbsp;test&nbsp;mode,</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_15">15</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;default&nbsp;is&nbsp;0.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next" id="difflib_chg_to19__3"></td><td class="diff_header" id="from19_16">16</td><td nowrap="nowrap">*&nbsp;**momentum**:</td><td class="diff_next"></td><td class="diff_header" id="to19_13">13</td><td nowrap="nowrap">*&nbsp;**momentum**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_17">17</td><td nowrap="nowrap">&nbsp;&nbsp;Factor&nbsp;used&nbsp;in&nbsp;computing&nbsp;the&nbsp;running&nbsp;mean&nbsp;and&nbsp;variance.e.g.,</td><td class="diff_next"></td><td class="diff_header" id="to19_14">14</td><td nowrap="nowrap">&nbsp;&nbsp;Factor&nbsp;used&nbsp;in&nbsp;computing&nbsp;the&nbsp;running&nbsp;mean&nbsp;and&nbsp;variance.e.g.,</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to19__3">n</a></td><td class="diff_header" id="from19_18">18</td><td nowrap="nowrap">&nbsp;&nbsp;running_mean&nbsp;=&nbsp;running_mean&nbsp;*&nbsp;momentum&nbsp;+&nbsp;mean&nbsp;*&nbsp;(1&nbsp;-&nbsp;momentum)<span class="diff_chg">,</span></td><td class="diff_next"><a href="#difflib_chg_to19__3">n</a></td><td class="diff_header" id="to19_15">15</td><td nowrap="nowrap">&nbsp;&nbsp;running_mean&nbsp;=&nbsp;running_mean&nbsp;*&nbsp;momentum&nbsp;+&nbsp;mean&nbsp;*&nbsp;(1&nbsp;-&nbsp;momentum)<span class="diff_chg">.</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_19">19</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;default&nbsp;is&nbsp;0.9f.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_20">20</td><td nowrap="nowrap">*&nbsp;**spatial**:</td><td class="diff_next"></td><td class="diff_header" id="to19_16">16</td><td nowrap="nowrap">*&nbsp;**spatial**:</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to19__4">n</a></td><td class="diff_header" id="from19_21">21</td><td nowrap="nowrap">&nbsp;&nbsp;If&nbsp;true,&nbsp;compute&nbsp;the&nbsp;mean&nbsp;and&nbsp;variance&nbsp;across&nbsp;a<span class="diff_chg">ll&nbsp;sp</span>ati<span class="diff_chg">al&nbsp;eleme</span>n<span class="diff_chg">ts</span></td><td class="diff_next"><a href="#difflib_chg_to19__4">n</a></td><td class="diff_header" id="to19_17">17</td><td nowrap="nowrap">&nbsp;&nbsp;If&nbsp;true,&nbsp;compute&nbsp;the&nbsp;mean&nbsp;and&nbsp;variance&nbsp;across&nbsp;<span class="diff_add">per&nbsp;</span>a<span class="diff_chg">ctiv</span>ati<span class="diff_chg">o</span>n<span class="diff_chg">.&nbsp;If</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_22">22</td><td nowrap="nowrap">&nbsp;<span class="diff_sub">&nbsp;If</span>&nbsp;false,&nbsp;compute&nbsp;the&nbsp;mean&nbsp;and&nbsp;variance&nbsp;across&nbsp;per&nbsp;feature<span class="diff_chg">.D</span>e<span class="diff_chg">f</span>a<span class="diff_chg">ult</span></td><td class="diff_next"></td><td class="diff_header" id="to19_18">18</td><td nowrap="nowrap">&nbsp;&nbsp;false,&nbsp;compute&nbsp;the&nbsp;mean&nbsp;and&nbsp;variance&nbsp;across&nbsp;per&nbsp;feature<span class="diff_chg">&nbsp;ov</span>e<span class="diff_chg">r&nbsp;e</span>a<span class="diff_chg">ch</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_23">23</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;is&nbsp;1.</span></td><td class="diff_next"></td><td class="diff_header" id="to19_19">19</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;mini-batch.</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_24">24</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to19_20">20</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_25">25</td><td nowrap="nowrap">**Inputs**</td><td class="diff_next"></td><td class="diff_header" id="to19_21">21</td><td nowrap="nowrap">**Inputs**</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_26">26</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to19_22">22</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_27">27</td><td nowrap="nowrap">*&nbsp;**X**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to19_23">23</td><td nowrap="nowrap">*&nbsp;**X**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_28">28</td><td nowrap="nowrap">&nbsp;&nbsp;Input&nbsp;data&nbsp;tensor&nbsp;from&nbsp;the&nbsp;previous&nbsp;operator;&nbsp;dimensions&nbsp;for&nbsp;image</td><td class="diff_next"></td><td class="diff_header" id="to19_24">24</td><td nowrap="nowrap">&nbsp;&nbsp;Input&nbsp;data&nbsp;tensor&nbsp;from&nbsp;the&nbsp;previous&nbsp;operator;&nbsp;dimensions&nbsp;for&nbsp;image</td></tr>
                <tr><td class="diff_next" id="difflib_chg_to19__4"></td><td class="diff_header" id="from19_29">29</td><td nowrap="nowrap">&nbsp;&nbsp;case&nbsp;are&nbsp;(N&nbsp;x&nbsp;C&nbsp;x&nbsp;H&nbsp;x&nbsp;W),&nbsp;where&nbsp;N&nbsp;is&nbsp;the&nbsp;batch&nbsp;size,&nbsp;C&nbsp;is&nbsp;the&nbsp;number</td><td class="diff_next"></td><td class="diff_header" id="to19_25">25</td><td nowrap="nowrap">&nbsp;&nbsp;case&nbsp;are&nbsp;(N&nbsp;x&nbsp;C&nbsp;x&nbsp;H&nbsp;x&nbsp;W),&nbsp;where&nbsp;N&nbsp;is&nbsp;the&nbsp;batch&nbsp;size,&nbsp;C&nbsp;is&nbsp;the&nbsp;number</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_30">30</td><td nowrap="nowrap">&nbsp;&nbsp;of&nbsp;channels,&nbsp;and&nbsp;H&nbsp;and&nbsp;W&nbsp;are&nbsp;the&nbsp;height&nbsp;and&nbsp;the&nbsp;width&nbsp;of&nbsp;the&nbsp;data.</td><td class="diff_next"></td><td class="diff_header" id="to19_26">26</td><td nowrap="nowrap">&nbsp;&nbsp;of&nbsp;channels,&nbsp;and&nbsp;H&nbsp;and&nbsp;W&nbsp;are&nbsp;the&nbsp;height&nbsp;and&nbsp;the&nbsp;width&nbsp;of&nbsp;the&nbsp;data.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_31">31</td><td nowrap="nowrap">&nbsp;&nbsp;For&nbsp;non&nbsp;image&nbsp;case,&nbsp;the&nbsp;dimensions&nbsp;are&nbsp;in&nbsp;the&nbsp;form&nbsp;of&nbsp;(N&nbsp;x&nbsp;C&nbsp;x&nbsp;D1&nbsp;x</td><td class="diff_next"></td><td class="diff_header" id="to19_27">27</td><td nowrap="nowrap">&nbsp;&nbsp;For&nbsp;non&nbsp;image&nbsp;case,&nbsp;the&nbsp;dimensions&nbsp;are&nbsp;in&nbsp;the&nbsp;form&nbsp;of&nbsp;(N&nbsp;x&nbsp;C&nbsp;x&nbsp;D1&nbsp;x</td></tr>
                <tr><td class="diff_next" id="difflib_chg_to19__5"></td><td class="diff_header" id="from19_32">32</td><td nowrap="nowrap">&nbsp;&nbsp;D2&nbsp;...&nbsp;Dn),&nbsp;where&nbsp;N&nbsp;is&nbsp;the&nbsp;batch&nbsp;size.</td><td class="diff_next"></td><td class="diff_header" id="to19_28">28</td><td nowrap="nowrap">&nbsp;&nbsp;D2&nbsp;...&nbsp;Dn),&nbsp;where&nbsp;N&nbsp;is&nbsp;the&nbsp;batch&nbsp;size.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_33">33</td><td nowrap="nowrap">*&nbsp;**scale**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to19_29">29</td><td nowrap="nowrap">*&nbsp;**scale**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to19__5">n</a></td><td class="diff_header" id="from19_34">34</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;The&nbsp;scale&nbsp;as&nbsp;a&nbsp;1-dimensional&nbsp;tensor&nbsp;of&nbsp;size&nbsp;C&nbsp;to&nbsp;be&nbsp;applied&nbsp;to&nbsp;the</span></td><td class="diff_next"><a href="#difflib_chg_to19__5">n</a></td><td class="diff_header" id="to19_30">30</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;If&nbsp;spatial&nbsp;is&nbsp;true,&nbsp;the&nbsp;dimension&nbsp;of&nbsp;scale&nbsp;is&nbsp;(C).&nbsp;If&nbsp;spatial&nbsp;is</span></td></tr>
                <tr><td class="diff_next" id="difflib_chg_to19__6"></td><td class="diff_header" id="from19_35">35</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;output.</span></td><td class="diff_next"></td><td class="diff_header" id="to19_31">31</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;false,&nbsp;the&nbsp;dimensions&nbsp;of&nbsp;scale&nbsp;are&nbsp;(C&nbsp;x&nbsp;D1&nbsp;x&nbsp;...&nbsp;x&nbsp;Dn)</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_36">36</td><td nowrap="nowrap">*&nbsp;**B**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to19_32">32</td><td nowrap="nowrap">*&nbsp;**B**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to19__6">n</a></td><td class="diff_header" id="from19_37">37</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;The&nbsp;bias&nbsp;as&nbsp;a&nbsp;1-dimensional&nbsp;tensor&nbsp;of&nbsp;size&nbsp;C&nbsp;to&nbsp;be&nbsp;applied&nbsp;to&nbsp;the</span></td><td class="diff_next"><a href="#difflib_chg_to19__6">n</a></td><td class="diff_header" id="to19_33">33</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;If&nbsp;spatial&nbsp;is&nbsp;true,&nbsp;the&nbsp;dimension&nbsp;of&nbsp;bias&nbsp;is&nbsp;(C).&nbsp;If&nbsp;spatial&nbsp;is</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_38">38</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;output.</span></td><td class="diff_next"></td><td class="diff_header" id="to19_34">34</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;false,&nbsp;the&nbsp;dimensions&nbsp;of&nbsp;bias&nbsp;are&nbsp;(C&nbsp;x&nbsp;D1&nbsp;x&nbsp;...&nbsp;x&nbsp;Dn)</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_39">39</td><td nowrap="nowrap">*&nbsp;**mean**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to19_35">35</td><td nowrap="nowrap">*&nbsp;**mean**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next" id="difflib_chg_to19__7"><a href="#difflib_chg_to19__7">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"><a href="#difflib_chg_to19__7">n</a></td><td class="diff_header" id="to19_36">36</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;If&nbsp;spatial&nbsp;is&nbsp;true,&nbsp;the&nbsp;dimension&nbsp;of&nbsp;the&nbsp;running&nbsp;mean&nbsp;(training)&nbsp;or</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to19_37">37</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;the&nbsp;estimated&nbsp;mean&nbsp;(testing)&nbsp;is&nbsp;(C).&nbsp;If&nbsp;spatial&nbsp;is&nbsp;false,&nbsp;the</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_40">40</td><td nowrap="nowrap">&nbsp;&nbsp;<span class="diff_chg">T</span>he&nbsp;running&nbsp;mean&nbsp;(training)&nbsp;or&nbsp;the&nbsp;estimated&nbsp;mean<span class="diff_sub">&nbsp;(testing)&nbsp;as&nbsp;a</span></td><td class="diff_next"></td><td class="diff_header" id="to19_38">38</td><td nowrap="nowrap">&nbsp;&nbsp;<span class="diff_chg">dimensions&nbsp;of&nbsp;t</span>he&nbsp;running&nbsp;mean&nbsp;(training)&nbsp;or&nbsp;the&nbsp;estimated&nbsp;mean</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_41">41</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;1-dimensional&nbsp;tensor&nbsp;of&nbsp;size&nbsp;C.</span></td><td class="diff_next"></td><td class="diff_header" id="to19_39">39</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;(testing)&nbsp;are&nbsp;(C&nbsp;x&nbsp;D1&nbsp;x&nbsp;...&nbsp;x&nbsp;Dn).</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_42">42</td><td nowrap="nowrap">*&nbsp;**var**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to19_40">40</td><td nowrap="nowrap">*&nbsp;**var**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to19__8">n</a></td><td class="diff_header" id="from19_43">43</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;The&nbsp;running&nbsp;variance&nbsp;(training)&nbsp;or&nbsp;the&nbsp;estimated&nbsp;variance&nbsp;(testing)</span></td><td class="diff_next"><a href="#difflib_chg_to19__8">n</a></td><td class="diff_header" id="to19_41">41</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;If&nbsp;spatial&nbsp;is&nbsp;true,&nbsp;the&nbsp;dimension&nbsp;of&nbsp;the&nbsp;running&nbsp;variance(training)</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_44">44</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;as&nbsp;a&nbsp;1-dimensional&nbsp;tensor&nbsp;of&nbsp;size&nbsp;C.</span></td><td class="diff_next"></td><td class="diff_header" id="to19_42">42</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;or&nbsp;the&nbsp;estimated&nbsp;variance&nbsp;(testing)&nbsp;is&nbsp;(C).&nbsp;If&nbsp;spatial&nbsp;is&nbsp;false,&nbsp;the</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to19_43">43</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;dimensions&nbsp;of&nbsp;the&nbsp;running&nbsp;variance(training)&nbsp;or&nbsp;the&nbsp;estimated</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to19_44">44</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;variance&nbsp;(testing)&nbsp;are&nbsp;(C&nbsp;x&nbsp;D1&nbsp;x&nbsp;...&nbsp;x&nbsp;Dn).</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_45">45</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to19_45">45</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next" id="difflib_chg_to19__8"></td><td class="diff_header" id="from19_46">46</td><td nowrap="nowrap">**Outputs**</td><td class="diff_next"></td><td class="diff_header" id="to19_46">46</td><td nowrap="nowrap">**Outputs**</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_47">47</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to19_47">47</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next" id="difflib_chg_to19__9"></td><td class="diff_header" id="from19_48">48</td><td nowrap="nowrap">Between&nbsp;1&nbsp;and&nbsp;5&nbsp;outputs.</td><td class="diff_next"></td><td class="diff_header" id="to19_48">48</td><td nowrap="nowrap">Between&nbsp;1&nbsp;and&nbsp;5&nbsp;outputs.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_49">49</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to19_49">49</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_50">50</td><td nowrap="nowrap">*&nbsp;**Y**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to19_50">50</td><td nowrap="nowrap">*&nbsp;**Y**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next" id="difflib_chg_to19__10"><a href="#difflib_chg_to19__9">n</a></td><td class="diff_header" id="from19_51">51</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;output&nbsp;tensor&nbsp;of&nbsp;the&nbsp;same&nbsp;shape&nbsp;as&nbsp;X<span class="diff_sub">.</span></td><td class="diff_next"><a href="#difflib_chg_to19__9">n</a></td><td class="diff_header" id="to19_51">51</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;output&nbsp;tensor&nbsp;of&nbsp;the&nbsp;same&nbsp;shape&nbsp;as&nbsp;X</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_52">52</td><td nowrap="nowrap">*&nbsp;**mean**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to19_52">52</td><td nowrap="nowrap">*&nbsp;**mean**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to19__10">n</a></td><td class="diff_header" id="from19_53">53</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;running&nbsp;mean&nbsp;after&nbsp;the&nbsp;BatchNormalization&nbsp;operator.<span class="diff_sub">&nbsp;Must&nbsp;be&nbsp;in-</span></td><td class="diff_next"><a href="#difflib_chg_to19__10">n</a></td><td class="diff_header" id="to19_53">53</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;running&nbsp;mean&nbsp;after&nbsp;the&nbsp;BatchNormalization&nbsp;operator.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_54">54</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;place&nbsp;with&nbsp;the&nbsp;input&nbsp;mean.&nbsp;Should&nbsp;not&nbsp;be&nbsp;used&nbsp;for&nbsp;testing.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next" id="difflib_chg_to19__11"></td><td class="diff_header" id="from19_55">55</td><td nowrap="nowrap">*&nbsp;**var**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to19_54">54</td><td nowrap="nowrap">*&nbsp;**var**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to19__11">n</a></td><td class="diff_header" id="from19_56">56</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;running&nbsp;variance&nbsp;after&nbsp;the&nbsp;BatchNormalization&nbsp;operator.<span class="diff_sub">&nbsp;Must&nbsp;be</span></td><td class="diff_next"><a href="#difflib_chg_to19__11">n</a></td><td class="diff_header" id="to19_55">55</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;running&nbsp;variance&nbsp;after&nbsp;the&nbsp;BatchNormalization&nbsp;operator.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_57">57</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;in-place&nbsp;with&nbsp;the&nbsp;input&nbsp;var.&nbsp;Should&nbsp;not&nbsp;be&nbsp;used&nbsp;for&nbsp;testing.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next" id="difflib_chg_to19__12"></td><td class="diff_header" id="from19_58">58</td><td nowrap="nowrap">*&nbsp;**saved_mean**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to19_56">56</td><td nowrap="nowrap">*&nbsp;**saved_mean**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_59">59</td><td nowrap="nowrap">&nbsp;&nbsp;Saved&nbsp;mean&nbsp;used&nbsp;during&nbsp;training&nbsp;to&nbsp;speed&nbsp;up&nbsp;gradient&nbsp;computation.</td><td class="diff_next"></td><td class="diff_header" id="to19_57">57</td><td nowrap="nowrap">&nbsp;&nbsp;Saved&nbsp;mean&nbsp;used&nbsp;during&nbsp;training&nbsp;to&nbsp;speed&nbsp;up&nbsp;gradient&nbsp;computation.</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to19__12">n</a></td><td class="diff_header" id="from19_60">60</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;Should&nbsp;not&nbsp;be&nbsp;used&nbsp;for&nbsp;testing.</span></td><td class="diff_next"><a href="#difflib_chg_to19__12">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_61">61</td><td nowrap="nowrap">*&nbsp;**saved_var**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to19_58">58</td><td nowrap="nowrap">*&nbsp;**saved_var**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_62">62</td><td nowrap="nowrap">&nbsp;&nbsp;Saved&nbsp;variance&nbsp;used&nbsp;during&nbsp;training&nbsp;to&nbsp;speed&nbsp;up&nbsp;gradient</td><td class="diff_next"></td><td class="diff_header" id="to19_59">59</td><td nowrap="nowrap">&nbsp;&nbsp;Saved&nbsp;variance&nbsp;used&nbsp;during&nbsp;training&nbsp;to&nbsp;speed&nbsp;up&nbsp;gradient</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to19__top">t</a></td><td class="diff_header" id="from19_63">63</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;computation.&nbsp;Should&nbsp;not&nbsp;be&nbsp;used&nbsp;for&nbsp;testing.</span></td><td class="diff_next"><a href="#difflib_chg_to19__top">t</a></td><td class="diff_header" id="to19_60">60</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;computation.</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_64">64</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to19_61">61</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_65">65</td><td nowrap="nowrap">**Type&nbsp;Constraints**</td><td class="diff_next"></td><td class="diff_header" id="to19_62">62</td><td nowrap="nowrap">**Type&nbsp;Constraints**</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_66">66</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to19_63">63</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_67">67</td><td nowrap="nowrap">*&nbsp;**T**&nbsp;in&nbsp;(</td><td class="diff_next"></td><td class="diff_header" id="to19_64">64</td><td nowrap="nowrap">*&nbsp;**T**&nbsp;in&nbsp;(</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_68">68</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(double),</td><td class="diff_next"></td><td class="diff_header" id="to19_65">65</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(double),</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_69">69</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(float),</td><td class="diff_next"></td><td class="diff_header" id="to19_66">66</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(float),</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_70">70</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(float16)</td><td class="diff_next"></td><td class="diff_header" id="to19_67">67</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(float16)</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_71">71</td><td nowrap="nowrap">&nbsp;&nbsp;):</td><td class="diff_next"></td><td class="diff_header" id="to19_68">68</td><td nowrap="nowrap">&nbsp;&nbsp;):</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from19_72">72</td><td nowrap="nowrap">&nbsp;&nbsp;Constrain&nbsp;input&nbsp;and&nbsp;output&nbsp;types&nbsp;to&nbsp;float&nbsp;tensors.</td><td class="diff_next"></td><td class="diff_header" id="to19_69">69</td><td nowrap="nowrap">&nbsp;&nbsp;Constrain&nbsp;input&nbsp;and&nbsp;output&nbsp;types&nbsp;to&nbsp;float&nbsp;tensors.</td></tr>
            </tbody>
        </table>

.. _l-onnx-op-batchnormalization-6:

BatchNormalization - 6
======================

**Version**

* **name**: `BatchNormalization (GitHub) <https://github.com/onnx/onnx/blob/main/docs/Operators.md#BatchNormalization>`_
* **domain**: **main**
* **since_version**: **6**
* **function**: False
* **support_level**: SupportType.COMMON
* **shape inference**: True

This version of the operator has been available
**since version 6**.

**Summary**

Carries out batch normalization as described in the paper
https://arxiv.org/abs/1502.03167. Depending on the mode it is being run,
there are multiple cases for the number of outputs, which we list below:

Output case #1: Y, mean, var, saved_mean, saved_var (training mode)
Output case #2: Y (test mode)

**Attributes**

* **epsilon**:
  The epsilon value to use to avoid division by zero, default is
  1e-5f.
* **is_test**:
  If set to nonzero, run spatial batch normalization in test mode,
  default is 0.
* **momentum**:
  Factor used in computing the running mean and variance.e.g.,
  running_mean = running_mean * momentum + mean * (1 - momentum),
  default is 0.9f.
* **spatial**:
  If true, compute the mean and variance across all spatial elements
  If false, compute the mean and variance across per feature.Default
  is 1.

**Inputs**

* **X** (heterogeneous) - **T**:
  Input data tensor from the previous operator; dimensions for image
  case are (N x C x H x W), where N is the batch size, C is the number
  of channels, and H and W are the height and the width of the data.
  For non image case, the dimensions are in the form of (N x C x D1 x
  D2 ... Dn), where N is the batch size.
* **scale** (heterogeneous) - **T**:
  The scale as a 1-dimensional tensor of size C to be applied to the
  output.
* **B** (heterogeneous) - **T**:
  The bias as a 1-dimensional tensor of size C to be applied to the
  output.
* **mean** (heterogeneous) - **T**:
  The running mean (training) or the estimated mean (testing) as a
  1-dimensional tensor of size C.
* **var** (heterogeneous) - **T**:
  The running variance (training) or the estimated variance (testing)
  as a 1-dimensional tensor of size C.

**Outputs**

Between 1 and 5 outputs.

* **Y** (heterogeneous) - **T**:
  The output tensor of the same shape as X.
* **mean** (optional, heterogeneous) - **T**:
  The running mean after the BatchNormalization operator. Must be in-
  place with the input mean. Should not be used for testing.
* **var** (optional, heterogeneous) - **T**:
  The running variance after the BatchNormalization operator. Must be
  in-place with the input var. Should not be used for testing.
* **saved_mean** (optional, heterogeneous) - **T**:
  Saved mean used during training to speed up gradient computation.
  Should not be used for testing.
* **saved_var** (optional, heterogeneous) - **T**:
  Saved variance used during training to speed up gradient
  computation. Should not be used for testing.

**Type Constraints**

* **T** in (
  tensor(double),
  tensor(float),
  tensor(float16)
  ):
  Constrain input and output types to float tensors.

**Differences**

.. raw:: html

        <table class="diff" id="difflib_chg_to20__top"
               cellspacing="0" cellpadding="0" rules="groups" >
            <colgroup></colgroup> <colgroup></colgroup> <colgroup></colgroup>
            <colgroup></colgroup> <colgroup></colgroup> <colgroup></colgroup>

            <tbody>
                <tr><td class="diff_next"><a href="#difflib_chg_to20__0">f</a></td><td class="diff_header" id="from20_1">1</td><td nowrap="nowrap">Carries&nbsp;out&nbsp;batch&nbsp;normalization&nbsp;as&nbsp;described&nbsp;in&nbsp;the&nbsp;paper</td><td class="diff_next"><a href="#difflib_chg_to20__0">f</a></td><td class="diff_header" id="to20_1">1</td><td nowrap="nowrap">Carries&nbsp;out&nbsp;batch&nbsp;normalization&nbsp;as&nbsp;described&nbsp;in&nbsp;the&nbsp;paper</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_2">2</td><td nowrap="nowrap">https://arxiv.org/abs/1502.03167.&nbsp;Depending&nbsp;on&nbsp;the&nbsp;mode&nbsp;it&nbsp;is&nbsp;being&nbsp;run,</td><td class="diff_next"></td><td class="diff_header" id="to20_2">2</td><td nowrap="nowrap">https://arxiv.org/abs/1502.03167.&nbsp;Depending&nbsp;on&nbsp;the&nbsp;mode&nbsp;it&nbsp;is&nbsp;being&nbsp;run,</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_3">3</td><td nowrap="nowrap">there&nbsp;are&nbsp;multiple&nbsp;cases&nbsp;for&nbsp;the&nbsp;number&nbsp;of&nbsp;outputs,&nbsp;which&nbsp;we&nbsp;list&nbsp;below:</td><td class="diff_next"></td><td class="diff_header" id="to20_3">3</td><td nowrap="nowrap">there&nbsp;are&nbsp;multiple&nbsp;cases&nbsp;for&nbsp;the&nbsp;number&nbsp;of&nbsp;outputs,&nbsp;which&nbsp;we&nbsp;list&nbsp;below:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_4">4</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to20_4">4</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next" id="difflib_chg_to20__0"></td><td class="diff_header" id="from20_5">5</td><td nowrap="nowrap">Output&nbsp;case&nbsp;#1:&nbsp;Y,&nbsp;mean,&nbsp;var,&nbsp;saved_mean,&nbsp;saved_var&nbsp;(training&nbsp;mode)</td><td class="diff_next"></td><td class="diff_header" id="to20_5">5</td><td nowrap="nowrap">Output&nbsp;case&nbsp;#1:&nbsp;Y,&nbsp;mean,&nbsp;var,&nbsp;saved_mean,&nbsp;saved_var&nbsp;(training&nbsp;mode)</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_6">6</td><td nowrap="nowrap">Output&nbsp;case&nbsp;#2:&nbsp;Y&nbsp;(test&nbsp;mode)</td><td class="diff_next"></td><td class="diff_header" id="to20_6">6</td><td nowrap="nowrap">Output&nbsp;case&nbsp;#2:&nbsp;Y&nbsp;(test&nbsp;mode)</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_7">7</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to20_7">7</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_8">8</td><td nowrap="nowrap">**Attributes**</td><td class="diff_next"></td><td class="diff_header" id="to20_8">8</td><td nowrap="nowrap">**Attributes**</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_9">9</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to20_9">9</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to20__1">n</a></td><td class="diff_header" id="from20_10">10</td><td nowrap="nowrap"><span class="diff_sub">*&nbsp;**consumed_inputs**&nbsp;(required):</span></td><td class="diff_next"><a href="#difflib_chg_to20__1">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_11">11</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;legacy&nbsp;optimization&nbsp;attribute.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_12">12</td><td nowrap="nowrap">*&nbsp;**epsilon**:</td><td class="diff_next"></td><td class="diff_header" id="to20_10">10</td><td nowrap="nowrap">*&nbsp;**epsilon**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_13">13</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;epsilon&nbsp;value&nbsp;to&nbsp;use&nbsp;to&nbsp;avoid&nbsp;division&nbsp;by&nbsp;zero,&nbsp;default&nbsp;is</td><td class="diff_next"></td><td class="diff_header" id="to20_11">11</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;epsilon&nbsp;value&nbsp;to&nbsp;use&nbsp;to&nbsp;avoid&nbsp;division&nbsp;by&nbsp;zero,&nbsp;default&nbsp;is</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_14">14</td><td nowrap="nowrap">&nbsp;&nbsp;1e-5f.</td><td class="diff_next"></td><td class="diff_header" id="to20_12">12</td><td nowrap="nowrap">&nbsp;&nbsp;1e-5f.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_15">15</td><td nowrap="nowrap">*&nbsp;**is_test**:</td><td class="diff_next"></td><td class="diff_header" id="to20_13">13</td><td nowrap="nowrap">*&nbsp;**is_test**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_16">16</td><td nowrap="nowrap">&nbsp;&nbsp;If&nbsp;set&nbsp;to&nbsp;nonzero,&nbsp;run&nbsp;spatial&nbsp;batch&nbsp;normalization&nbsp;in&nbsp;test&nbsp;mode,</td><td class="diff_next"></td><td class="diff_header" id="to20_14">14</td><td nowrap="nowrap">&nbsp;&nbsp;If&nbsp;set&nbsp;to&nbsp;nonzero,&nbsp;run&nbsp;spatial&nbsp;batch&nbsp;normalization&nbsp;in&nbsp;test&nbsp;mode,</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_17">17</td><td nowrap="nowrap">&nbsp;&nbsp;default&nbsp;is&nbsp;0.</td><td class="diff_next"></td><td class="diff_header" id="to20_15">15</td><td nowrap="nowrap">&nbsp;&nbsp;default&nbsp;is&nbsp;0.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_18">18</td><td nowrap="nowrap">*&nbsp;**momentum**:</td><td class="diff_next"></td><td class="diff_header" id="to20_16">16</td><td nowrap="nowrap">*&nbsp;**momentum**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_19">19</td><td nowrap="nowrap">&nbsp;&nbsp;Factor&nbsp;used&nbsp;in&nbsp;computing&nbsp;the&nbsp;running&nbsp;mean&nbsp;and&nbsp;variance.e.g.,</td><td class="diff_next"></td><td class="diff_header" id="to20_17">17</td><td nowrap="nowrap">&nbsp;&nbsp;Factor&nbsp;used&nbsp;in&nbsp;computing&nbsp;the&nbsp;running&nbsp;mean&nbsp;and&nbsp;variance.e.g.,</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_20">20</td><td nowrap="nowrap">&nbsp;&nbsp;running_mean&nbsp;=&nbsp;running_mean&nbsp;*&nbsp;momentum&nbsp;+&nbsp;mean&nbsp;*&nbsp;(1&nbsp;-&nbsp;momentum),</td><td class="diff_next"></td><td class="diff_header" id="to20_18">18</td><td nowrap="nowrap">&nbsp;&nbsp;running_mean&nbsp;=&nbsp;running_mean&nbsp;*&nbsp;momentum&nbsp;+&nbsp;mean&nbsp;*&nbsp;(1&nbsp;-&nbsp;momentum),</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_21">21</td><td nowrap="nowrap">&nbsp;&nbsp;default&nbsp;is&nbsp;0.9f.</td><td class="diff_next"></td><td class="diff_header" id="to20_19">19</td><td nowrap="nowrap">&nbsp;&nbsp;default&nbsp;is&nbsp;0.9f.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_22">22</td><td nowrap="nowrap">*&nbsp;**spatial**:</td><td class="diff_next"></td><td class="diff_header" id="to20_20">20</td><td nowrap="nowrap">*&nbsp;**spatial**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_23">23</td><td nowrap="nowrap">&nbsp;&nbsp;If&nbsp;true,&nbsp;compute&nbsp;the&nbsp;mean&nbsp;and&nbsp;variance&nbsp;across&nbsp;all&nbsp;spatial&nbsp;elements</td><td class="diff_next"></td><td class="diff_header" id="to20_21">21</td><td nowrap="nowrap">&nbsp;&nbsp;If&nbsp;true,&nbsp;compute&nbsp;the&nbsp;mean&nbsp;and&nbsp;variance&nbsp;across&nbsp;all&nbsp;spatial&nbsp;elements</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_24">24</td><td nowrap="nowrap">&nbsp;&nbsp;If&nbsp;false,&nbsp;compute&nbsp;the&nbsp;mean&nbsp;and&nbsp;variance&nbsp;across&nbsp;per&nbsp;feature.Default</td><td class="diff_next"></td><td class="diff_header" id="to20_22">22</td><td nowrap="nowrap">&nbsp;&nbsp;If&nbsp;false,&nbsp;compute&nbsp;the&nbsp;mean&nbsp;and&nbsp;variance&nbsp;across&nbsp;per&nbsp;feature.Default</td></tr>
                <tr><td class="diff_next" id="difflib_chg_to20__1"></td><td class="diff_header" id="from20_25">25</td><td nowrap="nowrap">&nbsp;&nbsp;is&nbsp;1.</td><td class="diff_next"></td><td class="diff_header" id="to20_23">23</td><td nowrap="nowrap">&nbsp;&nbsp;is&nbsp;1.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_26">26</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to20_24">24</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_27">27</td><td nowrap="nowrap">**Inputs**</td><td class="diff_next"></td><td class="diff_header" id="to20_25">25</td><td nowrap="nowrap">**Inputs**</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_28">28</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to20_26">26</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_29">29</td><td nowrap="nowrap">*&nbsp;**X**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to20_27">27</td><td nowrap="nowrap">*&nbsp;**X**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to20__2">n</a></td><td class="diff_header" id="from20_30">30</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;The&nbsp;input&nbsp;4-dimensional&nbsp;tensor&nbsp;of&nbsp;shape&nbsp;NCHW.</span></td><td class="diff_next"><a href="#difflib_chg_to20__2">n</a></td><td class="diff_header" id="to20_28">28</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;Input&nbsp;data&nbsp;tensor&nbsp;from&nbsp;the&nbsp;previous&nbsp;operator;&nbsp;dimensions&nbsp;for&nbsp;image</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to20_29">29</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;case&nbsp;are&nbsp;(N&nbsp;x&nbsp;C&nbsp;x&nbsp;H&nbsp;x&nbsp;W),&nbsp;where&nbsp;N&nbsp;is&nbsp;the&nbsp;batch&nbsp;size,&nbsp;C&nbsp;is&nbsp;the&nbsp;number</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to20_30">30</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;of&nbsp;channels,&nbsp;and&nbsp;H&nbsp;and&nbsp;W&nbsp;are&nbsp;the&nbsp;height&nbsp;and&nbsp;the&nbsp;width&nbsp;of&nbsp;the&nbsp;data.</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to20_31">31</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;For&nbsp;non&nbsp;image&nbsp;case,&nbsp;the&nbsp;dimensions&nbsp;are&nbsp;in&nbsp;the&nbsp;form&nbsp;of&nbsp;(N&nbsp;x&nbsp;C&nbsp;x&nbsp;D1&nbsp;x</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to20_32">32</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;D2&nbsp;...&nbsp;Dn),&nbsp;where&nbsp;N&nbsp;is&nbsp;the&nbsp;batch&nbsp;size.</span></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_31">31</td><td nowrap="nowrap">*&nbsp;**scale**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to20_33">33</td><td nowrap="nowrap">*&nbsp;**scale**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_32">32</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;scale&nbsp;as&nbsp;a&nbsp;1-dimensional&nbsp;tensor&nbsp;of&nbsp;size&nbsp;C&nbsp;to&nbsp;be&nbsp;applied&nbsp;to&nbsp;the</td><td class="diff_next"></td><td class="diff_header" id="to20_34">34</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;scale&nbsp;as&nbsp;a&nbsp;1-dimensional&nbsp;tensor&nbsp;of&nbsp;size&nbsp;C&nbsp;to&nbsp;be&nbsp;applied&nbsp;to&nbsp;the</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_33">33</td><td nowrap="nowrap">&nbsp;&nbsp;output.</td><td class="diff_next"></td><td class="diff_header" id="to20_35">35</td><td nowrap="nowrap">&nbsp;&nbsp;output.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_34">34</td><td nowrap="nowrap">*&nbsp;**B**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to20_36">36</td><td nowrap="nowrap">*&nbsp;**B**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_35">35</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;bias&nbsp;as&nbsp;a&nbsp;1-dimensional&nbsp;tensor&nbsp;of&nbsp;size&nbsp;C&nbsp;to&nbsp;be&nbsp;applied&nbsp;to&nbsp;the</td><td class="diff_next"></td><td class="diff_header" id="to20_37">37</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;bias&nbsp;as&nbsp;a&nbsp;1-dimensional&nbsp;tensor&nbsp;of&nbsp;size&nbsp;C&nbsp;to&nbsp;be&nbsp;applied&nbsp;to&nbsp;the</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_36">36</td><td nowrap="nowrap">&nbsp;&nbsp;output.</td><td class="diff_next"></td><td class="diff_header" id="to20_38">38</td><td nowrap="nowrap">&nbsp;&nbsp;output.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_37">37</td><td nowrap="nowrap">*&nbsp;**mean**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to20_39">39</td><td nowrap="nowrap">*&nbsp;**mean**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_38">38</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;running&nbsp;mean&nbsp;(training)&nbsp;or&nbsp;the&nbsp;estimated&nbsp;mean&nbsp;(testing)&nbsp;as&nbsp;a</td><td class="diff_next"></td><td class="diff_header" id="to20_40">40</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;running&nbsp;mean&nbsp;(training)&nbsp;or&nbsp;the&nbsp;estimated&nbsp;mean&nbsp;(testing)&nbsp;as&nbsp;a</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_39">39</td><td nowrap="nowrap">&nbsp;&nbsp;1-dimensional&nbsp;tensor&nbsp;of&nbsp;size&nbsp;C.</td><td class="diff_next"></td><td class="diff_header" id="to20_41">41</td><td nowrap="nowrap">&nbsp;&nbsp;1-dimensional&nbsp;tensor&nbsp;of&nbsp;size&nbsp;C.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_40">40</td><td nowrap="nowrap">*&nbsp;**var**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to20_42">42</td><td nowrap="nowrap">*&nbsp;**var**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_41">41</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;running&nbsp;variance&nbsp;(training)&nbsp;or&nbsp;the&nbsp;estimated&nbsp;variance&nbsp;(testing)</td><td class="diff_next"></td><td class="diff_header" id="to20_43">43</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;running&nbsp;variance&nbsp;(training)&nbsp;or&nbsp;the&nbsp;estimated&nbsp;variance&nbsp;(testing)</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_42">42</td><td nowrap="nowrap">&nbsp;&nbsp;as&nbsp;a&nbsp;1-dimensional&nbsp;tensor&nbsp;of&nbsp;size&nbsp;C.</td><td class="diff_next"></td><td class="diff_header" id="to20_44">44</td><td nowrap="nowrap">&nbsp;&nbsp;as&nbsp;a&nbsp;1-dimensional&nbsp;tensor&nbsp;of&nbsp;size&nbsp;C.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_43">43</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to20_45">45</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next" id="difflib_chg_to20__2"></td><td class="diff_header" id="from20_44">44</td><td nowrap="nowrap">**Outputs**</td><td class="diff_next"></td><td class="diff_header" id="to20_46">46</td><td nowrap="nowrap">**Outputs**</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_45">45</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to20_47">47</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_46">46</td><td nowrap="nowrap">Between&nbsp;1&nbsp;and&nbsp;5&nbsp;outputs.</td><td class="diff_next"></td><td class="diff_header" id="to20_48">48</td><td nowrap="nowrap">Between&nbsp;1&nbsp;and&nbsp;5&nbsp;outputs.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_47">47</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to20_49">49</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_48">48</td><td nowrap="nowrap">*&nbsp;**Y**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to20_50">50</td><td nowrap="nowrap">*&nbsp;**Y**&nbsp;(heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next"><a href="#difflib_chg_to20__top">t</a></td><td class="diff_header" id="from20_49">49</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;output&nbsp;<span class="diff_sub">4-dimensional&nbsp;</span>tensor&nbsp;of&nbsp;the&nbsp;same&nbsp;shape&nbsp;as&nbsp;X.</td><td class="diff_next"><a href="#difflib_chg_to20__top">t</a></td><td class="diff_header" id="to20_51">51</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;output&nbsp;tensor&nbsp;of&nbsp;the&nbsp;same&nbsp;shape&nbsp;as&nbsp;X.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_50">50</td><td nowrap="nowrap">*&nbsp;**mean**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to20_52">52</td><td nowrap="nowrap">*&nbsp;**mean**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_51">51</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;running&nbsp;mean&nbsp;after&nbsp;the&nbsp;BatchNormalization&nbsp;operator.&nbsp;Must&nbsp;be&nbsp;in-</td><td class="diff_next"></td><td class="diff_header" id="to20_53">53</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;running&nbsp;mean&nbsp;after&nbsp;the&nbsp;BatchNormalization&nbsp;operator.&nbsp;Must&nbsp;be&nbsp;in-</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_52">52</td><td nowrap="nowrap">&nbsp;&nbsp;place&nbsp;with&nbsp;the&nbsp;input&nbsp;mean.&nbsp;Should&nbsp;not&nbsp;be&nbsp;used&nbsp;for&nbsp;testing.</td><td class="diff_next"></td><td class="diff_header" id="to20_54">54</td><td nowrap="nowrap">&nbsp;&nbsp;place&nbsp;with&nbsp;the&nbsp;input&nbsp;mean.&nbsp;Should&nbsp;not&nbsp;be&nbsp;used&nbsp;for&nbsp;testing.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_53">53</td><td nowrap="nowrap">*&nbsp;**var**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to20_55">55</td><td nowrap="nowrap">*&nbsp;**var**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_54">54</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;running&nbsp;variance&nbsp;after&nbsp;the&nbsp;BatchNormalization&nbsp;operator.&nbsp;Must&nbsp;be</td><td class="diff_next"></td><td class="diff_header" id="to20_56">56</td><td nowrap="nowrap">&nbsp;&nbsp;The&nbsp;running&nbsp;variance&nbsp;after&nbsp;the&nbsp;BatchNormalization&nbsp;operator.&nbsp;Must&nbsp;be</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_55">55</td><td nowrap="nowrap">&nbsp;&nbsp;in-place&nbsp;with&nbsp;the&nbsp;input&nbsp;var.&nbsp;Should&nbsp;not&nbsp;be&nbsp;used&nbsp;for&nbsp;testing.</td><td class="diff_next"></td><td class="diff_header" id="to20_57">57</td><td nowrap="nowrap">&nbsp;&nbsp;in-place&nbsp;with&nbsp;the&nbsp;input&nbsp;var.&nbsp;Should&nbsp;not&nbsp;be&nbsp;used&nbsp;for&nbsp;testing.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_56">56</td><td nowrap="nowrap">*&nbsp;**saved_mean**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to20_58">58</td><td nowrap="nowrap">*&nbsp;**saved_mean**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_57">57</td><td nowrap="nowrap">&nbsp;&nbsp;Saved&nbsp;mean&nbsp;used&nbsp;during&nbsp;training&nbsp;to&nbsp;speed&nbsp;up&nbsp;gradient&nbsp;computation.</td><td class="diff_next"></td><td class="diff_header" id="to20_59">59</td><td nowrap="nowrap">&nbsp;&nbsp;Saved&nbsp;mean&nbsp;used&nbsp;during&nbsp;training&nbsp;to&nbsp;speed&nbsp;up&nbsp;gradient&nbsp;computation.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_58">58</td><td nowrap="nowrap">&nbsp;&nbsp;Should&nbsp;not&nbsp;be&nbsp;used&nbsp;for&nbsp;testing.</td><td class="diff_next"></td><td class="diff_header" id="to20_60">60</td><td nowrap="nowrap">&nbsp;&nbsp;Should&nbsp;not&nbsp;be&nbsp;used&nbsp;for&nbsp;testing.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_59">59</td><td nowrap="nowrap">*&nbsp;**saved_var**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**T**:</td><td class="diff_next"></td><td class="diff_header" id="to20_61">61</td><td nowrap="nowrap">*&nbsp;**saved_var**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**T**:</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_60">60</td><td nowrap="nowrap">&nbsp;&nbsp;Saved&nbsp;variance&nbsp;used&nbsp;during&nbsp;training&nbsp;to&nbsp;speed&nbsp;up&nbsp;gradient</td><td class="diff_next"></td><td class="diff_header" id="to20_62">62</td><td nowrap="nowrap">&nbsp;&nbsp;Saved&nbsp;variance&nbsp;used&nbsp;during&nbsp;training&nbsp;to&nbsp;speed&nbsp;up&nbsp;gradient</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_61">61</td><td nowrap="nowrap">&nbsp;&nbsp;computation.&nbsp;Should&nbsp;not&nbsp;be&nbsp;used&nbsp;for&nbsp;testing.</td><td class="diff_next"></td><td class="diff_header" id="to20_63">63</td><td nowrap="nowrap">&nbsp;&nbsp;computation.&nbsp;Should&nbsp;not&nbsp;be&nbsp;used&nbsp;for&nbsp;testing.</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_62">62</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to20_64">64</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_63">63</td><td nowrap="nowrap">**Type&nbsp;Constraints**</td><td class="diff_next"></td><td class="diff_header" id="to20_65">65</td><td nowrap="nowrap">**Type&nbsp;Constraints**</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_64">64</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to20_66">66</td><td nowrap="nowrap"></td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_65">65</td><td nowrap="nowrap">*&nbsp;**T**&nbsp;in&nbsp;(</td><td class="diff_next"></td><td class="diff_header" id="to20_67">67</td><td nowrap="nowrap">*&nbsp;**T**&nbsp;in&nbsp;(</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_66">66</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(double),</td><td class="diff_next"></td><td class="diff_header" id="to20_68">68</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(double),</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_67">67</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(float),</td><td class="diff_next"></td><td class="diff_header" id="to20_69">69</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(float),</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_68">68</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(float16)</td><td class="diff_next"></td><td class="diff_header" id="to20_70">70</td><td nowrap="nowrap">&nbsp;&nbsp;tensor(float16)</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_69">69</td><td nowrap="nowrap">&nbsp;&nbsp;):</td><td class="diff_next"></td><td class="diff_header" id="to20_71">71</td><td nowrap="nowrap">&nbsp;&nbsp;):</td></tr>
                <tr><td class="diff_next"></td><td class="diff_header" id="from20_70">70</td><td nowrap="nowrap">&nbsp;&nbsp;Constrain&nbsp;input&nbsp;and&nbsp;output&nbsp;types&nbsp;to&nbsp;float&nbsp;tensors.</td><td class="diff_next"></td><td class="diff_header" id="to20_72">72</td><td nowrap="nowrap">&nbsp;&nbsp;Constrain&nbsp;input&nbsp;and&nbsp;output&nbsp;types&nbsp;to&nbsp;float&nbsp;tensors.</td></tr>
            </tbody>
        </table>

.. _l-onnx-op-batchnormalization-1:

BatchNormalization - 1
======================

**Version**

* **name**: `BatchNormalization (GitHub) <https://github.com/onnx/onnx/blob/main/docs/Operators.md#BatchNormalization>`_
* **domain**: **main**
* **since_version**: **1**
* **function**: False
* **support_level**: SupportType.COMMON
* **shape inference**: False

This version of the operator has been available
**since version 1**.

**Summary**

Carries out batch normalization as described in the paper
https://arxiv.org/abs/1502.03167. Depending on the mode it is being run,
there are multiple cases for the number of outputs, which we list below:

Output case #1: Y, mean, var, saved_mean, saved_var (training mode)
Output case #2: Y (test mode)

**Attributes**

* **consumed_inputs** (required):
  legacy optimization attribute.
* **epsilon**:
  The epsilon value to use to avoid division by zero, default is
  1e-5f.
* **is_test**:
  If set to nonzero, run spatial batch normalization in test mode,
  default is 0.
* **momentum**:
  Factor used in computing the running mean and variance.e.g.,
  running_mean = running_mean * momentum + mean * (1 - momentum),
  default is 0.9f.
* **spatial**:
  If true, compute the mean and variance across all spatial elements
  If false, compute the mean and variance across per feature.Default
  is 1.

**Inputs**

* **X** (heterogeneous) - **T**:
  The input 4-dimensional tensor of shape NCHW.
* **scale** (heterogeneous) - **T**:
  The scale as a 1-dimensional tensor of size C to be applied to the
  output.
* **B** (heterogeneous) - **T**:
  The bias as a 1-dimensional tensor of size C to be applied to the
  output.
* **mean** (heterogeneous) - **T**:
  The running mean (training) or the estimated mean (testing) as a
  1-dimensional tensor of size C.
* **var** (heterogeneous) - **T**:
  The running variance (training) or the estimated variance (testing)
  as a 1-dimensional tensor of size C.

**Outputs**

Between 1 and 5 outputs.

* **Y** (heterogeneous) - **T**:
  The output 4-dimensional tensor of the same shape as X.
* **mean** (optional, heterogeneous) - **T**:
  The running mean after the BatchNormalization operator. Must be in-
  place with the input mean. Should not be used for testing.
* **var** (optional, heterogeneous) - **T**:
  The running variance after the BatchNormalization operator. Must be
  in-place with the input var. Should not be used for testing.
* **saved_mean** (optional, heterogeneous) - **T**:
  Saved mean used during training to speed up gradient computation.
  Should not be used for testing.
* **saved_var** (optional, heterogeneous) - **T**:
  Saved variance used during training to speed up gradient
  computation. Should not be used for testing.

**Type Constraints**

* **T** in (
  tensor(double),
  tensor(float),
  tensor(float16)
  ):
  Constrain input and output types to float tensors.
