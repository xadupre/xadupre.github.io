<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>NonMaxSuppression &#8212; ONNX 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sample.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="NonZero" href="onnx__NonZero.html" />
    <link rel="prev" title="NegativeLogLikelihoodLoss" href="onnx__NegativeLogLikelihoodLoss.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          ONNX Docs</a>
        <span class="navbar-text navbar-version pull-left"><b>0.1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../onnx-api/index.html">API Overview</a></li>
                <li><a href="../operators/index.html">Op Schemas</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><p class="caption" role="heading"><span class="caption-text">API Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../onnx-api/modules/onnx.checker.html">onnx.checker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../onnx-api/modules/onnx.compose.html">onnx.compose</a></li>
<li class="toctree-l1"><a class="reference internal" href="../onnx-api/modules/onnx.external_data_helper.html">onnx.external_data_helper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../onnx-api/modules/onnx.helper.html">onnx.helper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../onnx-api/modules/onnx.hub.html">onnx.hub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../onnx-api/modules/onnx.numpy_helper.html">onnx.numpy_helper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../onnx-api/modules/onnx.parser.html">onnx.parser</a></li>
<li class="toctree-l1"><a class="reference internal" href="../onnx-api/modules/onnx.utils.html">onnx.utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../onnx-api/modules/onnx.version.version.html">onnx.version.version</a></li>
<li class="toctree-l1"><a class="reference internal" href="../onnx-api/modules/onnx.version_converter.html">onnx.version_converter</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Operators + OpSchemas</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">ONNX operators</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">NonMaxSuppression</a><ul>
<li><a class="reference internal" href="#nonmaxsuppression-11">NonMaxSuppression - 11</a></li>
<li><a class="reference internal" href="#nonmaxsuppression-10">NonMaxSuppression - 10</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="onnx__NegativeLogLikelihoodLoss.html" title="Previous Chapter: NegativeLogLikelihoodLoss"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; NegativeLogLi...</span>
    </a>
  </li>
  <li>
    <a href="onnx__NonZero.html" title="Next Chapter: NonZero"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">NonZero &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/onnx_doc_folder/onnx__NonMaxSuppression.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <section id="nonmaxsuppression">
<span id="l-onnx-doc-nonmaxsuppression"></span><h1>NonMaxSuppression<a class="headerlink" href="#nonmaxsuppression" title="Permalink to this heading">¶</a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#nonmaxsuppression-11" id="id2">NonMaxSuppression - 11</a></p></li>
<li><p><a class="reference internal" href="#nonmaxsuppression-10" id="id3">NonMaxSuppression - 10</a></p></li>
</ul>
</nav>
<section id="nonmaxsuppression-11">
<span id="l-onnx-op-nonmaxsuppression-11"></span><h2><a class="toc-backref" href="#id2" role="doc-backlink">NonMaxSuppression - 11</a><a class="headerlink" href="#nonmaxsuppression-11" title="Permalink to this heading">¶</a></h2>
<p><strong>Version</strong>
* <strong>name</strong>: <a class="reference external" href="https://github.com/onnx/onnx/blob/main/docs/Operators.md#NonMaxSuppression">NonMaxSuppression (GitHub)</a>
* <strong>domain</strong>: <strong>main</strong>
* <strong>since_version</strong>: <strong>11</strong>
* <strong>function</strong>: False
* <strong>support_level</strong>: SupportType.COMMON
* <strong>shape inference</strong>: True</p>
<p>This version of the operator has been available
<strong>since version 11</strong>.</p>
<p><strong>Summary</strong></p>
<p>Filter out boxes that have high intersection-over-union (IOU) overlap with previously selected boxes.
Bounding boxes with score less than score_threshold are removed. Bounding box format is indicated by attribute center_point_box.
Note that this algorithm is agnostic to where the origin is in the coordinate system and more generally is invariant to
orthogonal transformations and translations of the coordinate system; thus translating or reflections of the coordinate system
result in the same boxes being selected by the algorithm.
The selected_indices output is a set of integers indexing into the input collection of bounding boxes representing the selected boxes.
The bounding box coordinates corresponding to the selected indices can then be obtained using the Gather or GatherND operation.</p>
<p><strong>Attributes</strong>
* <strong>center_point_box</strong>:</p>
<blockquote>
<div><p>Integer indicate the format of the box data. The default is 0. 0 -
the box data is supplied as [y1, x1, y2, x2] where (y1, x1) and (y2,
x2) are the coordinates of any diagonal pair of box corners and the
coordinates can be provided as normalized (i.e., lying in the
interval [0, 1]) or absolute. Mostly used for TF models. 1 - the box
data is supplied as [x_center, y_center, width, height]. Mostly used
for Pytorch models.</p>
</div></blockquote>
<p><strong>Inputs</strong>
Between 2 and 5 inputs.</p>
<ul class="simple">
<li><p><strong>boxes</strong> (heterogeneous) - <strong>tensor(float)</strong>:
An input tensor with shape [num_batches, spatial_dimension, 4]. The
single box data format is indicated by center_point_box.</p></li>
<li><p><strong>scores</strong> (heterogeneous) - <strong>tensor(float)</strong>:
An input tensor with shape [num_batches, num_classes,
spatial_dimension]</p></li>
<li><p><strong>max_output_boxes_per_class</strong> (optional, heterogeneous) - <strong>tensor(int64)</strong>:
Integer representing the maximum number of boxes to be selected per
batch per class. It is a scalar. Default to 0, which means no
output.</p></li>
<li><p><strong>iou_threshold</strong> (optional, heterogeneous) - <strong>tensor(float)</strong>:
Float representing the threshold for deciding whether boxes overlap
too much with respect to IOU. It is scalar. Value range [0, 1].
Default to 0.</p></li>
<li><p><strong>score_threshold</strong> (optional, heterogeneous) - <strong>tensor(float)</strong>:
Float representing the threshold for deciding when to remove boxes
based on score. It is a scalar.</p></li>
</ul>
<p><strong>Outputs</strong></p>
<ul class="simple">
<li><p><strong>selected_indices</strong> (heterogeneous) - <strong>tensor(int64)</strong>:
selected indices from the boxes tensor. [num_selected_indices, 3],
the selected index format is [batch_index, class_index, box_index].</p></li>
</ul>
<p><strong>Examples</strong></p>
<p><strong>_nonmaxsuppression_suppress_by_IOU</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">node</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_node</span><span class="p">(</span>
    <span class="s2">&quot;NonMaxSuppression&quot;</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;boxes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;scores&quot;</span><span class="p">,</span>
        <span class="s2">&quot;max_output_boxes_per_class&quot;</span><span class="p">,</span>
        <span class="s2">&quot;iou_threshold&quot;</span><span class="p">,</span>
        <span class="s2">&quot;score_threshold&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;selected_indices&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">boxes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">11.0</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">11.1</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">101.0</span><span class="p">],</span>
        <span class="p">]</span>
    <span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]]])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">max_output_boxes_per_class</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<span class="n">iou_threshold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">score_threshold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">selected_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>

<span class="n">expect</span><span class="p">(</span>
    <span class="n">node</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span>
        <span class="n">boxes</span><span class="p">,</span>
        <span class="n">scores</span><span class="p">,</span>
        <span class="n">max_output_boxes_per_class</span><span class="p">,</span>
        <span class="n">iou_threshold</span><span class="p">,</span>
        <span class="n">score_threshold</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="n">selected_indices</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;test_nonmaxsuppression_suppress_by_IOU&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>_nonmaxsuppression_suppress_by_IOU_and_scores</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">node</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_node</span><span class="p">(</span>
    <span class="s2">&quot;NonMaxSuppression&quot;</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;boxes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;scores&quot;</span><span class="p">,</span>
        <span class="s2">&quot;max_output_boxes_per_class&quot;</span><span class="p">,</span>
        <span class="s2">&quot;iou_threshold&quot;</span><span class="p">,</span>
        <span class="s2">&quot;score_threshold&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;selected_indices&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">boxes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">11.0</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">11.1</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">101.0</span><span class="p">],</span>
        <span class="p">]</span>
    <span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]]])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">max_output_boxes_per_class</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<span class="n">iou_threshold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">score_threshold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.4</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">selected_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>

<span class="n">expect</span><span class="p">(</span>
    <span class="n">node</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span>
        <span class="n">boxes</span><span class="p">,</span>
        <span class="n">scores</span><span class="p">,</span>
        <span class="n">max_output_boxes_per_class</span><span class="p">,</span>
        <span class="n">iou_threshold</span><span class="p">,</span>
        <span class="n">score_threshold</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="n">selected_indices</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;test_nonmaxsuppression_suppress_by_IOU_and_scores&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>_nonmaxsuppression_flipped_coordinates</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">node</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_node</span><span class="p">(</span>
    <span class="s2">&quot;NonMaxSuppression&quot;</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;boxes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;scores&quot;</span><span class="p">,</span>
        <span class="s2">&quot;max_output_boxes_per_class&quot;</span><span class="p">,</span>
        <span class="s2">&quot;iou_threshold&quot;</span><span class="p">,</span>
        <span class="s2">&quot;score_threshold&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;selected_indices&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">boxes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">11.0</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">11.1</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">101.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">],</span>
        <span class="p">]</span>
    <span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]]])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">max_output_boxes_per_class</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<span class="n">iou_threshold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">score_threshold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">selected_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>

<span class="n">expect</span><span class="p">(</span>
    <span class="n">node</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span>
        <span class="n">boxes</span><span class="p">,</span>
        <span class="n">scores</span><span class="p">,</span>
        <span class="n">max_output_boxes_per_class</span><span class="p">,</span>
        <span class="n">iou_threshold</span><span class="p">,</span>
        <span class="n">score_threshold</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="n">selected_indices</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;test_nonmaxsuppression_flipped_coordinates&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>_nonmaxsuppression_limit_output_size</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">node</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_node</span><span class="p">(</span>
    <span class="s2">&quot;NonMaxSuppression&quot;</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;boxes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;scores&quot;</span><span class="p">,</span>
        <span class="s2">&quot;max_output_boxes_per_class&quot;</span><span class="p">,</span>
        <span class="s2">&quot;iou_threshold&quot;</span><span class="p">,</span>
        <span class="s2">&quot;score_threshold&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;selected_indices&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">boxes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">11.0</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">11.1</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">101.0</span><span class="p">],</span>
        <span class="p">]</span>
    <span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]]])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">max_output_boxes_per_class</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<span class="n">iou_threshold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">score_threshold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">selected_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>

<span class="n">expect</span><span class="p">(</span>
    <span class="n">node</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span>
        <span class="n">boxes</span><span class="p">,</span>
        <span class="n">scores</span><span class="p">,</span>
        <span class="n">max_output_boxes_per_class</span><span class="p">,</span>
        <span class="n">iou_threshold</span><span class="p">,</span>
        <span class="n">score_threshold</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="n">selected_indices</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;test_nonmaxsuppression_limit_output_size&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>_nonmaxsuppression_single_box</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">node</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_node</span><span class="p">(</span>
    <span class="s2">&quot;NonMaxSuppression&quot;</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;boxes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;scores&quot;</span><span class="p">,</span>
        <span class="s2">&quot;max_output_boxes_per_class&quot;</span><span class="p">,</span>
        <span class="s2">&quot;iou_threshold&quot;</span><span class="p">,</span>
        <span class="s2">&quot;score_threshold&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;selected_indices&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">boxes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]]])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mf">0.9</span><span class="p">]]])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">max_output_boxes_per_class</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<span class="n">iou_threshold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">score_threshold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">selected_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>

<span class="n">expect</span><span class="p">(</span>
    <span class="n">node</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span>
        <span class="n">boxes</span><span class="p">,</span>
        <span class="n">scores</span><span class="p">,</span>
        <span class="n">max_output_boxes_per_class</span><span class="p">,</span>
        <span class="n">iou_threshold</span><span class="p">,</span>
        <span class="n">score_threshold</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="n">selected_indices</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;test_nonmaxsuppression_single_box&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>_nonmaxsuppression_identical_boxes</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">node</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_node</span><span class="p">(</span>
    <span class="s2">&quot;NonMaxSuppression&quot;</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;boxes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;scores&quot;</span><span class="p">,</span>
        <span class="s2">&quot;max_output_boxes_per_class&quot;</span><span class="p">,</span>
        <span class="s2">&quot;iou_threshold&quot;</span><span class="p">,</span>
        <span class="s2">&quot;score_threshold&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;selected_indices&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">boxes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
        <span class="p">]</span>
    <span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[[[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]]]</span>
<span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">max_output_boxes_per_class</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<span class="n">iou_threshold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">score_threshold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">selected_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>

<span class="n">expect</span><span class="p">(</span>
    <span class="n">node</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span>
        <span class="n">boxes</span><span class="p">,</span>
        <span class="n">scores</span><span class="p">,</span>
        <span class="n">max_output_boxes_per_class</span><span class="p">,</span>
        <span class="n">iou_threshold</span><span class="p">,</span>
        <span class="n">score_threshold</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="n">selected_indices</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;test_nonmaxsuppression_identical_boxes&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>_nonmaxsuppression_center_point_box_format</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">node</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_node</span><span class="p">(</span>
    <span class="s2">&quot;NonMaxSuppression&quot;</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;boxes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;scores&quot;</span><span class="p">,</span>
        <span class="s2">&quot;max_output_boxes_per_class&quot;</span><span class="p">,</span>
        <span class="s2">&quot;iou_threshold&quot;</span><span class="p">,</span>
        <span class="s2">&quot;score_threshold&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;selected_indices&quot;</span><span class="p">],</span>
    <span class="n">center_point_box</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">boxes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">10.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">10.6</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">100.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
        <span class="p">]</span>
    <span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]]])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">max_output_boxes_per_class</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<span class="n">iou_threshold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">score_threshold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">selected_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>

<span class="n">expect</span><span class="p">(</span>
    <span class="n">node</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span>
        <span class="n">boxes</span><span class="p">,</span>
        <span class="n">scores</span><span class="p">,</span>
        <span class="n">max_output_boxes_per_class</span><span class="p">,</span>
        <span class="n">iou_threshold</span><span class="p">,</span>
        <span class="n">score_threshold</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="n">selected_indices</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;test_nonmaxsuppression_center_point_box_format&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>_nonmaxsuppression_two_classes</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">node</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_node</span><span class="p">(</span>
    <span class="s2">&quot;NonMaxSuppression&quot;</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;boxes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;scores&quot;</span><span class="p">,</span>
        <span class="s2">&quot;max_output_boxes_per_class&quot;</span><span class="p">,</span>
        <span class="s2">&quot;iou_threshold&quot;</span><span class="p">,</span>
        <span class="s2">&quot;score_threshold&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;selected_indices&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">boxes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">11.0</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">11.1</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">101.0</span><span class="p">],</span>
        <span class="p">]</span>
    <span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[[[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]]]</span>
<span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">max_output_boxes_per_class</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<span class="n">iou_threshold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">score_threshold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">selected_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>

<span class="n">expect</span><span class="p">(</span>
    <span class="n">node</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span>
        <span class="n">boxes</span><span class="p">,</span>
        <span class="n">scores</span><span class="p">,</span>
        <span class="n">max_output_boxes_per_class</span><span class="p">,</span>
        <span class="n">iou_threshold</span><span class="p">,</span>
        <span class="n">score_threshold</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="n">selected_indices</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;test_nonmaxsuppression_two_classes&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>_nonmaxsuppression_two_batches</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">node</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_node</span><span class="p">(</span>
    <span class="s2">&quot;NonMaxSuppression&quot;</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;boxes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;scores&quot;</span><span class="p">,</span>
        <span class="s2">&quot;max_output_boxes_per_class&quot;</span><span class="p">,</span>
        <span class="s2">&quot;iou_threshold&quot;</span><span class="p">,</span>
        <span class="s2">&quot;score_threshold&quot;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;selected_indices&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">boxes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">11.0</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">11.1</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">101.0</span><span class="p">],</span>
        <span class="p">],</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">11.0</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">11.1</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">101.0</span><span class="p">],</span>
        <span class="p">],</span>
    <span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[[[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]],</span> <span class="p">[[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]]]</span>
<span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">max_output_boxes_per_class</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<span class="n">iou_threshold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">score_threshold</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">selected_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>

<span class="n">expect</span><span class="p">(</span>
    <span class="n">node</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span>
        <span class="n">boxes</span><span class="p">,</span>
        <span class="n">scores</span><span class="p">,</span>
        <span class="n">max_output_boxes_per_class</span><span class="p">,</span>
        <span class="n">iou_threshold</span><span class="p">,</span>
        <span class="n">score_threshold</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="n">selected_indices</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;test_nonmaxsuppression_two_batches&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>Differences</strong></p>
<table class="diff" id="difflib_chg_to140__top"
       cellspacing="0" cellpadding="0" rules="groups" >
    <colgroup></colgroup> <colgroup></colgroup> <colgroup></colgroup>
    <colgroup></colgroup> <colgroup></colgroup> <colgroup></colgroup>

    <tbody>
        <tr><td class="diff_next"><a href="#difflib_chg_to140__top">t</a></td><td class="diff_header" id="from140_1">1</td><td nowrap="nowrap">Filter&nbsp;out&nbsp;boxes&nbsp;that&nbsp;have&nbsp;high&nbsp;intersection-over-union&nbsp;(IOU)&nbsp;overlap&nbsp;with&nbsp;previously&nbsp;selected&nbsp;boxes.</td><td class="diff_next"><a href="#difflib_chg_to140__top">t</a></td><td class="diff_header" id="to140_1">1</td><td nowrap="nowrap">Filter&nbsp;out&nbsp;boxes&nbsp;that&nbsp;have&nbsp;high&nbsp;intersection-over-union&nbsp;(IOU)&nbsp;overlap&nbsp;with&nbsp;previously&nbsp;selected&nbsp;boxes.</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_2">2</td><td nowrap="nowrap">Bounding&nbsp;boxes&nbsp;with&nbsp;score&nbsp;less&nbsp;than&nbsp;score_threshold&nbsp;are&nbsp;removed.&nbsp;Bounding&nbsp;box&nbsp;format&nbsp;is&nbsp;indicated&nbsp;by&nbsp;attribute&nbsp;center_point_box.</td><td class="diff_next"></td><td class="diff_header" id="to140_2">2</td><td nowrap="nowrap">Bounding&nbsp;boxes&nbsp;with&nbsp;score&nbsp;less&nbsp;than&nbsp;score_threshold&nbsp;are&nbsp;removed.&nbsp;Bounding&nbsp;box&nbsp;format&nbsp;is&nbsp;indicated&nbsp;by&nbsp;attribute&nbsp;center_point_box.</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_3">3</td><td nowrap="nowrap">Note&nbsp;that&nbsp;this&nbsp;algorithm&nbsp;is&nbsp;agnostic&nbsp;to&nbsp;where&nbsp;the&nbsp;origin&nbsp;is&nbsp;in&nbsp;the&nbsp;coordinate&nbsp;system&nbsp;and&nbsp;more&nbsp;generally&nbsp;is&nbsp;invariant&nbsp;to</td><td class="diff_next"></td><td class="diff_header" id="to140_3">3</td><td nowrap="nowrap">Note&nbsp;that&nbsp;this&nbsp;algorithm&nbsp;is&nbsp;agnostic&nbsp;to&nbsp;where&nbsp;the&nbsp;origin&nbsp;is&nbsp;in&nbsp;the&nbsp;coordinate&nbsp;system&nbsp;and&nbsp;more&nbsp;generally&nbsp;is&nbsp;invariant&nbsp;to</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_4">4</td><td nowrap="nowrap">orthogonal&nbsp;transformations&nbsp;and&nbsp;translations&nbsp;of&nbsp;the&nbsp;coordinate&nbsp;system;&nbsp;thus&nbsp;translating&nbsp;or&nbsp;reflections&nbsp;of&nbsp;the&nbsp;coordinate&nbsp;system</td><td class="diff_next"></td><td class="diff_header" id="to140_4">4</td><td nowrap="nowrap">orthogonal&nbsp;transformations&nbsp;and&nbsp;translations&nbsp;of&nbsp;the&nbsp;coordinate&nbsp;system;&nbsp;thus&nbsp;translating&nbsp;or&nbsp;reflections&nbsp;of&nbsp;the&nbsp;coordinate&nbsp;system</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_5">5</td><td nowrap="nowrap">result&nbsp;in&nbsp;the&nbsp;same&nbsp;boxes&nbsp;being&nbsp;selected&nbsp;by&nbsp;the&nbsp;algorithm.</td><td class="diff_next"></td><td class="diff_header" id="to140_5">5</td><td nowrap="nowrap">result&nbsp;in&nbsp;the&nbsp;same&nbsp;boxes&nbsp;being&nbsp;selected&nbsp;by&nbsp;the&nbsp;algorithm.</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_6">6</td><td nowrap="nowrap">The&nbsp;selected_indices&nbsp;output&nbsp;is&nbsp;a&nbsp;set&nbsp;of&nbsp;integers&nbsp;indexing&nbsp;into&nbsp;the&nbsp;input&nbsp;collection&nbsp;of&nbsp;bounding&nbsp;boxes&nbsp;representing&nbsp;the&nbsp;selected&nbsp;boxes.</td><td class="diff_next"></td><td class="diff_header" id="to140_6">6</td><td nowrap="nowrap">The&nbsp;selected_indices&nbsp;output&nbsp;is&nbsp;a&nbsp;set&nbsp;of&nbsp;integers&nbsp;indexing&nbsp;into&nbsp;the&nbsp;input&nbsp;collection&nbsp;of&nbsp;bounding&nbsp;boxes&nbsp;representing&nbsp;the&nbsp;selected&nbsp;boxes.</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_7">7</td><td nowrap="nowrap">The&nbsp;bounding&nbsp;box&nbsp;coordinates&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;selected&nbsp;indices&nbsp;can&nbsp;then&nbsp;be&nbsp;obtained&nbsp;using&nbsp;the&nbsp;Gather&nbsp;or&nbsp;GatherND&nbsp;operation.</td><td class="diff_next"></td><td class="diff_header" id="to140_7">7</td><td nowrap="nowrap">The&nbsp;bounding&nbsp;box&nbsp;coordinates&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;selected&nbsp;indices&nbsp;can&nbsp;then&nbsp;be&nbsp;obtained&nbsp;using&nbsp;the&nbsp;Gather&nbsp;or&nbsp;GatherND&nbsp;operation.</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_8">8</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to140_8">8</td><td nowrap="nowrap"></td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_9">9</td><td nowrap="nowrap">**Attributes**</td><td class="diff_next"></td><td class="diff_header" id="to140_9">9</td><td nowrap="nowrap">**Attributes**</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_10">10</td><td nowrap="nowrap">*&nbsp;**center_point_box**:</td><td class="diff_next"></td><td class="diff_header" id="to140_10">10</td><td nowrap="nowrap">*&nbsp;**center_point_box**:</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_11">11</td><td nowrap="nowrap">&nbsp;&nbsp;Integer&nbsp;indicate&nbsp;the&nbsp;format&nbsp;of&nbsp;the&nbsp;box&nbsp;data.&nbsp;The&nbsp;default&nbsp;is&nbsp;0.&nbsp;0&nbsp;-</td><td class="diff_next"></td><td class="diff_header" id="to140_11">11</td><td nowrap="nowrap">&nbsp;&nbsp;Integer&nbsp;indicate&nbsp;the&nbsp;format&nbsp;of&nbsp;the&nbsp;box&nbsp;data.&nbsp;The&nbsp;default&nbsp;is&nbsp;0.&nbsp;0&nbsp;-</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_12">12</td><td nowrap="nowrap">&nbsp;&nbsp;the&nbsp;box&nbsp;data&nbsp;is&nbsp;supplied&nbsp;as&nbsp;[y1,&nbsp;x1,&nbsp;y2,&nbsp;x2]&nbsp;where&nbsp;(y1,&nbsp;x1)&nbsp;and&nbsp;(y2,</td><td class="diff_next"></td><td class="diff_header" id="to140_12">12</td><td nowrap="nowrap">&nbsp;&nbsp;the&nbsp;box&nbsp;data&nbsp;is&nbsp;supplied&nbsp;as&nbsp;[y1,&nbsp;x1,&nbsp;y2,&nbsp;x2]&nbsp;where&nbsp;(y1,&nbsp;x1)&nbsp;and&nbsp;(y2,</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_13">13</td><td nowrap="nowrap">&nbsp;&nbsp;x2)&nbsp;are&nbsp;the&nbsp;coordinates&nbsp;of&nbsp;any&nbsp;diagonal&nbsp;pair&nbsp;of&nbsp;box&nbsp;corners&nbsp;and&nbsp;the</td><td class="diff_next"></td><td class="diff_header" id="to140_13">13</td><td nowrap="nowrap">&nbsp;&nbsp;x2)&nbsp;are&nbsp;the&nbsp;coordinates&nbsp;of&nbsp;any&nbsp;diagonal&nbsp;pair&nbsp;of&nbsp;box&nbsp;corners&nbsp;and&nbsp;the</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_14">14</td><td nowrap="nowrap">&nbsp;&nbsp;coordinates&nbsp;can&nbsp;be&nbsp;provided&nbsp;as&nbsp;normalized&nbsp;(i.e.,&nbsp;lying&nbsp;in&nbsp;the</td><td class="diff_next"></td><td class="diff_header" id="to140_14">14</td><td nowrap="nowrap">&nbsp;&nbsp;coordinates&nbsp;can&nbsp;be&nbsp;provided&nbsp;as&nbsp;normalized&nbsp;(i.e.,&nbsp;lying&nbsp;in&nbsp;the</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_15">15</td><td nowrap="nowrap">&nbsp;&nbsp;interval&nbsp;[0,&nbsp;1])&nbsp;or&nbsp;absolute.&nbsp;Mostly&nbsp;used&nbsp;for&nbsp;TF&nbsp;models.&nbsp;1&nbsp;-&nbsp;the&nbsp;box</td><td class="diff_next"></td><td class="diff_header" id="to140_15">15</td><td nowrap="nowrap">&nbsp;&nbsp;interval&nbsp;[0,&nbsp;1])&nbsp;or&nbsp;absolute.&nbsp;Mostly&nbsp;used&nbsp;for&nbsp;TF&nbsp;models.&nbsp;1&nbsp;-&nbsp;the&nbsp;box</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_16">16</td><td nowrap="nowrap">&nbsp;&nbsp;data&nbsp;is&nbsp;supplied&nbsp;as&nbsp;[x_center,&nbsp;y_center,&nbsp;width,&nbsp;height].&nbsp;Mostly&nbsp;used</td><td class="diff_next"></td><td class="diff_header" id="to140_16">16</td><td nowrap="nowrap">&nbsp;&nbsp;data&nbsp;is&nbsp;supplied&nbsp;as&nbsp;[x_center,&nbsp;y_center,&nbsp;width,&nbsp;height].&nbsp;Mostly&nbsp;used</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_17">17</td><td nowrap="nowrap">&nbsp;&nbsp;for&nbsp;Pytorch&nbsp;models.</td><td class="diff_next"></td><td class="diff_header" id="to140_17">17</td><td nowrap="nowrap">&nbsp;&nbsp;for&nbsp;Pytorch&nbsp;models.</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_18">18</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to140_18">18</td><td nowrap="nowrap"></td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_19">19</td><td nowrap="nowrap">**Inputs**</td><td class="diff_next"></td><td class="diff_header" id="to140_19">19</td><td nowrap="nowrap">**Inputs**</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_20">20</td><td nowrap="nowrap">Between&nbsp;2&nbsp;and&nbsp;5&nbsp;inputs.</td><td class="diff_next"></td><td class="diff_header" id="to140_20">20</td><td nowrap="nowrap">Between&nbsp;2&nbsp;and&nbsp;5&nbsp;inputs.</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_21">21</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to140_21">21</td><td nowrap="nowrap"></td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_22">22</td><td nowrap="nowrap">*&nbsp;**boxes**&nbsp;(heterogeneous)&nbsp;-&nbsp;**tensor(float)**:</td><td class="diff_next"></td><td class="diff_header" id="to140_22">22</td><td nowrap="nowrap">*&nbsp;**boxes**&nbsp;(heterogeneous)&nbsp;-&nbsp;**tensor(float)**:</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_23">23</td><td nowrap="nowrap">&nbsp;&nbsp;An&nbsp;input&nbsp;tensor&nbsp;with&nbsp;shape&nbsp;[num_batches,&nbsp;spatial_dimension,&nbsp;4].&nbsp;The</td><td class="diff_next"></td><td class="diff_header" id="to140_23">23</td><td nowrap="nowrap">&nbsp;&nbsp;An&nbsp;input&nbsp;tensor&nbsp;with&nbsp;shape&nbsp;[num_batches,&nbsp;spatial_dimension,&nbsp;4].&nbsp;The</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_24">24</td><td nowrap="nowrap">&nbsp;&nbsp;single&nbsp;box&nbsp;data&nbsp;format&nbsp;is&nbsp;indicated&nbsp;by&nbsp;center_point_box.</td><td class="diff_next"></td><td class="diff_header" id="to140_24">24</td><td nowrap="nowrap">&nbsp;&nbsp;single&nbsp;box&nbsp;data&nbsp;format&nbsp;is&nbsp;indicated&nbsp;by&nbsp;center_point_box.</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_25">25</td><td nowrap="nowrap">*&nbsp;**scores**&nbsp;(heterogeneous)&nbsp;-&nbsp;**tensor(float)**:</td><td class="diff_next"></td><td class="diff_header" id="to140_25">25</td><td nowrap="nowrap">*&nbsp;**scores**&nbsp;(heterogeneous)&nbsp;-&nbsp;**tensor(float)**:</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_26">26</td><td nowrap="nowrap">&nbsp;&nbsp;An&nbsp;input&nbsp;tensor&nbsp;with&nbsp;shape&nbsp;[num_batches,&nbsp;num_classes,</td><td class="diff_next"></td><td class="diff_header" id="to140_26">26</td><td nowrap="nowrap">&nbsp;&nbsp;An&nbsp;input&nbsp;tensor&nbsp;with&nbsp;shape&nbsp;[num_batches,&nbsp;num_classes,</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_27">27</td><td nowrap="nowrap">&nbsp;&nbsp;spatial_dimension]</td><td class="diff_next"></td><td class="diff_header" id="to140_27">27</td><td nowrap="nowrap">&nbsp;&nbsp;spatial_dimension]</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_28">28</td><td nowrap="nowrap">*&nbsp;**max_output_boxes_per_class**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**tensor(int64)**:</td><td class="diff_next"></td><td class="diff_header" id="to140_28">28</td><td nowrap="nowrap">*&nbsp;**max_output_boxes_per_class**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**tensor(int64)**:</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_29">29</td><td nowrap="nowrap">&nbsp;&nbsp;Integer&nbsp;representing&nbsp;the&nbsp;maximum&nbsp;number&nbsp;of&nbsp;boxes&nbsp;to&nbsp;be&nbsp;selected&nbsp;per</td><td class="diff_next"></td><td class="diff_header" id="to140_29">29</td><td nowrap="nowrap">&nbsp;&nbsp;Integer&nbsp;representing&nbsp;the&nbsp;maximum&nbsp;number&nbsp;of&nbsp;boxes&nbsp;to&nbsp;be&nbsp;selected&nbsp;per</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_30">30</td><td nowrap="nowrap">&nbsp;&nbsp;batch&nbsp;per&nbsp;class.&nbsp;It&nbsp;is&nbsp;a&nbsp;scalar.&nbsp;Default&nbsp;to&nbsp;0,&nbsp;which&nbsp;means&nbsp;no</td><td class="diff_next"></td><td class="diff_header" id="to140_30">30</td><td nowrap="nowrap">&nbsp;&nbsp;batch&nbsp;per&nbsp;class.&nbsp;It&nbsp;is&nbsp;a&nbsp;scalar.&nbsp;Default&nbsp;to&nbsp;0,&nbsp;which&nbsp;means&nbsp;no</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_31">31</td><td nowrap="nowrap">&nbsp;&nbsp;output.</td><td class="diff_next"></td><td class="diff_header" id="to140_31">31</td><td nowrap="nowrap">&nbsp;&nbsp;output.</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_32">32</td><td nowrap="nowrap">*&nbsp;**iou_threshold**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**tensor(float)**:</td><td class="diff_next"></td><td class="diff_header" id="to140_32">32</td><td nowrap="nowrap">*&nbsp;**iou_threshold**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**tensor(float)**:</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_33">33</td><td nowrap="nowrap">&nbsp;&nbsp;Float&nbsp;representing&nbsp;the&nbsp;threshold&nbsp;for&nbsp;deciding&nbsp;whether&nbsp;boxes&nbsp;overlap</td><td class="diff_next"></td><td class="diff_header" id="to140_33">33</td><td nowrap="nowrap">&nbsp;&nbsp;Float&nbsp;representing&nbsp;the&nbsp;threshold&nbsp;for&nbsp;deciding&nbsp;whether&nbsp;boxes&nbsp;overlap</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_34">34</td><td nowrap="nowrap">&nbsp;&nbsp;too&nbsp;much&nbsp;with&nbsp;respect&nbsp;to&nbsp;IOU.&nbsp;It&nbsp;is&nbsp;scalar.&nbsp;Value&nbsp;range&nbsp;[0,&nbsp;1].</td><td class="diff_next"></td><td class="diff_header" id="to140_34">34</td><td nowrap="nowrap">&nbsp;&nbsp;too&nbsp;much&nbsp;with&nbsp;respect&nbsp;to&nbsp;IOU.&nbsp;It&nbsp;is&nbsp;scalar.&nbsp;Value&nbsp;range&nbsp;[0,&nbsp;1].</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_35">35</td><td nowrap="nowrap">&nbsp;&nbsp;Default&nbsp;to&nbsp;0.</td><td class="diff_next"></td><td class="diff_header" id="to140_35">35</td><td nowrap="nowrap">&nbsp;&nbsp;Default&nbsp;to&nbsp;0.</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_36">36</td><td nowrap="nowrap">*&nbsp;**score_threshold**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**tensor(float)**:</td><td class="diff_next"></td><td class="diff_header" id="to140_36">36</td><td nowrap="nowrap">*&nbsp;**score_threshold**&nbsp;(optional,&nbsp;heterogeneous)&nbsp;-&nbsp;**tensor(float)**:</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_37">37</td><td nowrap="nowrap">&nbsp;&nbsp;Float&nbsp;representing&nbsp;the&nbsp;threshold&nbsp;for&nbsp;deciding&nbsp;when&nbsp;to&nbsp;remove&nbsp;boxes</td><td class="diff_next"></td><td class="diff_header" id="to140_37">37</td><td nowrap="nowrap">&nbsp;&nbsp;Float&nbsp;representing&nbsp;the&nbsp;threshold&nbsp;for&nbsp;deciding&nbsp;when&nbsp;to&nbsp;remove&nbsp;boxes</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_38">38</td><td nowrap="nowrap">&nbsp;&nbsp;based&nbsp;on&nbsp;score.&nbsp;It&nbsp;is&nbsp;a&nbsp;scalar.</td><td class="diff_next"></td><td class="diff_header" id="to140_38">38</td><td nowrap="nowrap">&nbsp;&nbsp;based&nbsp;on&nbsp;score.&nbsp;It&nbsp;is&nbsp;a&nbsp;scalar.</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_39">39</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to140_39">39</td><td nowrap="nowrap"></td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_40">40</td><td nowrap="nowrap">**Outputs**</td><td class="diff_next"></td><td class="diff_header" id="to140_40">40</td><td nowrap="nowrap">**Outputs**</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_41">41</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to140_41">41</td><td nowrap="nowrap"></td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_42">42</td><td nowrap="nowrap">*&nbsp;**selected_indices**&nbsp;(heterogeneous)&nbsp;-&nbsp;**tensor(int64)**:</td><td class="diff_next"></td><td class="diff_header" id="to140_42">42</td><td nowrap="nowrap">*&nbsp;**selected_indices**&nbsp;(heterogeneous)&nbsp;-&nbsp;**tensor(int64)**:</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_43">43</td><td nowrap="nowrap">&nbsp;&nbsp;selected&nbsp;indices&nbsp;from&nbsp;the&nbsp;boxes&nbsp;tensor.&nbsp;[num_selected_indices,&nbsp;3],</td><td class="diff_next"></td><td class="diff_header" id="to140_43">43</td><td nowrap="nowrap">&nbsp;&nbsp;selected&nbsp;indices&nbsp;from&nbsp;the&nbsp;boxes&nbsp;tensor.&nbsp;[num_selected_indices,&nbsp;3],</td></tr>
        <tr><td class="diff_next"></td><td class="diff_header" id="from140_44">44</td><td nowrap="nowrap">&nbsp;&nbsp;the&nbsp;selected&nbsp;index&nbsp;format&nbsp;is&nbsp;[batch_index,&nbsp;class_index,&nbsp;box_index].</td><td class="diff_next"></td><td class="diff_header" id="to140_44">44</td><td nowrap="nowrap">&nbsp;&nbsp;the&nbsp;selected&nbsp;index&nbsp;format&nbsp;is&nbsp;[batch_index,&nbsp;class_index,&nbsp;box_index].</td></tr>
    </tbody>
</table></section>
<section id="nonmaxsuppression-10">
<span id="l-onnx-op-nonmaxsuppression-10"></span><h2><a class="toc-backref" href="#id3" role="doc-backlink">NonMaxSuppression - 10</a><a class="headerlink" href="#nonmaxsuppression-10" title="Permalink to this heading">¶</a></h2>
<p><strong>Version</strong>
* <strong>name</strong>: <a class="reference external" href="https://github.com/onnx/onnx/blob/main/docs/Operators.md#NonMaxSuppression">NonMaxSuppression (GitHub)</a>
* <strong>domain</strong>: <strong>main</strong>
* <strong>since_version</strong>: <strong>10</strong>
* <strong>function</strong>: False
* <strong>support_level</strong>: SupportType.COMMON
* <strong>shape inference</strong>: True</p>
<p>This version of the operator has been available
<strong>since version 10</strong>.</p>
<p><strong>Summary</strong></p>
<p>Filter out boxes that have high intersection-over-union (IOU) overlap with previously selected boxes.
Bounding boxes with score less than score_threshold are removed. Bounding box format is indicated by attribute center_point_box.
Note that this algorithm is agnostic to where the origin is in the coordinate system and more generally is invariant to
orthogonal transformations and translations of the coordinate system; thus translating or reflections of the coordinate system
result in the same boxes being selected by the algorithm.
The selected_indices output is a set of integers indexing into the input collection of bounding boxes representing the selected boxes.
The bounding box coordinates corresponding to the selected indices can then be obtained using the Gather or GatherND operation.</p>
<p><strong>Attributes</strong>
* <strong>center_point_box</strong>:</p>
<blockquote>
<div><p>Integer indicate the format of the box data. The default is 0. 0 -
the box data is supplied as [y1, x1, y2, x2] where (y1, x1) and (y2,
x2) are the coordinates of any diagonal pair of box corners and the
coordinates can be provided as normalized (i.e., lying in the
interval [0, 1]) or absolute. Mostly used for TF models. 1 - the box
data is supplied as [x_center, y_center, width, height]. Mostly used
for Pytorch models.</p>
</div></blockquote>
<p><strong>Inputs</strong>
Between 2 and 5 inputs.</p>
<ul class="simple">
<li><p><strong>boxes</strong> (heterogeneous) - <strong>tensor(float)</strong>:
An input tensor with shape [num_batches, spatial_dimension, 4]. The
single box data format is indicated by center_point_box.</p></li>
<li><p><strong>scores</strong> (heterogeneous) - <strong>tensor(float)</strong>:
An input tensor with shape [num_batches, num_classes,
spatial_dimension]</p></li>
<li><p><strong>max_output_boxes_per_class</strong> (optional, heterogeneous) - <strong>tensor(int64)</strong>:
Integer representing the maximum number of boxes to be selected per
batch per class. It is a scalar. Default to 0, which means no
output.</p></li>
<li><p><strong>iou_threshold</strong> (optional, heterogeneous) - <strong>tensor(float)</strong>:
Float representing the threshold for deciding whether boxes overlap
too much with respect to IOU. It is scalar. Value range [0, 1].
Default to 0.</p></li>
<li><p><strong>score_threshold</strong> (optional, heterogeneous) - <strong>tensor(float)</strong>:
Float representing the threshold for deciding when to remove boxes
based on score. It is a scalar.</p></li>
</ul>
<p><strong>Outputs</strong></p>
<ul class="simple">
<li><p><strong>selected_indices</strong> (heterogeneous) - <strong>tensor(int64)</strong>:
selected indices from the boxes tensor. [num_selected_indices, 3],
the selected index format is [batch_index, class_index, box_index].</p></li>
</ul>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2022.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.1.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>