<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>GridSample &#8212; ONNX 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sample.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="HammingWindow" href="onnx__HammingWindow.html" />
    <link rel="prev" title="GreaterOrEqual" href="onnx__GreaterOrEqual.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          ONNX Docs</a>
        <span class="navbar-text navbar-version pull-left"><b>0.1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../onnx-api/index.html">API Overview</a></li>
                <li><a href="../operators/index.html">Op Schemas</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><p class="caption" role="heading"><span class="caption-text">API Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../onnx-api/modules/onnx.checker.html">onnx.checker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../onnx-api/modules/onnx.compose.html">onnx.compose</a></li>
<li class="toctree-l1"><a class="reference internal" href="../onnx-api/modules/onnx.external_data_helper.html">onnx.external_data_helper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../onnx-api/modules/onnx.helper.html">onnx.helper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../onnx-api/modules/onnx.hub.html">onnx.hub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../onnx-api/modules/onnx.numpy_helper.html">onnx.numpy_helper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../onnx-api/modules/onnx.parser.html">onnx.parser</a></li>
<li class="toctree-l1"><a class="reference internal" href="../onnx-api/modules/onnx.utils.html">onnx.utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../onnx-api/modules/onnx.version.version.html">onnx.version.version</a></li>
<li class="toctree-l1"><a class="reference internal" href="../onnx-api/modules/onnx.version_converter.html">onnx.version_converter</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Operators + OpSchemas</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">ONNX operators</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">GridSample</a><ul>
<li><a class="reference internal" href="#gridsample-16">GridSample - 16</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="onnx__GreaterOrEqual.html" title="Previous Chapter: GreaterOrEqual"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; GreaterOrEqual</span>
    </a>
  </li>
  <li>
    <a href="onnx__HammingWindow.html" title="Next Chapter: HammingWindow"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">HammingWindow &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/onnx_doc_folder/onnx__GridSample.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <section id="gridsample">
<span id="l-onnx-doc-gridsample"></span><h1>GridSample<a class="headerlink" href="#gridsample" title="Permalink to this heading">¶</a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#gridsample-16" id="id1">GridSample - 16</a></p></li>
</ul>
</nav>
<section id="gridsample-16">
<span id="l-onnx-op-gridsample-16"></span><h2><a class="toc-backref" href="#id1" role="doc-backlink">GridSample - 16</a><a class="headerlink" href="#gridsample-16" title="Permalink to this heading">¶</a></h2>
<p><strong>Version</strong>
* <strong>name</strong>: <a class="reference external" href="https://github.com/onnx/onnx/blob/main/docs/Operators.md#GridSample">GridSample (GitHub)</a>
* <strong>domain</strong>: <strong>main</strong>
* <strong>since_version</strong>: <strong>16</strong>
* <strong>function</strong>: False
* <strong>support_level</strong>: SupportType.COMMON
* <strong>shape inference</strong>: True</p>
<p>This version of the operator has been available
<strong>since version 16</strong>.</p>
<p><strong>Summary</strong></p>
<p>Given an <cite>input</cite> and a flow-field <cite>grid</cite>, computes the <cite>output</cite> using <cite>input</cite> values and pixel locations from <cite>grid</cite>.
Currently, only spatial (4-D) inputs are supported. For <cite>input</cite> with shape (N, C, H, W) and <cite>grid</cite> with shape (N, H_out, W_out, 2),
the <cite>output</cite> will have shape (N, C, H_out, W_out).
For each output location <cite>output[N, C, H_out, W_out]</cite>, the size-2 vector <cite>grid[N, H_out, W_out]</cite> specifies <cite>input</cite> pixel locations <cite>x</cite> and <cite>y</cite>,
which are used to interpolate the output value <cite>output[N, C, H_out, W_out]</cite>.</p>
<p>The GridSample operator is often used in doing grid generator and sampler in the [Spatial Transformer Networks](<a class="reference external" href="https://arxiv.org/abs/1506.02025">https://arxiv.org/abs/1506.02025</a>).
See also in [torch.nn.functional.grid_sample](<a class="reference external" href="https://pytorch.org/docs/master/generated/torch.nn.functional.grid_sample.html#torch-nn-functional-grid-sample">https://pytorch.org/docs/master/generated/torch.nn.functional.grid_sample.html#torch-nn-functional-grid-sample</a>).</p>
<p><strong>Attributes</strong>
* <strong>align_corners</strong>:</p>
<blockquote>
<div><p>If align_corners=1, the extrema (-1 and 1) are considered as
referring to the center points of the input’s corner pixels. If
align_corners=0, they are instead considered as referring to the
corner points of the input’s corner pixels, making the sampling more
resolution agnostic.</p>
</div></blockquote>
<ul class="simple">
<li><p><strong>mode</strong>:
Three interpolation modes: bilinear (default), nearest and bicubic.</p></li>
<li><p><strong>padding_mode</strong>:
Support padding modes for outside grid values: <cite>zeros`(default),
`border</cite>, <cite>reflection</cite>. zeros: use 0 for out-of-bound grid
locations, border: use border values for out-of-bound grid
locations, reflection: use values at locations reflected by the
border for out-of-bound grid locations. If index 0 represents the
margin pixel, the reflected value at index -1 will be the same as
the value at index 1. For location far away from the border, it will
keep being reflected until becoming in bound. If pixel location x =
-3.5 reflects by border -1 and becomes x’ = 1.5, then reflects by
border 1 and becomes x’’ = 0.5.</p></li>
</ul>
<p><strong>Inputs</strong></p>
<ul class="simple">
<li><p><strong>X</strong> (heterogeneous) - <strong>T1</strong>:
4-D tensor of shape (N, C, H, W), where N is the batch size, C is
the numbers of channels, H and W are the height and width of the
input data.</p></li>
<li><p><strong>grid</strong> (heterogeneous) - <strong>T1</strong>:
Input offset, 4-D tensor of shape (N, H_out, W_out, 2), where H_out
and W_out are the height and width of grid and output, Grid
specifies the sampling pixel locations normalized by the input
spatial dimensions. Therefore, it should have most values in the
range of [-1, 1]. If grid has values outside the range of [-1, 1],
the corresponding outputs will be handled as defined by
padding_mode.</p></li>
</ul>
<p><strong>Outputs</strong></p>
<ul class="simple">
<li><p><strong>Y</strong> (heterogeneous) - <strong>T2</strong>:
4-D tensor of shape (N, C, H_out, W_out).</p></li>
</ul>
<p><strong>Type Constraints</strong>
* <strong>T1</strong> in (</p>
<blockquote>
<div><p>tensor(bool),
tensor(complex128),
tensor(complex64),
tensor(double),
tensor(float),
tensor(float16),
tensor(int16),
tensor(int32),
tensor(int64),
tensor(int8),
tensor(string),
tensor(uint16),
tensor(uint32),
tensor(uint64),
tensor(uint8)
):
Constrain input types to all tensor types.</p>
</div></blockquote>
<ul class="simple">
<li><p><strong>T2</strong> in (
tensor(double),
tensor(float),
tensor(float16)
):
Constrain output types to float tensors.</p></li>
</ul>
<p><strong>Examples</strong></p>
<p><strong>_gridsample</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">node</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_node</span><span class="p">(</span>
    <span class="s2">&quot;GridSample&quot;</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;Grid&quot;</span><span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">],</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;bilinear&quot;</span><span class="p">,</span>
    <span class="n">padding_mode</span><span class="o">=</span><span class="s2">&quot;zeros&quot;</span><span class="p">,</span>
    <span class="n">align_corners</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># X shape, [N, C, H, W] - [1, 1, 4, 4]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">[</span>
            <span class="p">[</span>
                <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">8.0</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">11.0</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">12.0</span><span class="p">,</span> <span class="mf">13.0</span><span class="p">,</span> <span class="mf">14.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">],</span>
            <span class="p">]</span>
        <span class="p">]</span>
    <span class="p">],</span>
    <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># Grid shape, [N, H_out, W_out, 2] - [1, 6, 6, 2]</span>
<span class="n">Grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">[</span>
            <span class="p">[</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">1.0000</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0000</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">0.6000</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0000</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">0.2000</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0000</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.2000</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0000</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.6000</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0000</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">1.0000</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0000</span><span class="p">],</span>
            <span class="p">],</span>
            <span class="p">[</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">1.0000</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6000</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">0.6000</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6000</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">0.2000</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6000</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.2000</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6000</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.6000</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6000</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">1.0000</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6000</span><span class="p">],</span>
            <span class="p">],</span>
            <span class="p">[</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">1.0000</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2000</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">0.6000</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2000</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">0.2000</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2000</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.2000</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2000</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.6000</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2000</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">1.0000</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2000</span><span class="p">],</span>
            <span class="p">],</span>
            <span class="p">[</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">1.0000</span><span class="p">,</span> <span class="mf">0.2000</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">0.6000</span><span class="p">,</span> <span class="mf">0.2000</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">0.2000</span><span class="p">,</span> <span class="mf">0.2000</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.2000</span><span class="p">,</span> <span class="mf">0.2000</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.6000</span><span class="p">,</span> <span class="mf">0.2000</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">1.0000</span><span class="p">,</span> <span class="mf">0.2000</span><span class="p">],</span>
            <span class="p">],</span>
            <span class="p">[</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">1.0000</span><span class="p">,</span> <span class="mf">0.6000</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">0.6000</span><span class="p">,</span> <span class="mf">0.6000</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">0.2000</span><span class="p">,</span> <span class="mf">0.6000</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.2000</span><span class="p">,</span> <span class="mf">0.6000</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.6000</span><span class="p">,</span> <span class="mf">0.6000</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">1.0000</span><span class="p">,</span> <span class="mf">0.6000</span><span class="p">],</span>
            <span class="p">],</span>
            <span class="p">[</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">1.0000</span><span class="p">,</span> <span class="mf">1.0000</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">0.6000</span><span class="p">,</span> <span class="mf">1.0000</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">0.2000</span><span class="p">,</span> <span class="mf">1.0000</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.2000</span><span class="p">,</span> <span class="mf">1.0000</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.6000</span><span class="p">,</span> <span class="mf">1.0000</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">1.0000</span><span class="p">,</span> <span class="mf">1.0000</span><span class="p">],</span>
            <span class="p">],</span>
        <span class="p">]</span>
    <span class="p">],</span>
    <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># Y shape, [N, C, H_out, W_out] - [1, 1, 6, 6]</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">[</span>
            <span class="p">[</span>
                <span class="p">[</span><span class="mf">0.0000</span><span class="p">,</span> <span class="mf">0.1500</span><span class="p">,</span> <span class="mf">0.5500</span><span class="p">,</span> <span class="mf">0.9500</span><span class="p">,</span> <span class="mf">1.3500</span><span class="p">,</span> <span class="mf">0.7500</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">0.6000</span><span class="p">,</span> <span class="mf">1.5000</span><span class="p">,</span> <span class="mf">2.3000</span><span class="p">,</span> <span class="mf">3.1000</span><span class="p">,</span> <span class="mf">3.9000</span><span class="p">,</span> <span class="mf">2.1000</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">2.2000</span><span class="p">,</span> <span class="mf">4.7000</span><span class="p">,</span> <span class="mf">5.5000</span><span class="p">,</span> <span class="mf">6.3000</span><span class="p">,</span> <span class="mf">7.1000</span><span class="p">,</span> <span class="mf">3.7000</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">3.8000</span><span class="p">,</span> <span class="mf">7.9000</span><span class="p">,</span> <span class="mf">8.7000</span><span class="p">,</span> <span class="mf">9.5000</span><span class="p">,</span> <span class="mf">10.3000</span><span class="p">,</span> <span class="mf">5.3000</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">5.4000</span><span class="p">,</span> <span class="mf">11.1000</span><span class="p">,</span> <span class="mf">11.9000</span><span class="p">,</span> <span class="mf">12.7000</span><span class="p">,</span> <span class="mf">13.5000</span><span class="p">,</span> <span class="mf">6.9000</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">3.0000</span><span class="p">,</span> <span class="mf">6.1500</span><span class="p">,</span> <span class="mf">6.5500</span><span class="p">,</span> <span class="mf">6.9500</span><span class="p">,</span> <span class="mf">7.3500</span><span class="p">,</span> <span class="mf">3.7500</span><span class="p">],</span>
            <span class="p">]</span>
        <span class="p">]</span>
    <span class="p">],</span>
    <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">expect</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">Grid</span><span class="p">],</span> <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="n">Y</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;test_gridsample&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>_gridsample_paddingmode</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># X shape, [N, C, H, W] - [1, 1, 3, 2]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[[[[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">]]]],</span>
    <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># Grid shape, [N, H_out, W_out, 2] - [1, 2, 4, 2]</span>
<span class="n">Grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">[</span>
            <span class="p">[</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">10.0000</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.0000</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">5.0000</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.0000</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">0.2000</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2000</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">10.0000</span><span class="p">,</span> <span class="mf">10.0000</span><span class="p">],</span>
            <span class="p">],</span>
            <span class="p">[</span>
                <span class="p">[</span><span class="mf">10.0000</span><span class="p">,</span> <span class="mf">10.0000</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mf">0.2000</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2000</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">5.0000</span><span class="p">,</span> <span class="mf">5.0000</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">10.0000</span><span class="p">,</span> <span class="mf">10.0000</span><span class="p">],</span>
            <span class="p">],</span>
        <span class="p">]</span>
    <span class="p">],</span>
    <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># setting padding_mode = &#39;zeros&#39;</span>
<span class="n">node</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_node</span><span class="p">(</span>
    <span class="s2">&quot;GridSample&quot;</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;Grid&quot;</span><span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">],</span>
    <span class="n">padding_mode</span><span class="o">=</span><span class="s2">&quot;zeros&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># Y shape, [N, C, H_out, W_out] - [1, 1, 2, 4]</span>
<span class="n">Y_zeros</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[[[[</span><span class="mf">0.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">,</span> <span class="mf">1.7000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0000</span><span class="p">,</span> <span class="mf">1.7000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">]]]],</span>
    <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">expect</span><span class="p">(</span>
    <span class="n">node</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">Grid</span><span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="n">Y_zeros</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;test_gridsample_zeros_padding&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># setting padding_mode = &#39;border&#39;</span>
<span class="n">node</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_node</span><span class="p">(</span>
    <span class="s2">&quot;GridSample&quot;</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;Grid&quot;</span><span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">],</span>
    <span class="n">padding_mode</span><span class="o">=</span><span class="s2">&quot;border&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># Y shape, [N, C, H_out, W_out] - [1, 1, 2, 4]</span>
<span class="n">Y_border</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[[[[</span><span class="mf">0.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">,</span> <span class="mf">1.7000</span><span class="p">,</span> <span class="mf">5.0000</span><span class="p">],</span> <span class="p">[</span><span class="mf">5.0000</span><span class="p">,</span> <span class="mf">1.7000</span><span class="p">,</span> <span class="mf">5.0000</span><span class="p">,</span> <span class="mf">5.0000</span><span class="p">]]]],</span>
    <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">expect</span><span class="p">(</span>
    <span class="n">node</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">Grid</span><span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="n">Y_border</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;test_gridsample_border_padding&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># setting padding_mode = &#39;reflection&#39;</span>
<span class="n">node</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_node</span><span class="p">(</span>
    <span class="s2">&quot;GridSample&quot;</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;Grid&quot;</span><span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">],</span>
    <span class="n">padding_mode</span><span class="o">=</span><span class="s2">&quot;reflection&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># Y shape, [N, C, H_out, W_out] - [1, 1, 2, 4]</span>
<span class="n">Y_reflection</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[[[[</span><span class="mf">2.5000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">,</span> <span class="mf">1.7000</span><span class="p">,</span> <span class="mf">2.5000</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.5000</span><span class="p">,</span> <span class="mf">1.7000</span><span class="p">,</span> <span class="mf">5.0000</span><span class="p">,</span> <span class="mf">2.5000</span><span class="p">]]]],</span>
    <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">expect</span><span class="p">(</span>
    <span class="n">node</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">Grid</span><span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="n">Y_reflection</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;test_gridsample_reflection_padding&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>_gridsample_mode_aligncorners</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="c1"># X shape, [N, C, H, W] - [1, 1, 3, 2]</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[[[[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">]]]],</span>
        <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="c1"># Grid shape, [N, H_out, W_out, 2] - [1, 2, 4, 2]</span>
    <span class="n">Grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="p">[</span>
                <span class="p">[</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">1.0000</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0000</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">0.5000</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5000</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">0.2000</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2000</span><span class="p">],</span>
                    <span class="p">[</span><span class="mf">0.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">],</span>
                <span class="p">],</span>
                <span class="p">[</span>
                    <span class="p">[</span><span class="mf">0.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mf">0.2000</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2000</span><span class="p">],</span>
                    <span class="p">[</span><span class="mf">0.5000</span><span class="p">,</span> <span class="mf">0.5000</span><span class="p">],</span>
                    <span class="p">[</span><span class="mf">1.0000</span><span class="p">,</span> <span class="mf">1.0000</span><span class="p">],</span>
                <span class="p">],</span>
            <span class="p">]</span>
        <span class="p">],</span>
        <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># setting mode = &#39;bilinear&#39;, default align_corners = 0</span>
    <span class="n">node</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_node</span><span class="p">(</span>
        <span class="s2">&quot;GridSample&quot;</span><span class="p">,</span>
        <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;Grid&quot;</span><span class="p">],</span>
        <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">],</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;bilinear&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="c1"># Y shape, [N, C, H_out, W_out] - [1, 1, 2, 4]</span>
    <span class="n">Y_bilinear</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[[[[</span><span class="mf">0.0000</span><span class="p">,</span> <span class="mf">0.5000</span><span class="p">,</span> <span class="mf">1.7000</span><span class="p">,</span> <span class="mf">2.5000</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.5000</span><span class="p">,</span> <span class="mf">1.7000</span><span class="p">,</span> <span class="mf">4.5000</span><span class="p">,</span> <span class="mf">1.2500</span><span class="p">]]]],</span>
        <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">expect</span><span class="p">(</span>
        <span class="n">node</span><span class="p">,</span>
        <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">Grid</span><span class="p">],</span>
        <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="n">Y_bilinear</span><span class="p">],</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;test_gridsample_bilinear&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># setting mode = &#39;bilinear&#39;, align_corners = 1</span>
    <span class="n">node</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_node</span><span class="p">(</span>
        <span class="s2">&quot;GridSample&quot;</span><span class="p">,</span>
        <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;Grid&quot;</span><span class="p">],</span>
        <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">],</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;bilinear&quot;</span><span class="p">,</span>
        <span class="n">align_corners</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="c1"># Y shape, [N, C, H_out, W_out] - [1, 1, 2, 4]</span>
    <span class="n">Y_align_corners</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[[[[</span><span class="mf">0.0000</span><span class="p">,</span> <span class="mf">1.2500</span><span class="p">,</span> <span class="mf">2.0000</span><span class="p">,</span> <span class="mf">2.5000</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.5000</span><span class="p">,</span> <span class="mf">2.0000</span><span class="p">,</span> <span class="mf">3.7500</span><span class="p">,</span> <span class="mf">5.0000</span><span class="p">]]]],</span>
        <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">expect</span><span class="p">(</span>
        <span class="n">node</span><span class="p">,</span>
        <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">Grid</span><span class="p">],</span>
        <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="n">Y_align_corners</span><span class="p">],</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;test_gridsample_aligncorners_true&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># setting mode = &#39;nearest&#39;</span>
    <span class="n">node</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_node</span><span class="p">(</span>
        <span class="s2">&quot;GridSample&quot;</span><span class="p">,</span>
        <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;Grid&quot;</span><span class="p">],</span>
        <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">],</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="c1"># Y shape, [N, C, H_out, W_out] - [1, 1, 2, 4]</span>
    <span class="n">Y_nearest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[[[[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]]]],</span>
        <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">expect</span><span class="p">(</span>
        <span class="n">node</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">Grid</span><span class="p">],</span> <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="n">Y_nearest</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;test_gridsample_nearest&quot;</span>
    <span class="p">)</span>

    <span class="c1"># setting mode = &#39;bicubic&#39;</span>
    <span class="n">node</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_node</span><span class="p">(</span>
        <span class="s2">&quot;GridSample&quot;</span><span class="p">,</span>
        <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;Grid&quot;</span><span class="p">],</span>
        <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">],</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;bicubic&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="c1"># Y shape, [N, C, H_out, W_out] - [1, 1, 2, 4]</span>
    <span class="n">Y_bicubic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[[[[</span><span class="o">-</span><span class="mf">0.1406</span><span class="p">,</span> <span class="mf">0.3828</span><span class="p">,</span> <span class="mf">1.7556</span><span class="p">,</span> <span class="mf">2.9688</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.9688</span><span class="p">,</span> <span class="mf">1.7556</span><span class="p">,</span> <span class="mf">5.1445</span><span class="p">,</span> <span class="mf">1.3906</span><span class="p">]]]],</span>
        <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">expect</span><span class="p">(</span>
        <span class="n">node</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">Grid</span><span class="p">],</span> <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="n">Y_bicubic</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;test_gridsample_bicubic&quot;</span>
    <span class="p">)</span>

<span class="s2">&quot;&quot;&quot;</span>
<span class="s2">For someone who want to test by script. Comment it cause github ONNX CI</span>
<span class="s2">do not have the torch python package.</span>
</pre></div>
</div>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2022.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.1.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>