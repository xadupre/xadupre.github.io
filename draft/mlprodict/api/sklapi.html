
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>scikit-learn API and ONNX graph in pipelines &#8212; Python Runtime for ONNX</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/style_notebook_snippet.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinxtrib-images/LightBox2/lightbox2/css/lightbox.css" />
    <link rel="stylesheet" type="text/css" href="../_static/my-styles.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script src="../_static/require.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script src="../_static/sphinxtrib-images/LightBox2/lightbox2/js/jquery-1.11.0.min.js"></script>
    <script src="../_static/sphinxtrib-images/LightBox2/lightbox2/js/lightbox.min.js"></script>
    <script src="../_static/sphinxtrib-images/LightBox2/lightbox2_customize/jquery-noconflict.js"></script>
    <link rel="shortcut icon" href="../_static/project_ico.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Complete Numpy API for ONNX" href="npy.html" />
    <link rel="prev" title="Additional ONNX Converters" href="onnx_conv.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/project_ico.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../installation.html">
  Installation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../tutorial/index.html">
  Tutorial
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="index.html">
  API
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../onnx.html">
  ONNX, Runtime, Backends
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../onnx_bench.html">
  scikit-learn Converters and Benchmarks
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../i_cmd.html">
  Command lines
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../i_ex.html">
  Examples
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../i_index.html">
  FAQ, code, â€¦
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../gyexamples/index.html">
  Gallery of examples
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../all_notebooks.html">
  Notebook Gallery
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../HISTORY.html">
  History
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="onnx_conv.html">
   Additional ONNX Converters
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   scikit-learn API and ONNX graph in pipelines
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="npy.html">
   Complete Numpy API for ONNX
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="xop.html">
   Xop API
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ast.html">
   AST
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="onnxrt.html">
   Python Runtime for ONNX
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="onnxrt_ops.html">
   Python Runtime for ONNX operators
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="testing.html">
   Experimental implementations
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="asv.html">
   Benchmarking with asv
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="validation.html">
   Validation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tools.html">
   Tools
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="cc_grammar.html">
   Former Experiments
  </a>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#onnxpipeline">
   OnnxPipeline
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#onnxtransformer">
   OnnxTransformer
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#speedup-scikit-learn-pipeline-with-onnx">
   Speedup scikit-learn pipeline with ONNX
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tokenizers">
   Tokenizers
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="scikit-learn-api-and-onnx-graph-in-pipelines">
<h1>scikit-learn API and ONNX graph in pipelines<a class="headerlink" href="#scikit-learn-api-and-onnx-graph-in-pipelines" title="Permalink to this headline">#</a></h1>
<p>This is the main class which makes it easy to insert
to use the prediction from an <a class="reference external" href="https://onnx.ai/">ONNX</a> files into a <a class="reference external" href="https://scikit-learn.org/stable/">scikit-learn</a>
pipeline.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#onnxpipeline" id="id1">OnnxPipeline</a></p></li>
<li><p><a class="reference internal" href="#onnxtransformer" id="id2">OnnxTransformer</a></p></li>
<li><p><a class="reference internal" href="#speedup-scikit-learn-pipeline-with-onnx" id="id3">Speedup scikit-learn pipeline with ONNX</a></p></li>
<li><p><a class="reference internal" href="#tokenizers" id="id4">Tokenizers</a></p></li>
</ul>
</div>
<section id="onnxpipeline">
<h2><a class="toc-backref" href="#id1">OnnxPipeline</a><a class="headerlink" href="#onnxpipeline" title="Permalink to this headline">#</a></h2>
<p><a class="reference internal" href="../mlprodict/sklapi/onnx_pipeline.html#mlprodict.sklapi.onnx_pipeline.OnnxPipeline" title="mlprodict.sklapi.onnx_pipeline.OnnxPipeline"><code class="xref py py-class docutils literal notranslate"><span class="pre">mlprodict.sklapi.OnnxPipeline</span></code></a> (<em>self</em>, <em>steps</em>, <em>memory</em> = <cite>None</cite>, <em>verbose</em> = <cite>False</cite>, <em>output_name</em> = <cite>None</cite>, <em>enforce_float32</em> = <cite>True</cite>, <em>runtime</em> = <cite>â€˜pythonâ€™</cite>, <em>options</em> = <cite>None</cite>, <em>white_op</em> = <cite>None</cite>, <em>black_op</em> = <cite>None</cite>, <em>final_types</em> = <cite>None</cite>, <em>op_version</em> = <cite>None</cite>)</p>
<blockquote>
<div><p>The pipeline overwrites method <em>fit</em>, it trains and converts
every steps into ONNX before training the next step
in order to minimize discrepencies. By default,
ONNX is using float and not double which is the default
for <a class="reference external" href="https://scikit-learn.org/stable/">scikit-learn</a>. It may introduce discrepencies
when a non-continuous model (mathematical definition) such
as tree ensemble and part of the pipeline.</p>
<p><a class="reference internal" href="../mlprodict/sklapi/onnx_pipeline.html#mlprodict.sklapi.onnx_pipeline.OnnxPipeline.fit" title="mlprodict.sklapi.onnx_pipeline.OnnxPipeline.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit</span></code></a> (<em>self</em>, <em>X</em>, <em>y</em> = <cite>None</cite>, <em>fit_params</em>)</p>
<blockquote>
<div><p>Fits the model, fits all the transforms one after the
other and transform the data, then fit the transformed
data using the final estimator.</p>
</div></blockquote>
</div></blockquote>
</section>
<section id="onnxtransformer">
<h2><a class="toc-backref" href="#id2">OnnxTransformer</a><a class="headerlink" href="#onnxtransformer" title="Permalink to this headline">#</a></h2>
<p><a class="reference internal" href="../mlprodict/sklapi/onnx_transformer.html#mlprodict.sklapi.onnx_transformer.OnnxTransformer" title="mlprodict.sklapi.onnx_transformer.OnnxTransformer"><code class="xref py py-class docutils literal notranslate"><span class="pre">mlprodict.sklapi.OnnxTransformer</span></code></a> (<em>self</em>, <em>onnx_bytes</em>, <em>output_name</em> = <cite>None</cite>, <em>enforce_float32</em> = <cite>True</cite>, <em>runtime</em> = <cite>â€˜pythonâ€™</cite>, <em>change_batch_size</em> = <cite>None</cite>, <em>reshape</em> = <cite>False</cite>)</p>
<blockquote>
<div><p>Calls <a class="reference external" href="https://github.com/microsoft/onnxruntime">onnxruntime</a> or the runtime implemented
in this package to transform input based on a ONNX graph.
It follows <a class="reference external" href="https://scikit-learn.org/stable/">scikit-learn</a> API
so that it can be included in a <a class="reference external" href="https://scikit-learn.org/stable/">scikit-learn</a> pipeline.
See notebook <a class="reference internal" href="../notebooks/transfer_learning.html#transferlearningrst"><span class="std std-ref">Transfer Learning with ONNX</span></a> for an example.</p>
<p><a class="reference internal" href="../mlprodict/sklapi/onnx_transformer.html#mlprodict.sklapi.onnx_transformer.OnnxTransformer.enumerate_create" title="mlprodict.sklapi.onnx_transformer.OnnxTransformer.enumerate_create"><code class="xref py py-meth docutils literal notranslate"><span class="pre">enumerate_create</span></code></a> (<em>onnx_bytes</em>, <em>output_names</em> = <cite>None</cite>, <em>enforce_float32</em> = <cite>True</cite>)</p>
<blockquote>
<div><p>Creates multiple <em>OnnxTransformer</em>,
one for each requested intermediate node.</p>
<p>onnx_bytes : bytes
output_names: string</p>
<blockquote>
<div><p>requested output names or None to request all and
have method <em>transform</em> to store all of them in a dataframe</p>
</div></blockquote>
<dl class="simple">
<dt>enforce_float32<span class="classifier">boolean</span></dt><dd><p><a class="reference external" href="https://github.com/microsoft/onnxruntime">onnxruntime</a> only supports <em>float32</em>,
<a class="reference external" href="https://scikit-learn.org/stable/">scikit-learn</a> usually uses double floats, this parameter
ensures that every array of double floats is converted into
single floats</p>
</dd>
</dl>
</div></blockquote>
<p><a class="reference internal" href="../mlprodict/sklapi/onnx_transformer.html#mlprodict.sklapi.onnx_transformer.OnnxTransformer.fit" title="mlprodict.sklapi.onnx_transformer.OnnxTransformer.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit</span></code></a> (<em>self</em>, <em>X</em> = <cite>None</cite>, <em>y</em> = <cite>None</cite>, <em>fit_params</em>)</p>
<blockquote>
<div><p>Loads the <a class="reference external" href="https://onnx.ai/">ONNX</a> model.</p>
</div></blockquote>
<p><a class="reference internal" href="../mlprodict/sklapi/onnx_transformer.html#mlprodict.sklapi.onnx_transformer.OnnxTransformer.fit_transform" title="mlprodict.sklapi.onnx_transformer.OnnxTransformer.fit_transform"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit_transform</span></code></a> (<em>self</em>, <em>X</em>, <em>y</em> = <cite>None</cite>, <em>inputs</em>)</p>
<blockquote>
<div><p>Loads the <em>ONNX</em> model and runs the predictions.</p>
</div></blockquote>
<p><a class="reference internal" href="../mlprodict/sklapi/onnx_transformer.html#mlprodict.sklapi.onnx_transformer.OnnxTransformer.onnx_converter" title="mlprodict.sklapi.onnx_transformer.OnnxTransformer.onnx_converter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">onnx_converter</span></code></a> (<em>self</em>)</p>
<blockquote>
<div><p>Returns a converter for this model.
If not overloaded, it fetches the converter
mapped to the first <em>scikit-learn</em> parent
it can find.</p>
</div></blockquote>
<p><a class="reference internal" href="../mlprodict/sklapi/onnx_transformer.html#mlprodict.sklapi.onnx_transformer.OnnxTransformer.onnx_parser" title="mlprodict.sklapi.onnx_transformer.OnnxTransformer.onnx_parser"><code class="xref py py-meth docutils literal notranslate"><span class="pre">onnx_parser</span></code></a> (<em>self</em>)</p>
<blockquote>
<div><p>Returns a parser for this model.</p>
</div></blockquote>
<p><a class="reference internal" href="../mlprodict/sklapi/onnx_transformer.html#mlprodict.sklapi.onnx_transformer.OnnxTransformer.onnx_shape_calculator" title="mlprodict.sklapi.onnx_transformer.OnnxTransformer.onnx_shape_calculator"><code class="xref py py-meth docutils literal notranslate"><span class="pre">onnx_shape_calculator</span></code></a> (<em>self</em>)</p>
<p><a class="reference internal" href="../mlprodict/sklapi/onnx_transformer.html#mlprodict.sklapi.onnx_transformer.OnnxTransformer.transform" title="mlprodict.sklapi.onnx_transformer.OnnxTransformer.transform"><code class="xref py py-meth docutils literal notranslate"><span class="pre">transform</span></code></a> (<em>self</em>, <em>X</em>, <em>y</em> = <cite>None</cite>, <em>inputs</em>)</p>
<blockquote>
<div><p>Runs the predictions. If <em>X</em> is a dataframe,
the function assumes every columns is a separate input,
otherwise, <em>X</em> is considered as a first input and <em>inputs</em>
can be used to specify extra inputs.</p>
</div></blockquote>
</div></blockquote>
</section>
<section id="speedup-scikit-learn-pipeline-with-onnx">
<h2><a class="toc-backref" href="#id3">Speedup scikit-learn pipeline with ONNX</a><a class="headerlink" href="#speedup-scikit-learn-pipeline-with-onnx" title="Permalink to this headline">#</a></h2>
<p>These classes wraps an existing pipeline from <em>scikit-learn</em>
and replaces the inference (<em>transform</em>, <em>predict</em>, <em>predict_proba</em>)
by another runtime built after the model was converted into ONNX.
See example <a class="reference internal" href="../gyexamples/plot_numba.html#l-b-numpy-numba-ort"><span class="std std-ref">Compares numba, numpy, onnxruntime for simple functions</span></a> for further details.</p>
<p><a class="reference internal" href="../mlprodict/sklapi/onnx_speed_up.html#mlprodict.sklapi.onnx_speed_up.OnnxSpeedupClassifier" title="mlprodict.sklapi.onnx_speed_up.OnnxSpeedupClassifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">mlprodict.sklapi.OnnxSpeedupClassifier</span></code></a> (<em>self</em>, <em>estimator</em>, <em>runtime</em> = <cite>â€˜pythonâ€™</cite>, <em>enforce_float32</em> = <cite>True</cite>, <em>target_opset</em> = <cite>None</cite>, <em>conv_options</em> = <cite>None</cite>, <em>nopython</em> = <cite>True</cite>)</p>
<blockquote>
<div><p>Trains with <a class="reference external" href="https://scikit-learn.org/stable/">scikit-learn</a>, transform with <a class="reference external" href="https://onnx.ai/">ONNX</a>.</p>
<p><a class="reference internal" href="../mlprodict/sklapi/onnx_speed_up.html#mlprodict.sklapi.onnx_speed_up.OnnxSpeedupClassifier.assert_almost_equal" title="mlprodict.sklapi.onnx_speed_up.OnnxSpeedupClassifier.assert_almost_equal"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assert_almost_equal</span></code></a> (<em>self</em>, <em>X</em>, <em>kwargs</em>)</p>
<blockquote>
<div><p>Checks that ONNX and scikit-learn produces the same
outputs.</p>
</div></blockquote>
<p><a class="reference internal" href="../mlprodict/sklapi/onnx_speed_up.html#mlprodict.sklapi.onnx_speed_up.OnnxSpeedupClassifier.fit" title="mlprodict.sklapi.onnx_speed_up.OnnxSpeedupClassifier.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit</span></code></a> (<em>self</em>, <em>X</em>, <em>y</em>, <em>sample_weight</em> = <cite>None</cite>)</p>
<blockquote>
<div><p>Trains based estimator.</p>
</div></blockquote>
<p><a class="reference internal" href="../mlprodict/sklapi/onnx_speed_up.html#mlprodict.sklapi.onnx_speed_up.OnnxSpeedupClassifier.predict" title="mlprodict.sklapi.onnx_speed_up.OnnxSpeedupClassifier.predict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">predict</span></code></a> (<em>self</em>, <em>X</em>)</p>
<blockquote>
<div><p>Transforms with <em>ONNX</em>.</p>
</div></blockquote>
<p><a class="reference internal" href="../mlprodict/sklapi/onnx_speed_up.html#mlprodict.sklapi.onnx_speed_up.OnnxSpeedupClassifier.predict_proba" title="mlprodict.sklapi.onnx_speed_up.OnnxSpeedupClassifier.predict_proba"><code class="xref py py-meth docutils literal notranslate"><span class="pre">predict_proba</span></code></a> (<em>self</em>, <em>X</em>)</p>
<blockquote>
<div><p>Transforms with <em>ONNX</em>.</p>
</div></blockquote>
<p><a class="reference internal" href="../mlprodict/sklapi/onnx_speed_up.html#mlprodict.sklapi.onnx_speed_up.OnnxSpeedupClassifier.raw_predict" title="mlprodict.sklapi.onnx_speed_up.OnnxSpeedupClassifier.raw_predict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">raw_predict</span></code></a> (<em>self</em>, <em>X</em>)</p>
<blockquote>
<div><p>Transforms with <em>scikit-learn</em>.</p>
</div></blockquote>
<p><a class="reference internal" href="../mlprodict/sklapi/onnx_speed_up.html#mlprodict.sklapi.onnx_speed_up.OnnxSpeedupClassifier.raw_predict_proba" title="mlprodict.sklapi.onnx_speed_up.OnnxSpeedupClassifier.raw_predict_proba"><code class="xref py py-meth docutils literal notranslate"><span class="pre">raw_predict_proba</span></code></a> (<em>self</em>, <em>X</em>)</p>
<blockquote>
<div><p>Transforms with <em>scikit-learn</em>.</p>
</div></blockquote>
</div></blockquote>
<p><a class="reference internal" href="../mlprodict/sklapi/onnx_speed_up.html#mlprodict.sklapi.onnx_speed_up.OnnxSpeedupRegressor" title="mlprodict.sklapi.onnx_speed_up.OnnxSpeedupRegressor"><code class="xref py py-class docutils literal notranslate"><span class="pre">mlprodict.sklapi.OnnxSpeedupRegressor</span></code></a> (<em>self</em>, <em>estimator</em>, <em>runtime</em> = <cite>â€˜pythonâ€™</cite>, <em>enforce_float32</em> = <cite>True</cite>, <em>target_opset</em> = <cite>None</cite>, <em>conv_options</em> = <cite>None</cite>, <em>nopython</em> = <cite>True</cite>)</p>
<blockquote>
<div><p>Trains with <a class="reference external" href="https://scikit-learn.org/stable/">scikit-learn</a>, transform with <a class="reference external" href="https://onnx.ai/">ONNX</a>.</p>
<p><a class="reference internal" href="../mlprodict/sklapi/onnx_speed_up.html#mlprodict.sklapi.onnx_speed_up.OnnxSpeedupRegressor.assert_almost_equal" title="mlprodict.sklapi.onnx_speed_up.OnnxSpeedupRegressor.assert_almost_equal"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assert_almost_equal</span></code></a> (<em>self</em>, <em>X</em>, <em>kwargs</em>)</p>
<blockquote>
<div><p>Checks that ONNX and scikit-learn produces the same
outputs.</p>
</div></blockquote>
<p><a class="reference internal" href="../mlprodict/sklapi/onnx_speed_up.html#mlprodict.sklapi.onnx_speed_up.OnnxSpeedupRegressor.fit" title="mlprodict.sklapi.onnx_speed_up.OnnxSpeedupRegressor.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit</span></code></a> (<em>self</em>, <em>X</em>, <em>y</em>, <em>sample_weight</em> = <cite>None</cite>)</p>
<blockquote>
<div><p>Trains based estimator.</p>
</div></blockquote>
<p><a class="reference internal" href="../mlprodict/sklapi/onnx_speed_up.html#mlprodict.sklapi.onnx_speed_up.OnnxSpeedupRegressor.predict" title="mlprodict.sklapi.onnx_speed_up.OnnxSpeedupRegressor.predict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">predict</span></code></a> (<em>self</em>, <em>X</em>)</p>
<blockquote>
<div><p>Transforms with <em>ONNX</em>.</p>
</div></blockquote>
<p><a class="reference internal" href="../mlprodict/sklapi/onnx_speed_up.html#mlprodict.sklapi.onnx_speed_up.OnnxSpeedupRegressor.raw_predict" title="mlprodict.sklapi.onnx_speed_up.OnnxSpeedupRegressor.raw_predict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">raw_predict</span></code></a> (<em>self</em>, <em>X</em>)</p>
<blockquote>
<div><p>Transforms with <em>scikit-learn</em>.</p>
</div></blockquote>
</div></blockquote>
<p><a class="reference internal" href="../mlprodict/sklapi/onnx_speed_up.html#mlprodict.sklapi.onnx_speed_up.OnnxSpeedupTransformer" title="mlprodict.sklapi.onnx_speed_up.OnnxSpeedupTransformer"><code class="xref py py-class docutils literal notranslate"><span class="pre">mlprodict.sklapi.OnnxSpeedupTransformer</span></code></a> (<em>self</em>, <em>estimator</em>, <em>runtime</em> = <cite>â€˜pythonâ€™</cite>, <em>enforce_float32</em> = <cite>True</cite>, <em>target_opset</em> = <cite>None</cite>, <em>conv_options</em> = <cite>None</cite>, <em>nopython</em> = <cite>True</cite>)</p>
<blockquote>
<div><p>Trains with <a class="reference external" href="https://scikit-learn.org/stable/">scikit-learn</a>, transform with <a class="reference external" href="https://onnx.ai/">ONNX</a>.</p>
<p><a class="reference internal" href="../mlprodict/sklapi/onnx_speed_up.html#mlprodict.sklapi.onnx_speed_up.OnnxSpeedupTransformer.assert_almost_equal" title="mlprodict.sklapi.onnx_speed_up.OnnxSpeedupTransformer.assert_almost_equal"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assert_almost_equal</span></code></a> (<em>self</em>, <em>X</em>, <em>kwargs</em>)</p>
<blockquote>
<div><p>Checks that ONNX and scikit-learn produces the same
outputs.</p>
</div></blockquote>
<p><a class="reference internal" href="../mlprodict/sklapi/onnx_speed_up.html#mlprodict.sklapi.onnx_speed_up.OnnxSpeedupTransformer.fit" title="mlprodict.sklapi.onnx_speed_up.OnnxSpeedupTransformer.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit</span></code></a> (<em>self</em>, <em>X</em>, <em>y</em> = <cite>None</cite>, <em>sample_weight</em> = <cite>None</cite>)</p>
<blockquote>
<div><p>Trains based estimator.</p>
</div></blockquote>
<p><a class="reference internal" href="../mlprodict/sklapi/onnx_speed_up.html#mlprodict.sklapi.onnx_speed_up.OnnxSpeedupTransformer.raw_transform" title="mlprodict.sklapi.onnx_speed_up.OnnxSpeedupTransformer.raw_transform"><code class="xref py py-meth docutils literal notranslate"><span class="pre">raw_transform</span></code></a> (<em>self</em>, <em>X</em>)</p>
<blockquote>
<div><p>Transforms with <em>scikit-learn</em>.</p>
</div></blockquote>
<p><a class="reference internal" href="../mlprodict/sklapi/onnx_speed_up.html#mlprodict.sklapi.onnx_speed_up.OnnxSpeedupTransformer.transform" title="mlprodict.sklapi.onnx_speed_up.OnnxSpeedupTransformer.transform"><code class="xref py py-meth docutils literal notranslate"><span class="pre">transform</span></code></a> (<em>self</em>, <em>X</em>)</p>
<blockquote>
<div><p>Transforms with <em>ONNX</em>.</p>
</div></blockquote>
</div></blockquote>
</section>
<section id="tokenizers">
<h2><a class="toc-backref" href="#id4">Tokenizers</a><a class="headerlink" href="#tokenizers" title="Permalink to this headline">#</a></h2>
<p><a class="reference internal" href="../mlprodict/sklapi/onnx_tokenizer.html#mlprodict.sklapi.onnx_tokenizer.GPT2TokenizerTransformer" title="mlprodict.sklapi.onnx_tokenizer.GPT2TokenizerTransformer"><code class="xref py py-class docutils literal notranslate"><span class="pre">mlprodict.sklapi.onnx_tokenizer.GPT2TokenizerTransformer</span></code></a> (<em>self</em>, <em>vocab</em>, <em>merges</em>, <em>padding_length</em> = <cite>-1</cite>, <em>opset</em> = <cite>None</cite>)</p>
<blockquote>
<div><p>Wraps <a class="reference external" href="https://github.com/microsoft/onnxruntime-extensions/blob/main/docs/custom_text_ops.md#gpt2tokenizer">GPT2Tokenizer</a>
into a <a class="reference external" href="https://scikit-learn.org/stable/">scikit-learn</a> transformer.</p>
<p><a class="reference internal" href="../mlprodict/sklapi/onnx_tokenizer.html#mlprodict.sklapi.onnx_tokenizer.GPT2TokenizerTransformer.fit" title="mlprodict.sklapi.onnx_tokenizer.GPT2TokenizerTransformer.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit</span></code></a> (<em>self</em>, <em>X</em>, <em>y</em> = <cite>None</cite>, <em>sample_weight</em> = <cite>None</cite>)</p>
<blockquote>
<div><p>The model is not trains this method is still needed to
set the instance up and ready to transform.</p>
</div></blockquote>
<p><a class="reference internal" href="../mlprodict/sklapi/onnx_tokenizer.html#mlprodict.sklapi.onnx_tokenizer.GPT2TokenizerTransformer.transform" title="mlprodict.sklapi.onnx_tokenizer.GPT2TokenizerTransformer.transform"><code class="xref py py-meth docutils literal notranslate"><span class="pre">transform</span></code></a> (<em>self</em>, <em>X</em>)</p>
<blockquote>
<div><p>Applies the tokenizers on an array of strings.</p>
</div></blockquote>
</div></blockquote>
<p><a class="reference internal" href="../mlprodict/sklapi/onnx_tokenizer.html#mlprodict.sklapi.onnx_tokenizer.SentencePieceTokenizerTransformer" title="mlprodict.sklapi.onnx_tokenizer.SentencePieceTokenizerTransformer"><code class="xref py py-class docutils literal notranslate"><span class="pre">mlprodict.sklapi.onnx_tokenizer.SentencePieceTokenizerTransformer</span></code></a> (<em>self</em>, <em>model</em>, <em>nbest_size</em> = <cite>1</cite>, <em>alpha</em> = <cite>0.5</cite>, <em>reverse</em> = <cite>False</cite>, <em>add_bos</em> = <cite>False</cite>, <em>add_eos</em> = <cite>False</cite>, <em>opset</em> = <cite>None</cite>)</p>
<blockquote>
<div><p>Wraps <a class="reference external" href="https://github.com/microsoft/onnxruntime-extensions/blob/main/docs/custom_text_ops.md#sentencepiecetokenizer">SentencePieceTokenizer</a>
into a <a class="reference external" href="https://scikit-learn.org/stable/">scikit-learn</a> transformer.</p>
<p><a class="reference internal" href="../mlprodict/sklapi/onnx_tokenizer.html#mlprodict.sklapi.onnx_tokenizer.SentencePieceTokenizerTransformer.fit" title="mlprodict.sklapi.onnx_tokenizer.SentencePieceTokenizerTransformer.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit</span></code></a> (<em>self</em>, <em>X</em>, <em>y</em> = <cite>None</cite>, <em>sample_weight</em> = <cite>None</cite>)</p>
<blockquote>
<div><p>The model is not trains this method is still needed to
set the instance up and ready to transform.</p>
</div></blockquote>
<p><a class="reference internal" href="../mlprodict/sklapi/onnx_tokenizer.html#mlprodict.sklapi.onnx_tokenizer.SentencePieceTokenizerTransformer.transform" title="mlprodict.sklapi.onnx_tokenizer.SentencePieceTokenizerTransformer.transform"><code class="xref py py-meth docutils literal notranslate"><span class="pre">transform</span></code></a> (<em>self</em>, <em>X</em>)</p>
<blockquote>
<div><p>Applies the tokenizers on an array of strings.</p>
</div></blockquote>
</div></blockquote>
</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="onnx_conv.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Additional ONNX Converters</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="npy.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Complete Numpy API for ONNX</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2022, Xavier DuprÃ©.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>