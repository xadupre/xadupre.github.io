
.. _f-einsumfct:

module ``testing.einsum.einsum_fct``
====================================





.. inheritance-diagram:: mlprodict.testing.einsum.einsum_fct


Short summary
+++++++++++++

module ``mlprodict.testing.einsum.einsum_fct``

Main functions decomposing einsum computation into
more simple functions.


:githublink:`%|py|6`




Classes
+++++++

+--------------------------------------------------------------------------+------------------------------------------------------------------------------------------+
| class                                                                    | truncated documentation                                                                  |
+==========================================================================+==========================================================================================+
| :class:`CachedEinsum <mlprodict.testing.einsum.einsum_fct.CachedEinsum>` | Stores all the necessary information to cache the preprocessing of a an einsum equation. |
+--------------------------------------------------------------------------+------------------------------------------------------------------------------------------+




Functions
+++++++++

+---------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------+
| function                                                                                                            | truncated documentation                                                                                                |
+=====================================================================================================================+========================================================================================================================+
| :func:`_einsum <mlprodict.testing.einsum.einsum_fct._einsum>`                                                       |                                                                                                                        |
+---------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------+
| :func:`einsum <mlprodict.testing.einsum.einsum_fct.einsum>`                                                         | Proposes a new implementation of :epkg:`numpy:einsum`. It does not allow expresion using `...` and expects a right ... |
+---------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------+
| :func:`enumerate_cached_einsum <mlprodict.testing.einsum.einsum_fct.enumerate_cached_einsum>`                       | Enumerates all cached einsum function.                                                                                 |
+---------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------+
| :func:`optimize_decompose_einsum_equation <mlprodict.testing.einsum.einsum_fct.optimize_decompose_einsum_equation>` | Proposes a new implementation of :epkg:`numpy:einsum`. It does not allow expresion using `...` and expects a right ... |
+---------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------+






Static Methods
++++++++++++++

+--------------------------------------------------------------------------------------+----------------------------------------+
| staticmethod                                                                         | truncated documentation                |
+======================================================================================+========================================+
| :meth:`build_einsum <mlprodict.testing.einsum.einsum_fct.CachedEinsum.build_einsum>` | Creates an instance of *CachedEinsum*. |
+--------------------------------------------------------------------------------------+----------------------------------------+




Methods
+++++++

+-----------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------+
| method                                                                                              | truncated documentation                                                                              |
+=====================================================================================================+======================================================================================================+
| :py:meth:`__call__ <mlprodict.testing.einsum.einsum_fct.CachedEinsum.__call__>`                     | Calls the runtime `self.runtime_`.                                                                   |
+-----------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------+
| :py:meth:`__init__ <mlprodict.testing.einsum.einsum_fct.CachedEinsum.__init__>`                     |                                                                                                      |
+-----------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------+
| :py:meth:`__repr__ <mlprodict.testing.einsum.einsum_fct.CachedEinsum.__repr__>`                     | usual                                                                                                |
+-----------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------+
| :py:meth:`_build_optimize <mlprodict.testing.einsum.einsum_fct.CachedEinsum._build_optimize>`       |                                                                                                      |
+-----------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------+
| :py:meth:`_build_optimize_ml <mlprodict.testing.einsum.einsum_fct.CachedEinsum._build_optimize_ml>` |                                                                                                      |
+-----------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------+
| :meth:`build <mlprodict.testing.einsum.einsum_fct.CachedEinsum.build>`                              | Preprocesses the equation builds whatever is necessary to compute the result of the einsum equation. |
+-----------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------+
| :meth:`build_onnx_einsum <mlprodict.testing.einsum.einsum_fct.CachedEinsum.build_onnx_einsum>`      | Builds an ONNX graph with a single einsum operator.                                                  |
+-----------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------+
| :meth:`build_runtime <mlprodict.testing.einsum.einsum_fct.CachedEinsum.build_runtime>`              | Builds the runtime associated to the equation `self.equation_`.                                      |
+-----------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------+
| :meth:`default_inputs <mlprodict.testing.einsum.einsum_fct.CachedEinsum.default_inputs>`            | Returns default inputs (reshaped numpy.arange + 0.7i).                                               |
+-----------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------+


Documentation
+++++++++++++

.. automodule:: mlprodict.testing.einsum.einsum_fct
    :members:
    :special-members: __init__
    :show-inheritance:



