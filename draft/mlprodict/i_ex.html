
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Examples &#8212; Python Runtime for ONNX</title>
    
    <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
  
    
    <link rel="stylesheet"
      href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">
  
    
      
  
    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/pydata-sphinx-theme.css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="_static/style_notebook_snippet.css" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinxtrib-images/LightBox2/lightbox2/css/lightbox.css" />
    <link rel="stylesheet" type="text/css" href="_static/my-styles.css" />
    
    <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">
  
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/thebelab-helper.js"></script>
    <script src="_static/require.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script src="_static/sphinxtrib-images/LightBox2/lightbox2/js/jquery-1.11.0.min.js"></script>
    <script src="_static/sphinxtrib-images/LightBox2/lightbox2/js/lightbox.min.js"></script>
    <script src="_static/sphinxtrib-images/LightBox2/lightbox2_customize/jquery-noconflict.js"></script>
    <link rel="shortcut icon" href="_static/project_ico.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="FAQ, code, …" href="i_index.html" />
    <link rel="prev" title="Command lines" href="i_cmd.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="index.html">
  <img src="_static/project_ico.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="installation.html">
  Installation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="tutorial/index.html">
  Tutorial
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="api/index.html">
  API
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="onnx.html">
  ONNX, Runtime, Backends
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="onnx_bench.html">
  scikit-learn Converters and Benchmarks
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="i_cmd.html">
  Command lines
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="current reference internal nav-link" href="#">
  Examples
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="i_index.html">
  FAQ, code, …
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="gyexamples/index.html">
  Gallery of examples
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="all_notebooks.html">
  Notebook Gallery
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="HISTORY.html">
  History
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                

<nav id="bd-toc-nav">
    
</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="examples">
<span id="l-ex2"></span><h1>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h1>
<ol class="simple">
<li><p><a class="reference internal" href="#index-exref-0-0">Change ONNX model inputs</a></p></li>
<li><p><a class="reference internal" href="#index-exref-0-1">Computes predictions with any runtime</a></p></li>
<li><p><a class="reference internal" href="#index-exref-0-2">Convert ONNX into DOT</a></p></li>
<li><p><a class="reference internal" href="#index-exref-0-3">Convert ONNX into JSON</a></p></li>
<li><p><a class="reference internal" href="#index-exref-0-4">Convert ONNX into graph</a></p></li>
<li><p><a class="reference internal" href="#index-exref-0-5">Convert a function into ONNX code</a></p></li>
<li><p><a class="reference internal" href="#index-exref-0-6">Convert a function into ONNX code and run</a></p></li>
<li><p><a class="reference internal" href="#index-exref-0-8">Converts bytes into an array (serialization)</a></p></li>
<li><p><a class="reference internal" href="#index-exref-0-9">Displays an ONNX graph as text</a></p></li>
<li><p><a class="reference internal" href="#index-exref-0-10">Extract information from a model</a></p></li>
<li><p><a class="reference internal" href="#index-exref-0-11">Get the tree of a simple function</a></p></li>
<li><p><a class="reference internal" href="#index-exref-0-12">How to use TreeEnsembleRegressorDouble instead of TreeEnsembleRegressor</a></p></li>
<li><p><a class="reference internal" href="#index-exref-0-13">Plot benchmark improvments</a></p></li>
<li><p><a class="reference internal" href="#index-exref-0-14">Run a model with runtime 'python_compiled'</a></p></li>
</ol>
<div class="admonition-exref admonition" id="index-exref-0-0">
<p class="admonition-title">Change ONNX model inputs</p>
<p>The following exampels shows how to change the inputs of model
to bypass the first nodes. Shape inferences fails to determine
the new inputs type. They need to be overwritten.
<cite>verbose=1, fLOG=print</cite> shows the number of deleted nodes.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">onnx</span>
<span class="kn">from</span> <span class="nn">mlprodict.onnx_tools.onnx_manipulations</span> <span class="kn">import</span> <span class="n">select_model_inputs_outputs</span>

<span class="n">onx</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="n">onx2</span> <span class="o">=</span> <span class="n">select_model_inputs_outputs</span><span class="p">(</span>
    <span class="n">onx</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;SentenceTokenizer/SentencepieceTokenizeOp:0&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;SentenceTokenizer/SentencepieceTokenizeOp:1&quot;</span><span class="p">],</span>
    <span class="n">infer_shapes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fLOG</span><span class="o">=</span><span class="nb">print</span><span class="p">,</span>
    <span class="n">overwrite</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;SentenceTokenizer/SentencepieceTokenizeOp:0&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
               <span class="s1">&#39;SentenceTokenizer/SentencepieceTokenizeOp:1&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">int64</span><span class="p">,</span> <span class="kc">None</span><span class="p">)})</span>
<span class="n">onnx</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">onx2</span><span class="p">,</span> <span class="n">path2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p class="exref-source"><span class="target" id="indexindexexref-ex0-0"></span>(<a class="reference internal" href="mlprodict/onnx_tools/onnx_manipulations.html#indexexref-ex0">original entry</a> : onnx_manipulations.py:docstring of mlprodict.onnx_tools.onnx_manipulations.select_model_inputs_outputs, line 17)</p>
<div class="admonition-exref admonition" id="index-exref-0-1">
<p class="admonition-title">Computes predictions with any runtime</p>
<p>The following example compares predictions
between <a class="reference external" href="https://scikit-learn.org/stable/">scikit-learn</a> and this runtime
for the python runtime.</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">mlprodict.onnxrt</span> <span class="kn">import</span> <span class="n">OnnxInference</span>
<span class="kn">from</span> <span class="nn">mlprodict.onnx_conv</span> <span class="kn">import</span> <span class="n">to_onnx</span>

<span class="n">iris</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">clr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">clr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">exp</span> <span class="o">=</span> <span class="n">clr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span>

<span class="n">model_def</span> <span class="o">=</span> <span class="n">to_onnx</span><span class="p">(</span><span class="n">clr</span><span class="p">,</span> <span class="n">X_train</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
                    <span class="n">target_opset</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">oinf</span> <span class="o">=</span> <span class="n">OnnxInference</span><span class="p">(</span><span class="n">model_def</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">oinf</span><span class="o">.</span><span class="n">run</span><span class="p">({</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="n">X_test</span><span class="p">[:</span><span class="mi">5</span><span class="p">]})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="p">[</span><span class="mf">2.077</span> <span class="mf">1.803</span> <span class="mf">0.896</span> <span class="mf">0.012</span> <span class="mf">1.194</span><span class="p">]</span>
    <span class="p">{</span><span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([[</span><span class="mf">2.077</span><span class="p">],</span>
           <span class="p">[</span><span class="mf">1.803</span><span class="p">],</span>
           <span class="p">[</span><span class="mf">0.896</span><span class="p">],</span>
           <span class="p">[</span><span class="mf">0.012</span><span class="p">],</span>
           <span class="p">[</span><span class="mf">1.194</span><span class="p">]])}</span>
</pre></div>
</div>
</div>
<p class="exref-source"><span class="target" id="indexindexexref-ex1-0"></span>(<a class="reference internal" href="mlprodict/onnxrt/onnx_inference.html#indexexref-ex1">original entry</a> : onnx_inference.py:docstring of mlprodict.onnxrt.onnx_inference.OnnxInference.run, line 20)</p>
<div class="admonition-exref admonition" id="index-exref-0-2">
<p class="admonition-title">Convert ONNX into DOT</p>
<p>An example on how to convert an <a class="reference external" href="https://onnx.ai/">ONNX</a>
graph into <a class="reference external" href="https://en.wikipedia.org/wiki/DOT_(graph_description_language)">DOT</a>.</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">mlprodict.npy.xop</span> <span class="kn">import</span> <span class="n">loadop</span>
<span class="kn">from</span> <span class="nn">mlprodict.onnxrt</span> <span class="kn">import</span> <span class="n">OnnxInference</span>

<span class="n">OnnxAiOnnxMlLinearRegressor</span> <span class="o">=</span> <span class="n">loadop</span><span class="p">(</span>
    <span class="p">(</span><span class="s1">&#39;ai.onnx.ml&#39;</span><span class="p">,</span> <span class="s1">&#39;LinearRegressor&#39;</span><span class="p">))</span>

<span class="n">pars</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">coefficients</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">]),</span>
            <span class="n">intercepts</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">]),</span>
            <span class="n">post_transform</span><span class="o">=</span><span class="s1">&#39;NONE&#39;</span><span class="p">)</span>
<span class="n">onx</span> <span class="o">=</span> <span class="n">OnnxAiOnnxMlLinearRegressor</span><span class="p">(</span>
    <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">output_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>
<span class="n">model_def</span> <span class="o">=</span> <span class="n">onx</span><span class="o">.</span><span class="n">to_onnx</span><span class="p">(</span>
    <span class="p">{</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;coefficients&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)},</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">},</span>
    <span class="n">target_opset</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">oinf</span> <span class="o">=</span> <span class="n">OnnxInference</span><span class="p">(</span><span class="n">model_def</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">oinf</span><span class="o">.</span><span class="n">to_dot</span><span class="p">())</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">digraph</span><span class="p">{</span>
      <span class="n">nodesep</span><span class="o">=</span><span class="mf">0.05</span><span class="p">;</span>
      <span class="n">ranksep</span><span class="o">=</span><span class="mf">0.25</span><span class="p">;</span>
      <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">;</span>
      <span class="n">orientation</span><span class="o">=</span><span class="n">portrait</span><span class="p">;</span>
    
      <span class="n">X</span> <span class="p">[</span><span class="n">shape</span><span class="o">=</span><span class="n">box</span> <span class="n">color</span><span class="o">=</span><span class="n">red</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;X</span><span class="se">\n</span><span class="s2">float((2,))&quot;</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">];</span>
    
      <span class="n">Y</span> <span class="p">[</span><span class="n">shape</span><span class="o">=</span><span class="n">box</span> <span class="n">color</span><span class="o">=</span><span class="n">green</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Y</span><span class="se">\n</span><span class="s2">float((&#39;?&#39;,))&quot;</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">];</span>
    
    
      <span class="n">_linearregressor</span> <span class="p">[</span><span class="n">shape</span><span class="o">=</span><span class="n">box</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;filled,rounded&quot;</span> <span class="n">color</span><span class="o">=</span><span class="n">orange</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;LinearRegressor</span><span class="se">\n</span><span class="s2">(_linearregressor)</span><span class="se">\n</span><span class="s2">coefficients=[1. 2.]</span><span class="se">\n</span><span class="s2">intercepts=[1.]</span><span class="se">\n</span><span class="s2">post_transform=b&#39;NONE&#39;&quot;</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">];</span>
      <span class="n">X</span> <span class="o">-&gt;</span> <span class="n">_linearregressor</span><span class="p">;</span>
      <span class="n">_linearregressor</span> <span class="o">-&gt;</span> <span class="n">Y</span><span class="p">;</span>
    <span class="p">}</span>
</pre></div>
</div>
<p>See an example of representation in notebook
<a class="reference internal" href="../../notebooks/onnx_visualization.html#onnxvisualizationrst"><span class="std std-ref">ONNX visualization</span></a>.</p>
</div>
<p class="exref-source"><span class="target" id="indexindexexref-ex0-1"></span>(<a class="reference internal" href="mlprodict/onnxrt/onnx_inference_exports.html#indexexref-ex0">original entry</a> : onnx_inference_exports.py:docstring of mlprodict.onnxrt.onnx_inference_exports.OnnxInferenceExport.to_dot, line 26)</p>
<div class="admonition-exref admonition" id="index-exref-0-3">
<p class="admonition-title">Convert ONNX into JSON</p>
<p>An example on how to convert an <a class="reference external" href="https://onnx.ai/">ONNX</a>
graph into <a class="reference external" href="https://en.wikipedia.org/wiki/JSON">JSON</a>.</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">mlprodict.npy.xop</span> <span class="kn">import</span> <span class="n">loadop</span>
<span class="kn">from</span> <span class="nn">mlprodict.onnxrt</span> <span class="kn">import</span> <span class="n">OnnxInference</span>

<span class="n">OnnxAiOnnxMlLinearRegressor</span> <span class="o">=</span> <span class="n">loadop</span><span class="p">(</span>
    <span class="p">(</span><span class="s1">&#39;ai.onnx.ml&#39;</span><span class="p">,</span> <span class="s1">&#39;LinearRegressor&#39;</span><span class="p">))</span>

<span class="n">pars</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">coefficients</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">]),</span>
            <span class="n">intercepts</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">]),</span>
            <span class="n">post_transform</span><span class="o">=</span><span class="s1">&#39;NONE&#39;</span><span class="p">)</span>
<span class="n">onx</span> <span class="o">=</span> <span class="n">OnnxAiOnnxMlLinearRegressor</span><span class="p">(</span>
    <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">output_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>
<span class="n">model_def</span> <span class="o">=</span> <span class="n">onx</span><span class="o">.</span><span class="n">to_onnx</span><span class="p">(</span>
    <span class="p">{</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;coefficients&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)},</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">},</span>
    <span class="n">target_opset</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">oinf</span> <span class="o">=</span> <span class="n">OnnxInference</span><span class="p">(</span><span class="n">model_def</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">oinf</span><span class="o">.</span><span class="n">to_json</span><span class="p">())</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="p">{</span>
      <span class="s2">&quot;model_version&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;producer_name&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
      <span class="s2">&quot;domain&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
      <span class="s2">&quot;ir_version&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
      <span class="s2">&quot;doc_string&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
      <span class="s2">&quot;producer_version&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
      <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;X&quot;</span><span class="p">,</span>
          <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;tensor_type&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;elem_type&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
              <span class="s2">&quot;shape&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;dim&quot;</span><span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;dim_value&quot;</span><span class="p">:</span> <span class="mi">2</span>
                <span class="p">}</span>
              <span class="p">}</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="s2">&quot;outputs&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Y&quot;</span><span class="p">,</span>
          <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;tensor_type&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;elem_type&quot;</span><span class="p">:</span> <span class="mi">1</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="s2">&quot;initializers&quot;</span><span class="p">:</span> <span class="p">{},</span>
      <span class="s2">&quot;nodes&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;_linearregressor&quot;</span><span class="p">,</span>
          <span class="s2">&quot;op_type&quot;</span><span class="p">:</span> <span class="s2">&quot;LinearRegressor&quot;</span><span class="p">,</span>
          <span class="s2">&quot;domain&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
          <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;X&quot;</span>
          <span class="p">],</span>
          <span class="s2">&quot;outputs&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;Y&quot;</span>
          <span class="p">],</span>
          <span class="s2">&quot;attributes&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;coefficients&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;floats&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="mf">1.0</span><span class="p">,</span>
                <span class="mf">2.0</span>
              <span class="p">],</span>
              <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;FLOATS&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;intercepts&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;floats&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="mf">1.0</span>
              <span class="p">],</span>
              <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;FLOATS&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;post_transform&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="s2">&quot;NONE&quot;</span><span class="p">,</span>
              <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;STRING&quot;</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
</pre></div>
</div>
</div>
<p class="exref-source"><span class="target" id="indexindexexref-ex1-1"></span>(<a class="reference internal" href="mlprodict/onnxrt/onnx_inference_exports.html#indexexref-ex1">original entry</a> : onnx_inference_exports.py:docstring of mlprodict.onnxrt.onnx_inference_exports.OnnxInferenceExport.to_json, line 6)</p>
<div class="admonition-exref admonition" id="index-exref-0-4">
<p class="admonition-title">Convert ONNX into graph</p>
<p>An example on how to convert an <a class="reference external" href="https://onnx.ai/">ONNX</a>
graph into a graph.</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pprint</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">mlprodict.npy.xop</span> <span class="kn">import</span> <span class="n">loadop</span>
<span class="kn">from</span> <span class="nn">mlprodict.onnxrt</span> <span class="kn">import</span> <span class="n">OnnxInference</span>

<span class="n">OnnxAiOnnxMlLinearRegressor</span> <span class="o">=</span> <span class="n">loadop</span><span class="p">(</span>
    <span class="p">(</span><span class="s1">&#39;ai.onnx.ml&#39;</span><span class="p">,</span> <span class="s1">&#39;LinearRegressor&#39;</span><span class="p">))</span>

<span class="n">pars</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">coefficients</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">]),</span>
            <span class="n">intercepts</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">]),</span>
            <span class="n">post_transform</span><span class="o">=</span><span class="s1">&#39;NONE&#39;</span><span class="p">)</span>
<span class="n">onx</span> <span class="o">=</span> <span class="n">OnnxAiOnnxMlLinearRegressor</span><span class="p">(</span>
    <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">output_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span> <span class="o">**</span><span class="n">pars</span><span class="p">)</span>
<span class="n">model_def</span> <span class="o">=</span> <span class="n">onx</span><span class="o">.</span><span class="n">to_onnx</span><span class="p">(</span>
    <span class="p">{</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;coefficients&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)},</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">},</span>
    <span class="n">target_opset</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">oinf</span> <span class="o">=</span> <span class="n">OnnxInference</span><span class="p">(</span><span class="n">model_def</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">oinf</span><span class="o">.</span><span class="n">to_sequence</span><span class="p">())</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="p">{</span><span class="s1">&#39;functions&#39;</span><span class="p">:</span> <span class="p">{},</span>
     <span class="s1">&#39;inits&#39;</span><span class="p">:</span> <span class="p">{},</span>
     <span class="s1">&#39;inputs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;X&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;elem&#39;</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;kind&#39;</span><span class="p">:</span> <span class="s1">&#39;tensor&#39;</span><span class="p">,</span> <span class="s1">&#39;shape&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,)}}},</span>
     <span class="s1">&#39;intermediate&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>
     <span class="s1">&#39;ir_version&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
     <span class="s1">&#39;nodes&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;_linearregressor&#39;</span><span class="p">:</span> <span class="n">Onnx</span><span class="o">-</span><span class="n">LinearRegressor</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Y</span>    <span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;_linearregressor&#39;</span><span class="p">)},</span>
     <span class="s1">&#39;outputs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;elem&#39;</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;kind&#39;</span><span class="p">:</span> <span class="s1">&#39;tensor&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;shape&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,)}}},</span>
     <span class="s1">&#39;sequence&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">Onnx</span><span class="o">-</span><span class="n">LinearRegressor</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Y</span>    <span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;_linearregressor&#39;</span><span class="p">)],</span>
     <span class="s1">&#39;statics&#39;</span><span class="p">:</span> <span class="p">{},</span>
     <span class="s1">&#39;targets&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}}</span>
</pre></div>
</div>
<p>See an example of representation in notebook
<a class="reference internal" href="../../notebooks/onnx_visualization.html#onnxvisualizationrst"><span class="std std-ref">ONNX visualization</span></a>.</p>
</div>
<p class="exref-source"><span class="target" id="indexindexexref-ex2-0"></span>(<a class="reference internal" href="mlprodict/onnxrt/onnx_inference.html#indexexref-ex2">original entry</a> : onnx_inference.py:docstring of mlprodict.onnxrt.onnx_inference.OnnxInference.to_sequence, line 5)</p>
<div class="admonition-exref admonition" id="index-exref-0-5">
<p class="admonition-title">Convert a function into ONNX code</p>
<p>The following code parses a python function and returns
another python function which produces an <a class="reference external" href="https://onnx.ai/">ONNX</a>
graph if executed.</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">mlprodict.onnx_tools.onnx_grammar</span> <span class="kn">import</span> <span class="n">translate_fct2onnx</span>


<span class="k">def</span> <span class="nf">trs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">z</span>


<span class="n">onnx_code</span> <span class="o">=</span> <span class="n">translate_fct2onnx</span><span class="p">(</span>
    <span class="n">trs</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;numpy.transpose&#39;</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">transpose</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">onnx_code</span><span class="p">)</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">trs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">op_version</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">z</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">OnnxAdd</span><span class="p">(</span>
                <span class="n">x</span><span class="p">,</span>
                <span class="n">OnnxTranspose</span><span class="p">(</span>
                    <span class="n">y</span><span class="p">,</span>
                    <span class="n">perm</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="n">op_version</span><span class="o">=</span><span class="n">op_version</span>
                <span class="p">),</span>
                <span class="n">op_version</span><span class="o">=</span><span class="n">op_version</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">OnnxMul</span><span class="p">(</span>
                <span class="n">x</span><span class="p">,</span>
                <span class="n">z</span><span class="p">,</span>
                <span class="n">op_version</span><span class="o">=</span><span class="n">op_version</span>
            <span class="p">)</span>
        <span class="p">)</span>
</pre></div>
</div>
</div>
<p class="exref-source"><span class="target" id="indexindexexref-ex0-2"></span>(<a class="reference internal" href="mlprodict/onnx_tools/onnx_grammar/onnx_translation.html#indexexref-ex0">original entry</a> : onnx_translation.py:docstring of mlprodict.onnx_tools.onnx_grammar.onnx_translation.translate_fct2onnx, line 23)</p>
<div class="admonition-exref admonition" id="index-exref-0-6">
<p class="admonition-title">Convert a function into ONNX code and run</p>
<p>The following code parses a python function and returns
another python function which produces an <a class="reference external" href="https://onnx.ai/">ONNX</a>
graph if executed. The example executes the function,
creates an <a class="reference external" href="https://onnx.ai/">ONNX</a> then uses <a class="reference internal" href="../../onnxrt/onnx_inference.html#mlprodict.onnxrt.onnx_inference.OnnxInference" title="mlprodict.onnxrt.onnx_inference.OnnxInference"><code class="xref py py-class docutils literal notranslate"><span class="pre">OnnxInference</span></code></a>
to compute <em>predictions</em>. Finally it compares
them to the original.</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">mlprodict.onnx_tools.onnx_grammar</span> <span class="kn">import</span> <span class="n">translate_fct2onnx</span>
<span class="kn">from</span> <span class="nn">mlprodict.plotting.text_plot</span> <span class="kn">import</span> <span class="n">onnx_simple_text_plot</span>
<span class="kn">from</span> <span class="nn">mlprodict.onnxrt</span> <span class="kn">import</span> <span class="n">OnnxInference</span>
<span class="kn">from</span> <span class="nn">mlprodict.npy.xop</span> <span class="kn">import</span> <span class="n">loadop</span>


<span class="n">OnnxAdd</span><span class="p">,</span> <span class="n">OnnxTranspose</span><span class="p">,</span> <span class="n">OnnxMul</span><span class="p">,</span> <span class="n">OnnxIdentity</span> <span class="o">=</span> <span class="n">loadop</span><span class="p">(</span>
    <span class="s1">&#39;Add&#39;</span><span class="p">,</span> <span class="s1">&#39;Transpose&#39;</span><span class="p">,</span> <span class="s1">&#39;Mul&#39;</span><span class="p">,</span> <span class="s1">&#39;Identity&#39;</span><span class="p">)</span>


<span class="n">ctx</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;OnnxAdd&#39;</span><span class="p">:</span> <span class="n">OnnxAdd</span><span class="p">,</span>
       <span class="s1">&#39;OnnxTranspose&#39;</span><span class="p">:</span> <span class="n">OnnxTranspose</span><span class="p">,</span>
       <span class="s1">&#39;OnnxMul&#39;</span><span class="p">:</span> <span class="n">OnnxMul</span><span class="p">,</span>
       <span class="s1">&#39;OnnxIdentity&#39;</span><span class="p">:</span> <span class="n">OnnxIdentity</span><span class="p">}</span>


<span class="k">def</span> <span class="nf">trs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">z</span>


<span class="n">inputs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
          <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">}</span>

<span class="n">original</span> <span class="o">=</span> <span class="n">trs</span><span class="p">(</span><span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;original output:&#39;</span><span class="p">,</span> <span class="n">original</span><span class="p">)</span>

<span class="n">onnx_fct</span> <span class="o">=</span> <span class="n">translate_fct2onnx</span><span class="p">(</span>
    <span class="n">trs</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;numpy.transpose&#39;</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">transpose</span><span class="p">},</span>
    <span class="n">cpl</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">context_cpl</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span> <span class="n">output_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">])</span>

<span class="n">onnx_code</span> <span class="o">=</span> <span class="n">onnx_fct</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">op_version</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">onnx_g</span> <span class="o">=</span> <span class="n">onnx_code</span><span class="o">.</span><span class="n">to_onnx</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">target_opset</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ONNX model&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">onnx_simple_text_plot</span><span class="p">(</span><span class="n">onnx_g</span><span class="p">))</span>

<span class="n">oinf</span> <span class="o">=</span> <span class="n">OnnxInference</span><span class="p">(</span><span class="n">onnx_g</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">oinf</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-----------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ONNX inference:&quot;</span><span class="p">,</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">original</span> <span class="n">output</span><span class="p">:</span> <span class="p">[[</span><span class="mf">0.7</span> <span class="mf">4.8</span><span class="p">]]</span>
    <span class="n">ONNX</span> <span class="n">model</span>
    <span class="n">opset</span><span class="p">:</span> <span class="n">domain</span><span class="o">=</span><span class="s1">&#39;&#39;</span> <span class="n">version</span><span class="o">=</span><span class="mi">12</span>
    <span class="nb">input</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;x&#39;</span> <span class="nb">type</span><span class="o">=</span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="nb">input</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;y&#39;</span> <span class="nb">type</span><span class="o">=</span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">Transpose</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">perm</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">out_tra_0</span>
      <span class="n">Add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">out_tra_0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">out_add_0</span>
        <span class="n">Mul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">out_add_0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Z</span>
    <span class="n">output</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span> <span class="nb">type</span><span class="o">=</span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="o">-----------</span>
    <span class="n">ONNX</span> <span class="n">inference</span><span class="p">:</span> <span class="p">[[</span><span class="mf">0.7</span> <span class="mf">4.8</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<p class="exref-source"><span class="target" id="indexindexexref-ex1-2"></span>(<a class="reference internal" href="mlprodict/onnx_tools/onnx_grammar/onnx_translation.html#indexexref-ex1">original entry</a> : onnx_translation.py:docstring of mlprodict.onnx_tools.onnx_grammar.onnx_translation.translate_fct2onnx, line 49)</p>
<div class="admonition-exref admonition" id="index-exref-0-8">
<p class="admonition-title">Converts bytes into an array (serialization)</p>
<p>Useful to deserialize.</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">mlprodict.onnx_tools.onnx2py_helper</span> <span class="kn">import</span> <span class="n">to_bytes</span><span class="p">,</span> <span class="n">from_bytes</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">pb</span> <span class="o">=</span> <span class="n">to_bytes</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">data2</span> <span class="o">=</span> <span class="n">from_bytes</span><span class="p">(</span><span class="n">pb</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="p">[[</span><span class="mf">0.</span> <span class="mf">1.</span><span class="p">]</span>
     <span class="p">[</span><span class="mf">2.</span> <span class="mf">3.</span><span class="p">]</span>
     <span class="p">[</span><span class="mf">4.</span> <span class="mf">5.</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<p class="exref-source"><span class="target" id="indexindexexref-ex0-3"></span>(<a class="reference internal" href="mlprodict/onnx_tools/onnx2py_helper.html#indexexref-ex0">original entry</a> : onnx2py_helper.py:docstring of mlprodict.onnx_tools.onnx2py_helper.from_bytes, line 6)</p>
<div class="admonition-exref admonition" id="index-exref-0-9">
<p class="admonition-title">Displays an ONNX graph as text</p>
<p>The function uses an adjacency matrix of the graph.
Results are displayed by rows, operator by columns.
Results kinds are shows on the left,
their names on the right. Operator types are displayed
on the top, their names on the bottom.</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">mlprodict.onnx_conv</span> <span class="kn">import</span> <span class="n">to_onnx</span>
<span class="kn">from</span> <span class="nn">mlprodict</span> <span class="kn">import</span> <span class="n">__max_supported_opset__</span> <span class="k">as</span> <span class="n">opv</span>
<span class="kn">from</span> <span class="nn">mlprodict.tools.graphs</span> <span class="kn">import</span> <span class="n">onnx2bigraph</span>
<span class="kn">from</span> <span class="nn">mlprodict.npy.xop</span> <span class="kn">import</span> <span class="n">loadop</span>

<span class="n">OnnxAdd</span><span class="p">,</span> <span class="n">OnnxSub</span> <span class="o">=</span> <span class="n">loadop</span><span class="p">(</span><span class="s1">&#39;Add&#39;</span><span class="p">,</span> <span class="s1">&#39;Sub&#39;</span><span class="p">)</span>

<span class="n">idi</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">OnnxAdd</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">idi</span><span class="p">,</span> <span class="n">op_version</span><span class="o">=</span><span class="n">opv</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">OnnxSub</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="n">output_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span> <span class="n">op_version</span><span class="o">=</span><span class="n">opv</span><span class="p">)</span>
<span class="n">onx</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">to_onnx</span><span class="p">({</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="n">idi</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">:</span> <span class="n">idi</span><span class="p">})</span>
<span class="n">bigraph</span> <span class="o">=</span> <span class="n">onnx2bigraph</span><span class="p">(</span><span class="n">onx</span><span class="p">)</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">bigraph</span><span class="o">.</span><span class="n">display_structure</span><span class="p">()</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">to_text</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                          <span class="n">A</span>  <span class="n">S</span>                    
                          <span class="n">d</span>  <span class="n">u</span>                    
                          <span class="n">d</span>  <span class="n">b</span>                    
                                                  
                                                  
                                                  
                                                  
     <span class="n">Input</span><span class="o">-</span><span class="mi">0</span>                 <span class="n">I1</span>          <span class="n">W</span>        
     <span class="n">Input</span><span class="o">-</span><span class="mi">1</span>              <span class="n">I0</span>             <span class="n">X</span>        
        <span class="n">Init</span>              <span class="n">I1</span>             <span class="n">init</span>     
       <span class="n">inout</span>              <span class="n">O0</span> <span class="n">I0</span>          <span class="n">out_add_0</span>
    <span class="n">Output</span><span class="o">-</span><span class="mi">0</span>                 <span class="n">O0</span>          <span class="n">Y</span>        
                                                  
                                                  
                                                  
                                                  
                                                  
                          <span class="n">_</span>  <span class="n">_</span>                    
                          <span class="n">a</span>  <span class="n">s</span>                    
                          <span class="n">d</span>  <span class="n">u</span>                    
                          <span class="n">d</span>  <span class="n">b</span>
</pre></div>
</div>
</div>
<p class="exref-source"><span class="target" id="indexindexexref-ex0-4"></span>(<a class="reference internal" href="mlprodict/tools/graphs.html#indexexref-ex0">original entry</a> : graphs.py:docstring of mlprodict.tools.graphs.onnx2bigraph, line 17)</p>
<div class="admonition-exref admonition" id="index-exref-0-10">
<p class="admonition-title">Extract information from a model</p>
<p>The function <a class="reference internal" href="#mlprodict.tools.model_info.analyze_model" title="mlprodict.tools.model_info.analyze_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">analyze_model</span></code></a> extracts global
figures about a model, whatever it is.</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pprint</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">mlprodict.tools.model_info</span> <span class="kn">import</span> <span class="n">analyze_model</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">target</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">infos</span> <span class="o">=</span> <span class="n">analyze_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">infos</span><span class="p">)</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    /usr/local/lib/python3.9/site-packages/sklearn/utils/deprecation.py:103: FutureWarning: Attribute `n_features_` was deprecated in version 1.0 and will be removed in 1.2. Use `n_features_in_` instead.
      warnings.warn(msg, category=FutureWarning)
    /usr/local/lib/python3.9/site-packages/sklearn/utils/deprecation.py:103: FutureWarning: The attribute `n_features_` is deprecated in 1.0 and will be removed in 1.2. Use `n_features_in_` instead.
      warnings.warn(msg, category=FutureWarning)
    {&#39;classes_.shape&#39;: 3,
     &#39;estimators_.classes_.shape&#39;: 3,
     &#39;estimators_.max|tree_.max_depth&#39;: 8,
     &#39;estimators_.n_classes_&#39;: 3,
     &#39;estimators_.n_features_&#39;: 4,
     &#39;estimators_.size&#39;: 100,
     &#39;estimators_.sum|tree_.leave_count&#39;: 894,
     &#39;estimators_.sum|tree_.node_count&#39;: 1688,
     &#39;n_classes_&#39;: 3,
     &#39;n_features_&#39;: 4}
</pre></div>
</div>
</div>
<p class="exref-source"><span class="target" id="indexindexexref-ex0-5"></span>(<a class="reference internal" href="mlprodict/tools/model_info.html#indexexref-ex0">original entry</a> : model_info.py:docstring of mlprodict.tools.model_info.analyze_model, line 8)</p>
<div class="admonition-exref admonition" id="index-exref-0-11">
<p class="admonition-title">Get the tree of a simple function</p>
<p>The following code uses Python syntax but follows a SQL logic.</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ast</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">from</span> <span class="nn">textwrap</span> <span class="kn">import</span> <span class="n">dedent</span>
<span class="kn">from</span> <span class="nn">mlprodict.onnx_tools.onnx_grammar</span> <span class="kn">import</span> <span class="n">CodeNodeVisitor</span>


<span class="k">def</span> <span class="nf">norm2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">y</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">delta</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="n">n</span>


<span class="n">code</span> <span class="o">=</span> <span class="n">dedent</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">norm2</span><span class="p">))</span>
<span class="n">node</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">CodeNodeVisitor</span><span class="p">()</span>
<span class="n">v</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">Rows</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{0}{1}</span><span class="s2">: </span><span class="si">{2}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;    &quot;</span> <span class="o">*</span> <span class="n">r</span><span class="p">[</span><span class="s2">&quot;indent&quot;</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="s2">&quot;str&quot;</span><span class="p">]))</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">Module</span><span class="p">:</span> 
        <span class="n">FunctionDef</span><span class="p">:</span> <span class="n">norm2</span>
            <span class="n">arguments</span><span class="p">:</span> 
                <span class="n">arg</span><span class="p">:</span> <span class="n">x</span>
                <span class="n">arg</span><span class="p">:</span> <span class="n">y</span>
            <span class="n">Assign</span><span class="p">:</span> 
                <span class="n">Name</span><span class="p">:</span> <span class="n">delta</span>
                <span class="n">BinOp</span><span class="p">:</span> 
                    <span class="n">Name</span><span class="p">:</span> <span class="n">x</span>
                    <span class="n">Sub</span><span class="p">:</span> 
                    <span class="n">Name</span><span class="p">:</span> <span class="n">y</span>
            <span class="n">Assign</span><span class="p">:</span> 
                <span class="n">Name</span><span class="p">:</span> <span class="n">n</span>
                <span class="n">BinOp</span><span class="p">:</span> 
                    <span class="n">Name</span><span class="p">:</span> <span class="n">delta</span>
                    <span class="n">Pow</span><span class="p">:</span> 
                    <span class="n">Num</span><span class="p">:</span> <span class="mi">2</span>
            <span class="n">Return</span><span class="p">:</span> 
                <span class="n">Name</span><span class="p">:</span> <span class="n">n</span>
</pre></div>
</div>
</div>
<p class="exref-source"><span class="target" id="indexindexexref-ex0-6"></span>(<a class="reference internal" href="mlprodict/onnx_tools/onnx_grammar/node_visitor_translator.html#indexexref-ex0">original entry</a> : node_visitor_translator.py:docstring of mlprodict.onnx_tools.onnx_grammar.node_visitor_translator.CodeNodeVisitor, line 3)</p>
<div class="admonition-exref admonition" id="index-exref-0-12">
<p class="admonition-title">How to use TreeEnsembleRegressorDouble instead of TreeEnsembleRegressor</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_regression</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">RandomForestRegressor</span><span class="p">,</span> <span class="n">GradientBoostingRegressor</span><span class="p">,</span>
    <span class="n">HistGradientBoostingRegressor</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">mlprodict.onnx_conv</span> <span class="kn">import</span> <span class="n">to_onnx</span>
<span class="kn">from</span> <span class="nn">mlprodict.onnxrt</span> <span class="kn">import</span> <span class="n">OnnxInference</span>

<span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

    <span class="n">models</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
        <span class="n">GradientBoostingRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
        <span class="n">HistGradientBoostingRegressor</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_regression</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_targets</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

    <span class="n">conv</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
        <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">500</span><span class="p">],</span> <span class="n">y</span><span class="p">[:</span><span class="mi">500</span><span class="p">])</span>
        <span class="n">onx64</span> <span class="o">=</span> <span class="n">to_onnx</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">rewrite_ops</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">target_opset</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="k">assert</span> <span class="s1">&#39;TreeEnsembleRegressorDouble&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">onx64</span><span class="p">)</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

        <span class="n">oinf</span> <span class="o">=</span> <span class="n">OnnxInference</span><span class="p">(</span><span class="n">onx64</span><span class="p">)</span>
        <span class="n">got</span> <span class="o">=</span> <span class="n">oinf</span><span class="o">.</span><span class="n">run</span><span class="p">({</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="n">X</span><span class="p">})</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;variable&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">expected</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">: max=</span><span class="si">%f</span><span class="s2"> mean=</span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
            <span class="n">model</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">diff</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">diff</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">RandomForestRegressor</span><span class="p">:</span> <span class="nb">max</span><span class="o">=</span><span class="mf">0.000000</span> <span class="n">mean</span><span class="o">=</span><span class="mf">0.000000</span>
    <span class="n">GradientBoostingRegressor</span><span class="p">:</span> <span class="nb">max</span><span class="o">=</span><span class="mf">0.000000</span> <span class="n">mean</span><span class="o">=</span><span class="mf">0.000000</span>
    <span class="n">HistGradientBoostingRegressor</span><span class="p">:</span> <span class="nb">max</span><span class="o">=</span><span class="mf">0.000000</span> <span class="n">mean</span><span class="o">=</span><span class="mf">0.000000</span>
</pre></div>
</div>
</div>
<p class="exref-source"><span class="target" id="indexindexexref-ex0-7"></span>(<a class="reference internal" href="mlprodict/onnxrt/ops_cpu/op_tree_ensemble_regressor.html#indexexref-ex0">original entry</a> : op_tree_ensemble_regressor.py:docstring of mlprodict.onnxrt.ops_cpu.op_tree_ensemble_regressor.TreeEnsembleRegressorDouble, line 3)</p>
<div class="admonition-exref admonition" id="index-exref-0-13">
<div class="docutils container">
</div>
<p class="admonition-title" id="plot-2d-benchmark-metric">Plot benchmark improvments</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mlprodict.plotting.plotting_benchmark</span> <span class="kn">import</span> <span class="n">plot_benchmark_metrics</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">{(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mf">0.1</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span> <span class="mi">2</span><span class="p">,</span>
        <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span> <span class="mi">100</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">100</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span> <span class="mi">1000</span><span class="p">}</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plot_benchmark_metrics</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cbar_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;shrink&#39;</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">})</span>
<span class="n">plot_benchmark_metrics</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">transpose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span>
                       <span class="n">cbarlabel</span><span class="o">=</span><span class="s2">&quot;ratio&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../mlprodict/plotting/plotting_benchmark-1.png">png</a>, <a class="reference external" href="../../mlprodict/plotting/plotting_benchmark-1.hires.png">hires.png</a>, <a class="reference external" href="../../mlprodict/plotting/plotting_benchmark-1.pdf">pdf</a>)</p>
<figure class="align-default">
<img alt="_images/plotting_benchmark-1.png" class="plot-directive" src="_images/plotting_benchmark-1.png" />
</figure>
</div>
<p class="exref-source"><span class="target" id="indexindexexref-ex0-8"></span>(<a class="reference internal" href="mlprodict/plotting/plotting_benchmark.html#indexexref-ex0">original entry</a> : plotting_benchmark.py:docstring of mlprodict.plotting.plotting_benchmark.plot_benchmark_metrics, line 18)</p>
<div class="admonition-exref admonition" id="index-exref-0-14">
<p class="admonition-title">Run a model with runtime ‘python_compiled’</p>
<p>The following code trains a model and compute
the predictions with runtime <code class="docutils literal notranslate"><span class="pre">'python_compiled'</span></code>.
It converts the onnx graph into a python function
which calls every operator. Its code is printed
below.</p>
<p>&lt;&lt;&lt;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">AdaBoostClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">mlprodict.onnx_conv</span> <span class="kn">import</span> <span class="n">to_onnx</span>
<span class="kn">from</span> <span class="nn">mlprodict.onnxrt</span> <span class="kn">import</span> <span class="n">OnnxInference</span>

<span class="n">iris</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">__</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">clr</span> <span class="o">=</span> <span class="n">AdaBoostClassifier</span><span class="p">(</span>
    <span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
    <span class="n">n_estimators</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">clr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">model_def</span> <span class="o">=</span> <span class="n">to_onnx</span><span class="p">(</span><span class="n">clr</span><span class="p">,</span> <span class="n">X_train</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
                    <span class="n">target_opset</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="n">oinf2</span> <span class="o">=</span> <span class="n">OnnxInference</span><span class="p">(</span><span class="n">model_def</span><span class="p">,</span> <span class="n">runtime</span><span class="o">=</span><span class="s1">&#39;python_compiled&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">oinf2</span><span class="o">.</span><span class="n">run</span><span class="p">({</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="n">X_test</span><span class="p">[:</span><span class="mi">5</span><span class="p">]}))</span>

<span class="c1"># prints out the python function equivalent</span>
<span class="c1"># to the onnx graph</span>
<span class="nb">print</span><span class="p">(</span><span class="n">oinf2</span><span class="p">)</span>
</pre></div>
</div>
<p>&gt;&gt;&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="p">{</span><span class="s1">&#39;output_label&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span> <span class="s1">&#39;output_probability&#39;</span><span class="p">:</span> <span class="p">[]}</span>
    <span class="n">OnnxInference</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">compiled_run</span><span class="p">(</span><span class="n">dict_inputs</span><span class="p">,</span> <span class="n">yield_ops</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">yield_ops</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;yields_ops should be None.&#39;</span><span class="p">)</span>
            <span class="c1"># init: classes (classes)</span>
            <span class="c1"># init: clip_min (clip_min)</span>
            <span class="c1"># init: inverted_n_classes (inverted_n_classes)</span>
            <span class="c1"># init: mul_operand (mul_operand)</span>
            <span class="c1"># init: n_classes_minus_one (n_classes_minus_one)</span>
            <span class="c1"># init: shape_tensor (shape_tensor)</span>
            <span class="c1"># init: shape_tensor3 (shape_tensor3)</span>
            <span class="c1"># init: zero_scalar (zero_scalar)</span>
            <span class="c1"># inputs</span>
            <span class="n">X</span> <span class="o">=</span> <span class="n">dict_inputs</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span>
            <span class="p">(</span><span class="n">elab_name_0</span><span class="p">,</span> <span class="n">eprob_name_0</span><span class="p">,</span> <span class="p">)</span> <span class="o">=</span> <span class="n">n0_treeensembleclassifier</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
            <span class="p">(</span><span class="n">elab_name_1</span><span class="p">,</span> <span class="n">eprob_name_1</span><span class="p">,</span> <span class="p">)</span> <span class="o">=</span> <span class="n">n1_treeensembleclassifier</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
            <span class="p">(</span><span class="n">clipped_proba</span><span class="p">,</span> <span class="p">)</span> <span class="o">=</span> <span class="n">n2_clip_11</span><span class="p">(</span><span class="n">eprob_name_0</span><span class="p">,</span> <span class="n">clip_min</span><span class="p">)</span>
            <span class="p">(</span><span class="n">clipped_proba1</span><span class="p">,</span> <span class="p">)</span> <span class="o">=</span> <span class="n">n3_clip_11</span><span class="p">(</span><span class="n">eprob_name_1</span><span class="p">,</span> <span class="n">clip_min</span><span class="p">)</span>
            <span class="p">(</span><span class="n">log_proba1</span><span class="p">,</span> <span class="p">)</span> <span class="o">=</span> <span class="n">n4_log</span><span class="p">(</span><span class="n">clipped_proba1</span><span class="p">)</span>
            <span class="p">(</span><span class="n">log_proba</span><span class="p">,</span> <span class="p">)</span> <span class="o">=</span> <span class="n">n5_log</span><span class="p">(</span><span class="n">clipped_proba</span><span class="p">)</span>
            <span class="p">(</span><span class="n">reduced_proba1</span><span class="p">,</span> <span class="p">)</span> <span class="o">=</span> <span class="n">n6_reducesum_11</span><span class="p">(</span><span class="n">log_proba1</span><span class="p">)</span>
            <span class="p">(</span><span class="n">reduced_proba</span><span class="p">,</span> <span class="p">)</span> <span class="o">=</span> <span class="n">n7_reducesum_11</span><span class="p">(</span><span class="n">log_proba</span><span class="p">)</span>
            <span class="p">(</span><span class="n">reshaped_result</span><span class="p">,</span> <span class="p">)</span> <span class="o">=</span> <span class="n">n8_reshape_5</span><span class="p">(</span><span class="n">reduced_proba</span><span class="p">,</span> <span class="n">shape_tensor</span><span class="p">)</span>
            <span class="p">(</span><span class="n">reshaped_result1</span><span class="p">,</span> <span class="p">)</span> <span class="o">=</span> <span class="n">n9_reshape_5</span><span class="p">(</span><span class="n">reduced_proba1</span><span class="p">,</span> <span class="n">shape_tensor</span><span class="p">)</span>
            <span class="p">(</span><span class="n">prod_result1</span><span class="p">,</span> <span class="p">)</span> <span class="o">=</span> <span class="n">n10_mul</span><span class="p">(</span><span class="n">reshaped_result1</span><span class="p">,</span> <span class="n">inverted_n_classes</span><span class="p">)</span>
            <span class="p">(</span><span class="n">prod_result</span><span class="p">,</span> <span class="p">)</span> <span class="o">=</span> <span class="n">n11_mul</span><span class="p">(</span><span class="n">reshaped_result</span><span class="p">,</span> <span class="n">inverted_n_classes</span><span class="p">)</span>
            <span class="p">(</span><span class="n">sub_result</span><span class="p">,</span> <span class="p">)</span> <span class="o">=</span> <span class="n">n12_sub</span><span class="p">(</span><span class="n">log_proba</span><span class="p">,</span> <span class="n">prod_result</span><span class="p">)</span>
            <span class="p">(</span><span class="n">sub_result1</span><span class="p">,</span> <span class="p">)</span> <span class="o">=</span> <span class="n">n13_sub</span><span class="p">(</span><span class="n">log_proba1</span><span class="p">,</span> <span class="n">prod_result1</span><span class="p">)</span>
            <span class="p">(</span><span class="n">samme_proba</span><span class="p">,</span> <span class="p">)</span> <span class="o">=</span> <span class="n">n14_mul</span><span class="p">(</span><span class="n">sub_result</span><span class="p">,</span> <span class="n">n_classes_minus_one</span><span class="p">)</span>
            <span class="p">(</span><span class="n">samme_proba1</span><span class="p">,</span> <span class="p">)</span> <span class="o">=</span> <span class="n">n15_mul</span><span class="p">(</span><span class="n">sub_result1</span><span class="p">,</span> <span class="n">n_classes_minus_one</span><span class="p">)</span>
            <span class="p">(</span><span class="n">summation_prob</span><span class="p">,</span> <span class="p">)</span> <span class="o">=</span> <span class="n">n16_sum</span><span class="p">(</span><span class="n">samme_proba</span><span class="p">,</span> <span class="n">samme_proba1</span><span class="p">)</span>
            <span class="p">(</span><span class="n">div_result</span><span class="p">,</span> <span class="p">)</span> <span class="o">=</span> <span class="n">n17_div</span><span class="p">(</span><span class="n">summation_prob</span><span class="p">,</span> <span class="n">n_classes_minus_one</span><span class="p">)</span>
            <span class="p">(</span><span class="n">exp_operand</span><span class="p">,</span> <span class="p">)</span> <span class="o">=</span> <span class="n">n18_mul</span><span class="p">(</span><span class="n">div_result</span><span class="p">,</span> <span class="n">mul_operand</span><span class="p">)</span>
            <span class="p">(</span><span class="n">exp_result</span><span class="p">,</span> <span class="p">)</span> <span class="o">=</span> <span class="n">n19_exp</span><span class="p">(</span><span class="n">exp_operand</span><span class="p">)</span>
            <span class="p">(</span><span class="n">reduced_exp_result</span><span class="p">,</span> <span class="p">)</span> <span class="o">=</span> <span class="n">n20_reducesum_11</span><span class="p">(</span><span class="n">exp_result</span><span class="p">)</span>
            <span class="p">(</span><span class="n">normaliser</span><span class="p">,</span> <span class="p">)</span> <span class="o">=</span> <span class="n">n21_reshape_5</span><span class="p">(</span><span class="n">reduced_exp_result</span><span class="p">,</span> <span class="n">shape_tensor</span><span class="p">)</span>
            <span class="p">(</span><span class="n">cast_normaliser</span><span class="p">,</span> <span class="p">)</span> <span class="o">=</span> <span class="n">n22_cast</span><span class="p">(</span><span class="n">normaliser</span><span class="p">)</span>
            <span class="p">(</span><span class="n">comparison_result</span><span class="p">,</span> <span class="p">)</span> <span class="o">=</span> <span class="n">n23_equal</span><span class="p">(</span><span class="n">cast_normaliser</span><span class="p">,</span> <span class="n">zero_scalar</span><span class="p">)</span>
            <span class="p">(</span><span class="n">cast_output</span><span class="p">,</span> <span class="p">)</span> <span class="o">=</span> <span class="n">n24_cast</span><span class="p">(</span><span class="n">comparison_result</span><span class="p">)</span>
            <span class="p">(</span><span class="n">zero_filtered_normaliser</span><span class="p">,</span> <span class="p">)</span> <span class="o">=</span> <span class="n">n25_add</span><span class="p">(</span><span class="n">normaliser</span><span class="p">,</span> <span class="n">cast_output</span><span class="p">)</span>
            <span class="p">(</span><span class="n">probabilities</span><span class="p">,</span> <span class="p">)</span> <span class="o">=</span> <span class="n">n26_div</span><span class="p">(</span><span class="n">exp_result</span><span class="p">,</span> <span class="n">zero_filtered_normaliser</span><span class="p">)</span>
            <span class="p">(</span><span class="n">argmax_output</span><span class="p">,</span> <span class="p">)</span> <span class="o">=</span> <span class="n">n27_argmax_12</span><span class="p">(</span><span class="n">probabilities</span><span class="p">)</span>
            <span class="p">(</span><span class="n">output_probability</span><span class="p">,</span> <span class="p">)</span> <span class="o">=</span> <span class="n">n28_zipmap</span><span class="p">(</span><span class="n">probabilities</span><span class="p">)</span>
            <span class="p">(</span><span class="n">array_feature_extractor_result</span><span class="p">,</span> <span class="p">)</span> <span class="o">=</span> <span class="n">n29_arrayfeatureextractor</span><span class="p">(</span><span class="n">classes</span><span class="p">,</span> <span class="n">argmax_output</span><span class="p">)</span>
            <span class="p">(</span><span class="n">reshaped_result2</span><span class="p">,</span> <span class="p">)</span> <span class="o">=</span> <span class="n">n30_reshape_5</span><span class="p">(</span><span class="n">array_feature_extractor_result</span><span class="p">,</span> <span class="n">shape_tensor3</span><span class="p">)</span>
            <span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="p">)</span> <span class="o">=</span> <span class="n">n31_cast</span><span class="p">(</span><span class="n">reshaped_result2</span><span class="p">)</span>
            <span class="p">(</span><span class="n">output_label</span><span class="p">,</span> <span class="p">)</span> <span class="o">=</span> <span class="n">n32_cast</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;output_label&#39;</span><span class="p">:</span> <span class="n">output_label</span><span class="p">,</span>
                <span class="s1">&#39;output_probability&#39;</span><span class="p">:</span> <span class="n">output_probability</span><span class="p">,</span>
            <span class="p">}</span>
</pre></div>
</div>
</div>
<p class="exref-source"><span class="target" id="indexindexexref-ex0-9"></span>(<a class="reference internal" href="mlprodict/onnxrt/onnx_inference.html#indexexref-ex0">original entry</a> : onnx_inference.py:docstring of mlprodict.onnxrt.onnx_inference.OnnxInference._build_compile_run, line 7)</p>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="i_cmd.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Command lines</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="i_index.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">FAQ, code, …</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
    <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2022, Xavier Dupré.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.4.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>