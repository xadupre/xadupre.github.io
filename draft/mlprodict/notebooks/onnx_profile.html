
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Memory usage &#8212; Python Runtime for ONNX</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/style_notebook_snippet.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinxtrib-images/LightBox2/lightbox2/css/lightbox.css" />
    <link rel="stylesheet" type="text/css" href="../_static/my-styles.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script src="../_static/require.js"></script>
    <script src="../_static/embed-amd.js"></script>
    <script src="../_static/sphinxtrib-images/LightBox2/lightbox2/js/jquery-1.11.0.min.js"></script>
    <script src="../_static/sphinxtrib-images/LightBox2/lightbox2/js/lightbox.min.js"></script>
    <script src="../_static/sphinxtrib-images/LightBox2/lightbox2_customize/jquery-noconflict.js"></script>
    <link rel="shortcut icon" href="../_static/project_ico.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ONNX FFTs" href="onnx_ffts.html" />
    <link rel="prev" title="Loss function in ONNX" href="loss_functions.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/project_ico.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../installation.html">
  Installation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../tutorial/index.html">
  Tutorial
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../api/index.html">
  API
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../onnx.html">
  ONNX, Runtime, Backends
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../onnx_bench.html">
  scikit-learn Converters and Benchmarks
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../i_cmd.html">
  Command lines
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../i_ex.html">
  Examples
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../i_index.html">
  FAQ, code, â€¦
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../gyexamples/index.html">
  Gallery of examples
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../all_notebooks.html">
  Notebook Gallery
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../HISTORY.html">
  History
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="sklearn_grammar_lr.html">
   Converts a logistic regression into C
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="onnx_discrepencies.html">
   Discrepencies with ONNX
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="einsum_decomposition.html">
   Einsum decomposition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="topk_cpp.html">
   Fast TopK elements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="onnx_operator_cost.html">
   Infer operator computation cost
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="numpy_api_onnx_ccl.html">
   Introduction to a numpy API for ONNX: CustomClassifier
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="numpy_api_onnx_ftr.html">
   Introduction to a numpy API for ONNX: FunctionTransformer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lightgbm_double.html">
   Lightgbm, double, discrepencies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="loss_functions.html">
   Loss function in ONNX
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Memory usage
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="onnx_ffts.html">
   ONNX FFTs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="onnx_fft.html">
   ONNX and FFT
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="onnx_float32_and_64.html">
   ONNX graph, single or double floats
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="onnx_sbs.html">
   ONNX side by side
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="onnx_visualization.html">
   ONNX visualization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="onnx_pdist.html">
   Pairwise distances with ONNX (pdist)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="onnx_shaker.html">
   Precision loss due to float32 conversion with ONNX
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="onnx_profile_ort.html">
   Profiling with onnxruntime
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="onnx_node_time.html">
   Time processing for every ONNX nodes in a graph
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="transfer_learning.html">
   Transfer Learning with ONNX
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="onnx_float_double_skl_decision_trees.html">
   Tricky detail when converting a random forest from scikit-learn into ONNX
  </a>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#artificial-huge-data">
   Artificial huge data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#profiling-the-prediction-function">
   Profiling the prediction function
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sgdclasifier">
   SGDClasifier
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#memory-profiling">
   Memory profiling
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#memory-profiling-outside-the-notebook">
   Memory profiling outside the notebook
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="memory-usage">
<span id="onnxprofilerst"></span><h1>Memory usage<a class="headerlink" href="#memory-usage" title="Permalink to this headline">#</a></h1>
<p><strong>Links:</strong> <a class="reference download internal" download="" href="../_downloads/e003f0d735899dc3444bd40bd56d01b3/onnx_profile.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">notebook</span></code></a>, <a class="reference internal" href="onnx_profile2html.html">html</a>, <a class="reference download internal" download="" href="../_downloads/903c4c804672e93485f42b6e64b9770f/onnx_profile.pdf"><code class="xref download docutils literal notranslate"><span class="pre">PDF</span></code></a>, <a class="reference download internal" download="" href="../_downloads/fa981b4ed455a59d8fca14c441b61aa5/onnx_profile.py"><code class="xref download docutils literal notranslate"><span class="pre">python</span></code></a>, <a class="reference internal" href="onnx_profile.slides.html">slides</a>, <a class="reference external" href="https://github.com/sdpython/mlprodict/blob/master/_doc/notebooks/onnx_profile.ipynb">GitHub</a></p>
<p>The <a class="reference external" href="http://www.xavierdupre.fr/app/_benchmarks/helpsphinx/sklbench_results/index.html">first
benchmark</a>
based on <a class="reference external" href="https://github.com/jeremiedbb/scikit-learn_benchmarks">scikti-learnâ€™s
benchmark</a>
shows high peaks of memory usage for the python runtime on linear
models. Letâ€™s see how to measure that.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jyquickhelper</span> <span class="kn">import</span> <span class="n">add_notebook_menu</span>
<span class="n">add_notebook_menu</span><span class="p">()</span>
</pre></div>
</div>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#artificial-huge-data" id="id139">Artificial huge data</a></p></li>
<li><p><a class="reference internal" href="#profiling-the-prediction-function" id="id140">Profiling the prediction function</a></p></li>
<li><p><a class="reference internal" href="#sgdclasifier" id="id141">SGDClasifier</a></p></li>
<li><p><a class="reference internal" href="#memory-profiling" id="id142">Memory profiling</a></p></li>
<li><p><a class="reference internal" href="#memory-profiling-outside-the-notebook" id="id143">Memory profiling outside the notebook</a></p></li>
</ul>
</div>
<section id="artificial-huge-data">
<h2><a class="toc-backref" href="#id139">Artificial huge data</a><a class="headerlink" href="#artificial-huge-data" title="Permalink to this headline">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="n">N</span><span class="p">,</span> <span class="n">nfeat</span> <span class="o">=</span> <span class="mi">300000</span><span class="p">,</span> <span class="mi">200</span>
<span class="n">N</span> <span class="o">*</span> <span class="n">nfeat</span> <span class="o">*</span> <span class="mi">8</span> <span class="o">/</span> <span class="mf">1e9</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.48</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">nfeat</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
    <span class="n">y</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="mi">300000</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span> <span class="p">(</span><span class="mi">300000</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">train_size</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="n">clr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">clr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LinearRegression</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mlprodict.onnx_conv</span> <span class="kn">import</span> <span class="n">to_onnx</span>
<span class="kn">from</span> <span class="nn">mlprodict.onnxrt</span> <span class="kn">import</span> <span class="n">OnnxInference</span>
<span class="n">clr_onnx</span> <span class="o">=</span> <span class="n">to_onnx</span><span class="p">(</span><span class="n">clr</span><span class="p">,</span> <span class="n">X_train</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="n">oinfpy</span> <span class="o">=</span> <span class="n">OnnxInference</span><span class="p">(</span><span class="n">clr_onnx</span><span class="p">,</span> <span class="n">runtime</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Letâ€™s minimize the cost of verifications on scikit-learnâ€™s side.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">set_config</span>
<span class="n">set_config</span><span class="p">(</span><span class="n">assume_finite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="profiling-the-prediction-function">
<h2><a class="toc-backref" href="#id140">Profiling the prediction function</a><a class="headerlink" href="#profiling-the-prediction-function" title="Permalink to this headline">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyquickhelper.pycode.profiling</span> <span class="kn">import</span> <span class="n">profile</span>
<span class="nb">print</span><span class="p">(</span><span class="n">profile</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">clr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span>
              <span class="n">pyinst_format</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<pre class="literal-block">  _     ._   __/__   _ _  _  _ _/_   Recorded: 15:51:37  Samples:  4
 /_//_/// /_/ //_// / //_'/ //     Duration: 0.439     CPU time: 0.797
/   _/                      v3.0.1
Program: c:python372_x64libsite-packagesipykernel_launcher.py -f C:UsersxavieAppDataRoamingjupyterruntimekernel-4e37b7b5-7bfc-4784-9e5a-cae5acd320c1.json
0.439 profile  pyquickhelperpycodeprofiling.py:49
<a href="#id1"><span class="problematic" id="id2">|</span></a>- 0.427 &lt;lambda&gt;  &lt;ipython-input-12-1097e70fe6c7&gt;:2
|  <a href="#id3"><span class="problematic" id="id4">`</span></a>- 0.427 predict  sklearnlinear_model_base.py:222
|     <a href="#id5"><span class="problematic" id="id6">`</span></a>- 0.427 _decision_function  sklearnlinear_model_base.py:215
|        <a href="#id7"><span class="problematic" id="id8">|</span></a>- 0.371 inner_f  sklearnutilsvalidation.py:60
|        |  <a href="#id9"><span class="problematic" id="id10">`</span></a>- 0.370 safe_sparse_dot  sklearnutilsextmath.py:118
|        <a href="#id11"><span class="problematic" id="id12">`</span></a>- 0.056 [self]
<a href="#id13"><span class="problematic" id="id14">`</span></a>- 0.012 [self]</pre>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>

<span class="k">def</span> <span class="nf">nastype32</span><span class="p">(</span><span class="n">mat</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">mat</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">profile</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">oinfpy</span><span class="o">.</span><span class="n">run</span><span class="p">({</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="n">nastype32</span><span class="p">(</span><span class="n">X_test</span><span class="p">)}),</span>
              <span class="n">pyinst_format</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<pre class="literal-block">  _     ._   __/__   _ _  _  _ _/_   Recorded: 15:51:39  Samples:  5
 /_//_/// /_/ //_// / //_'/ //     Duration: 0.378     CPU time: 0.453
/   _/                      v3.0.1
Program: c:python372_x64libsite-packagesipykernel_launcher.py -f C:UsersxavieAppDataRoamingjupyterruntimekernel-4e37b7b5-7bfc-4784-9e5a-cae5acd320c1.json
0.378 profile  pyquickhelperpycodeprofiling.py:49
<a href="#id15"><span class="problematic" id="id16">|</span></a>- 0.370 &lt;lambda&gt;  &lt;ipython-input-13-da4aa05db7ed&gt;:6
|  <a href="#id17"><span class="problematic" id="id18">|</span></a>- 0.233 run  mlprodictonnxrtonnx_inference.py:471
|  |  <a href="#id19"><span class="problematic" id="id20">`</span></a>- 0.233 _run_sequence_runtime  mlprodictonnxrtonnx_inference.py:551
|  |     <a href="#id21"><span class="problematic" id="id22">`</span></a>- 0.233 run  mlprodictonnxrtonnx_inference_node.py:141
|  |        <a href="#id23"><span class="problematic" id="id24">`</span></a>- 0.233 run  mlprodictonnxrtops_cpu_op.py:374
|  |           <a href="#id25"><span class="problematic" id="id26">`</span></a>- 0.233 run  mlprodictonnxrtops_cpu_op.py:289
|  |              <a href="#id27"><span class="problematic" id="id28">`</span></a>- 0.233 _run  mlprodictonnxrtops_cpuop_linear_regressor.py:27
|  |                 <a href="#id29"><span class="problematic" id="id30">|</span></a>- 0.215 numpy_dot_inplace  mlprodictonnxrtops_cpu_op_numpy_helper.py:8
|  |                 |  <a href="#id31"><span class="problematic" id="id32">`</span></a>- 0.215 dot  &lt;__array_function__ internals&gt;:2
|  |                 <a href="#id33"><span class="problematic" id="id34">`</span></a>- 0.018 [self]
|  <a href="#id35"><span class="problematic" id="id36">|</span></a>- 0.112 nastype32  &lt;ipython-input-13-da4aa05db7ed&gt;:3
|  <a href="#id37"><span class="problematic" id="id38">`</span></a>- 0.026 [self]
<a href="#id39"><span class="problematic" id="id40">`</span></a>- 0.008 [self]</pre>
<p>Most of the time is taken out into casting into float. Letâ€™s take it
out.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X_test32</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">profile</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">oinfpy</span><span class="o">.</span><span class="n">run</span><span class="p">({</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="n">X_test32</span><span class="p">}),</span>
              <span class="n">pyinst_format</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<pre class="literal-block">  _     ._   __/__   _ _  _  _ _/_   Recorded: 15:51:43  Samples:  3
 /_//_/// /_/ //_// / //_'/ //     Duration: 0.081     CPU time: 0.141
/   _/                      v3.0.1
Program: c:python372_x64libsite-packagesipykernel_launcher.py -f C:UsersxavieAppDataRoamingjupyterruntimekernel-4e37b7b5-7bfc-4784-9e5a-cae5acd320c1.json
0.080 profile  pyquickhelperpycodeprofiling.py:49
<a href="#id41"><span class="problematic" id="id42">|</span></a>- 0.074 &lt;lambda&gt;  &lt;ipython-input-14-fe055596e921&gt;:3
|  <a href="#id43"><span class="problematic" id="id44">`</span></a>- 0.074 run  mlprodictonnxrtonnx_inference.py:471
|     <a href="#id45"><span class="problematic" id="id46">`</span></a>- 0.074 _run_sequence_runtime  mlprodictonnxrtonnx_inference.py:551
|        <a href="#id47"><span class="problematic" id="id48">`</span></a>- 0.074 run  mlprodictonnxrtonnx_inference_node.py:141
|           <a href="#id49"><span class="problematic" id="id50">`</span></a>- 0.074 run  mlprodictonnxrtops_cpu_op.py:374
|              <a href="#id51"><span class="problematic" id="id52">`</span></a>- 0.074 run  mlprodictonnxrtops_cpu_op.py:289
|                 <a href="#id53"><span class="problematic" id="id54">`</span></a>- 0.074 _run  mlprodictonnxrtops_cpuop_linear_regressor.py:27
|                    <a href="#id55"><span class="problematic" id="id56">|</span></a>- 0.059 numpy_dot_inplace  mlprodictonnxrtops_cpu_op_numpy_helper.py:8
|                    |  <a href="#id57"><span class="problematic" id="id58">`</span></a>- 0.059 dot  &lt;__array_function__ internals&gt;:2
|                    <a href="#id59"><span class="problematic" id="id60">`</span></a>- 0.015 [self]
<a href="#id61"><span class="problematic" id="id62">`</span></a>- 0.007 [self]</pre>
<p>Much better.</p>
</section>
<section id="sgdclasifier">
<h2><a class="toc-backref" href="#id141">SGDClasifier</a><a class="headerlink" href="#sgdclasifier" title="Permalink to this headline">#</a></h2>
<p>This models is implemented with many ONNX nodes. Letâ€™s how it behaves.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">SGDClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
<span class="n">Xir</span><span class="p">,</span> <span class="n">yir</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">target</span>
<span class="n">Xir_train</span><span class="p">,</span> <span class="n">Xir_test</span><span class="p">,</span> <span class="n">yir_train</span><span class="p">,</span> <span class="n">yir_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">Xir</span><span class="p">,</span> <span class="n">yir</span><span class="p">)</span>
<span class="n">sgcl</span> <span class="o">=</span> <span class="n">SGDClassifier</span><span class="p">()</span>
<span class="n">sgcl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xir_train</span><span class="p">,</span> <span class="n">yir_train</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SGDClassifier</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sgd_onnx</span> <span class="o">=</span> <span class="n">to_onnx</span><span class="p">(</span><span class="n">sgcl</span><span class="p">,</span> <span class="n">Xir_train</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
</pre></div>
</div>
<pre class="literal-block">C:xavierdupre__home_github_forkscikit-learnsklearnutilsdeprecation.py:101: FutureWarning: Attribute <a href="#id144"><span class="problematic" id="id145">average_coef_</span></a> was deprecated in version 0.23 and will be removed in 0.25.
  warnings.warn(msg, category=FutureWarning)
C:xavierdupre__home_github_forkscikit-learnsklearnutilsdeprecation.py:101: FutureWarning: Attribute <a href="#id146"><span class="problematic" id="id147">average_intercept_</span></a> was deprecated in version 0.23 and will be removed in 0.25.
  warnings.warn(msg, category=FutureWarning)
C:xavierdupre__home_github_forkscikit-learnsklearnutilsdeprecation.py:101: FutureWarning: Attribute <a href="#id148"><span class="problematic" id="id149">standard_coef_</span></a> was deprecated in version 0.23 and will be removed in 0.25.
  warnings.warn(msg, category=FutureWarning)
C:xavierdupre__home_github_forkscikit-learnsklearnutilsdeprecation.py:101: FutureWarning: Attribute <a href="#id150"><span class="problematic" id="id151">standard_intercept_</span></a> was deprecated in version 0.23 and will be removed in 0.25.
  warnings.warn(msg, category=FutureWarning)</pre>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">load_ext</span> <span class="n">mlprodict</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">onnxview</span> <span class="n">sgd_onnx</span>
</pre></div>
</div>
<div id="Mc0b17e900dc843cfb2912f09cde39e4e-cont"><div id="Mc0b17e900dc843cfb2912f09cde39e4e" style="width:100%;height:100%;"></div></div>
<script>

require(['http://www.xavierdupre.fr/js/vizjs/viz.js'], function() { var svgGraph = Viz("digraph{\n  nodesep=0.05;\n  ranksep=0.25;\n  orientation=portrait;\n\n  X [shape=box color=red label=\"X\nfloat((0, 4))\" fontsize=10];\n\n  output_label [shape=box color=green label=\"output_label\nint64((0,))\" fontsize=10];\n  output_probability [shape=box color=green label=\"output_probability\n[{int64, {'kind': 'tensor', 'elem': 'float', 'shape': }}]\" fontsize=10];\n\n  classes [shape=box label=\"classes\nint32((3,))\n[0 1 2]\" fontsize=10];\n  coef [shape=box label=\"coef\nfloat32((4, 3))\n[[  11.777903     8.9414015 -107.97203  ]\n [  26.3...\" fontsize=10];\n  intercept [shape=box label=\"intercept\nfloat32((3,))\n[   9.930467  118.22354  -171.99855 ]\" fontsize=10];\n  shape_tensor [shape=box label=\"shape_tensor\nint64((1,))\n[-1]\" fontsize=10];\n\n  matmul_result [shape=box label=\"matmul_result\" fontsize=10];\n  MatMul [shape=box style=\"filled,rounded\" color=orange label=\"MatMul\n(MatMul)\" fontsize=10];\n  X -> MatMul;\n  coef -> MatMul;\n  MatMul -> matmul_result;\n\n  score [shape=box label=\"score\" fontsize=10];\n  Add [shape=box style=\"filled,rounded\" color=orange label=\"Add\n(Add)\" fontsize=10];\n  matmul_result -> Add;\n  intercept -> Add;\n  Add -> score;\n\n  predicted_label [shape=box label=\"predicted_label\" fontsize=10];\n  ArgMax [shape=box style=\"filled,rounded\" color=orange label=\"ArgMax\n(ArgMax)\naxis=1\" fontsize=10];\n  score -> ArgMax;\n  ArgMax -> predicted_label;\n\n  final_label [shape=box label=\"final_label\" fontsize=10];\n  ArrayFeatureExtractor [shape=box style=\"filled,rounded\" color=orange label=\"ArrayFeatureExtractor\n(ArrayFeatureExtractor)\" fontsize=10];\n  classes -> ArrayFeatureExtractor;\n  predicted_label -> ArrayFeatureExtractor;\n  ArrayFeatureExtractor -> final_label;\n\n  reshaped_final_label [shape=box label=\"reshaped_final_label\" fontsize=10];\n  Reshape [shape=box style=\"filled,rounded\" color=orange label=\"Reshape\n(Reshape)\" fontsize=10];\n  final_label -> Reshape;\n  shape_tensor -> Reshape;\n  Reshape -> reshaped_final_label;\n\n  label [shape=box label=\"label\" fontsize=10];\n  Cast [shape=box style=\"filled,rounded\" color=orange label=\"Cast\n(Cast)\nto=7\" fontsize=10];\n  reshaped_final_label -> Cast;\n  Cast -> label;\n\n  Cast1 [shape=box style=\"filled,rounded\" color=orange label=\"Cast\n(Cast1)\nto=7\" fontsize=10];\n  label -> Cast1;\n  Cast1 -> output_label;\n\n  ZipMap [shape=box style=\"filled,rounded\" color=orange label=\"ZipMap\n(ZipMap)\nclasslabels_int64s=[0 1 2]\" fontsize=10];\n  score -> ZipMap;\n  ZipMap -> output_probability;\n}");
document.getElementById('Mc0b17e900dc843cfb2912f09cde39e4e').innerHTML = svgGraph; });

</script><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sgd_oinf</span> <span class="o">=</span> <span class="n">OnnxInference</span><span class="p">(</span><span class="n">sgd_onnx</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">call_n_times_x1</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">sgd_oinf</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">sgd_oinf</span><span class="o">.</span><span class="n">run</span><span class="p">({</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="n">X_test</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">res</span>

<span class="n">call_n_times_x1</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="n">Xir_test</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="n">sgd_oinf</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;output_label&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int64</span><span class="p">),</span>
 <span class="s1">&#39;output_probability&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="mi">0</span><span class="p">:</span> <span class="o">-</span><span class="mf">65.8407</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="o">-</span><span class="mf">158.60867</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="o">-</span><span class="mf">100.55802</span><span class="p">}]}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sgcl</span><span class="o">.</span><span class="n">decision_function</span><span class="p">(</span><span class="n">Xir_test</span><span class="p">[:</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span> <span class="o">-</span><span class="mf">65.840706</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">158.60864916</span><span class="p">,</span> <span class="o">-</span><span class="mf">100.55799704</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xir_32</span> <span class="o">=</span> <span class="n">Xir_test</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">profile</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">call_n_times_x1</span><span class="p">(</span><span class="mi">20000</span><span class="p">,</span> <span class="n">xir_32</span><span class="p">,</span> <span class="n">sgd_oinf</span><span class="p">),</span>
              <span class="n">pyinst_format</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<pre class="literal-block">  _     ._   __/__   _ _  _  _ _/_   Recorded: 15:52:03  Samples:  1022
 /_//_/// /_/ //_// / //_'/ //     Duration: 1.432     CPU time: 1.453
/   _/                      v3.0.1
Program: c:python372_x64libsite-packagesipykernel_launcher.py -f C:UsersxavieAppDataRoamingjupyterruntimekernel-4e37b7b5-7bfc-4784-9e5a-cae5acd320c1.json
1.432 profile  pyquickhelperpycodeprofiling.py:49
<a href="#id63"><span class="problematic" id="id64">`</span></a>- 1.432 &lt;lambda&gt;  &lt;ipython-input-22-ec5a6181dc40&gt;:3
   <a href="#id65"><span class="problematic" id="id66">`</span></a>- 1.432 call_n_times_x1  &lt;ipython-input-20-32f502ef162e&gt;:1
      <a href="#id67"><span class="problematic" id="id68">|</span></a>- 1.412 run  mlprodictonnxrtonnx_inference.py:471
      |  <a href="#id69"><span class="problematic" id="id70">|</span></a>- 1.381 _run_sequence_runtime  mlprodictonnxrtonnx_inference.py:551
      |  |  <a href="#id71"><span class="problematic" id="id72">|</span></a>- 1.218 run  mlprodictonnxrtonnx_inference_node.py:141
      |  |  |  <a href="#id73"><span class="problematic" id="id74">|</span></a>- 0.398 [self]
      |  |  |  <a href="#id75"><span class="problematic" id="id76">|</span></a>- 0.311 run  mlprodictonnxrtops_cpu_op.py:132
      |  |  |  |  <a href="#id77"><span class="problematic" id="id78">|</span></a>- 0.193 _run  mlprodictonnxrtops_cpuop_array_feature_extractor.py:59
      |  |  |  |  |  <a href="#id79"><span class="problematic" id="id80">|</span></a>- 0.170 _array_feature_extrator  mlprodictonnxrtops_cpuop_array_feature_extractor.py:17
      |  |  |  |  |  <a href="#id81"><span class="problematic" id="id82">`</span></a>- 0.023 [self]
      |  |  |  |  <a href="#id83"><span class="problematic" id="id84">|</span></a>- 0.047 _run  mlprodictonnxrtops_cpuop_cast.py:37
      |  |  |  |  |  <a href="#id85"><span class="problematic" id="id86">`</span></a>- 0.033 _run_inplace  mlprodictonnxrtops_cpuop_cast.py:42
      |  |  |  |  |     <a href="#id87"><span class="problematic" id="id88">`</span></a>- 0.020 &lt;lambda&gt;  mlprodictonnxrtops_cpuop_cast.py:35
      |  |  |  |  <a href="#id89"><span class="problematic" id="id90">|</span></a>- 0.028 [self]
      |  |  |  |  <a href="#id91"><span class="problematic" id="id92">|</span></a>- 0.022 _run  mlprodictonnxrtops_cpuop_zipmap.py:221
      |  |  |  |  <a href="#id93"><span class="problematic" id="id94">`</span></a>- 0.021 _run  mlprodictonnxrtops_cpuop_reshape.py:16
      |  |  |  <a href="#id95"><span class="problematic" id="id96">|</span></a>- 0.299 run  mlprodictonnxrtops_cpu_op.py:337
      |  |  |  |  <a href="#id97"><span class="problematic" id="id98">`</span></a>- 0.287 run  mlprodictonnxrtops_cpu_op.py:289
      |  |  |  |     <a href="#id99"><span class="problematic" id="id100">`</span></a>- 0.281 _run  mlprodictonnxrtops_cpuop_argmax.py:69
      |  |  |  |        <a href="#id101"><span class="problematic" id="id102">`</span></a>- 0.277 _run  mlprodictonnxrtops_cpuop_argmax.py:42
      |  |  |  |           <a href="#id103"><span class="problematic" id="id104">`</span></a>- 0.271 _argmax  mlprodictonnxrtops_cpuop_argmax.py:12
      |  |  |  |              <a href="#id105"><span class="problematic" id="id106">|</span></a>- 0.159 expand_dims  &lt;__array_function__ internals&gt;:2
      |  |  |  |              |  <a href="#id107"><span class="problematic" id="id108">`</span></a>- 0.155 expand_dims  numpylibshape_base.py:512
      |  |  |  |              |        [10 frames hidden]  numpy
      |  |  |  |              <a href="#id109"><span class="problematic" id="id110">|</span></a>- 0.059 argmax  &lt;__array_function__ internals&gt;:2
      |  |  |  |              |  <a href="#id111"><span class="problematic" id="id112">|</span></a>- 0.041 argmax  numpycorefromnumeric.py:1112
      |  |  |  |              |  |     [4 frames hidden]  numpy
      |  |  |  |              |  <a href="#id113"><span class="problematic" id="id114">`</span></a>- 0.018 [self]
      |  |  |  |              <a href="#id115"><span class="problematic" id="id116">`</span></a>- 0.052 [self]
      |  |  |  <a href="#id117"><span class="problematic" id="id118">|</span></a>- 0.171 run  mlprodictonnxrtops_cpu_op.py:517
      |  |  |  |  <a href="#id119"><span class="problematic" id="id120">|</span></a>- 0.155 run  mlprodictonnxrtops_cpu_op.py:453
      |  |  |  |  |  <a href="#id121"><span class="problematic" id="id122">|</span></a>- 0.075 _run  mlprodictonnxrtops_cpu_op.py:550
      |  |  |  |  |  <a href="#id123"><span class="problematic" id="id124">`</span></a>- 0.067 _run  mlprodictonnxrtops_cpuop_matmul.py:16
      |  |  |  |  |     <a href="#id125"><span class="problematic" id="id126">`</span></a>- 0.066 numpy_dot_inplace  mlprodictonnxrtops_cpu_op_numpy_helper.py:8
      |  |  |  |  |        <a href="#id127"><span class="problematic" id="id128">`</span></a>- 0.055 dot  &lt;__array_function__ internals&gt;:2
      |  |  |  |  <a href="#id129"><span class="problematic" id="id130">`</span></a>- 0.016 [self]
      |  |  |  <a href="#id131"><span class="problematic" id="id132">`</span></a>- 0.038 &lt;genexpr&gt;  mlprodictonnxrtonnx_inference_node.py:153
      |  |  <a href="#id133"><span class="problematic" id="id134">`</span></a>- 0.158 [self]
      |  <a href="#id135"><span class="problematic" id="id136">`</span></a>- 0.031 [self]
      <a href="#id137"><span class="problematic" id="id138">`</span></a>- 0.020 [self]</pre>
<p>The code in <code class="docutils literal notranslate"><span class="pre">mlprodict/onnxrt/onnx_inference_node.py</span></code> just calls an
operator and updates the list containing all the results. The time in
here is significant if the number of node is huge if the python runtime
is used.</p>
</section>
<section id="memory-profiling">
<h2><a class="toc-backref" href="#id142">Memory profiling</a><a class="headerlink" href="#memory-profiling" title="Permalink to this headline">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">memory_profiler</span> <span class="kn">import</span> <span class="n">memory_usage</span>
<span class="n">memprof_skl</span> <span class="o">=</span> <span class="n">memory_usage</span><span class="p">((</span><span class="n">clr</span><span class="o">.</span><span class="n">predict</span><span class="p">,</span> <span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="p">)),</span> <span class="n">timestamps</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">memprof_skl</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="mf">811.3515625</span><span class="p">,</span> <span class="mf">1594129928.0175571</span><span class="p">),</span>
 <span class="p">(</span><span class="mf">811.671875</span><span class="p">,</span> <span class="mf">1594129932.2684996</span><span class="p">),</span>
 <span class="p">(</span><span class="mf">822.36328125</span><span class="p">,</span> <span class="mf">1594129932.28645</span><span class="p">),</span>
 <span class="p">(</span><span class="mf">832.11328125</span><span class="p">,</span> <span class="mf">1594129932.30241</span><span class="p">),</span>
 <span class="p">(</span><span class="mf">847.05078125</span><span class="p">,</span> <span class="mf">1594129932.3183646</span><span class="p">),</span>
 <span class="p">(</span><span class="mf">860.5625</span><span class="p">,</span> <span class="mf">1594129932.333325</span><span class="p">),</span>
 <span class="p">(</span><span class="mf">874.48828125</span><span class="p">,</span> <span class="mf">1594129932.3482847</span><span class="p">),</span>
 <span class="p">(</span><span class="mf">883.73828125</span><span class="p">,</span> <span class="mf">1594129932.3642418</span><span class="p">),</span>
 <span class="p">(</span><span class="mf">898.80078125</span><span class="p">,</span> <span class="mf">1594129932.380199</span><span class="p">),</span>
 <span class="p">(</span><span class="mf">907.98828125</span><span class="p">,</span> <span class="mf">1594129932.3961573</span><span class="p">),</span>
 <span class="p">(</span><span class="mf">935.03515625</span><span class="p">,</span> <span class="mf">1594129932.4121134</span><span class="p">),</span>
 <span class="p">(</span><span class="mf">965.03515625</span><span class="p">,</span> <span class="mf">1594129932.4280717</span><span class="p">),</span>
 <span class="p">(</span><span class="mf">998.59765625</span><span class="p">,</span> <span class="mf">1594129932.4440289</span><span class="p">),</span>
 <span class="p">(</span><span class="mf">949.73828125</span><span class="p">,</span> <span class="mf">1594129932.4599853</span><span class="p">),</span>
 <span class="p">(</span><span class="mf">914.75390625</span><span class="p">,</span> <span class="mf">1594129932.464972</span><span class="p">)]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">to_datetime</span>

<span class="k">def</span> <span class="nf">mem_profile_plot</span><span class="p">(</span><span class="n">mem</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">mem</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;memory&quot;</span><span class="p">,</span> <span class="s2">&quot;timestamp&quot;</span><span class="p">])</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span> <span class="o">-=</span> <span class="n">df</span><span class="o">.</span><span class="n">timestamp</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
    <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;timestamp&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">memory usage&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ax</span>

<span class="n">mem_profile_plot</span><span class="p">(</span><span class="n">memprof_skl</span><span class="p">,</span> <span class="s2">&quot;clr.predict&quot;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="../_images/onnx_profile_30_0.png" src="../_images/onnx_profile_30_0.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">memprof_onx</span> <span class="o">=</span> <span class="n">memory_usage</span><span class="p">((</span><span class="n">oinfpy</span><span class="o">.</span><span class="n">run</span><span class="p">,</span> <span class="p">({</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="n">X_test32</span><span class="p">},</span> <span class="p">)),</span> <span class="n">timestamps</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">mem_profile_plot</span><span class="p">(</span><span class="n">memprof_onx</span><span class="p">,</span> <span class="s2">&quot;oinfpy.run&quot;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="../_images/onnx_profile_31_0.png" src="../_images/onnx_profile_31_0.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">memprof_onx2</span> <span class="o">=</span> <span class="n">memory_usage</span><span class="p">((</span><span class="n">oinfpy</span><span class="o">.</span><span class="n">run</span><span class="p">,</span> <span class="p">({</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="n">X_test</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)},</span> <span class="p">)),</span>
                           <span class="n">timestamps</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">mem_profile_plot</span><span class="p">(</span><span class="n">memprof_onx2</span><span class="p">,</span> <span class="s2">&quot;oinfpy.run + astype(numpy.float32)&quot;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="../_images/onnx_profile_32_0.png" src="../_images/onnx_profile_32_0.png" />
<p>This is not very informative.</p>
</section>
<section id="memory-profiling-outside-the-notebook">
<h2><a class="toc-backref" href="#id143">Memory profiling outside the notebook</a><a class="headerlink" href="#memory-profiling-outside-the-notebook" title="Permalink to this headline">#</a></h2>
<p>More precise.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">writefile</span> <span class="n">mprof_clr_predict</span><span class="o">.</span><span class="n">py</span>

<span class="kn">import</span> <span class="nn">numpy</span>
<span class="n">N</span><span class="p">,</span> <span class="n">nfeat</span> <span class="o">=</span> <span class="mi">300000</span><span class="p">,</span> <span class="mi">200</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">nfeat</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
    <span class="n">y</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">train_size</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="n">clr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">clr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">set_config</span>
<span class="n">set_config</span><span class="p">(</span><span class="n">assume_finite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">memory_profiler</span> <span class="kn">import</span> <span class="n">profile</span>
<span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">clr_predict</span><span class="p">():</span>
    <span class="n">clr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">clr_predict</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Overwriting</span> <span class="n">mprof_clr_predict</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!python -m memory_profiler mprof_clr_predict.py --timestamp
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Filename</span><span class="p">:</span> <span class="n">mprof_clr_predict</span><span class="o">.</span><span class="n">py</span>
<span class="n">Line</span> <span class="c1">#    Mem usage    Increment   Line Contents</span>
<span class="o">================================================</span>
    <span class="mi">20</span>   <span class="mf">1234.7</span> <span class="n">MiB</span>   <span class="mf">1234.7</span> <span class="n">MiB</span>   <span class="nd">@profile</span>
    <span class="mi">21</span>                             <span class="k">def</span> <span class="nf">clr_predict</span><span class="p">():</span>
</pre></div>
</div>
<p>The notebook seems to increase the memory usage.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">writefile</span> <span class="n">mprof_onnx_run</span><span class="o">.</span><span class="n">py</span>

<span class="kn">import</span> <span class="nn">numpy</span>
<span class="n">N</span><span class="p">,</span> <span class="n">nfeat</span> <span class="o">=</span> <span class="mi">300000</span><span class="p">,</span> <span class="mi">200</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">nfeat</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
    <span class="n">y</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">train_size</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="n">clr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">clr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">mlprodict.onnx_conv</span> <span class="kn">import</span> <span class="n">to_onnx</span>
<span class="kn">from</span> <span class="nn">mlprodict.onnxrt</span> <span class="kn">import</span> <span class="n">OnnxInference</span>
<span class="n">clr_onnx</span> <span class="o">=</span> <span class="n">to_onnx</span><span class="p">(</span><span class="n">clr</span><span class="p">,</span> <span class="n">X_train</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="n">oinfpy</span> <span class="o">=</span> <span class="n">OnnxInference</span><span class="p">(</span><span class="n">clr_onnx</span><span class="p">,</span> <span class="n">runtime</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>
<span class="n">X_test32</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">set_config</span>
<span class="n">set_config</span><span class="p">(</span><span class="n">assume_finite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">memory_profiler</span> <span class="kn">import</span> <span class="n">profile</span>
<span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">oinfpy_predict</span><span class="p">():</span>
    <span class="n">oinfpy</span><span class="o">.</span><span class="n">run</span><span class="p">({</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="n">X_test32</span><span class="p">})</span>

<span class="n">oinfpy_predict</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Overwriting</span> <span class="n">mprof_onnx_run</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!python -m memory_profiler mprof_onnx_run.py --timestamp
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Filename</span><span class="p">:</span> <span class="n">mprof_onnx_run</span><span class="o">.</span><span class="n">py</span>
<span class="n">Line</span> <span class="c1">#    Mem usage    Increment   Line Contents</span>
<span class="o">================================================</span>
    <span class="mi">26</span>   <span class="mf">1498.8</span> <span class="n">MiB</span>   <span class="mf">1498.8</span> <span class="n">MiB</span>   <span class="nd">@profile</span>
    <span class="mi">27</span>                             <span class="k">def</span> <span class="nf">oinfpy_predict</span><span class="p">():</span>
    <span class="mi">28</span>   <span class="mf">1500.1</span> <span class="n">MiB</span>      <span class="mf">1.3</span> <span class="n">MiB</span>       <span class="n">oinfpy</span><span class="o">.</span><span class="n">run</span><span class="p">({</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="n">X_test32</span><span class="p">})</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">writefile</span> <span class="n">mprof_onnx_run32</span><span class="o">.</span><span class="n">py</span>

<span class="kn">import</span> <span class="nn">numpy</span>
<span class="n">N</span><span class="p">,</span> <span class="n">nfeat</span> <span class="o">=</span> <span class="mi">300000</span><span class="p">,</span> <span class="mi">200</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">nfeat</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
    <span class="n">y</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">train_size</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="n">clr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">clr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">mlprodict.onnx_conv</span> <span class="kn">import</span> <span class="n">to_onnx</span>
<span class="kn">from</span> <span class="nn">mlprodict.onnxrt</span> <span class="kn">import</span> <span class="n">OnnxInference</span>
<span class="n">clr_onnx</span> <span class="o">=</span> <span class="n">to_onnx</span><span class="p">(</span><span class="n">clr</span><span class="p">,</span> <span class="n">X_train</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="n">oinfpy</span> <span class="o">=</span> <span class="n">OnnxInference</span><span class="p">(</span><span class="n">clr_onnx</span><span class="p">,</span> <span class="n">runtime</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">set_config</span>
<span class="n">set_config</span><span class="p">(</span><span class="n">assume_finite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">memory_profiler</span> <span class="kn">import</span> <span class="n">profile</span>
<span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">oinfpy_predict32</span><span class="p">():</span>
    <span class="n">oinfpy</span><span class="o">.</span><span class="n">run</span><span class="p">({</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="n">X_test</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)})</span>

<span class="n">oinfpy_predict32</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Overwriting</span> <span class="n">mprof_onnx_run32</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!python -m memory_profiler mprof_onnx_run32.py --timestamp
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Filename</span><span class="p">:</span> <span class="n">mprof_onnx_run32</span><span class="o">.</span><span class="n">py</span>
<span class="n">Line</span> <span class="c1">#    Mem usage    Increment   Line Contents</span>
<span class="o">================================================</span>
    <span class="mi">25</span>   <span class="mf">1293.1</span> <span class="n">MiB</span>   <span class="mf">1293.1</span> <span class="n">MiB</span>   <span class="nd">@profile</span>
    <span class="mi">26</span>                             <span class="k">def</span> <span class="nf">oinfpy_predict32</span><span class="p">():</span>
    <span class="mi">27</span>   <span class="mf">1294.4</span> <span class="n">MiB</span>      <span class="mf">1.3</span> <span class="n">MiB</span>       <span class="n">oinfpy</span><span class="o">.</span><span class="n">run</span><span class="p">({</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="n">X_test</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)})</span>
</pre></div>
</div>
</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="loss_functions.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Loss function in ONNX</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="onnx_ffts.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">ONNX FFTs</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2022, Xavier DuprÃ©.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>