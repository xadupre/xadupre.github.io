
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Scan &#8212; Python Runtime for ONNX</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/style_notebook_snippet.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinxtrib-images/LightBox2/lightbox2/css/lightbox.css" />
    <link rel="stylesheet" type="text/css" href="../_static/my-styles.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script src="../_static/require.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script src="../_static/sphinxtrib-images/LightBox2/lightbox2/js/jquery-1.11.0.min.js"></script>
    <script src="../_static/sphinxtrib-images/LightBox2/lightbox2/js/lightbox.min.js"></script>
    <script src="../_static/sphinxtrib-images/LightBox2/lightbox2_customize/jquery-noconflict.js"></script>
    <link rel="shortcut icon" href="../_static/project_ico.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Scatter" href="onnx__Scatter.html" />
    <link rel="prev" title="Round" href="onnx__Round.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/project_ico.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../installation.html">
  Installation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../tutorial/index.html">
  Tutorial
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../api/index.html">
  API
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../onnx.html">
  ONNX, Runtime, Backends
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../onnx_bench.html">
  scikit-learn Converters and Benchmarks
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../i_cmd.html">
  Command lines
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../i_ex.html">
  Examples
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../i_index.html">
  FAQ, code, …
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../gyexamples/index.html">
  Gallery of examples
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../all_notebooks.html">
  Notebook Gallery
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../HISTORY.html">
  History
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="index.html">
   ONNX operators
  </a>
  <input checked class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Abs.html">
     Abs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Acos.html">
     Acos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Acosh.html">
     Acosh
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Add.html">
     Add
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__And.html">
     And
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__ArgMax.html">
     ArgMax
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__ArgMin.html">
     ArgMin
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Asin.html">
     Asin
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Asinh.html">
     Asinh
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Atan.html">
     Atan
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Atanh.html">
     Atanh
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__AveragePool.html">
     AveragePool
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__BatchNormalization.html">
     BatchNormalization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Bernoulli.html">
     Bernoulli
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__BitShift.html">
     BitShift
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Cast.html">
     Cast
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__CastLike.html">
     CastLike
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Ceil.html">
     Ceil
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Celu.html">
     Celu
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Clip.html">
     Clip
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Compress.html">
     Compress
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Concat.html">
     Concat
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__ConcatFromSequence.html">
     ConcatFromSequence
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Constant.html">
     Constant
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__ConstantOfShape.html">
     ConstantOfShape
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Conv.html">
     Conv
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__ConvInteger.html">
     ConvInteger
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__ConvTranspose.html">
     ConvTranspose
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Cos.html">
     Cos
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Cosh.html">
     Cosh
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__CumSum.html">
     CumSum
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__DepthToSpace.html">
     DepthToSpace
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__DequantizeLinear.html">
     DequantizeLinear
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Det.html">
     Det
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Div.html">
     Div
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Dropout.html">
     Dropout
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__DynamicQuantizeLinear.html">
     DynamicQuantizeLinear
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Einsum.html">
     Einsum
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Elu.html">
     Elu
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Equal.html">
     Equal
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Erf.html">
     Erf
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Exp.html">
     Exp
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Expand.html">
     Expand
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__EyeLike.html">
     EyeLike
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Flatten.html">
     Flatten
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Floor.html">
     Floor
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__GRU.html">
     GRU
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Gather.html">
     Gather
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__GatherElements.html">
     GatherElements
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__GatherND.html">
     GatherND
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Gemm.html">
     Gemm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__GlobalAveragePool.html">
     GlobalAveragePool
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__GlobalLpPool.html">
     GlobalLpPool
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__GlobalMaxPool.html">
     GlobalMaxPool
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Greater.html">
     Greater
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__GreaterOrEqual.html">
     GreaterOrEqual
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__GridSample.html">
     GridSample
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__HardSigmoid.html">
     HardSigmoid
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__HardSwish.html">
     HardSwish
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Hardmax.html">
     Hardmax
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Identity.html">
     Identity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__If.html">
     If
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__InstanceNormalization.html">
     InstanceNormalization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__IsInf.html">
     IsInf
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__IsNaN.html">
     IsNaN
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__LRN.html">
     LRN
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__LSTM.html">
     LSTM
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__LeakyRelu.html">
     LeakyRelu
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Less.html">
     Less
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__LessOrEqual.html">
     LessOrEqual
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Log.html">
     Log
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__LogSoftmax.html">
     LogSoftmax
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Loop.html">
     Loop
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__LpNormalization.html">
     LpNormalization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__LpPool.html">
     LpPool
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__MatMul.html">
     MatMul
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__MatMulInteger.html">
     MatMulInteger
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Max.html">
     Max
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__MaxPool.html">
     MaxPool
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__MaxRoiPool.html">
     MaxRoiPool
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__MaxUnpool.html">
     MaxUnpool
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Mean.html">
     Mean
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__MeanVarianceNormalization.html">
     MeanVarianceNormalization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Min.html">
     Min
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Mod.html">
     Mod
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Mul.html">
     Mul
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Multinomial.html">
     Multinomial
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Neg.html">
     Neg
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__NegativeLogLikelihoodLoss.html">
     NegativeLogLikelihoodLoss
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__NonMaxSuppression.html">
     NonMaxSuppression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__NonZero.html">
     NonZero
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Not.html">
     Not
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__OneHot.html">
     OneHot
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Optional.html">
     Optional
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__OptionalGetElement.html">
     OptionalGetElement
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__OptionalHasElement.html">
     OptionalHasElement
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Or.html">
     Or
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__PRelu.html">
     PRelu
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Pad.html">
     Pad
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Pow.html">
     Pow
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__QLinearConv.html">
     QLinearConv
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__QLinearMatMul.html">
     QLinearMatMul
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__QuantizeLinear.html">
     QuantizeLinear
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__RNN.html">
     RNN
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__RandomNormal.html">
     RandomNormal
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__RandomNormalLike.html">
     RandomNormalLike
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__RandomUniform.html">
     RandomUniform
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__RandomUniformLike.html">
     RandomUniformLike
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Range.html">
     Range
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Reciprocal.html">
     Reciprocal
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__ReduceL1.html">
     ReduceL1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__ReduceL2.html">
     ReduceL2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__ReduceLogSum.html">
     ReduceLogSum
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__ReduceLogSumExp.html">
     ReduceLogSumExp
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__ReduceMax.html">
     ReduceMax
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__ReduceMean.html">
     ReduceMean
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__ReduceMin.html">
     ReduceMin
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__ReduceProd.html">
     ReduceProd
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__ReduceSum.html">
     ReduceSum
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__ReduceSumSquare.html">
     ReduceSumSquare
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Relu.html">
     Relu
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Reshape.html">
     Reshape
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Resize.html">
     Resize
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__ReverseSequence.html">
     ReverseSequence
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__RoiAlign.html">
     RoiAlign
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Round.html">
     Round
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Scan
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Scatter.html">
     Scatter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__ScatterElements.html">
     ScatterElements
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__ScatterND.html">
     ScatterND
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Selu.html">
     Selu
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__SequenceAt.html">
     SequenceAt
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__SequenceConstruct.html">
     SequenceConstruct
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__SequenceEmpty.html">
     SequenceEmpty
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__SequenceErase.html">
     SequenceErase
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__SequenceInsert.html">
     SequenceInsert
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__SequenceLength.html">
     SequenceLength
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Shape.html">
     Shape
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Shrink.html">
     Shrink
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Sigmoid.html">
     Sigmoid
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Sign.html">
     Sign
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Sin.html">
     Sin
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Sinh.html">
     Sinh
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Size.html">
     Size
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Slice.html">
     Slice
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Softmax.html">
     Softmax
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__SoftmaxCrossEntropyLoss.html">
     SoftmaxCrossEntropyLoss
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Softplus.html">
     Softplus
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Softsign.html">
     Softsign
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__SpaceToDepth.html">
     SpaceToDepth
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Split.html">
     Split
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__SplitToSequence.html">
     SplitToSequence
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Sqrt.html">
     Sqrt
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Squeeze.html">
     Squeeze
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__StringNormalizer.html">
     StringNormalizer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Sub.html">
     Sub
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Sum.html">
     Sum
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Tan.html">
     Tan
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Tanh.html">
     Tanh
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__TfIdfVectorizer.html">
     TfIdfVectorizer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__ThresholdedRelu.html">
     ThresholdedRelu
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Tile.html">
     Tile
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__TopK.html">
     TopK
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Transpose.html">
     Transpose
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Trilu.html">
     Trilu
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Unique.html">
     Unique
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Unsqueeze.html">
     Unsqueeze
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Upsample.html">
     Upsample
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Where.html">
     Where
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx__Xor.html">
     Xor
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx_aionnxml_ArrayFeatureExtractor.html">
     ai.onnx.ml - ArrayFeatureExtractor
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx_aionnxml_Binarizer.html">
     ai.onnx.ml - Binarizer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx_aionnxml_CastMap.html">
     ai.onnx.ml - CastMap
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx_aionnxml_CategoryMapper.html">
     ai.onnx.ml - CategoryMapper
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx_aionnxml_DictVectorizer.html">
     ai.onnx.ml - DictVectorizer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx_aionnxml_FeatureVectorizer.html">
     ai.onnx.ml - FeatureVectorizer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx_aionnxml_Imputer.html">
     ai.onnx.ml - Imputer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx_aionnxml_LabelEncoder.html">
     ai.onnx.ml - LabelEncoder
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx_aionnxml_LinearClassifier.html">
     ai.onnx.ml - LinearClassifier
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx_aionnxml_LinearRegressor.html">
     ai.onnx.ml - LinearRegressor
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx_aionnxml_Normalizer.html">
     ai.onnx.ml - Normalizer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx_aionnxml_OneHotEncoder.html">
     ai.onnx.ml - OneHotEncoder
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx_aionnxml_SVMClassifier.html">
     ai.onnx.ml - SVMClassifier
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx_aionnxml_SVMRegressor.html">
     ai.onnx.ml - SVMRegressor
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx_aionnxml_Scaler.html">
     ai.onnx.ml - Scaler
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx_aionnxml_TreeEnsembleClassifier.html">
     ai.onnx.ml - TreeEnsembleClassifier
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx_aionnxml_TreeEnsembleRegressor.html">
     ai.onnx.ml - TreeEnsembleRegressor
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx_aionnxml_ZipMap.html">
     ai.onnx.ml - ZipMap
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx_aionnxpreviewtraining_Adagrad.html">
     ai.onnx.preview.training - Adagrad
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx_aionnxpreviewtraining_Adam.html">
     ai.onnx.preview.training - Adam
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx_aionnxpreviewtraining_Gradient.html">
     ai.onnx.preview.training - Gradient
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="onnx_aionnxpreviewtraining_Momentum.html">
     ai.onnx.preview.training - Momentum
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../onnx_runtime.html">
   Runtimes for ONNX
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../backends/index.html">
   ONNX Backends
  </a>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scan-16">
   Scan - 16
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scan-11">
   Scan - 11
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scan-9">
   Scan - 9
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scan-8">
   Scan - 8
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="scan">
<span id="l-onnx-doc-scan"></span><h1>Scan<a class="headerlink" href="#scan" title="Permalink to this headline">#</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#scan-16" id="id4">Scan - 16</a></p></li>
<li><p><a class="reference internal" href="#scan-11" id="id5">Scan - 11</a></p></li>
<li><p><a class="reference internal" href="#scan-9" id="id6">Scan - 9</a></p></li>
<li><p><a class="reference internal" href="#scan-8" id="id7">Scan - 8</a></p></li>
</ul>
</div>
<section id="scan-16">
<span id="l-onnx-op-scan-16"></span><h2><a class="toc-backref" href="#id4">Scan - 16</a><a class="headerlink" href="#scan-16" title="Permalink to this headline">#</a></h2>
<p><strong>Version</strong></p>
<ul class="simple">
<li><p><strong>name</strong>: <a class="reference external" href="https://github.com/onnx/onnx/blob/main/docs/Operators.md#Scan">Scan (GitHub)</a></p></li>
<li><p><strong>domain</strong>: <strong>main</strong></p></li>
<li><p><strong>since_version</strong>: <strong>16</strong></p></li>
<li><p><strong>function</strong>: False</p></li>
<li><p><strong>support_level</strong>: SupportType.COMMON</p></li>
<li><p><strong>shape inference</strong>: True</p></li>
</ul>
<p>This version of the operator has been available
<strong>since version 16</strong>.</p>
<p><strong>Summary</strong></p>
<p>Scan can be used to iterate over one or more scan_input tensors,
constructing zero or more scan_output tensors. It combines ideas from general recurrences,
functional programming constructs such as scan, fold, map, and zip and is intended to enable
generalizations of RNN-like constructs for sequence-to-sequence processing.
Other tensors (referred to as state_variables here) can be used to carry a state
when iterating from one element to another (similar to hidden-state in RNNs, also referred
to as loop-carried dependences in the context of loops).
Many common usages involve a single scan_input tensor (where functionality
similar to scan, fold and map can be obtained). When more than one scan_input is used,
a behavior similar to zip is obtained.</p>
<p>The attribute body must be a graph, specifying the computation to be performed in
every iteration. It takes as input the current values of the state_variables and
the current iterated element of the scan_inputs. It must return the (updated) values
of the state_variables and zero or more scan_output_element tensors. The values of the
scan_output_element tensors are concatenated over all the iterations to produce the
scan_output values of the scan construct (similar to the concatenated intermediate
hidden-state values of RNN-like constructs). All the output tensors (state_variables as
well as scan_output_element tensors) are required to have the same shape in each iteration
of the loop (a restriction imposed to enable efficient memory allocation).</p>
<p>Note that the iterated element passed to the body subgraph does not have a sequence
axis. It will have a rank one less than the rank of the corresponding scan_input.</p>
<p>The scan operation returns the final values of the state_variables as well as the
scan_outputs.</p>
<p>The optional attribute scan_input_directions specifies the direction (forward or backward)
for each scan input. If this attribute is omitted, all sequences are scanned in the forward
direction. A bidirectional scan may be performed by specifying the same tensor input twice
in the scan_inputs, once with a forward direction, and once with a backward direction.</p>
<p>The scan_output of the operation is produced by concatenating the scan_output_element
values produced by the body in each iteration.  The optional attribute scan_output_directions
specifies the direction in which scan_output is constructed (by appending or prepending the
scan_output_element to scan_output in each iteration) for each scan_output. If this attribute
is omitted, the scan_output_element is appended to the scan_output in each iteration.</p>
<p>The optional attribute scan_input_axes specifies the axis to be scanned for each scan_input.
If omitted, every scan_input will be scanned in axis 0. For example, if axis 0 is the
batch axis and axis 1 is the time axis (to be scanned), specify an axis value of 1.
Note that scanning a non-zero axis may be less efficient than scanning axis zero.</p>
<p>The optional attribute scan_output_axes specifies the axis along which the scan_outputs
are accumulated for each scan_output. For example, if axis 1 is the time axis (to be
scanned) for both inputs and outputs, specify a scan_input axis and scan_output axis
value of 1.</p>
<p>Note that because of the ONNX restriction that only the last parameter of an operator can
be variadic, the initial-states and scan-inputs are listed together as one input parameter.
Similarly, the final-states and scan-outputs are listed together as one output parameter.
The attribute num_scan_inputs indicates the number M of scan-inputs.</p>
<p>The behavior of</p>
<blockquote>
<div><dl class="simple">
<dt>Scan &lt;</dt><dd><p>num_scan_inputs = m,
body = loop-body,
scan_input_axes = [axis_1, …, axis_m]</p>
</dd>
</dl>
<p>&gt; (init_1, …, init_n, scan_1, …, scan_m)</p>
</div></blockquote>
<p>is equivalent to the following pseudo-code:</p>
<blockquote>
<div><p>// scan_i.shape[axis_i] denotes the (max) sequence-length of scan_i
// scan_i.shape[axis_i] is required to be equal to scan_j.shape[axis_j] for all i,j.
sequence_length = scan_1.shape[axis_1];</p>
<p>// initialize state-variables
st_1 = init_1; … st_n = init_n;
// initialize scan-output variables: [] denotes an empty tensor
scan_out_1 = []; …; scan_out_k = [];
// identify number of iterations:</p>
<p>// execute loop
for (int t = 0; t &lt; sequence_length; ++t) {</p>
<blockquote>
<div><p>// generate the scan-input elements: the notation T&lt;axis=k&gt;[t] indicates the sub-tensor
// of rank one less than T obtained by indexing T at position t along axis k.
si_1 = scan_1&lt;axis=axis_1&gt;[t];
… ;
si_m = scan_m&lt;axis=axis_m&gt;[t];
// execute loop-body
st_1, …, st_n, so_1, …, so_k = loop-body(st_1, …, st_n, si_1, …, si_m)
// accumulate the scan-output elements
scan_out_1 = Concat&lt;axis=0&gt;(scan_out_1, so_1); … ; scan_out_k = Concat&lt;axis=0&gt;(scan_out_k, so_k);</p>
</div></blockquote>
<p>}</p>
<p>return st_1, …, st_n, scan_out_1, …, scan_out_k;</p>
</div></blockquote>
<p><em>Sample usage: Encoding RNN using a Scan</em></p>
<p>The following example shows how a simple RNN over an input tensor %X, with weight tensor %Wi,
recurrence weight tensor %Ri, bias tensors %Wbi and %Rbi, and initial hidden-state %H_0 can
be encoded as a ScanLoop. Note that the loop-body is a nested graph, and it directly computes
%Wi, %Ri, %Wbi, and %Rbi (typically constants or initializers in the body graph). If these
values are computed in the outer graph, they need to be passed in as extra state_variables.</p>
<blockquote>
<div><dl class="simple">
<dt>graph rnn-encoding {</dt><dd><p>%H_0 = …
%X = …
%Y_h, %Y = Scan[body = &lt;graph rnn-cell-1&gt;, num_scan_inputs=1](%H_0, %X)
return %Y, %Y_h</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>graph rnn-cell-1 (</dt><dd><p>%H_tminus1[FLOAT, tensor]
%X_t[FLOAT, tensor]</p>
</dd>
<dt>) {</dt><dd><p>%Wi = …
%Ri = …
%Wbi = …
%Rbi = …
%t1 = X_t * (Wi^T)
%t2 = H_tminus1*(Ri^T)
%t3 = Add(%t1, %t2)
%t4 = Add(%t3, %Wbi)
%t5 = Add(%t4, %Rbi)
%Ht = Tanh(%t5)
%Accumulate = Identity(%Ht)
return %Ht, %Accumulate</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p><strong>Attributes</strong></p>
<ul class="simple">
<li><p><strong>body</strong> (required):
The graph run each iteration. It has N+M inputs: (loop state
variables…, scan_input_elts…). It has N+K outputs: (loop state
variables…, scan_output_elts…). Each scan_output is created by
concatenating the value of the specified scan_output_elt value at
the end of each iteration of the loop. It is an error if the
dimensions of these values change across loop iterations.</p></li>
<li><p><strong>num_scan_inputs</strong> (required):
An attribute specifying the number of scan_inputs M.</p></li>
<li><p><strong>scan_input_axes</strong>:
An optional list of M flags. The i-th element of the list specifies
the axis to be scanned (the sequence axis) for the i-th scan_input.
If omitted, 0 will be used as the scan axis for every scan_input.
Negative value for an axis means counting dimensions from the back.
Accepted range is [-r, r-1] where r = rank(input).</p></li>
<li><p><strong>scan_input_directions</strong>:
An optional list of M flags. The i-th element of the list specifies
the direction to be scanned for the i-th scan_input tensor: 0
indicates forward direction and 1 indicates reverse direction. If
omitted, all scan_input tensors will be scanned in the forward
direction.</p></li>
<li><p><strong>scan_output_axes</strong>:
An optional list of K flags. The i-th element of the list specifies
the axis for the i-th scan_output. The scan outputs are accumulated
along the specified axis. If omitted, 0 will be used as the scan
axis for every scan_output. Negative value for an axis means
counting dimensions from the back. Accepted range is [-r, r-1].</p></li>
<li><p><strong>scan_output_directions</strong>:
An optional list of K flags, one for each scan_output. The i-th
element of the list specifies whether the i-th scan_output should be
constructed by appending or prepending a new value in each
iteration: 0 indicates appending and 1 indicates prepending. If
omitted, all scan_output tensors will be produced by appending a
value in each iteration.</p></li>
</ul>
<p><strong>Inputs</strong></p>
<p>Between 1 and 2147483647 inputs.</p>
<ul class="simple">
<li><p><strong>initial_state_and_scan_inputs</strong> (variadic) - <strong>V</strong>:
Initial values of the loop’s N state variables followed by M
scan_inputs</p></li>
</ul>
<p><strong>Outputs</strong></p>
<p>Between 1 and 2147483647 outputs.</p>
<ul class="simple">
<li><p><strong>final_state_and_scan_outputs</strong> (variadic) - <strong>V</strong>:
Final values of the loop’s N state variables followed by K
scan_outputs</p></li>
</ul>
<p><strong>Type Constraints</strong></p>
<ul class="simple">
<li><p><strong>I</strong> in (
tensor(int64)
):
Int64 tensor</p></li>
<li><p><strong>V</strong> in (
tensor(bfloat16),
tensor(bool),
tensor(complex128),
tensor(complex64),
tensor(double),
tensor(float),
tensor(float16),
tensor(int16),
tensor(int32),
tensor(int64),
tensor(int8),
tensor(string),
tensor(uint16),
tensor(uint32),
tensor(uint64),
tensor(uint8)
):
All Tensor types</p></li>
</ul>
<p><strong>Examples</strong></p>
<p><strong>scan_8</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Given an input sequence [x1, ..., xN], sum up its elements using a scan</span>
<span class="c1"># returning the final state (x1+x2+...+xN) as well the scan_output</span>
<span class="c1"># [x1, x1+x2, ..., x1+x2+...+xN]</span>
<span class="c1">#</span>
<span class="c1"># create graph to represent scan body</span>
<span class="n">sum_in</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_tensor_value_info</span><span class="p">(</span><span class="s1">&#39;sum_in&#39;</span><span class="p">,</span> <span class="n">onnx</span><span class="o">.</span><span class="n">TensorProto</span><span class="o">.</span><span class="n">FLOAT</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="nb">next</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_tensor_value_info</span><span class="p">(</span><span class="s1">&#39;next&#39;</span><span class="p">,</span> <span class="n">onnx</span><span class="o">.</span><span class="n">TensorProto</span><span class="o">.</span><span class="n">FLOAT</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">sum_out</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_tensor_value_info</span><span class="p">(</span><span class="s1">&#39;sum_out&#39;</span><span class="p">,</span> <span class="n">onnx</span><span class="o">.</span><span class="n">TensorProto</span><span class="o">.</span><span class="n">FLOAT</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">scan_out</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_tensor_value_info</span><span class="p">(</span><span class="s1">&#39;scan_out&#39;</span><span class="p">,</span> <span class="n">onnx</span><span class="o">.</span><span class="n">TensorProto</span><span class="o">.</span><span class="n">FLOAT</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">add_node</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_node</span><span class="p">(</span>
    <span class="s1">&#39;Add&#39;</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sum_in&#39;</span><span class="p">,</span> <span class="s1">&#39;next&#39;</span><span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sum_out&#39;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">id_node</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_node</span><span class="p">(</span>
    <span class="s1">&#39;Identity&#39;</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sum_out&#39;</span><span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;scan_out&#39;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">scan_body</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_graph</span><span class="p">(</span>
    <span class="p">[</span><span class="n">add_node</span><span class="p">,</span> <span class="n">id_node</span><span class="p">],</span>
    <span class="s1">&#39;scan_body&#39;</span><span class="p">,</span>
    <span class="p">[</span><span class="n">sum_in</span><span class="p">,</span> <span class="nb">next</span><span class="p">],</span>
    <span class="p">[</span><span class="n">sum_out</span><span class="p">,</span> <span class="n">scan_out</span><span class="p">]</span>
<span class="p">)</span>
<span class="c1"># create scan op node</span>
<span class="n">no_sequence_lens</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>   <span class="c1"># optional input, not supplied</span>
<span class="n">node</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_node</span><span class="p">(</span>
    <span class="s1">&#39;Scan&#39;</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">no_sequence_lens</span><span class="p">,</span> <span class="s1">&#39;initial&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">],</span>
    <span class="n">num_scan_inputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">body</span><span class="o">=</span><span class="n">scan_body</span>
<span class="p">)</span>
<span class="c1"># create inputs for batch-size 1, sequence-length 3, inner dimension 2</span>
<span class="n">initial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="c1"># final state computed = [1 + 3 + 5, 2 + 4 + 6]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="c1"># scan-output computed</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

<span class="n">expect</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">initial</span><span class="p">,</span> <span class="n">x</span><span class="p">],</span> <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">],</span>
       <span class="n">name</span><span class="o">=</span><span class="s1">&#39;test_scan_sum&#39;</span><span class="p">,</span> <span class="n">opset_imports</span><span class="o">=</span><span class="p">[</span><span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_opsetid</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="mi">8</span><span class="p">)])</span>
</pre></div>
</div>
<p><strong>scan_9</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Given an input sequence [x1, ..., xN], sum up its elements using a scan</span>
<span class="c1"># returning the final state (x1+x2+...+xN) as well the scan_output</span>
<span class="c1"># [x1, x1+x2, ..., x1+x2+...+xN]</span>
<span class="c1">#</span>
<span class="c1"># create graph to represent scan body</span>
<span class="n">sum_in</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_tensor_value_info</span><span class="p">(</span><span class="s1">&#39;sum_in&#39;</span><span class="p">,</span> <span class="n">onnx</span><span class="o">.</span><span class="n">TensorProto</span><span class="o">.</span><span class="n">FLOAT</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="nb">next</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_tensor_value_info</span><span class="p">(</span><span class="s1">&#39;next&#39;</span><span class="p">,</span> <span class="n">onnx</span><span class="o">.</span><span class="n">TensorProto</span><span class="o">.</span><span class="n">FLOAT</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">sum_out</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_tensor_value_info</span><span class="p">(</span><span class="s1">&#39;sum_out&#39;</span><span class="p">,</span> <span class="n">onnx</span><span class="o">.</span><span class="n">TensorProto</span><span class="o">.</span><span class="n">FLOAT</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">scan_out</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_tensor_value_info</span><span class="p">(</span><span class="s1">&#39;scan_out&#39;</span><span class="p">,</span> <span class="n">onnx</span><span class="o">.</span><span class="n">TensorProto</span><span class="o">.</span><span class="n">FLOAT</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">add_node</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_node</span><span class="p">(</span>
    <span class="s1">&#39;Add&#39;</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sum_in&#39;</span><span class="p">,</span> <span class="s1">&#39;next&#39;</span><span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sum_out&#39;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">id_node</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_node</span><span class="p">(</span>
    <span class="s1">&#39;Identity&#39;</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sum_out&#39;</span><span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;scan_out&#39;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">scan_body</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_graph</span><span class="p">(</span>
    <span class="p">[</span><span class="n">add_node</span><span class="p">,</span> <span class="n">id_node</span><span class="p">],</span>
    <span class="s1">&#39;scan_body&#39;</span><span class="p">,</span>
    <span class="p">[</span><span class="n">sum_in</span><span class="p">,</span> <span class="nb">next</span><span class="p">],</span>
    <span class="p">[</span><span class="n">sum_out</span><span class="p">,</span> <span class="n">scan_out</span><span class="p">]</span>
<span class="p">)</span>
<span class="c1"># create scan op node</span>
<span class="n">node</span> <span class="o">=</span> <span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_node</span><span class="p">(</span>
    <span class="s1">&#39;Scan&#39;</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;initial&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">],</span>
    <span class="n">num_scan_inputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">body</span><span class="o">=</span><span class="n">scan_body</span>
<span class="p">)</span>
<span class="c1"># create inputs for sequence-length 3, inner dimension 2</span>
<span class="n">initial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="c1"># final state computed = [1 + 3 + 5, 2 + 4 + 6]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,))</span>
<span class="c1"># scan-output computed</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

<span class="n">expect</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">initial</span><span class="p">,</span> <span class="n">x</span><span class="p">],</span> <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">],</span>
       <span class="n">name</span><span class="o">=</span><span class="s1">&#39;test_scan9_sum&#39;</span><span class="p">,</span> <span class="n">opset_imports</span><span class="o">=</span><span class="p">[</span><span class="n">onnx</span><span class="o">.</span><span class="n">helper</span><span class="o">.</span><span class="n">make_opsetid</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="mi">9</span><span class="p">)])</span>
</pre></div>
</div>
<p><strong>Differences</strong></p>
<table style="white-space: pre; 1px solid black; font-family:courier; text-align:left !important;">
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">0</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">0</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Scan can be used to iterate over one or more scan_input tensors,</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Scan can be used to iterate over one or more scan_input tensors,</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">1</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">1</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">constructing zero or more scan_output tensors. It combines ideas from general recurrences,</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">constructing zero or more scan_output tensors. It combines ideas from general recurrences,</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">2</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">2</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">functional programming constructs such as scan, fold, map, and zip and is intended to enable</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">functional programming constructs such as scan, fold, map, and zip and is intended to enable</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">3</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">3</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">generalizations of RNN-like constructs for sequence-to-sequence processing.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">generalizations of RNN-like constructs for sequence-to-sequence processing.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">4</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">4</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Other tensors (referred to as state_variables here) can be used to carry a state</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Other tensors (referred to as state_variables here) can be used to carry a state</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">5</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">5</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">when iterating from one element to another (similar to hidden-state in RNNs, also referred</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">when iterating from one element to another (similar to hidden-state in RNNs, also referred</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">6</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">6</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">to as loop-carried dependences in the context of loops).</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">to as loop-carried dependences in the context of loops).</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">7</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">7</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Many common usages involve a single scan_input tensor (where functionality</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Many common usages involve a single scan_input tensor (where functionality</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">8</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">8</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">similar to scan, fold and map can be obtained). When more than one scan_input is used,</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">similar to scan, fold and map can be obtained). When more than one scan_input is used,</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">9</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">9</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">a behavior similar to zip is obtained.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">a behavior similar to zip is obtained.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">10</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">10</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">11</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">11</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The attribute body must be a graph, specifying the computation to be performed in</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The attribute body must be a graph, specifying the computation to be performed in</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">12</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">12</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">every iteration. It takes as input the current values of the state_variables and</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">every iteration. It takes as input the current values of the state_variables and</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">13</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">13</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">the current iterated element of the scan_inputs. It must return the (updated) values</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">the current iterated element of the scan_inputs. It must return the (updated) values</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">14</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">14</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">of the state_variables and zero or more scan_output_element tensors. The values of the</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">of the state_variables and zero or more scan_output_element tensors. The values of the</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">15</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">15</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">scan_output_element tensors are concatenated over all the iterations to produce the</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">scan_output_element tensors are concatenated over all the iterations to produce the</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">16</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">16</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">scan_output values of the scan construct (similar to the concatenated intermediate</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">scan_output values of the scan construct (similar to the concatenated intermediate</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">17</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">17</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">hidden-state values of RNN-like constructs). All the output tensors (state_variables as</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">hidden-state values of RNN-like constructs). All the output tensors (state_variables as</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">18</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">18</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">well as scan_output_element tensors) are required to have the same shape in each iteration</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">well as scan_output_element tensors) are required to have the same shape in each iteration</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">19</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">19</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">of the loop (a restriction imposed to enable efficient memory allocation).</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">of the loop (a restriction imposed to enable efficient memory allocation).</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">20</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">20</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">21</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">21</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Note that the iterated element passed to the body subgraph does not have a sequence</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Note that the iterated element passed to the body subgraph does not have a sequence</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">22</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">22</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">axis. It will have a rank one less than the rank of the corresponding scan_input.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">axis. It will have a rank one less than the rank of the corresponding scan_input.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">23</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">23</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">24</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">24</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The scan operation returns the final values of the state_variables as well as the</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The scan operation returns the final values of the state_variables as well as the</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">25</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">25</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">scan_outputs.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">scan_outputs.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">26</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">26</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">27</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">27</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The optional attribute scan_input_directions specifies the direction (forward or backward)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The optional attribute scan_input_directions specifies the direction (forward or backward)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">28</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">28</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">for each scan input. If this attribute is omitted, all sequences are scanned in the forward</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">for each scan input. If this attribute is omitted, all sequences are scanned in the forward</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">29</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">29</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">direction. A bidirectional scan may be performed by specifying the same tensor input twice</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">direction. A bidirectional scan may be performed by specifying the same tensor input twice</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">30</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">30</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">in the scan_inputs, once with a forward direction, and once with a backward direction.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">in the scan_inputs, once with a forward direction, and once with a backward direction.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">31</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">31</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">32</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">32</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The scan_output of the operation is produced by concatenating the scan_output_element</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The scan_output of the operation is produced by concatenating the scan_output_element</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">33</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">33</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">values produced by the body in each iteration.  The optional attribute scan_output_directions</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">values produced by the body in each iteration.  The optional attribute scan_output_directions</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">34</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">34</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">specifies the direction in which scan_output is constructed (by appending or prepending the</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">specifies the direction in which scan_output is constructed (by appending or prepending the</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">35</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">35</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">scan_output_element to scan_output in each iteration) for each scan_output. If this attribute</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">scan_output_element to scan_output in each iteration) for each scan_output. If this attribute</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">36</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">36</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">is omitted, the scan_output_element is appended to the scan_output in each iteration.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">is omitted, the scan_output_element is appended to the scan_output in each iteration.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">37</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">37</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">38</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">38</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The optional attribute scan_input_axes specifies the axis to be scanned for each scan_input.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The optional attribute scan_input_axes specifies the axis to be scanned for each scan_input.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">39</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">39</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">If omitted, every scan_input will be scanned in axis 0. For example, if axis 0 is the</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">If omitted, every scan_input will be scanned in axis 0. For example, if axis 0 is the</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">40</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">40</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">batch axis and axis 1 is the time axis (to be scanned), specify an axis value of 1.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">batch axis and axis 1 is the time axis (to be scanned), specify an axis value of 1.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">41</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">41</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Note that scanning a non-zero axis may be less efficient than scanning axis zero.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Note that scanning a non-zero axis may be less efficient than scanning axis zero.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">42</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">42</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">43</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">43</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The optional attribute scan_output_axes specifies the axis along which the scan_outputs</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The optional attribute scan_output_axes specifies the axis along which the scan_outputs</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">44</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">44</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">are accumulated for each scan_output. For example, if axis 1 is the time axis (to be</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">are accumulated for each scan_output. For example, if axis 1 is the time axis (to be</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">45</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">45</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">scanned) for both inputs and outputs, specify a scan_input axis and scan_output axis</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">scanned) for both inputs and outputs, specify a scan_input axis and scan_output axis</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">46</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">46</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">value of 1.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">value of 1.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">47</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">47</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">48</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">48</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Note that because of the ONNX restriction that only the last parameter of an operator can</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Note that because of the ONNX restriction that only the last parameter of an operator can</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">49</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">49</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">be variadic, the initial-states and scan-inputs are listed together as one input parameter.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">be variadic, the initial-states and scan-inputs are listed together as one input parameter.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">50</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">50</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Similarly, the final-states and scan-outputs are listed together as one output parameter.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Similarly, the final-states and scan-outputs are listed together as one output parameter.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">51</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">51</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The attribute num_scan_inputs indicates the number M of scan-inputs.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The attribute num_scan_inputs indicates the number M of scan-inputs.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">52</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">52</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">53</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">53</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The behavior of</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The behavior of</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">54</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">54</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">55</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">55</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    Scan <</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    Scan <</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">56</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">56</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        num_scan_inputs = m,</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        num_scan_inputs = m,</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">57</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">57</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        body = loop-body,</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        body = loop-body,</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">58</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">58</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        scan_input_axes = [axis_1, ..., axis_m]</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        scan_input_axes = [axis_1, ..., axis_m]</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">59</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">59</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    > (init_1, ..., init_n, scan_1, ..., scan_m)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    > (init_1, ..., init_n, scan_1, ..., scan_m)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">60</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">60</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">61</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">61</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">is equivalent to the following pseudo-code:</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">is equivalent to the following pseudo-code:</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">62</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">62</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">63</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">63</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    // scan_i.shape[axis_i] denotes the (max) sequence-length of scan_i</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    // scan_i.shape[axis_i] denotes the (max) sequence-length of scan_i</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">64</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">64</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    // scan_i.shape[axis_i] is required to be equal to scan_j.shape[axis_j] for all i,j.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    // scan_i.shape[axis_i] is required to be equal to scan_j.shape[axis_j] for all i,j.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">65</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">65</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    sequence_length = scan_1.shape[axis_1];</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    sequence_length = scan_1.shape[axis_1];</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">66</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">66</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">67</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">67</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    // initialize state-variables</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    // initialize state-variables</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">68</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">68</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    st_1 = init_1; ... st_n = init_n;</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    st_1 = init_1; ... st_n = init_n;</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">69</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">69</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    // initialize scan-output variables: [] denotes an empty tensor</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    // initialize scan-output variables: [] denotes an empty tensor</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">70</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">70</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    scan_out_1 = []; ...; scan_out_k = [];</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    scan_out_1 = []; ...; scan_out_k = [];</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">71</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">71</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    // identify number of iterations:</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    // identify number of iterations:</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">72</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">72</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">73</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">73</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    // execute loop</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    // execute loop</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">74</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">74</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    for (int t = 0; t < sequence_length; ++t) {</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    for (int t = 0; t < sequence_length; ++t) {</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">75</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">75</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        // generate the scan-input elements: the notation T<axis=k>[t] indicates the sub-tensor</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        // generate the scan-input elements: the notation T<axis=k>[t] indicates the sub-tensor</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">76</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">76</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        // of rank one less than T obtained by indexing T at position t along axis k.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        // of rank one less than T obtained by indexing T at position t along axis k.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">77</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">77</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        si_1 = scan_1<axis=axis_1>[t];</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        si_1 = scan_1<axis=axis_1>[t];</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">78</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">78</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        ... ;</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        ... ;</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">79</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">79</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        si_m = scan_m<axis=axis_m>[t];</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        si_m = scan_m<axis=axis_m>[t];</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">80</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">80</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        // execute loop-body</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        // execute loop-body</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">81</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">81</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        st_1, ..., st_n, so_1, ..., so_k = loop-body(st_1, ..., st_n, si_1, ..., si_m)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        st_1, ..., st_n, so_1, ..., so_k = loop-body(st_1, ..., st_n, si_1, ..., si_m)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">82</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">82</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        // accumulate the scan-output elements</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        // accumulate the scan-output elements</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">83</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">83</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        scan_out_1 = Concat<axis=0>(scan_out_1, so_1); ... ; scan_out_k = Concat<axis=0>(scan_out_k, so_k);</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        scan_out_1 = Concat<axis=0>(scan_out_1, so_1); ... ; scan_out_k = Concat<axis=0>(scan_out_k, so_k);</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">84</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">84</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    }</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    }</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">85</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">85</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">86</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">86</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    return st_1, ..., st_n, scan_out_1, ..., scan_out_k;</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    return st_1, ..., st_n, scan_out_1, ..., scan_out_k;</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">87</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">87</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">88</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">88</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">*Sample usage: Encoding RNN using a Scan*</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">*Sample usage: Encoding RNN using a Scan*</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">89</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">89</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">90</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">90</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The following example shows how a simple RNN over an input tensor %X, with weight tensor %Wi,</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The following example shows how a simple RNN over an input tensor %X, with weight tensor %Wi,</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">91</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">91</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">recurrence weight tensor %Ri, bias tensors %Wbi and %Rbi, and initial hidden-state %H_0 can</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">recurrence weight tensor %Ri, bias tensors %Wbi and %Rbi, and initial hidden-state %H_0 can</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">92</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">92</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">be encoded as a ScanLoop. Note that the loop-body is a nested graph, and it directly computes</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">be encoded as a ScanLoop. Note that the loop-body is a nested graph, and it directly computes</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">93</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">93</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">%Wi, %Ri, %Wbi, and %Rbi (typically constants or initializers in the body graph). If these</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">%Wi, %Ri, %Wbi, and %Rbi (typically constants or initializers in the body graph). If these</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">94</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">94</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">values are computed in the outer graph, they need to be passed in as extra state_variables.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">values are computed in the outer graph, they need to be passed in as extra state_variables.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">95</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">95</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">96</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">96</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    graph rnn-encoding {</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    graph rnn-encoding {</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">97</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">97</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %H_0 = ...</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %H_0 = ...</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">98</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">98</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %X = ...</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %X = ...</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">99</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">99</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Y_h, %Y = Scan[body = <graph rnn-cell-1>, num_scan_inputs=1](%H_0, %X)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Y_h, %Y = Scan[body = <graph rnn-cell-1>, num_scan_inputs=1](%H_0, %X)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">100</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">100</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      return %Y, %Y_h</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      return %Y, %Y_h</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">101</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">101</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    }</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    }</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">102</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">102</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">103</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">103</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    graph rnn-cell-1 (</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    graph rnn-cell-1 (</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">104</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">104</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %H_tminus1[FLOAT, tensor]</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %H_tminus1[FLOAT, tensor]</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">105</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">105</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %X_t[FLOAT, tensor]</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %X_t[FLOAT, tensor]</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">106</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">106</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    ) {</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    ) {</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">107</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">107</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Wi = ...</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Wi = ...</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">108</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">108</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Ri = ...</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Ri = ...</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">109</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">109</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Wbi = ...</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Wbi = ...</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">110</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">110</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Rbi = ...</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Rbi = ...</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">111</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">111</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %t1 = X_t * (Wi^T)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %t1 = X_t * (Wi^T)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">112</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">112</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %t2 = H_tminus1*(Ri^T)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %t2 = H_tminus1*(Ri^T)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">113</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">113</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %t3 = Add(%t1, %t2)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %t3 = Add(%t1, %t2)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">114</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">114</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %t4 = Add(%t3, %Wbi)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %t4 = Add(%t3, %Wbi)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">115</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">115</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %t5 = Add(%t4, %Rbi)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %t5 = Add(%t4, %Rbi)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">116</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">116</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Ht = Tanh(%t5)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Ht = Tanh(%t5)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">117</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">117</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Accumulate = Identity(%Ht)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Accumulate = Identity(%Ht)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">118</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">118</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      return %Ht, %Accumulate</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      return %Ht, %Accumulate</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">119</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">119</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    }</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    }</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">120</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">120</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">121</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">121</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">**Attributes**</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">**Attributes**</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">122</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">122</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">123</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">123</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **body** (required):</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **body** (required):</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">124</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">124</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  The graph run each iteration. It has N+M inputs: (loop state</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  The graph run each iteration. It has N+M inputs: (loop state</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">125</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">125</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  variables..., scan_input_elts...). It has N+K outputs: (loop state</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  variables..., scan_input_elts...). It has N+K outputs: (loop state</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">126</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">126</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  variables..., scan_output_elts...). Each scan_output is created by</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  variables..., scan_output_elts...). Each scan_output is created by</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">127</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">127</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  concatenating the value of the specified scan_output_elt value at</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  concatenating the value of the specified scan_output_elt value at</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">128</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">128</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  the end of each iteration of the loop. It is an error if the</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  the end of each iteration of the loop. It is an error if the</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">129</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">129</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  dimensions of these values change across loop iterations.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  dimensions of these values change across loop iterations.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">130</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">130</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **num_scan_inputs** (required):</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **num_scan_inputs** (required):</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">131</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">131</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  An attribute specifying the number of scan_inputs M.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  An attribute specifying the number of scan_inputs M.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">132</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">132</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **scan_input_axes**:</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **scan_input_axes**:</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">133</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">133</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  An optional list of M flags. The i-th element of the list specifies</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  An optional list of M flags. The i-th element of the list specifies</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">134</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">134</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  the axis to be scanned (the sequence axis) for the i-th scan_input.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  the axis to be scanned (the sequence axis) for the i-th scan_input.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">135</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">135</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  If omitted, 0 will be used as the scan axis for every scan_input.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  If omitted, 0 will be used as the scan axis for every scan_input.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">136</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">136</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  Negative value for an axis means counting dimensions from the back.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  Negative value for an axis means counting dimensions from the back.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">137</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">137</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  Accepted range is [-r, r-1] where r = rank(input).</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  Accepted range is [-r, r-1] where r = rank(input).</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">138</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">138</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **scan_input_directions**:</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **scan_input_directions**:</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">139</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">139</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  An optional list of M flags. The i-th element of the list specifies</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  An optional list of M flags. The i-th element of the list specifies</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">140</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">140</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  the direction to be scanned for the i-th scan_input tensor: 0</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  the direction to be scanned for the i-th scan_input tensor: 0</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">141</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">141</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  indicates forward direction and 1 indicates reverse direction. If</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  indicates forward direction and 1 indicates reverse direction. If</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">142</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">142</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  omitted, all scan_input tensors will be scanned in the forward</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  omitted, all scan_input tensors will be scanned in the forward</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">143</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">143</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  direction.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  direction.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">144</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">144</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **scan_output_axes**:</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **scan_output_axes**:</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">145</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">145</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  An optional list of K flags. The i-th element of the list specifies</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  An optional list of K flags. The i-th element of the list specifies</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">146</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">146</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  the axis for the i-th scan_output. The scan outputs are accumulated</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  the axis for the i-th scan_output. The scan outputs are accumulated</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">147</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">147</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  along the specified axis. If omitted, 0 will be used as the scan</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  along the specified axis. If omitted, 0 will be used as the scan</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">148</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">148</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  axis for every scan_output. Negative value for an axis means</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  axis for every scan_output. Negative value for an axis means</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">149</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">149</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  counting dimensions from the back. Accepted range is [-r, r-1].</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  counting dimensions from the back. Accepted range is [-r, r-1].</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">150</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">150</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **scan_output_directions**:</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **scan_output_directions**:</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">151</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">151</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  An optional list of K flags, one for each scan_output. The i-th</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  An optional list of K flags, one for each scan_output. The i-th</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">152</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">152</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  element of the list specifies whether the i-th scan_output should be</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  element of the list specifies whether the i-th scan_output should be</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">153</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">153</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  constructed by appending or prepending a new value in each</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  constructed by appending or prepending a new value in each</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">154</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">154</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  iteration: 0 indicates appending and 1 indicates prepending. If</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  iteration: 0 indicates appending and 1 indicates prepending. If</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">155</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">155</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  omitted, all scan_output tensors will be produced by appending a</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  omitted, all scan_output tensors will be produced by appending a</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">156</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">156</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  value in each iteration.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  value in each iteration.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">157</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">157</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">158</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">158</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">**Inputs**</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">**Inputs**</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">159</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">159</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">160</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">160</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Between 1 and 2147483647 inputs.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Between 1 and 2147483647 inputs.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">161</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">161</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">162</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">162</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **initial_state_and_scan_inputs** (variadic) - **V**:</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **initial_state_and_scan_inputs** (variadic) - **V**:</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">163</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">163</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  Initial values of the loop's N state variables followed by M</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  Initial values of the loop's N state variables followed by M</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">164</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">164</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  scan_inputs</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  scan_inputs</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">165</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">165</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">166</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">166</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">**Outputs**</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">**Outputs**</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">167</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">167</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">168</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">168</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Between 1 and 2147483647 outputs.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Between 1 and 2147483647 outputs.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">169</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">169</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">170</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">170</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **final_state_and_scan_outputs** (variadic) - **V**:</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **final_state_and_scan_outputs** (variadic) - **V**:</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">171</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">171</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  Final values of the loop's N state variables followed by K</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  Final values of the loop's N state variables followed by K</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">172</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">172</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  scan_outputs</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  scan_outputs</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">173</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">173</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">174</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">174</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">**Type Constraints**</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">**Type Constraints**</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">175</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">175</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">176</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">176</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **I** in (</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **I** in (</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">177</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">177</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(int64)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(int64)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">178</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">178</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  ):</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  ):</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">179</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">179</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  Int64 tensor</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  Int64 tensor</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">180</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">180</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **V** in (</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **V** in (</code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">181</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">  tensor(bfloat16),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">181</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">182</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(bool),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(bool),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">182</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">183</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(complex128),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(complex128),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">183</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">184</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(complex64),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(complex64),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">184</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">185</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(double),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(double),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">185</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">186</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(float),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(float),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">186</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">187</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(float16),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(float16),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">187</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">188</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(int16),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(int16),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">188</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">189</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(int32),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(int32),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">189</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">190</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(int64),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(int64),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">190</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">191</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(int8),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(int8),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">191</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">192</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(string),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(string),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">192</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">193</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(uint16),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(uint16),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">193</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">194</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(uint32),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(uint32),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">194</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">195</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(uint64),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(uint64),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">195</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">196</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(uint8)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(uint8)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">196</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">197</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  ):</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  ):</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">197</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">198</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  All Tensor types</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  All Tensor types</code></td></tr>
</table></section>
<section id="scan-11">
<span id="l-onnx-op-scan-11"></span><h2><a class="toc-backref" href="#id5">Scan - 11</a><a class="headerlink" href="#scan-11" title="Permalink to this headline">#</a></h2>
<p><strong>Version</strong></p>
<ul class="simple">
<li><p><strong>name</strong>: <a class="reference external" href="https://github.com/onnx/onnx/blob/main/docs/Operators.md#Scan">Scan (GitHub)</a></p></li>
<li><p><strong>domain</strong>: <strong>main</strong></p></li>
<li><p><strong>since_version</strong>: <strong>11</strong></p></li>
<li><p><strong>function</strong>: False</p></li>
<li><p><strong>support_level</strong>: SupportType.COMMON</p></li>
<li><p><strong>shape inference</strong>: True</p></li>
</ul>
<p>This version of the operator has been available
<strong>since version 11</strong>.</p>
<p><strong>Summary</strong></p>
<p>Scan can be used to iterate over one or more scan_input tensors,
constructing zero or more scan_output tensors. It combines ideas from general recurrences,
functional programming constructs such as scan, fold, map, and zip and is intended to enable
generalizations of RNN-like constructs for sequence-to-sequence processing.
Other tensors (referred to as state_variables here) can be used to carry a state
when iterating from one element to another (similar to hidden-state in RNNs, also referred
to as loop-carried dependences in the context of loops).
Many common usages involve a single scan_input tensor (where functionality
similar to scan, fold and map can be obtained). When more than one scan_input is used,
a behavior similar to zip is obtained.</p>
<p>The attribute body must be a graph, specifying the computation to be performed in
every iteration. It takes as input the current values of the state_variables and
the current iterated element of the scan_inputs. It must return the (updated) values
of the state_variables and zero or more scan_output_element tensors. The values of the
scan_output_element tensors are concatenated over all the iterations to produce the
scan_output values of the scan construct (similar to the concatenated intermediate
hidden-state values of RNN-like constructs). All the output tensors (state_variables as
well as scan_output_element tensors) are required to have the same shape in each iteration
of the loop (a restriction imposed to enable efficient memory allocation).</p>
<p>Note that the iterated element passed to the body subgraph does not have a sequence
axis. It will have a rank one less than the rank of the corresponding scan_input.</p>
<p>The scan operation returns the final values of the state_variables as well as the
scan_outputs.</p>
<p>The optional attribute scan_input_directions specifies the direction (forward or backward)
for each scan input. If this attribute is omitted, all sequences are scanned in the forward
direction. A bidirectional scan may be performed by specifying the same tensor input twice
in the scan_inputs, once with a forward direction, and once with a backward direction.</p>
<p>The scan_output of the operation is produced by concatenating the scan_output_element
values produced by the body in each iteration.  The optional attribute scan_output_directions
specifies the direction in which scan_output is constructed (by appending or prepending the
scan_output_element to scan_output in each iteration) for each scan_output. If this attribute
is omitted, the scan_output_element is appended to the scan_output in each iteration.</p>
<p>The optional attribute scan_input_axes specifies the axis to be scanned for each scan_input.
If omitted, every scan_input will be scanned in axis 0. For example, if axis 0 is the
batch axis and axis 1 is the time axis (to be scanned), specify an axis value of 1.
Note that scanning a non-zero axis may be less efficient than scanning axis zero.</p>
<p>The optional attribute scan_output_axes specifies the axis along which the scan_outputs
are accumulated for each scan_output. For example, if axis 1 is the time axis (to be
scanned) for both inputs and outputs, specify a scan_input axis and scan_output axis
value of 1.</p>
<p>Note that because of the ONNX restriction that only the last parameter of an operator can
be variadic, the initial-states and scan-inputs are listed together as one input parameter.
Similarly, the final-states and scan-outputs are listed together as one output parameter.
The attribute num_scan_inputs indicates the number M of scan-inputs.</p>
<p>The behavior of</p>
<blockquote>
<div><dl class="simple">
<dt>Scan &lt;</dt><dd><p>num_scan_inputs = m,
body = loop-body,
scan_input_axes = [axis_1, …, axis_m]</p>
</dd>
</dl>
<p>&gt; (init_1, …, init_n, scan_1, …, scan_m)</p>
</div></blockquote>
<p>is equivalent to the following pseudo-code:</p>
<blockquote>
<div><p>// scan_i.shape[axis_i] denotes the (max) sequence-length of scan_i
// scan_i.shape[axis_i] is required to be equal to scan_j.shape[axis_j] for all i,j.
sequence_length = scan_1.shape[axis_1];</p>
<p>// initialize state-variables
st_1 = init_1; … st_n = init_n;
// initialize scan-output variables: [] denotes an empty tensor
scan_out_1 = []; …; scan_out_k = [];
// identify number of iterations:</p>
<p>// execute loop
for (int t = 0; t &lt; sequence_length; ++t) {</p>
<blockquote>
<div><p>// generate the scan-input elements: the notation T&lt;axis=k&gt;[t] indicates the sub-tensor
// of rank one less than T obtained by indexing T at position t along axis k.
si_1 = scan_1&lt;axis=axis_1&gt;[t];
… ;
si_m = scan_m&lt;axis=axis_m&gt;[t];
// execute loop-body
st_1, …, st_n, so_1, …, so_k = loop-body(st_1, …, st_n, si_1, …, si_m)
// accumulate the scan-output elements
scan_out_1 = Concat&lt;axis=0&gt;(scan_out_1, so_1); … ; scan_out_k = Concat&lt;axis=0&gt;(scan_out_k, so_k);</p>
</div></blockquote>
<p>}</p>
<p>return st_1, …, st_n, scan_out_1, …, scan_out_k;</p>
</div></blockquote>
<p><em>Sample usage: Encoding RNN using a Scan</em></p>
<p>The following example shows how a simple RNN over an input tensor %X, with weight tensor %Wi,
recurrence weight tensor %Ri, bias tensors %Wbi and %Rbi, and initial hidden-state %H_0 can
be encoded as a ScanLoop. Note that the loop-body is a nested graph, and it directly computes
%Wi, %Ri, %Wbi, and %Rbi (typically constants or initializers in the body graph). If these
values are computed in the outer graph, they need to be passed in as extra state_variables.</p>
<blockquote>
<div><dl class="simple">
<dt>graph rnn-encoding {</dt><dd><p>%H_0 = …
%X = …
%Y_h, %Y = Scan[body = &lt;graph rnn-cell-1&gt;, num_scan_inputs=1](%H_0, %X)
return %Y, %Y_h</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>graph rnn-cell-1 (</dt><dd><p>%H_tminus1[FLOAT, tensor]
%X_t[FLOAT, tensor]</p>
</dd>
<dt>) {</dt><dd><p>%Wi = …
%Ri = …
%Wbi = …
%Rbi = …
%t1 = X_t * (Wi^T)
%t2 = H_tminus1*(Ri^T)
%t3 = Add(%t1, %t2)
%t4 = Add(%t3, %Wbi)
%t5 = Add(%t4, %Rbi)
%Ht = Tanh(%t5)
%Accumulate = Identity(%Ht)
return %Ht, %Accumulate</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p><strong>Attributes</strong></p>
<ul class="simple">
<li><p><strong>body</strong> (required):
The graph run each iteration. It has N+M inputs: (loop state
variables…, scan_input_elts…). It has N+K outputs: (loop state
variables…, scan_output_elts…). Each scan_output is created by
concatenating the value of the specified scan_output_elt value at
the end of each iteration of the loop. It is an error if the
dimensions of these values change across loop iterations.</p></li>
<li><p><strong>num_scan_inputs</strong> (required):
An attribute specifying the number of scan_inputs M.</p></li>
<li><p><strong>scan_input_axes</strong>:
An optional list of M flags. The i-th element of the list specifies
the axis to be scanned (the sequence axis) for the i-th scan_input.
If omitted, 0 will be used as the scan axis for every scan_input.
Negative value for an axis means counting dimensions from the back.
Accepted range is [-r, r-1] where r = rank(input).</p></li>
<li><p><strong>scan_input_directions</strong>:
An optional list of M flags. The i-th element of the list specifies
the direction to be scanned for the i-th scan_input tensor: 0
indicates forward direction and 1 indicates reverse direction. If
omitted, all scan_input tensors will be scanned in the forward
direction.</p></li>
<li><p><strong>scan_output_axes</strong>:
An optional list of K flags. The i-th element of the list specifies
the axis for the i-th scan_output. The scan outputs are accumulated
along the specified axis. If omitted, 0 will be used as the scan
axis for every scan_output. Negative value for an axis means
counting dimensions from the back. Accepted range is [-r, r-1].</p></li>
<li><p><strong>scan_output_directions</strong>:
An optional list of K flags, one for each scan_output. The i-th
element of the list specifies whether the i-th scan_output should be
constructed by appending or prepending a new value in each
iteration: 0 indicates appending and 1 indicates prepending. If
omitted, all scan_output tensors will be produced by appending a
value in each iteration.</p></li>
</ul>
<p><strong>Inputs</strong></p>
<p>Between 1 and 2147483647 inputs.</p>
<ul class="simple">
<li><p><strong>initial_state_and_scan_inputs</strong> (variadic) - <strong>V</strong>:
Initial values of the loop’s N state variables followed by M
scan_inputs</p></li>
</ul>
<p><strong>Outputs</strong></p>
<p>Between 1 and 2147483647 outputs.</p>
<ul class="simple">
<li><p><strong>final_state_and_scan_outputs</strong> (variadic) - <strong>V</strong>:
Final values of the loop’s N state variables followed by K
scan_outputs</p></li>
</ul>
<p><strong>Type Constraints</strong></p>
<ul class="simple">
<li><p><strong>I</strong> in (
tensor(int64)
):
Int64 tensor</p></li>
<li><p><strong>V</strong> in (
tensor(bool),
tensor(complex128),
tensor(complex64),
tensor(double),
tensor(float),
tensor(float16),
tensor(int16),
tensor(int32),
tensor(int64),
tensor(int8),
tensor(string),
tensor(uint16),
tensor(uint32),
tensor(uint64),
tensor(uint8)
):
All Tensor types</p></li>
</ul>
<p><strong>Differences</strong></p>
<table style="white-space: pre; 1px solid black; font-family:courier; text-align:left !important;">
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">0</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">0</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Scan can be used to iterate over one or more scan_input tensors,</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Scan can be used to iterate over one or more scan_input tensors,</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">1</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">1</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">constructing zero or more scan_output tensors. It combines ideas from general recurrences,</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">constructing zero or more scan_output tensors. It combines ideas from general recurrences,</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">2</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">2</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">functional programming constructs such as scan, fold, map, and zip and is intended to enable</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">functional programming constructs such as scan, fold, map, and zip and is intended to enable</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">3</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">3</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">generalizations of RNN-like constructs for sequence-to-sequence processing.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">generalizations of RNN-like constructs for sequence-to-sequence processing.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">4</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">4</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Other tensors (referred to as state_variables here) can be used to carry a state</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Other tensors (referred to as state_variables here) can be used to carry a state</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">5</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">5</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">when iterating from one element to another (similar to hidden-state in RNNs, also referred</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">when iterating from one element to another (similar to hidden-state in RNNs, also referred</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">6</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">6</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">to as loop-carried dependences in the context of loops).</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">to as loop-carried dependences in the context of loops).</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">7</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">7</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Many common usages involve a single scan_input tensor (where functionality</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Many common usages involve a single scan_input tensor (where functionality</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">8</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">8</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">similar to scan, fold and map can be obtained). When more than one scan_input is used,</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">similar to scan, fold and map can be obtained). When more than one scan_input is used,</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">9</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">9</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">a behavior similar to zip is obtained.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">a behavior similar to zip is obtained.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">10</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">10</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">11</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">11</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The attribute body must be a graph, specifying the computation to be performed in</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The attribute body must be a graph, specifying the computation to be performed in</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">12</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">12</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">every iteration. It takes as input the current values of the state_variables and</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">every iteration. It takes as input the current values of the state_variables and</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">13</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">13</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">the current iterated element of the scan_inputs. It must return the (updated) values</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">the current iterated element of the scan_inputs. It must return the (updated) values</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">14</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">14</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">of the state_variables and zero or more scan_output_element tensors. The values of the</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">of the state_variables and zero or more scan_output_element tensors. The values of the</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">15</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">15</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">scan_output_element tensors are concatenated over all the iterations to produce the</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">scan_output_element tensors are concatenated over all the iterations to produce the</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">16</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">16</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">scan_output values of the scan construct (similar to the concatenated intermediate</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">scan_output values of the scan construct (similar to the concatenated intermediate</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">17</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">17</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">hidden-state values of RNN-like constructs). All the output tensors (state_variables as</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">hidden-state values of RNN-like constructs). All the output tensors (state_variables as</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">18</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">18</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">well as scan_output_element tensors) are required to have the same shape in each iteration</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">well as scan_output_element tensors) are required to have the same shape in each iteration</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">19</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">19</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">of the loop (a restriction imposed to enable efficient memory allocation).</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">of the loop (a restriction imposed to enable efficient memory allocation).</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">20</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">20</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">21</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">21</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Note that the iterated element passed to the body subgraph does not have a sequence</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Note that the iterated element passed to the body subgraph does not have a sequence</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">22</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">22</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">axis. It will have a rank one less than the rank of the corresponding scan_input.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">axis. It will have a rank one less than the rank of the corresponding scan_input.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">23</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">23</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">24</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">24</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The scan operation returns the final values of the state_variables as well as the</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The scan operation returns the final values of the state_variables as well as the</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">25</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">25</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">scan_outputs.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">scan_outputs.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">26</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">26</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">27</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">27</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The optional attribute scan_input_directions specifies the direction (forward or backward)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The optional attribute scan_input_directions specifies the direction (forward or backward)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">28</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">28</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">for each scan input. If this attribute is omitted, all sequences are scanned in the forward</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">for each scan input. If this attribute is omitted, all sequences are scanned in the forward</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">29</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">29</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">direction. A bidirectional scan may be performed by specifying the same tensor input twice</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">direction. A bidirectional scan may be performed by specifying the same tensor input twice</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">30</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">30</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">in the scan_inputs, once with a forward direction, and once with a backward direction.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">in the scan_inputs, once with a forward direction, and once with a backward direction.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">31</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">31</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">32</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">32</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The scan_output of the operation is produced by concatenating the scan_output_element</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The scan_output of the operation is produced by concatenating the scan_output_element</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">33</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">33</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">values produced by the body in each iteration.  The optional attribute scan_output_directions</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">values produced by the body in each iteration.  The optional attribute scan_output_directions</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">34</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">34</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">specifies the direction in which scan_output is constructed (by appending or prepending the</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">specifies the direction in which scan_output is constructed (by appending or prepending the</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">35</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">35</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">scan_output_element to scan_output in each iteration) for each scan_output. If this attribute</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">scan_output_element to scan_output in each iteration) for each scan_output. If this attribute</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">36</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">36</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">is omitted, the scan_output_element is appended to the scan_output in each iteration.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">is omitted, the scan_output_element is appended to the scan_output in each iteration.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">37</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">37</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">38</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">38</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The optional attribute scan_input_axes specifies the axis to be scanned for each scan_input.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The optional attribute scan_input_axes specifies the axis to be scanned for each scan_input.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">39</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">39</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">If omitted, every scan_input will be scanned in axis 0. For example, if axis 0 is the</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">If omitted, every scan_input will be scanned in axis 0. For example, if axis 0 is the</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">40</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">40</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">batch axis and axis 1 is the time axis (to be scanned), specify an axis value of 1.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">batch axis and axis 1 is the time axis (to be scanned), specify an axis value of 1.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">41</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">41</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Note that scanning a non-zero axis may be less efficient than scanning axis zero.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Note that scanning a non-zero axis may be less efficient than scanning axis zero.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">42</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">42</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">43</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">43</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The optional attribute scan_output_axes specifies the axis along which the scan_outputs</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The optional attribute scan_output_axes specifies the axis along which the scan_outputs</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">44</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">44</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">are accumulated for each scan_output. For example, if axis 1 is the time axis (to be</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">are accumulated for each scan_output. For example, if axis 1 is the time axis (to be</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">45</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">45</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">scanned) for both inputs and outputs, specify a scan_input axis and scan_output axis</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">scanned) for both inputs and outputs, specify a scan_input axis and scan_output axis</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">46</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">46</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">value of 1.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">value of 1.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">47</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">47</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">48</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">48</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Note that because of the ONNX restriction that only the last parameter of an operator can</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Note that because of the ONNX restriction that only the last parameter of an operator can</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">49</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">49</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">be variadic, the initial-states and scan-inputs are listed together as one input parameter.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">be variadic, the initial-states and scan-inputs are listed together as one input parameter.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">50</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">50</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Similarly, the final-states and scan-outputs are listed together as one output parameter.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Similarly, the final-states and scan-outputs are listed together as one output parameter.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">51</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">51</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The attribute num_scan_inputs indicates the number M of scan-inputs.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The attribute num_scan_inputs indicates the number M of scan-inputs.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">52</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">52</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">53</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">53</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The behavior of</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The behavior of</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">54</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">54</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">55</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">55</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    Scan <</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    Scan <</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">56</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">56</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        num_scan_inputs = m,</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        num_scan_inputs = m,</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">57</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">57</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        body = loop-body,</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        body = loop-body,</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">58</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">58</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        scan_input_axes = [axis_1, ..., axis_m]</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        scan_input_axes = [axis_1, ..., axis_m]</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">59</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">59</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    > (init_1, ..., init_n, scan_1, ..., scan_m)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    > (init_1, ..., init_n, scan_1, ..., scan_m)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">60</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">60</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">61</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">61</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">is equivalent to the following pseudo-code:</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">is equivalent to the following pseudo-code:</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">62</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">62</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">63</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">63</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    // scan_i.shape[axis_i] denotes the (max) sequence-length of scan_i</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    // scan_i.shape[axis_i] denotes the (max) sequence-length of scan_i</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">64</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">64</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    // scan_i.shape[axis_i] is required to be equal to scan_j.shape[axis_j] for all i,j.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    // scan_i.shape[axis_i] is required to be equal to scan_j.shape[axis_j] for all i,j.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">65</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">65</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    sequence_length = scan_1.shape[axis_1];</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    sequence_length = scan_1.shape[axis_1];</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">66</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">66</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">67</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">67</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    // initialize state-variables</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    // initialize state-variables</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">68</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">68</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    st_1 = init_1; ... st_n = init_n;</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    st_1 = init_1; ... st_n = init_n;</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">69</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">69</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    // initialize scan-output variables: [] denotes an empty tensor</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    // initialize scan-output variables: [] denotes an empty tensor</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">70</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">70</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    scan_out_1 = []; ...; scan_out_k = [];</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    scan_out_1 = []; ...; scan_out_k = [];</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">71</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">71</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    // identify number of iterations:</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    // identify number of iterations:</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">72</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">72</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">73</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">73</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    // execute loop</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    // execute loop</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">74</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">74</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    for (int t = 0; t < sequence_length; ++t) {</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    for (int t = 0; t < sequence_length; ++t) {</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">75</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">75</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        // generate the scan-input elements: the notation T<axis=k>[t] indicates the sub-tensor</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        // generate the scan-input elements: the notation T<axis=k>[t] indicates the sub-tensor</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">76</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">76</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        // of rank one less than T obtained by indexing T at position t along axis k.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        // of rank one less than T obtained by indexing T at position t along axis k.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">77</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">77</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        si_1 = scan_1<axis=axis_1>[t];</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        si_1 = scan_1<axis=axis_1>[t];</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">78</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">78</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        ... ;</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        ... ;</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">79</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">79</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        si_m = scan_m<axis=axis_m>[t];</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        si_m = scan_m<axis=axis_m>[t];</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">80</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">80</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        // execute loop-body</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        // execute loop-body</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">81</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">81</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        st_1, ..., st_n, so_1, ..., so_k = loop-body(st_1, ..., st_n, si_1, ..., si_m)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        st_1, ..., st_n, so_1, ..., so_k = loop-body(st_1, ..., st_n, si_1, ..., si_m)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">82</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">82</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        // accumulate the scan-output elements</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        // accumulate the scan-output elements</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">83</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">83</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        scan_out_1 = Concat<axis=0>(scan_out_1, so_1); ... ; scan_out_k = Concat<axis=0>(scan_out_k, so_k);</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        scan_out_1 = Concat<axis=0>(scan_out_1, so_1); ... ; scan_out_k = Concat<axis=0>(scan_out_k, so_k);</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">84</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">84</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    }</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    }</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">85</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">85</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">86</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">86</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    return st_1, ..., st_n, scan_out_1, ..., scan_out_k;</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    return st_1, ..., st_n, scan_out_1, ..., scan_out_k;</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">87</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">87</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">88</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">88</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">*Sample usage: Encoding RNN using a Scan*</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">*Sample usage: Encoding RNN using a Scan*</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">89</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">89</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">90</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">90</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The following example shows how a simple RNN over an input tensor %X, with weight tensor %Wi,</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The following example shows how a simple RNN over an input tensor %X, with weight tensor %Wi,</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">91</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">91</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">recurrence weight tensor %Ri, bias tensors %Wbi and %Rbi, and initial hidden-state %H_0 can</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">recurrence weight tensor %Ri, bias tensors %Wbi and %Rbi, and initial hidden-state %H_0 can</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">92</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">92</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">be encoded as a ScanLoop. Note that the loop-body is a nested graph, and it directly computes</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">be encoded as a ScanLoop. Note that the loop-body is a nested graph, and it directly computes</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">93</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">93</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">%Wi, %Ri, %Wbi, and %Rbi (typically constants or initializers in the body graph). If these</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">%Wi, %Ri, %Wbi, and %Rbi (typically constants or initializers in the body graph). If these</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">94</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">94</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">values are computed in the outer graph, they need to be passed in as extra state_variables.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">values are computed in the outer graph, they need to be passed in as extra state_variables.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">95</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">95</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">96</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">96</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    graph rnn-encoding {</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    graph rnn-encoding {</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">97</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">97</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %H_0 = ...</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %H_0 = ...</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">98</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">98</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %X = ...</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %X = ...</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">99</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">99</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Y_h, %Y = Scan[body = <graph rnn-cell-1>, num_scan_inputs=1](%H_0, %X)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Y_h, %Y = Scan[body = <graph rnn-cell-1>, num_scan_inputs=1](%H_0, %X)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">100</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">100</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      return %Y, %Y_h</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      return %Y, %Y_h</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">101</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">101</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    }</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    }</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">102</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">102</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">103</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">103</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    graph rnn-cell-1 (</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    graph rnn-cell-1 (</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">104</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">104</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %H_tminus1[FLOAT, tensor]</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %H_tminus1[FLOAT, tensor]</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">105</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">105</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %X_t[FLOAT, tensor]</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %X_t[FLOAT, tensor]</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">106</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">106</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    ) {</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    ) {</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">107</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">107</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Wi = ...</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Wi = ...</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">108</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">108</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Ri = ...</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Ri = ...</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">109</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">109</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Wbi = ...</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Wbi = ...</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">110</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">110</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Rbi = ...</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Rbi = ...</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">111</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">111</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %t1 = X_t * (Wi^T)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %t1 = X_t * (Wi^T)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">112</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">112</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %t2 = H_tminus1*(Ri^T)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %t2 = H_tminus1*(Ri^T)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">113</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">113</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %t3 = Add(%t1, %t2)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %t3 = Add(%t1, %t2)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">114</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">114</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %t4 = Add(%t3, %Wbi)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %t4 = Add(%t3, %Wbi)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">115</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">115</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %t5 = Add(%t4, %Rbi)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %t5 = Add(%t4, %Rbi)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">116</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">116</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Ht = Tanh(%t5)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Ht = Tanh(%t5)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">117</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">117</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Accumulate = Identity(%Ht)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Accumulate = Identity(%Ht)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">118</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">118</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      return %Ht, %Accumulate</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      return %Ht, %Accumulate</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">119</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">119</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    }</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    }</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">120</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">120</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">121</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">121</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">**Attributes**</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">**Attributes**</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">122</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">122</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">123</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">123</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **body** (required):</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **body** (required):</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">124</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">124</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  The graph run each iteration. It has N+M inputs: (loop state</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  The graph run each iteration. It has N+M inputs: (loop state</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">125</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">125</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  variables..., scan_input_elts...). It has N+K outputs: (loop state</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  variables..., scan_input_elts...). It has N+K outputs: (loop state</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">126</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">126</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  variables..., scan_output_elts...). Each scan_output is created by</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  variables..., scan_output_elts...). Each scan_output is created by</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">127</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">127</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  concatenating the value of the specified scan_output_elt value at</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  concatenating the value of the specified scan_output_elt value at</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">128</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">128</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  the end of each iteration of the loop. It is an error if the</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  the end of each iteration of the loop. It is an error if the</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">129</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">129</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  dimensions of these values change across loop iterations.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  dimensions of these values change across loop iterations.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">130</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">130</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **num_scan_inputs** (required):</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **num_scan_inputs** (required):</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">131</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">131</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  An attribute specifying the number of scan_inputs M.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  An attribute specifying the number of scan_inputs M.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">132</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">132</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **scan_input_axes**:</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **scan_input_axes**:</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">133</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">133</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  An optional list of M flags. The i-th element of the list specifies</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  An optional list of M flags. The i-th element of the list specifies</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">134</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">134</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  the axis to be scanned (the sequence axis) for the i-th scan_input.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  the axis to be scanned (the sequence axis) for the i-th scan_input.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">135</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">135</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  If omitted, 0 will be used as the scan axis for every scan_input.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  If omitted, 0 will be used as the scan axis for every scan_input.</code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">136</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">  Negative value for an axis means counting dimensions from the back.</code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">137</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">  Accepted range is [-r, r-1] where r = rank(input).</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">136</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">138</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **scan_input_directions**:</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **scan_input_directions**:</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">137</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">139</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  An optional list of M flags. The i-th element of the list specifies</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  An optional list of M flags. The i-th element of the list specifies</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">138</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">140</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  the direction to be scanned for the i-th scan_input tensor: 0</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  the direction to be scanned for the i-th scan_input tensor: 0</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">139</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">141</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  indicates forward direction and 1 indicates reverse direction. If</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  indicates forward direction and 1 indicates reverse direction. If</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">140</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">142</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  omitted, all scan_input tensors will be scanned in the forward</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  omitted, all scan_input tensors will be scanned in the forward</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">141</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">143</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  direction.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  direction.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">142</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">144</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **scan_output_axes**:</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **scan_output_axes**:</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">143</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">145</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  An optional list of K flags. The i-th element of the list specifies</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  An optional list of K flags. The i-th element of the list specifies</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">144</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">146</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  the axis for the i-th scan_output. The scan outputs are accumulated</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  the axis for the i-th scan_output. The scan outputs are accumulated</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">145</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">147</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  along the specified axis. If omitted, 0 will be used as the scan</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  along the specified axis. If omitted, 0 will be used as the scan</code></td></tr>
<tr style="1px solid black;"><td><code>146</code></td><td><code>148</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;">  axis for every scan_output.</code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code>  axis for every scan_output.<span style="color:#196F3D;"> </span><span style="color:#196F3D;">N</span><span style="color:#196F3D;">e</span><span style="color:#196F3D;">g</span><span style="color:#196F3D;">a</span><span style="color:#196F3D;">t</span><span style="color:#196F3D;">i</span><span style="color:#196F3D;">v</span><span style="color:#196F3D;">e</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">v</span><span style="color:#196F3D;">a</span><span style="color:#196F3D;">l</span><span style="color:#196F3D;">u</span><span style="color:#196F3D;">e</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">f</span><span style="color:#196F3D;">o</span><span style="color:#196F3D;">r</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">a</span><span style="color:#196F3D;">n</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">a</span><span style="color:#196F3D;">x</span><span style="color:#196F3D;">i</span><span style="color:#196F3D;">s</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">m</span><span style="color:#196F3D;">e</span><span style="color:#196F3D;">a</span><span style="color:#196F3D;">n</span><span style="color:#196F3D;">s</span></code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">149</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">  counting dimensions from the back. Accepted range is [-r, r-1].</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">147</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">150</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **scan_output_directions**:</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **scan_output_directions**:</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">148</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">151</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  An optional list of K flags, one for each scan_output. The i-th</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  An optional list of K flags, one for each scan_output. The i-th</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">149</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">152</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  element of the list specifies whether the i-th scan_output should be</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  element of the list specifies whether the i-th scan_output should be</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">150</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">153</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  constructed by appending or prepending a new value in each</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  constructed by appending or prepending a new value in each</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">151</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">154</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  iteration: 0 indicates appending and 1 indicates prepending. If</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  iteration: 0 indicates appending and 1 indicates prepending. If</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">152</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">155</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  omitted, all scan_output tensors will be produced by appending a</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  omitted, all scan_output tensors will be produced by appending a</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">153</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">156</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  value in each iteration.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  value in each iteration.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">154</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">157</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">155</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">158</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">**Inputs**</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">**Inputs**</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">156</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">159</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">157</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">160</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Between 1 and 2147483647 inputs.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Between 1 and 2147483647 inputs.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">158</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">161</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">159</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">162</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **initial_state_and_scan_inputs** (variadic) - **V**:</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **initial_state_and_scan_inputs** (variadic) - **V**:</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">160</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">163</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  Initial values of the loop's N state variables followed by M</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  Initial values of the loop's N state variables followed by M</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">161</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">164</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  scan_inputs</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  scan_inputs</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">162</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">165</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">163</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">166</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">**Outputs**</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">**Outputs**</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">164</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">167</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">165</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">168</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Between 1 and 2147483647 outputs.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Between 1 and 2147483647 outputs.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">166</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">169</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">167</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">170</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **final_state_and_scan_outputs** (variadic) - **V**:</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **final_state_and_scan_outputs** (variadic) - **V**:</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">168</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">171</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  Final values of the loop's N state variables followed by K</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  Final values of the loop's N state variables followed by K</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">169</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">172</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  scan_outputs</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  scan_outputs</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">170</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">173</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">171</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">174</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">**Type Constraints**</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">**Type Constraints**</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">172</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">175</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">173</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">176</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **I** in (</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **I** in (</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">174</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">177</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(int64)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(int64)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">175</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">178</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  ):</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  ):</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">176</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">179</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  Int64 tensor</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  Int64 tensor</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">177</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">180</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **V** in (</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **V** in (</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">178</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">181</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(bool),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(bool),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">179</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">182</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(complex128),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(complex128),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">180</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">183</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(complex64),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(complex64),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">181</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">184</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(double),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(double),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">182</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">185</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(float),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(float),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">183</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">186</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(float16),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(float16),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">184</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">187</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(int16),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(int16),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">185</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">188</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(int32),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(int32),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">186</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">189</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(int64),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(int64),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">187</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">190</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(int8),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(int8),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">188</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">191</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(string),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(string),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">189</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">192</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(uint16),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(uint16),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">190</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">193</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(uint32),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(uint32),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">191</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">194</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(uint64),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(uint64),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">192</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">195</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(uint8)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(uint8)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">193</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">196</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  ):</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  ):</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">194</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">197</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  All Tensor types</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  All Tensor types</code></td></tr>
</table></section>
<section id="scan-9">
<span id="l-onnx-op-scan-9"></span><h2><a class="toc-backref" href="#id6">Scan - 9</a><a class="headerlink" href="#scan-9" title="Permalink to this headline">#</a></h2>
<p><strong>Version</strong></p>
<ul class="simple">
<li><p><strong>name</strong>: <a class="reference external" href="https://github.com/onnx/onnx/blob/main/docs/Operators.md#Scan">Scan (GitHub)</a></p></li>
<li><p><strong>domain</strong>: <strong>main</strong></p></li>
<li><p><strong>since_version</strong>: <strong>9</strong></p></li>
<li><p><strong>function</strong>: False</p></li>
<li><p><strong>support_level</strong>: SupportType.COMMON</p></li>
<li><p><strong>shape inference</strong>: True</p></li>
</ul>
<p>This version of the operator has been available
<strong>since version 9</strong>.</p>
<p><strong>Summary</strong></p>
<p>Scan can be used to iterate over one or more scan_input tensors,
constructing zero or more scan_output tensors. It combines ideas from general recurrences,
functional programming constructs such as scan, fold, map, and zip and is intended to enable
generalizations of RNN-like constructs for sequence-to-sequence processing.
Other tensors (referred to as state_variables here) can be used to carry a state
when iterating from one element to another (similar to hidden-state in RNNs, also referred
to as loop-carried dependences in the context of loops).
Many common usages involve a single scan_input tensor (where functionality
similar to scan, fold and map can be obtained). When more than one scan_input is used,
a behavior similar to zip is obtained.</p>
<p>The attribute body must be a graph, specifying the computation to be performed in
every iteration. It takes as input the current values of the state_variables and
the current iterated element of the scan_inputs. It must return the (updated) values
of the state_variables and zero or more scan_output_element tensors. The values of the
scan_output_element tensors are concatenated over all the iterations to produce the
scan_output values of the scan construct (similar to the concatenated intermediate
hidden-state values of RNN-like constructs). All the output tensors (state_variables as
well as scan_output_element tensors) are required to have the same shape in each iteration
of the loop (a restriction imposed to enable efficient memory allocation).</p>
<p>Note that the iterated element passed to the body subgraph does not have a sequence
axis. It will have a rank one less than the rank of the corresponding scan_input.</p>
<p>The scan operation returns the final values of the state_variables as well as the
scan_outputs.</p>
<p>The optional attribute scan_input_directions specifies the direction (forward or backward)
for each scan input. If this attribute is omitted, all sequences are scanned in the forward
direction. A bidirectional scan may be performed by specifying the same tensor input twice
in the scan_inputs, once with a forward direction, and once with a backward direction.</p>
<p>The scan_output of the operation is produced by concatenating the scan_output_element
values produced by the body in each iteration.  The optional attribute scan_output_directions
specifies the direction in which scan_output is constructed (by appending or prepending the
scan_output_element to scan_output in each iteration) for each scan_output. If this attribute
is omitted, the scan_output_element is appended to the scan_output in each iteration.</p>
<p>The optional attribute scan_input_axes specifies the axis to be scanned for each scan_input.
If omitted, every scan_input will be scanned in axis 0. For example, if axis 0 is the
batch axis and axis 1 is the time axis (to be scanned), specify an axis value of 1.
Note that scanning a non-zero axis may be less efficient than scanning axis zero.</p>
<p>The optional attribute scan_output_axes specifies the axis along which the scan_outputs
are accumulated for each scan_output. For example, if axis 1 is the time axis (to be
scanned) for both inputs and outputs, specify a scan_input axis and scan_output axis
value of 1.</p>
<p>Note that because of the ONNX restriction that only the last parameter of an operator can
be variadic, the initial-states and scan-inputs are listed together as one input parameter.
Similarly, the final-states and scan-outputs are listed together as one output parameter.
The attribute num_scan_inputs indicates the number M of scan-inputs.</p>
<p>The behavior of</p>
<blockquote>
<div><dl class="simple">
<dt>Scan &lt;</dt><dd><p>num_scan_inputs = m,
body = loop-body,
scan_input_axes = [axis_1, …, axis_m]</p>
</dd>
</dl>
<p>&gt; (init_1, …, init_n, scan_1, …, scan_m)</p>
</div></blockquote>
<p>is equivalent to the following pseudo-code:</p>
<blockquote>
<div><p>// scan_i.shape[axis_i] denotes the (max) sequence-length of scan_i
// scan_i.shape[axis_i] is required to be equal to scan_j.shape[axis_j] for all i,j.
sequence_length = scan_1.shape[axis_1];</p>
<p>// initialize state-variables
st_1 = init_1; … st_n = init_n;
// initialize scan-output variables: [] denotes an empty tensor
scan_out_1 = []; …; scan_out_k = [];
// identify number of iterations:</p>
<p>// execute loop
for (int t = 0; t &lt; sequence_length; ++t) {</p>
<blockquote>
<div><p>// generate the scan-input elements: the notation T&lt;axis=k&gt;[t] indicates the sub-tensor
// of rank one less than T obtained by indexing T at position t along axis k.
si_1 = scan_1&lt;axis=axis_1&gt;[t];
… ;
si_m = scan_m&lt;axis=axis_m&gt;[t];
// execute loop-body
st_1, …, st_n, so_1, …, so_k = loop-body(st_1, …, st_n, si_1, …, si_m)
// accumulate the scan-output elements
scan_out_1 = Concat&lt;axis=0&gt;(scan_out_1, so_1); … ; scan_out_k = Concat&lt;axis=0&gt;(scan_out_k, so_k);</p>
</div></blockquote>
<p>}</p>
<p>return st_1, …, st_n, scan_out_1, …, scan_out_k;</p>
</div></blockquote>
<p><em>Sample usage: Encoding RNN using a Scan</em></p>
<p>The following example shows how a simple RNN over an input tensor %X, with weight tensor %Wi,
recurrence weight tensor %Ri, bias tensors %Wbi and %Rbi, and initial hidden-state %H_0 can
be encoded as a ScanLoop. Note that the loop-body is a nested graph, and it directly computes
%Wi, %Ri, %Wbi, and %Rbi (typically constants or initializers in the body graph). If these
values are computed in the outer graph, they need to be passed in as extra state_variables.</p>
<blockquote>
<div><dl class="simple">
<dt>graph rnn-encoding {</dt><dd><p>%H_0 = …
%X = …
%Y_h, %Y = Scan[body = &lt;graph rnn-cell-1&gt;, num_scan_inputs=1](%H_0, %X)
return %Y, %Y_h</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>graph rnn-cell-1 (</dt><dd><p>%H_tminus1[FLOAT, tensor]
%X_t[FLOAT, tensor]</p>
</dd>
<dt>) {</dt><dd><p>%Wi = …
%Ri = …
%Wbi = …
%Rbi = …
%t1 = X_t * (Wi^T)
%t2 = H_tminus1*(Ri^T)
%t3 = Add(%t1, %t2)
%t4 = Add(%t3, %Wbi)
%t5 = Add(%t4, %Rbi)
%Ht = Tanh(%t5)
%Accumulate = Identity(%Ht)
return %Ht, %Accumulate</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p><strong>Attributes</strong></p>
<ul class="simple">
<li><p><strong>body</strong> (required):
The graph run each iteration. It has N+M inputs: (loop state
variables…, scan_input_elts…). It has N+K outputs: (loop state
variables…, scan_output_elts…). Each scan_output is created by
concatenating the value of the specified scan_output_elt value at
the end of each iteration of the loop. It is an error if the
dimensions of these values change across loop iterations.</p></li>
<li><p><strong>num_scan_inputs</strong> (required):
An attribute specifying the number of scan_inputs M.</p></li>
<li><p><strong>scan_input_axes</strong>:
An optional list of M flags. The i-th element of the list specifies
the axis to be scanned (the sequence axis) for the i-th scan_input.
If omitted, 0 will be used as the scan axis for every scan_input.</p></li>
<li><p><strong>scan_input_directions</strong>:
An optional list of M flags. The i-th element of the list specifies
the direction to be scanned for the i-th scan_input tensor: 0
indicates forward direction and 1 indicates reverse direction. If
omitted, all scan_input tensors will be scanned in the forward
direction.</p></li>
<li><p><strong>scan_output_axes</strong>:
An optional list of K flags. The i-th element of the list specifies
the axis for the i-th scan_output. The scan outputs are accumulated
along the specified axis. If omitted, 0 will be used as the scan
axis for every scan_output.</p></li>
<li><p><strong>scan_output_directions</strong>:
An optional list of K flags, one for each scan_output. The i-th
element of the list specifies whether the i-th scan_output should be
constructed by appending or prepending a new value in each
iteration: 0 indicates appending and 1 indicates prepending. If
omitted, all scan_output tensors will be produced by appending a
value in each iteration.</p></li>
</ul>
<p><strong>Inputs</strong></p>
<p>Between 1 and 2147483647 inputs.</p>
<ul class="simple">
<li><p><strong>initial_state_and_scan_inputs</strong> (variadic) - <strong>V</strong>:
Initial values of the loop’s N state variables followed by M
scan_inputs</p></li>
</ul>
<p><strong>Outputs</strong></p>
<p>Between 1 and 2147483647 outputs.</p>
<ul class="simple">
<li><p><strong>final_state_and_scan_outputs</strong> (variadic) - <strong>V</strong>:
Final values of the loop’s N state variables followed by K
scan_outputs</p></li>
</ul>
<p><strong>Type Constraints</strong></p>
<ul class="simple">
<li><p><strong>I</strong> in (
tensor(int64)
):
Int64 tensor</p></li>
<li><p><strong>V</strong> in (
tensor(bool),
tensor(complex128),
tensor(complex64),
tensor(double),
tensor(float),
tensor(float16),
tensor(int16),
tensor(int32),
tensor(int64),
tensor(int8),
tensor(string),
tensor(uint16),
tensor(uint32),
tensor(uint64),
tensor(uint8)
):
All Tensor types</p></li>
</ul>
<p><strong>Differences</strong></p>
<table style="white-space: pre; 1px solid black; font-family:courier; text-align:left !important;">
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">0</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">0</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Scan can be used to iterate over one or more scan_input tensors,</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Scan can be used to iterate over one or more scan_input tensors,</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">1</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">1</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">constructing zero or more scan_output tensors. It combines ideas from general recurrences,</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">constructing zero or more scan_output tensors. It combines ideas from general recurrences,</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">2</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">2</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">functional programming constructs such as scan, fold, map, and zip and is intended to enable</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">functional programming constructs such as scan, fold, map, and zip and is intended to enable</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">3</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">3</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">generalizations of RNN-like constructs for sequence-to-sequence processing.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">generalizations of RNN-like constructs for sequence-to-sequence processing.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">4</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">4</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Other tensors (referred to as state_variables here) can be used to carry a state</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Other tensors (referred to as state_variables here) can be used to carry a state</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">5</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">5</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">when iterating from one element to another (similar to hidden-state in RNNs, also referred</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">when iterating from one element to another (similar to hidden-state in RNNs, also referred</code></td></tr>
<tr style="1px solid black;"><td><code>6</code></td><td><code>6</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;">to as loop-carried dependences in the context of loops).<span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">A</span><span style="color:#BA4A00;">l</span><span style="color:#BA4A00;">l</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">t</span><span style="color:#BA4A00;">h</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;">s</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">t</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;">n</span><span style="color:#BA4A00;">s</span><span style="color:#BA4A00;">o</span><span style="color:#BA4A00;">r</span><span style="color:#BA4A00;">s</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">a</span><span style="color:#BA4A00;">r</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">r</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;">q</span><span style="color:#BA4A00;">u</span><span style="color:#BA4A00;">i</span><span style="color:#BA4A00;">r</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;">d</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">t</span><span style="color:#BA4A00;">o</span></code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code>to as loop-carried dependences in the context of loops).</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#E59866;"><code style="background-color:#E59866;">7</code></td><td></td><td style="background-color:#E59866;"><code style="background-color:#E59866;">have the same shape in each iteration of the loop (a restriction imposed to enable efficient</code></td><td></td></tr>
<tr style="1px solid black;"><td><code>8</code></td><td><code>7</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><span style="color:#BA4A00;">m</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;">m</span><span style="color:#BA4A00;">o</span><span style="color:#BA4A00;">r</span><span style="color:#BA4A00;">y</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">a</span><span style="color:#BA4A00;">l</span><span style="color:#BA4A00;">l</span><span style="color:#BA4A00;">o</span><span style="color:#BA4A00;">c</span><span style="color:#BA4A00;">a</span><span style="color:#BA4A00;">t</span><span style="color:#BA4A00;">i</span><span style="color:#BA4A00;">o</span><span style="color:#BA4A00;">n</span><span style="color:#BA4A00;">)</span><span style="color:#BA4A00;">.</span><span style="color:#BA4A00;"> </span>Many common usages involve a single scan_input tensor (where functionality</code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code>Many common usages involve a single scan_input tensor (where functionality</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">9</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">8</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">similar to scan, fold and map can be obtained). When more than one scan_input is used,</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">similar to scan, fold and map can be obtained). When more than one scan_input is used,</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">10</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">9</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">a behavior similar to zip is obtained.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">a behavior similar to zip is obtained.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">11</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">10</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">12</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">11</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The attribute body must be a graph, specifying the computation to be performed in</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The attribute body must be a graph, specifying the computation to be performed in</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">13</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">12</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">every iteration. It takes as input the current values of the state_variables and</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">every iteration. It takes as input the current values of the state_variables and</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">14</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">13</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">the current iterated element of the scan_inputs. It must return the (updated) values</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">the current iterated element of the scan_inputs. It must return the (updated) values</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">15</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">14</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">of the state_variables and zero or more scan_output_element tensors. The values of the</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">of the state_variables and zero or more scan_output_element tensors. The values of the</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">16</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">15</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">scan_output_element tensors are concatenated over all the iterations to produce the</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">scan_output_element tensors are concatenated over all the iterations to produce the</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">17</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">16</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">scan_output values of the scan construct (similar to the concatenated intermediate</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">scan_output values of the scan construct (similar to the concatenated intermediate</code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">17</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">hidden-state values of RNN-like constructs). All the output tensors (state_variables as</code></td></tr>
<tr style="1px solid black;"><td><code>18</code></td><td><code>18</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><span style="color:#BA4A00;">h</span><span style="color:#BA4A00;">i</span><span style="color:#BA4A00;">d</span><span style="color:#BA4A00;">d</span>en<span style="color:#BA4A00;">-</span>state <span style="color:#BA4A00;">v</span>a<span style="color:#BA4A00;">l</span><span style="color:#BA4A00;">u</span>es <span style="color:#BA4A00;">o</span><span style="color:#BA4A00;">f</span> <span style="color:#BA4A00;">R</span><span style="color:#BA4A00;">N</span><span style="color:#BA4A00;">N</span><span style="color:#BA4A00;">-</span><span style="color:#BA4A00;">l</span><span style="color:#BA4A00;">i</span><span style="color:#BA4A00;">k</span>e <span style="color:#BA4A00;">c</span><span style="color:#BA4A00;">o</span><span style="color:#BA4A00;">n</span><span style="color:#BA4A00;">s</span>tr<span style="color:#BA4A00;">u</span><span style="color:#BA4A00;">c</span>t<span style="color:#BA4A00;">s</span><span style="color:#BA4A00;">)</span><span style="color:#BA4A00;">.</span></code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code><span style="color:#196F3D;">w</span>e<span style="color:#196F3D;">l</span><span style="color:#196F3D;">l</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">a</span><span style="color:#196F3D;">s</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">s</span><span style="color:#196F3D;">c</span><span style="color:#196F3D;">a</span>n<span style="color:#196F3D;">_</span><span style="color:#196F3D;">o</span><span style="color:#196F3D;">u</span><span style="color:#196F3D;">t</span><span style="color:#196F3D;">p</span><span style="color:#196F3D;">u</span><span style="color:#196F3D;">t</span><span style="color:#196F3D;">_</span><span style="color:#196F3D;">e</span><span style="color:#196F3D;">l</span><span style="color:#196F3D;">e</span><span style="color:#196F3D;">m</span><span style="color:#196F3D;">e</span><span style="color:#196F3D;">n</span><span style="color:#196F3D;">t</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">t</span><span style="color:#196F3D;">e</span><span style="color:#196F3D;">n</span>s<span style="color:#196F3D;">o</span><span style="color:#196F3D;">r</span><span style="color:#196F3D;">s</span><span style="color:#196F3D;">)</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">a</span><span style="color:#196F3D;">r</span><span style="color:#196F3D;">e</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">r</span><span style="color:#196F3D;">e</span><span style="color:#196F3D;">q</span><span style="color:#196F3D;">u</span><span style="color:#196F3D;">i</span><span style="color:#196F3D;">r</span><span style="color:#196F3D;">e</span><span style="color:#196F3D;">d</span><span style="color:#196F3D;"> </span>t<span style="color:#196F3D;">o</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">h</span>a<span style="color:#196F3D;">v</span><span style="color:#196F3D;">e</span><span style="color:#196F3D;"> </span>t<span style="color:#196F3D;">h</span>e <span style="color:#196F3D;">s</span>a<span style="color:#196F3D;">m</span>e<span style="color:#196F3D;"> </span>s<span style="color:#196F3D;">h</span><span style="color:#196F3D;">a</span><span style="color:#196F3D;">p</span><span style="color:#196F3D;">e</span> <span style="color:#196F3D;">i</span><span style="color:#196F3D;">n</span> e<span style="color:#196F3D;">a</span><span style="color:#196F3D;">c</span><span style="color:#196F3D;">h</span> <span style="color:#196F3D;">i</span>t<span style="color:#196F3D;">e</span>r<span style="color:#196F3D;">a</span>t<span style="color:#196F3D;">i</span><span style="color:#196F3D;">o</span><span style="color:#196F3D;">n</span></code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">19</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">of the loop (a restriction imposed to enable efficient memory allocation).</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">19</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">20</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">21</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">Note that the iterated element passed to the body subgraph does not have a sequence</code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">22</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">axis. It will have a rank one less than the rank of the corresponding scan_input.</code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">23</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">20</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">24</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The scan operation returns the final values of the state_variables as well as the</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The scan operation returns the final values of the state_variables as well as the</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">21</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">25</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">scan_outputs.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">scan_outputs.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">22</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">26</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#E59866;"><code style="background-color:#E59866;">23</code></td><td></td><td style="background-color:#E59866;"><code style="background-color:#E59866;">The operation supports batching, and the batch-axis is required to be 0.</code></td><td></td></tr>
<tr style="1px solid black;"><td style="background-color:#E59866;"><code style="background-color:#E59866;">24</code></td><td></td><td style="background-color:#E59866;"><code style="background-color:#E59866;">When multiple scan_input tensors are used, they must all have the same batch-size,</code></td><td></td></tr>
<tr style="1px solid black;"><td style="background-color:#E59866;"><code style="background-color:#E59866;">25</code></td><td></td><td style="background-color:#E59866;"><code style="background-color:#E59866;">and they must all have the same maximum-sequence-length (the dimensionality of the</code></td><td></td></tr>
<tr style="1px solid black;"><td style="background-color:#E59866;"><code style="background-color:#E59866;">26</code></td><td></td><td style="background-color:#E59866;"><code style="background-color:#E59866;">sequence axis or scan axis). The sequence axis or scan axis is required to be 1.</code></td><td></td></tr>
<tr style="1px solid black;"><td style="background-color:#E59866;"><code style="background-color:#E59866;">27</code></td><td></td><td style="background-color:#E59866;"><code style="background-color:#E59866;"></code></td><td></td></tr>
<tr style="1px solid black;"><td style="background-color:#E59866;"><code style="background-color:#E59866;">28</code></td><td></td><td style="background-color:#E59866;"><code style="background-color:#E59866;">The operation has an optional sequence_lens input (of shape [BATCH_SIZE]) to</code></td><td></td></tr>
<tr style="1px solid black;"><td style="background-color:#E59866;"><code style="background-color:#E59866;">29</code></td><td></td><td style="background-color:#E59866;"><code style="background-color:#E59866;">allow variable length sequences of length <= the maximum-sequence-length. If this</code></td><td></td></tr>
<tr style="1px solid black;"><td style="background-color:#E59866;"><code style="background-color:#E59866;">30</code></td><td></td><td style="background-color:#E59866;"><code style="background-color:#E59866;">input is not specified, all sequences are assumed to be of length equal to</code></td><td></td></tr>
<tr style="1px solid black;"><td style="background-color:#E59866;"><code style="background-color:#E59866;">31</code></td><td></td><td style="background-color:#E59866;"><code style="background-color:#E59866;">maximum-sequence-length. For variable length input sequences, the scan_outputs</code></td><td></td></tr>
<tr style="1px solid black;"><td style="background-color:#E59866;"><code style="background-color:#E59866;">32</code></td><td></td><td style="background-color:#E59866;"><code style="background-color:#E59866;">will consist of a sequence of same length as the input, padded to the</code></td><td></td></tr>
<tr style="1px solid black;"><td><code>33</code></td><td><code>27</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><span style="color:#BA4A00;">m</span>a<span style="color:#BA4A00;">x</span>i<span style="color:#BA4A00;">m</span>u<span style="color:#BA4A00;">m</span><span style="color:#BA4A00;">-</span>s<span style="color:#BA4A00;">e</span><span style="color:#BA4A00;">q</span>uence<span style="color:#BA4A00;">-</span><span style="color:#BA4A00;">l</span>en<span style="color:#BA4A00;">g</span><span style="color:#BA4A00;">t</span><span style="color:#BA4A00;">h</span><span style="color:#BA4A00;">.</span></code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code><span style="color:#196F3D;">T</span><span style="color:#196F3D;">h</span><span style="color:#196F3D;">e</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">o</span><span style="color:#196F3D;">p</span><span style="color:#196F3D;">t</span><span style="color:#196F3D;">i</span><span style="color:#196F3D;">o</span><span style="color:#196F3D;">n</span>a<span style="color:#196F3D;">l</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">a</span><span style="color:#196F3D;">t</span><span style="color:#196F3D;">t</span><span style="color:#196F3D;">r</span>i<span style="color:#196F3D;">b</span>u<span style="color:#196F3D;">t</span><span style="color:#196F3D;">e</span><span style="color:#196F3D;"> </span>s<span style="color:#196F3D;">c</span><span style="color:#196F3D;">a</span><span style="color:#196F3D;">n</span><span style="color:#196F3D;">_</span><span style="color:#196F3D;">i</span><span style="color:#196F3D;">n</span><span style="color:#196F3D;">p</span>u<span style="color:#196F3D;">t</span><span style="color:#196F3D;">_</span><span style="color:#196F3D;">d</span><span style="color:#196F3D;">i</span><span style="color:#196F3D;">r</span>e<span style="color:#196F3D;">c</span><span style="color:#196F3D;">t</span><span style="color:#196F3D;">i</span><span style="color:#196F3D;">o</span>n<span style="color:#196F3D;">s</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">s</span><span style="color:#196F3D;">p</span><span style="color:#196F3D;">e</span>c<span style="color:#196F3D;">i</span><span style="color:#196F3D;">f</span><span style="color:#196F3D;">i</span>e<span style="color:#196F3D;">s</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">t</span><span style="color:#196F3D;">h</span>e<span style="color:#196F3D;"> </span><span style="color:#196F3D;">d</span><span style="color:#196F3D;">i</span><span style="color:#196F3D;">r</span><span style="color:#196F3D;">e</span><span style="color:#196F3D;">c</span><span style="color:#196F3D;">t</span><span style="color:#196F3D;">i</span><span style="color:#196F3D;">o</span>n<span style="color:#196F3D;"> </span><span style="color:#196F3D;">(</span><span style="color:#196F3D;">f</span><span style="color:#196F3D;">o</span><span style="color:#196F3D;">r</span><span style="color:#196F3D;">w</span><span style="color:#196F3D;">a</span><span style="color:#196F3D;">r</span><span style="color:#196F3D;">d</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">o</span><span style="color:#196F3D;">r</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">b</span><span style="color:#196F3D;">a</span><span style="color:#196F3D;">c</span><span style="color:#196F3D;">k</span><span style="color:#196F3D;">w</span><span style="color:#196F3D;">a</span><span style="color:#196F3D;">r</span><span style="color:#196F3D;">d</span><span style="color:#196F3D;">)</span></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#E59866;"><code style="background-color:#E59866;">34</code></td><td></td><td style="background-color:#E59866;"><code style="background-color:#E59866;"></code></td><td></td></tr>
<tr style="1px solid black;"><td style="background-color:#E59866;"><code style="background-color:#E59866;">35</code></td><td></td><td style="background-color:#E59866;"><code style="background-color:#E59866;">The optional attribute directions can be used to scan a sequence in the reverse direction.</code></td><td></td></tr>
<tr style="1px solid black;"><td><code>36</code></td><td><code>28</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;">If this attribute is omitted, all sequences are scanned in the forward<span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">d</span><span style="color:#BA4A00;">i</span><span style="color:#BA4A00;">r</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;">c</span><span style="color:#BA4A00;">t</span><span style="color:#BA4A00;">i</span><span style="color:#BA4A00;">o</span><span style="color:#BA4A00;">n</span><span style="color:#BA4A00;">.</span></code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code><span style="color:#196F3D;">f</span><span style="color:#196F3D;">o</span><span style="color:#196F3D;">r</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">e</span><span style="color:#196F3D;">a</span><span style="color:#196F3D;">c</span><span style="color:#196F3D;">h</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">s</span><span style="color:#196F3D;">c</span><span style="color:#196F3D;">a</span><span style="color:#196F3D;">n</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">i</span><span style="color:#196F3D;">n</span><span style="color:#196F3D;">p</span><span style="color:#196F3D;">u</span><span style="color:#196F3D;">t</span><span style="color:#196F3D;">.</span><span style="color:#196F3D;"> </span>If this attribute is omitted, all sequences are scanned in the forward</code></td></tr>
<tr style="1px solid black;"><td><code>37</code></td><td><code>29</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;">A bidirectional scan be performed by specifying the same tensor input twice<span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">i</span><span style="color:#BA4A00;">n</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">t</span><span style="color:#BA4A00;">h</span><span style="color:#BA4A00;">e</span></code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code><span style="color:#196F3D;">d</span><span style="color:#196F3D;">i</span><span style="color:#196F3D;">r</span><span style="color:#196F3D;">e</span><span style="color:#196F3D;">c</span><span style="color:#196F3D;">t</span><span style="color:#196F3D;">i</span><span style="color:#196F3D;">o</span><span style="color:#196F3D;">n</span><span style="color:#196F3D;">.</span><span style="color:#196F3D;"> </span>A bidirectional scan <span style="color:#196F3D;">m</span><span style="color:#196F3D;">a</span><span style="color:#196F3D;">y</span><span style="color:#196F3D;"> </span>be performed by specifying the same tensor input twice</code></td></tr>
<tr style="1px solid black;"><td><code>38</code></td><td><code>30</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;">scan_inputs, once with a forward direction, and once with a backward direction.</code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code><span style="color:#196F3D;">i</span><span style="color:#196F3D;">n</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">t</span><span style="color:#196F3D;">h</span><span style="color:#196F3D;">e</span><span style="color:#196F3D;"> </span>scan_inputs, once with a forward direction, and once with a backward direction.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">39</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">31</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">32</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">The scan_output of the operation is produced by concatenating the scan_output_element</code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">33</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">values produced by the body in each iteration.  The optional attribute scan_output_directions</code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">34</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">specifies the direction in which scan_output is constructed (by appending or prepending the</code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">35</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">scan_output_element to scan_output in each iteration) for each scan_output. If this attribute</code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">36</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">is omitted, the scan_output_element is appended to the scan_output in each iteration.</code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">37</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;"></code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">38</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">The optional attribute scan_input_axes specifies the axis to be scanned for each scan_input.</code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">39</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">If omitted, every scan_input will be scanned in axis 0. For example, if axis 0 is the</code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">40</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">batch axis and axis 1 is the time axis (to be scanned), specify an axis value of 1.</code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">41</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">Note that scanning a non-zero axis may be less efficient than scanning axis zero.</code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">42</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;"></code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">43</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">The optional attribute scan_output_axes specifies the axis along which the scan_outputs</code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">44</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">are accumulated for each scan_output. For example, if axis 1 is the time axis (to be</code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">45</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">scanned) for both inputs and outputs, specify a scan_input axis and scan_output axis</code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">46</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">value of 1.</code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">47</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">40</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">48</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Note that because of the ONNX restriction that only the last parameter of an operator can</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Note that because of the ONNX restriction that only the last parameter of an operator can</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">41</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">49</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">be variadic, the initial-states and scan-inputs are listed together as one input parameter.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">be variadic, the initial-states and scan-inputs are listed together as one input parameter.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">42</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">50</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Similarly, the final-states and scan-outputs are listed together as one output parameter.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Similarly, the final-states and scan-outputs are listed together as one output parameter.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">43</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">51</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The attribute num_scan_inputs indicates the number M of scan-inputs.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The attribute num_scan_inputs indicates the number M of scan-inputs.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">44</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">52</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">45</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">53</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The behavior of</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The behavior of</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">46</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">54</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">47</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">55</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    Scan <</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    Scan <</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">48</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">56</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        num_scan_inputs = m,</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">        num_scan_inputs = m,</code></td></tr>
<tr style="1px solid black;"><td><code>49</code></td><td><code>57</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;">        body = loop-body</code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code>        body = loop-body<span style="color:#196F3D;">,</span></code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">58</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">        scan_input_axes = [axis_1, ..., axis_m]</code></td></tr>
<tr style="1px solid black;"><td><code>50</code></td><td><code>59</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;">    > (<span style="color:#BA4A00;">s</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;">q</span><span style="color:#BA4A00;">u</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;">n</span><span style="color:#BA4A00;">c</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;">_</span><span style="color:#BA4A00;">l</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;">n</span><span style="color:#BA4A00;">g</span><span style="color:#BA4A00;">t</span><span style="color:#BA4A00;">h</span><span style="color:#BA4A00;">s</span><span style="color:#BA4A00;">,</span><span style="color:#BA4A00;"> </span>init_1, ..., init_n, scan_1, ..., scan_m)</code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code>    > (init_1, ..., init_n, scan_1, ..., scan_m)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">51</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">60</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">52</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">61</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">is equivalent to the following pseudo-code:</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">is equivalent to the following pseudo-code:</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">53</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">62</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#E59866;"><code style="background-color:#E59866;">54</code></td><td></td><td style="background-color:#E59866;"><code style="background-color:#E59866;">    // T.shape[0] denotes the batch-size of T</code></td><td></td></tr>
<tr style="1px solid black;"><td style="background-color:#E59866;"><code style="background-color:#E59866;">55</code></td><td></td><td style="background-color:#E59866;"><code style="background-color:#E59866;">    // The batch-size of scan_1, ..., scan_m are all required to be equal</code></td><td></td></tr>
<tr style="1px solid black;"><td style="background-color:#E59866;"><code style="background-color:#E59866;">56</code></td><td></td><td style="background-color:#E59866;"><code style="background-color:#E59866;">    batch_size = scan_1.shape[0];</code></td><td></td></tr>
<tr style="1px solid black;"><td style="background-color:#E59866;"><code style="background-color:#E59866;">57</code></td><td></td><td style="background-color:#E59866;"><code style="background-color:#E59866;"></code></td><td></td></tr>
<tr style="1px solid black;"><td><code>58</code></td><td><code>63</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;">    // scan_i.shape[<span style="color:#BA4A00;">1</span>] denotes the (max) sequence-length of scan_i</code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code>    // scan_i.shape[<span style="color:#196F3D;">a</span><span style="color:#196F3D;">x</span><span style="color:#196F3D;">i</span><span style="color:#196F3D;">s</span><span style="color:#196F3D;">_</span><span style="color:#196F3D;">i</span>] denotes the (max) sequence-length of scan_i</code></td></tr>
<tr style="1px solid black;"><td><code>59</code></td><td><code>64</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;">    // scan_i.shape[<span style="color:#BA4A00;">1</span>] is required to be equal to scan_j.shape[<span style="color:#BA4A00;">1</span>] for all i,j.</code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code>    // scan_i.shape[<span style="color:#196F3D;">a</span><span style="color:#196F3D;">x</span><span style="color:#196F3D;">i</span><span style="color:#196F3D;">s</span><span style="color:#196F3D;">_</span><span style="color:#196F3D;">i</span>] is required to be equal to scan_j.shape[<span style="color:#196F3D;">a</span><span style="color:#196F3D;">x</span><span style="color:#196F3D;">i</span><span style="color:#196F3D;">s</span><span style="color:#196F3D;">_</span><span style="color:#196F3D;">j</span>] for all i,j.</code></td></tr>
<tr style="1px solid black;"><td><code>60</code></td><td><code>65</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;">    <span style="color:#BA4A00;">m</span><span style="color:#BA4A00;">a</span><span style="color:#BA4A00;">x</span><span style="color:#BA4A00;">_</span>sequence_length = scan_1.shape[1];</code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code>    sequence_length = scan_1.shape[<span style="color:#196F3D;">a</span><span style="color:#196F3D;">x</span><span style="color:#196F3D;">i</span><span style="color:#196F3D;">s</span><span style="color:#196F3D;">_</span>1];</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">61</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">66</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#E59866;"><code style="background-color:#E59866;">62</code></td><td></td><td style="background-color:#E59866;"><code style="background-color:#E59866;">    for (int batch = 0; batch < batch_size; ++batch) {</code></td><td></td></tr>
<tr style="1px solid black;"><td><code>63</code></td><td><code>67</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;">    <span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span>// initialize state-variables</code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code>    // initialize state-variables</code></td></tr>
<tr style="1px solid black;"><td><code>64</code></td><td><code>68</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;">    <span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span>st_1 = init_1; ... st_n = init_n;</code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code>    st_1 = init_1; ... st_n = init_n;</code></td></tr>
<tr style="1px solid black;"><td><code>65</code></td><td><code>69</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;">    <span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span>// initialize scan-output variables: [] denotes an empty tensor</code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code>    // initialize scan-output variables: [] denotes an empty tensor</code></td></tr>
<tr style="1px solid black;"><td><code>66</code></td><td><code>70</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;">    <span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span>scan_out_1 = []; ...; scan_out_k = [];</code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code>    scan_out_1 = []; ...; scan_out_k = [];</code></td></tr>
<tr style="1px solid black;"><td><code>67</code></td><td><code>71</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;">    <span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span>// identify number of iterations:</code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code>    // identify number of iterations:</code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">72</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;"></code></td></tr>
<tr style="1px solid black;"><td><code>68</code></td><td><code>73</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;">     <span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">N</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">=</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">(</span><span style="color:#BA4A00;">s</span>e<span style="color:#BA4A00;">q</span><span style="color:#BA4A00;">u</span>e<span style="color:#BA4A00;">n</span>c<span style="color:#BA4A00;">e</span><span style="color:#BA4A00;">_</span><span style="color:#BA4A00;">l</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;">n</span><span style="color:#BA4A00;">g</span>t<span style="color:#BA4A00;">h</span><span style="color:#BA4A00;">s</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">s</span><span style="color:#BA4A00;">p</span>e<span style="color:#BA4A00;">c</span><span style="color:#BA4A00;">i</span><span style="color:#BA4A00;">f</span><span style="color:#BA4A00;">i</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;">d</span><span style="color:#BA4A00;">)</span> <span style="color:#BA4A00;">?</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">s</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;">q</span><span style="color:#BA4A00;">u</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;">n</span><span style="color:#BA4A00;">c</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;">_</span>l<span style="color:#BA4A00;">e</span><span style="color:#BA4A00;">n</span><span style="color:#BA4A00;">g</span><span style="color:#BA4A00;">t</span><span style="color:#BA4A00;">h</span><span style="color:#BA4A00;">s</span><span style="color:#BA4A00;">[</span><span style="color:#BA4A00;">b</span><span style="color:#BA4A00;">a</span><span style="color:#BA4A00;">t</span><span style="color:#BA4A00;">c</span><span style="color:#BA4A00;">h</span><span style="color:#BA4A00;">]</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">:</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">m</span><span style="color:#BA4A00;">a</span><span style="color:#BA4A00;">x</span><span style="color:#BA4A00;">_</span><span style="color:#BA4A00;">s</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;">q</span><span style="color:#BA4A00;">u</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;">n</span><span style="color:#BA4A00;">c</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;">_</span><span style="color:#BA4A00;">l</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;">n</span><span style="color:#BA4A00;">g</span><span style="color:#BA4A00;">t</span><span style="color:#BA4A00;">h</span><span style="color:#BA4A00;">;</span></code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code>    <span style="color:#196F3D;">/</span><span style="color:#196F3D;">/</span> e<span style="color:#196F3D;">x</span>ec<span style="color:#196F3D;">u</span>te l<span style="color:#196F3D;">o</span><span style="color:#196F3D;">o</span><span style="color:#196F3D;">p</span></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#E59866;"><code style="background-color:#E59866;">69</code></td><td></td><td style="background-color:#E59866;"><code style="background-color:#E59866;"></code></td><td></td></tr>
<tr style="1px solid black;"><td><code>70</code></td><td><code>74</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;">        <span style="color:#BA4A00;">/</span><span style="color:#BA4A00;">/</span> e<span style="color:#BA4A00;">x</span>ec<span style="color:#BA4A00;">u</span>t<span style="color:#BA4A00;">e</span> <span style="color:#BA4A00;">l</span><span style="color:#BA4A00;">o</span><span style="color:#BA4A00;">o</span><span style="color:#BA4A00;">p</span></code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code>    <span style="color:#196F3D;">f</span><span style="color:#196F3D;">o</span><span style="color:#196F3D;">r</span> <span style="color:#196F3D;">(</span><span style="color:#196F3D;">i</span><span style="color:#196F3D;">n</span><span style="color:#196F3D;">t</span> <span style="color:#196F3D;">t</span> <span style="color:#196F3D;">=</span> <span style="color:#196F3D;">0</span><span style="color:#196F3D;">;</span> <span style="color:#196F3D;">t</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;"><</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">s</span>e<span style="color:#196F3D;">q</span><span style="color:#196F3D;">u</span>e<span style="color:#196F3D;">n</span>c<span style="color:#196F3D;">e</span><span style="color:#196F3D;">_</span><span style="color:#196F3D;">l</span><span style="color:#196F3D;">e</span><span style="color:#196F3D;">n</span><span style="color:#196F3D;">g</span>t<span style="color:#196F3D;">h</span><span style="color:#196F3D;">;</span> <span style="color:#196F3D;">+</span><span style="color:#196F3D;">+</span><span style="color:#196F3D;">t</span><span style="color:#196F3D;">)</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">{</span></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#E59866;"><code style="background-color:#E59866;">71</code></td><td></td><td style="background-color:#E59866;"><code style="background-color:#E59866;">        for (int t = 0; t < N; ++t) {</code></td><td></td></tr>
<tr style="1px solid black;"><td><code>72</code></td><td><code>75</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;">        <span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span>// generate the scan-input elements: the notation T<axis=k>[t] indicates the sub-tensor</code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code>        // generate the scan-input elements: the notation T<axis=k>[t] indicates the sub-tensor</code></td></tr>
<tr style="1px solid black;"><td><code>73</code></td><td><code>76</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;">        <span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span>// of rank one less than T obtained by indexing T at position t along axis k.</code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code>        // of rank one less than T obtained by indexing T at position t along axis k.</code></td></tr>
<tr style="1px solid black;"><td><code>74</code></td><td><code>77</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;">        <span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span>si_1 = <span style="color:#BA4A00;">(</span>scan_1<axis=<span style="color:#BA4A00;">0</span><span style="color:#BA4A00;">></span><span style="color:#BA4A00;">[</span><span style="color:#BA4A00;">b</span>a<span style="color:#BA4A00;">t</span><span style="color:#BA4A00;">c</span><span style="color:#BA4A00;">h</span><span style="color:#BA4A00;">]</span><span style="color:#BA4A00;">)</span><span style="color:#BA4A00;"><</span><span style="color:#BA4A00;">a</span>xis<span style="color:#BA4A00;">=</span>1>[t];</code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code>        si_1 = scan_1<axis=axis<span style="color:#196F3D;">_</span>1>[t];</code></td></tr>
<tr style="1px solid black;"><td><code>75</code></td><td><code>78</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;">        <span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span>... ;</code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code>        ... ;</code></td></tr>
<tr style="1px solid black;"><td><code>76</code></td><td><code>79</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;">        <span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span>si_m = <span style="color:#BA4A00;">(</span>scan_m<axis=<span style="color:#BA4A00;">0</span><span style="color:#BA4A00;">></span><span style="color:#BA4A00;">[</span><span style="color:#BA4A00;">b</span>a<span style="color:#BA4A00;">t</span><span style="color:#BA4A00;">c</span><span style="color:#BA4A00;">h</span><span style="color:#BA4A00;">]</span><span style="color:#BA4A00;">)</span><span style="color:#BA4A00;"><</span><span style="color:#BA4A00;">a</span>xis<span style="color:#BA4A00;">=</span><span style="color:#BA4A00;">1</span>>[t];</code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code>        si_m = scan_m<axis=axis<span style="color:#196F3D;">_</span><span style="color:#196F3D;">m</span>>[t];</code></td></tr>
<tr style="1px solid black;"><td><code>77</code></td><td><code>80</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;">        <span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span>// execute loop-body</code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code>        // execute loop-body</code></td></tr>
<tr style="1px solid black;"><td><code>78</code></td><td><code>81</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;">        <span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span>st_1, ..., st_n, so_1, ..., so_k = loop-body(st_1, ..., st_n, si_1, ..., si_m)</code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code>        st_1, ..., st_n, so_1, ..., so_k = loop-body(st_1, ..., st_n, si_1, ..., si_m)</code></td></tr>
<tr style="1px solid black;"><td><code>79</code></td><td><code>82</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;">        <span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span>// accumulate the scan-output elements</code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code>        // accumulate the scan-output elements</code></td></tr>
<tr style="1px solid black;"><td><code>80</code></td><td><code>83</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;">        <span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span>scan_out_1 = Concat<axis=0>(scan_out_1, so_1); ... ; scan_out_k = Concat<axis=0>(scan_out_k, so_k);</code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code>        scan_out_1 = Concat<axis=0>(scan_out_1, so_1); ... ; scan_out_k = Concat<axis=0>(scan_out_k, so_k);</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#E59866;"><code style="background-color:#E59866;">81</code></td><td></td><td style="background-color:#E59866;"><code style="background-color:#E59866;">        }</code></td><td></td></tr>
<tr style="1px solid black;"><td style="background-color:#E59866;"><code style="background-color:#E59866;">82</code></td><td></td><td style="background-color:#E59866;"><code style="background-color:#E59866;">        // accumulate the outputs for this batch:</code></td><td></td></tr>
<tr style="1px solid black;"><td style="background-color:#E59866;"><code style="background-color:#E59866;">83</code></td><td></td><td style="background-color:#E59866;"><code style="background-color:#E59866;">        bst_1[batch] = st_1; ..., bst_n[batch] = st_n;</code></td><td></td></tr>
<tr style="1px solid black;"><td style="background-color:#E59866;"><code style="background-color:#E59866;">84</code></td><td></td><td style="background-color:#E59866;"><code style="background-color:#E59866;">        // Note scan-outputs will have size max_sequence_length, but only first N values will be meaningful.</code></td><td></td></tr>
<tr style="1px solid black;"><td style="background-color:#E59866;"><code style="background-color:#E59866;">85</code></td><td></td><td style="background-color:#E59866;"><code style="background-color:#E59866;">        // The remaining values have an undefined value.</code></td><td></td></tr>
<tr style="1px solid black;"><td style="background-color:#E59866;"><code style="background-color:#E59866;">86</code></td><td></td><td style="background-color:#E59866;"><code style="background-color:#E59866;">        b_scan_out_1[batch] = scan_out_1; ...; b_scan_out_k[batch] = scan_out_k;</code></td><td></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">87</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">84</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    }</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    }</code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">85</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;"></code></td></tr>
<tr style="1px solid black;"><td><code>88</code></td><td><code>86</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;">    return <span style="color:#BA4A00;">b</span>st_1, ..., <span style="color:#BA4A00;">b</span>st_n, <span style="color:#BA4A00;">b</span><span style="color:#BA4A00;">_</span>scan_out_1, ..., <span style="color:#BA4A00;">b</span><span style="color:#BA4A00;">_</span>scan_out_k;</code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code>    return st_1, ..., st_n, scan_out_1, ..., scan_out_k;</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">89</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">87</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">90</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">88</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">*Sample usage: Encoding RNN using a Scan*</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">*Sample usage: Encoding RNN using a Scan*</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">91</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">89</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">92</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">90</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The following example shows how a simple RNN over an input tensor %X, with weight tensor %Wi,</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">The following example shows how a simple RNN over an input tensor %X, with weight tensor %Wi,</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">93</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">91</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">recurrence weight tensor %Ri, bias tensors %Wbi and %Rbi, and initial hidden-state %H_0 can</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">recurrence weight tensor %Ri, bias tensors %Wbi and %Rbi, and initial hidden-state %H_0 can</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">94</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">92</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">be encoded as a ScanLoop. Note that the loop-body is a nested graph, and it directly computes</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">be encoded as a ScanLoop. Note that the loop-body is a nested graph, and it directly computes</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">95</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">93</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">%Wi, %Ri, %Wbi, and %Rbi (typically constants or initializers in the body graph). If these</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">%Wi, %Ri, %Wbi, and %Rbi (typically constants or initializers in the body graph). If these</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">96</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">94</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">values are computed in the outer graph, they need to be passed in as extra state_variables.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">values are computed in the outer graph, they need to be passed in as extra state_variables.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">97</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">95</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">98</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">96</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    graph rnn-encoding {</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    graph rnn-encoding {</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">99</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">97</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %H_0 = ...</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %H_0 = ...</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">100</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">98</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %X = ...</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %X = ...</code></td></tr>
<tr style="1px solid black;"><td><code>101</code></td><td><code>99</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;">      %Y_h, %Y = Scan[body = <graph rnn-cell-1>, num_scan_inputs=1](<span style="color:#BA4A00;">"</span><span style="color:#BA4A00;">"</span><span style="color:#BA4A00;">,</span><span style="color:#BA4A00;"> </span>%H_0, %X)</code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code>      %Y_h, %Y = Scan[body = <graph rnn-cell-1>, num_scan_inputs=1](%H_0, %X)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">102</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">100</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      return %Y, %Y_h</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      return %Y, %Y_h</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">103</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">101</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    }</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    }</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">104</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">102</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">105</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">103</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    graph rnn-cell-1 (</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    graph rnn-cell-1 (</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">106</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">104</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %H_tminus1[FLOAT, tensor]</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %H_tminus1[FLOAT, tensor]</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">107</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">105</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %X_t[FLOAT, tensor]</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %X_t[FLOAT, tensor]</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">108</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">106</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    ) {</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    ) {</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">109</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">107</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Wi = ...</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Wi = ...</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">110</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">108</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Ri = ...</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Ri = ...</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">111</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">109</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Wbi = ...</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Wbi = ...</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">112</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">110</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Rbi = ...</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Rbi = ...</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">113</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">111</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %t1 = X_t * (Wi^T)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %t1 = X_t * (Wi^T)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">114</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">112</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %t2 = H_tminus1*(Ri^T)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %t2 = H_tminus1*(Ri^T)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">115</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">113</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %t3 = Add(%t1, %t2)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %t3 = Add(%t1, %t2)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">116</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">114</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %t4 = Add(%t3, %Wbi)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %t4 = Add(%t3, %Wbi)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">117</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">115</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %t5 = Add(%t4, %Rbi)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %t5 = Add(%t4, %Rbi)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">118</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">116</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Ht = Tanh(%t5)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Ht = Tanh(%t5)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">119</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">117</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Accumulate = Identity(%Ht)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      %Accumulate = Identity(%Ht)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">120</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">118</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      return %Ht, %Accumulate</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">      return %Ht, %Accumulate</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">121</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">119</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    }</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">    }</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">122</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">120</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">123</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">121</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">**Attributes**</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">**Attributes**</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">124</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">122</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">125</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">123</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **body** (required):</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **body** (required):</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">126</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">124</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  The graph run each iteration. It has N+M inputs: (loop state</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  The graph run each iteration. It has N+M inputs: (loop state</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">127</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">125</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  variables..., scan_input_elts...). It has N+K outputs: (loop state</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  variables..., scan_input_elts...). It has N+K outputs: (loop state</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">128</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">126</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  variables..., scan_output_elts...). Each scan_output is created by</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  variables..., scan_output_elts...). Each scan_output is created by</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">129</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">127</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  concatenating the value of the specified scan_output_elt value at</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  concatenating the value of the specified scan_output_elt value at</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">130</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">128</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  the end of each iteration of the loop. It is an error if the</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  the end of each iteration of the loop. It is an error if the</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">131</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">129</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  dimensions of these values change across loop iterations.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  dimensions of these values change across loop iterations.</code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">130</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">* **num_scan_inputs** (required):</code></td></tr>
<tr style="1px solid black;"><td><code>132</code></td><td><code>131</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><span style="color:#BA4A00;">*</span> <span style="color:#BA4A00;">*</span><span style="color:#BA4A00;">*</span><span style="color:#BA4A00;">d</span>i<span style="color:#BA4A00;">r</span>ect<span style="color:#BA4A00;">i</span>ons<span style="color:#BA4A00;">*</span><span style="color:#BA4A00;">*</span><span style="color:#BA4A00;">:</span></code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code> <span style="color:#196F3D;"> </span><span style="color:#196F3D;">A</span><span style="color:#196F3D;">n</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">a</span><span style="color:#196F3D;">t</span><span style="color:#196F3D;">t</span><span style="color:#196F3D;">r</span>i<span style="color:#196F3D;">b</span><span style="color:#196F3D;">u</span><span style="color:#196F3D;">t</span>e<span style="color:#196F3D;"> </span><span style="color:#196F3D;">s</span><span style="color:#196F3D;">p</span><span style="color:#196F3D;">e</span>c<span style="color:#196F3D;">i</span><span style="color:#196F3D;">f</span><span style="color:#196F3D;">y</span><span style="color:#196F3D;">i</span><span style="color:#196F3D;">n</span><span style="color:#196F3D;">g</span><span style="color:#196F3D;"> </span>t<span style="color:#196F3D;">h</span><span style="color:#196F3D;">e</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">n</span><span style="color:#196F3D;">u</span><span style="color:#196F3D;">m</span><span style="color:#196F3D;">b</span><span style="color:#196F3D;">e</span><span style="color:#196F3D;">r</span><span style="color:#196F3D;"> </span>o<span style="color:#196F3D;">f</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">s</span><span style="color:#196F3D;">c</span><span style="color:#196F3D;">a</span>n<span style="color:#196F3D;">_</span><span style="color:#196F3D;">i</span><span style="color:#196F3D;">n</span><span style="color:#196F3D;">p</span><span style="color:#196F3D;">u</span><span style="color:#196F3D;">t</span>s<span style="color:#196F3D;"> </span><span style="color:#196F3D;">M</span><span style="color:#196F3D;">.</span></code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">132</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">* **scan_input_axes**:</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">133</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">133</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  An optional list of M flags. The i-th element of the list specifies</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  An optional list of M flags. The i-th element of the list specifies</code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">134</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">  the axis to be scanned (the sequence axis) for the i-th scan_input.</code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">135</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">  If omitted, 0 will be used as the scan axis for every scan_input.</code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">136</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">* **scan_input_directions**:</code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">137</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">  An optional list of M flags. The i-th element of the list specifies</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">134</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">138</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  the direction to be scanned for the i-th scan_input tensor: 0</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  the direction to be scanned for the i-th scan_input tensor: 0</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">135</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">139</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  indicates forward direction and 1 indicates reverse direction. If</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  indicates forward direction and 1 indicates reverse direction. If</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">136</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">140</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  omitted, all scan_input tensors will be scanned in the forward</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  omitted, all scan_input tensors will be scanned in the forward</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#E59866;"><code style="background-color:#E59866;">137</code></td><td></td><td style="background-color:#E59866;"><code style="background-color:#E59866;">  direction.</code></td><td></td></tr>
<tr style="1px solid black;"><td><code>138</code></td><td><code>141</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><span style="color:#BA4A00;">*</span> <span style="color:#BA4A00;">*</span><span style="color:#BA4A00;">*</span><span style="color:#BA4A00;">n</span><span style="color:#BA4A00;">u</span><span style="color:#BA4A00;">m</span><span style="color:#BA4A00;">_</span><span style="color:#BA4A00;">s</span><span style="color:#BA4A00;">c</span><span style="color:#BA4A00;">a</span><span style="color:#BA4A00;">n</span><span style="color:#BA4A00;">_</span>i<span style="color:#BA4A00;">n</span><span style="color:#BA4A00;">p</span><span style="color:#BA4A00;">u</span><span style="color:#BA4A00;">t</span><span style="color:#BA4A00;">s</span><span style="color:#BA4A00;">*</span><span style="color:#BA4A00;">*</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">(</span>re<span style="color:#BA4A00;">q</span><span style="color:#BA4A00;">u</span>i<span style="color:#BA4A00;">r</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;">d</span><span style="color:#BA4A00;">)</span><span style="color:#BA4A00;">:</span></code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code> <span style="color:#196F3D;"> </span><span style="color:#196F3D;">d</span>ire<span style="color:#196F3D;">c</span><span style="color:#196F3D;">t</span>i<span style="color:#196F3D;">o</span><span style="color:#196F3D;">n</span><span style="color:#196F3D;">.</span></code></td></tr>
<tr style="1px solid black;"><td><code>139</code></td><td><code>142</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"> <span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">A</span><span style="color:#BA4A00;">n</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">a</span><span style="color:#BA4A00;">t</span><span style="color:#BA4A00;">t</span><span style="color:#BA4A00;">r</span><span style="color:#BA4A00;">i</span><span style="color:#BA4A00;">b</span><span style="color:#BA4A00;">u</span><span style="color:#BA4A00;">t</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;"> </span>s<span style="color:#BA4A00;">p</span><span style="color:#BA4A00;">e</span>c<span style="color:#BA4A00;">i</span><span style="color:#BA4A00;">f</span><span style="color:#BA4A00;">y</span><span style="color:#BA4A00;">i</span><span style="color:#BA4A00;">n</span><span style="color:#BA4A00;">g</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">t</span><span style="color:#BA4A00;">h</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">n</span><span style="color:#BA4A00;">u</span><span style="color:#BA4A00;">m</span><span style="color:#BA4A00;">b</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;">r</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">o</span><span style="color:#BA4A00;">f</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">s</span><span style="color:#BA4A00;">c</span>an_<span style="color:#BA4A00;">i</span><span style="color:#BA4A00;">n</span>puts<span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">M</span><span style="color:#BA4A00;">.</span></code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code><span style="color:#196F3D;">*</span> <span style="color:#196F3D;">*</span><span style="color:#196F3D;">*</span>scan_<span style="color:#196F3D;">o</span><span style="color:#196F3D;">u</span><span style="color:#196F3D;">t</span>put<span style="color:#196F3D;">_</span><span style="color:#196F3D;">a</span><span style="color:#196F3D;">x</span><span style="color:#196F3D;">e</span>s<span style="color:#196F3D;">*</span><span style="color:#196F3D;">*</span><span style="color:#196F3D;">:</span></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#E59866;"><code style="background-color:#E59866;">140</code></td><td></td><td style="background-color:#E59866;"><code style="background-color:#E59866;"></code></td><td></td></tr>
<tr style="1px solid black;"><td><code>141</code></td><td><code>143</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><span style="color:#BA4A00;">*</span><span style="color:#BA4A00;">*</span><span style="color:#BA4A00;">I</span>np<span style="color:#BA4A00;">u</span>ts<span style="color:#BA4A00;">*</span><span style="color:#BA4A00;">*</span></code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code><span style="color:#196F3D;"> </span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">A</span>n<span style="color:#196F3D;"> </span><span style="color:#196F3D;">o</span>pt<span style="color:#196F3D;">i</span><span style="color:#196F3D;">o</span><span style="color:#196F3D;">n</span><span style="color:#196F3D;">a</span><span style="color:#196F3D;">l</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">l</span><span style="color:#196F3D;">i</span>s<span style="color:#196F3D;">t</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">o</span><span style="color:#196F3D;">f</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">K</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">f</span><span style="color:#196F3D;">l</span><span style="color:#196F3D;">a</span><span style="color:#196F3D;">g</span><span style="color:#196F3D;">s</span><span style="color:#196F3D;">.</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">T</span><span style="color:#196F3D;">h</span><span style="color:#196F3D;">e</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">i</span><span style="color:#196F3D;">-</span><span style="color:#196F3D;">t</span><span style="color:#196F3D;">h</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">e</span><span style="color:#196F3D;">l</span><span style="color:#196F3D;">e</span><span style="color:#196F3D;">m</span><span style="color:#196F3D;">e</span><span style="color:#196F3D;">n</span><span style="color:#196F3D;">t</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">o</span><span style="color:#196F3D;">f</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">t</span><span style="color:#196F3D;">h</span><span style="color:#196F3D;">e</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">l</span><span style="color:#196F3D;">i</span><span style="color:#196F3D;">s</span><span style="color:#196F3D;">t</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">s</span><span style="color:#196F3D;">p</span><span style="color:#196F3D;">e</span><span style="color:#196F3D;">c</span><span style="color:#196F3D;">i</span><span style="color:#196F3D;">f</span><span style="color:#196F3D;">i</span><span style="color:#196F3D;">e</span><span style="color:#196F3D;">s</span></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#E59866;"><code style="background-color:#E59866;">142</code></td><td></td><td style="background-color:#E59866;"><code style="background-color:#E59866;"></code></td><td></td></tr>
<tr style="1px solid black;"><td><code>143</code></td><td><code>144</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><span style="color:#BA4A00;">B</span>et<span style="color:#BA4A00;">w</span>e<span style="color:#BA4A00;">e</span><span style="color:#BA4A00;">n</span> <span style="color:#BA4A00;">2</span> an<span style="color:#BA4A00;">d</span> <span style="color:#BA4A00;">2</span><span style="color:#BA4A00;">1</span><span style="color:#BA4A00;">4</span><span style="color:#BA4A00;">7</span><span style="color:#BA4A00;">4</span><span style="color:#BA4A00;">8</span><span style="color:#BA4A00;">3</span><span style="color:#BA4A00;">6</span><span style="color:#BA4A00;">4</span><span style="color:#BA4A00;">7</span> <span style="color:#BA4A00;">i</span>nputs<span style="color:#BA4A00;">.</span></code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code><span style="color:#196F3D;"> </span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">t</span><span style="color:#196F3D;">h</span>e<span style="color:#196F3D;"> </span><span style="color:#196F3D;">a</span><span style="color:#196F3D;">x</span><span style="color:#196F3D;">i</span><span style="color:#196F3D;">s</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">f</span><span style="color:#196F3D;">o</span><span style="color:#196F3D;">r</span><span style="color:#196F3D;"> </span>t<span style="color:#196F3D;">h</span>e <span style="color:#196F3D;">i</span><span style="color:#196F3D;">-</span><span style="color:#196F3D;">t</span><span style="color:#196F3D;">h</span> <span style="color:#196F3D;">s</span><span style="color:#196F3D;">c</span>an<span style="color:#196F3D;">_</span><span style="color:#196F3D;">o</span><span style="color:#196F3D;">u</span><span style="color:#196F3D;">t</span><span style="color:#196F3D;">p</span><span style="color:#196F3D;">u</span><span style="color:#196F3D;">t</span><span style="color:#196F3D;">.</span> <span style="color:#196F3D;">T</span><span style="color:#196F3D;">h</span><span style="color:#196F3D;">e</span> <span style="color:#196F3D;">s</span><span style="color:#196F3D;">c</span><span style="color:#196F3D;">a</span>n<span style="color:#196F3D;"> </span><span style="color:#196F3D;">o</span><span style="color:#196F3D;">u</span><span style="color:#196F3D;">t</span>puts<span style="color:#196F3D;"> </span><span style="color:#196F3D;">a</span><span style="color:#196F3D;">r</span><span style="color:#196F3D;">e</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">a</span><span style="color:#196F3D;">c</span><span style="color:#196F3D;">c</span><span style="color:#196F3D;">u</span><span style="color:#196F3D;">m</span><span style="color:#196F3D;">u</span><span style="color:#196F3D;">l</span><span style="color:#196F3D;">a</span><span style="color:#196F3D;">t</span><span style="color:#196F3D;">e</span><span style="color:#196F3D;">d</span></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#E59866;"><code style="background-color:#E59866;">144</code></td><td></td><td style="background-color:#E59866;"><code style="background-color:#E59866;"></code></td><td></td></tr>
<tr style="1px solid black;"><td style="background-color:#E59866;"><code style="background-color:#E59866;">145</code></td><td></td><td style="background-color:#E59866;"><code style="background-color:#E59866;">* **sequence_lens** (optional, heterogeneous) - **I**:</code></td><td></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">145</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">  along the specified axis. If omitted, 0 will be used as the scan</code></td></tr>
<tr style="1px solid black;"><td><code>146</code></td><td><code>146</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;">  <span style="color:#BA4A00;">O</span><span style="color:#BA4A00;">p</span><span style="color:#BA4A00;">t</span>io<span style="color:#BA4A00;">n</span><span style="color:#BA4A00;">a</span><span style="color:#BA4A00;">l</span> <span style="color:#BA4A00;">t</span>e<span style="color:#BA4A00;">n</span><span style="color:#BA4A00;">s</span><span style="color:#BA4A00;">o</span>r s<span style="color:#BA4A00;">p</span><span style="color:#BA4A00;">e</span>c<span style="color:#BA4A00;">i</span><span style="color:#BA4A00;">f</span><span style="color:#BA4A00;">y</span><span style="color:#BA4A00;">i</span>n<span style="color:#BA4A00;">g</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">l</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;">n</span><span style="color:#BA4A00;">g</span><span style="color:#BA4A00;">t</span><span style="color:#BA4A00;">h</span><span style="color:#BA4A00;">s</span><span style="color:#BA4A00;"> </span>o<span style="color:#BA4A00;">f</span><span style="color:#BA4A00;"> </span>t<span style="color:#BA4A00;">h</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">s</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;">q</span>u<span style="color:#BA4A00;">e</span><span style="color:#BA4A00;">n</span><span style="color:#BA4A00;">c</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;">s</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">i</span><span style="color:#BA4A00;">n</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">a</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">b</span><span style="color:#BA4A00;">a</span>t<span style="color:#BA4A00;">c</span><span style="color:#BA4A00;">h</span>.<span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">I</span><span style="color:#BA4A00;">f</span></code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code>  <span style="color:#196F3D;">a</span><span style="color:#196F3D;">x</span>i<span style="color:#196F3D;">s</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">f</span>o<span style="color:#196F3D;">r</span> e<span style="color:#196F3D;">v</span><span style="color:#196F3D;">e</span>r<span style="color:#196F3D;">y</span> sc<span style="color:#196F3D;">a</span>n<span style="color:#196F3D;">_</span>o<span style="color:#196F3D;">u</span>t<span style="color:#196F3D;">p</span>ut.</code></td></tr>
<tr style="1px solid black;"><td><code>147</code></td><td><code>147</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"> <span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">t</span><span style="color:#BA4A00;">h</span><span style="color:#BA4A00;">i</span>s<span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">i</span>nput<span style="color:#BA4A00;"> </span>i<span style="color:#BA4A00;">s</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">n</span><span style="color:#BA4A00;">o</span><span style="color:#BA4A00;">t</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">s</span><span style="color:#BA4A00;">p</span>eci<span style="color:#BA4A00;">f</span><span style="color:#BA4A00;">i</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;">d</span><span style="color:#BA4A00;">,</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">a</span><span style="color:#BA4A00;">l</span><span style="color:#BA4A00;">l</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">s</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;">q</span><span style="color:#BA4A00;">u</span><span style="color:#BA4A00;">e</span>n<span style="color:#BA4A00;">c</span><span style="color:#BA4A00;">e</span>s<span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">a</span><span style="color:#BA4A00;">r</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">a</span><span style="color:#BA4A00;">s</span><span style="color:#BA4A00;">s</span><span style="color:#BA4A00;">u</span><span style="color:#BA4A00;">m</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;">d</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">t</span><span style="color:#BA4A00;">o</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">b</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">o</span><span style="color:#BA4A00;">f</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">t</span><span style="color:#BA4A00;">h</span><span style="color:#BA4A00;">e</span></code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code><span style="color:#196F3D;">*</span> <span style="color:#196F3D;">*</span><span style="color:#196F3D;">*</span>s<span style="color:#196F3D;">c</span><span style="color:#196F3D;">a</span>n<span style="color:#196F3D;">_</span><span style="color:#196F3D;">o</span><span style="color:#196F3D;">u</span><span style="color:#196F3D;">t</span>put<span style="color:#196F3D;">_</span><span style="color:#196F3D;">d</span>i<span style="color:#196F3D;">r</span>ec<span style="color:#196F3D;">t</span>i<span style="color:#196F3D;">o</span>ns<span style="color:#196F3D;">*</span><span style="color:#196F3D;">*</span><span style="color:#196F3D;">:</span></code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">148</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">  An optional list of K flags, one for each scan_output. The i-th</code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">149</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">  element of the list specifies whether the i-th scan_output should be</code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">150</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">  constructed by appending or prepending a new value in each</code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">151</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">  iteration: 0 indicates appending and 1 indicates prepending. If</code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">152</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">  omitted, all scan_output tensors will be produced by appending a</code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">153</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">  value in each iteration.</code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">154</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;"></code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">155</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">**Inputs**</code></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">156</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;"></code></td></tr>
<tr style="1px solid black;"><td><code>148</code></td><td><code>157</code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">m</span><span style="color:#BA4A00;">a</span><span style="color:#BA4A00;">x</span><span style="color:#BA4A00;">i</span><span style="color:#BA4A00;">m</span><span style="color:#BA4A00;">u</span><span style="color:#BA4A00;">m</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">s</span>e<span style="color:#BA4A00;">q</span><span style="color:#BA4A00;">u</span>en<span style="color:#BA4A00;">c</span><span style="color:#BA4A00;">e</span> <span style="color:#BA4A00;">l</span><span style="color:#BA4A00;">e</span>n<span style="color:#BA4A00;">g</span><span style="color:#BA4A00;">t</span><span style="color:#BA4A00;">h</span> <span style="color:#BA4A00;">(</span><span style="color:#BA4A00;">t</span><span style="color:#BA4A00;">h</span><span style="color:#BA4A00;">e</span> <span style="color:#BA4A00;">d</span>i<span style="color:#BA4A00;">m</span><span style="color:#BA4A00;">e</span>n<span style="color:#BA4A00;">s</span><span style="color:#BA4A00;">i</span><span style="color:#BA4A00;">o</span><span style="color:#BA4A00;">n</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">o</span><span style="color:#BA4A00;">f</span><span style="color:#BA4A00;"> </span>t<span style="color:#BA4A00;">h</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;"> </span>s<span style="color:#BA4A00;">e</span><span style="color:#BA4A00;">q</span><span style="color:#BA4A00;">u</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;">n</span><span style="color:#BA4A00;">c</span><span style="color:#BA4A00;">e</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">a</span><span style="color:#BA4A00;">x</span><span style="color:#BA4A00;">i</span><span style="color:#BA4A00;">s</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">o</span><span style="color:#BA4A00;">f</span><span style="color:#BA4A00;"> </span><span style="color:#BA4A00;">t</span><span style="color:#BA4A00;">h</span><span style="color:#BA4A00;">e</span></code></code></td><td style="background-color:#E5E7E9;"><code style="background-color:#E5E7E9;"><code><span style="color:#196F3D;">B</span>e<span style="color:#196F3D;">t</span><span style="color:#196F3D;">w</span>e<span style="color:#196F3D;">e</span>n <span style="color:#196F3D;">1</span><span style="color:#196F3D;"> </span><span style="color:#196F3D;">a</span>n<span style="color:#196F3D;">d</span> <span style="color:#196F3D;">2</span><span style="color:#196F3D;">1</span><span style="color:#196F3D;">4</span><span style="color:#196F3D;">7</span><span style="color:#196F3D;">4</span><span style="color:#196F3D;">8</span><span style="color:#196F3D;">3</span><span style="color:#196F3D;">6</span><span style="color:#196F3D;">4</span><span style="color:#196F3D;">7</span> in<span style="color:#196F3D;">p</span><span style="color:#196F3D;">u</span>ts<span style="color:#196F3D;">.</span></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#E59866;"><code style="background-color:#E59866;">149</code></td><td></td><td style="background-color:#E59866;"><code style="background-color:#E59866;">  scan_input tensors).</code></td><td></td></tr>
<tr style="1px solid black;"><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;">158</code></td><td></td><td style="background-color:#ABEBC6;"><code style="background-color:#ABEBC6;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">150</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">159</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **initial_state_and_scan_inputs** (variadic) - **V**:</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **initial_state_and_scan_inputs** (variadic) - **V**:</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">151</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">160</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  Initial values of the loop's N state variables followed by M</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  Initial values of the loop's N state variables followed by M</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">152</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">161</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  scan_inputs</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  scan_inputs</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">153</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">162</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">154</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">163</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">**Outputs**</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">**Outputs**</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">155</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">164</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">156</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">165</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Between 1 and 2147483647 outputs.</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">Between 1 and 2147483647 outputs.</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">157</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">166</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">158</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">167</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **final_state_and_scan_outputs** (variadic) - **V**:</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **final_state_and_scan_outputs** (variadic) - **V**:</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">159</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">168</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  Final values of the loop's N state variables followed by K</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  Final values of the loop's N state variables followed by K</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">160</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">169</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  scan_outputs</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  scan_outputs</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">161</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">170</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">162</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">171</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">**Type Constraints**</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">**Type Constraints**</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">163</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">172</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;"></code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">164</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">173</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **I** in (</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **I** in (</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">165</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">174</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(int64)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(int64)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">166</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">175</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  ):</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  ):</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">167</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">176</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  Int64 tensor</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  Int64 tensor</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">168</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">177</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **V** in (</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">* **V** in (</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">169</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">178</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(bool),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(bool),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">170</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">179</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(complex128),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(complex128),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">171</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">180</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(complex64),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(complex64),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">172</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">181</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(double),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(double),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">173</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">182</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(float),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(float),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">174</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">183</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(float16),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(float16),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">175</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">184</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(int16),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(int16),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">176</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">185</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(int32),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(int32),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">177</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">186</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(int64),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(int64),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">178</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">187</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(int8),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(int8),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">179</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">188</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(string),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(string),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">180</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">189</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(uint16),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(uint16),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">181</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">190</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(uint32),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(uint32),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">182</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">191</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(uint64),</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(uint64),</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">183</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">192</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(uint8)</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  tensor(uint8)</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">184</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">193</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  ):</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  ):</code></td></tr>
<tr style="1px solid black;"><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">185</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">194</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  All Tensor types</code></td><td style="background-color:#FFFFFF;"><code style="background-color:#FFFFFF;">  All Tensor types</code></td></tr>
</table></section>
<section id="scan-8">
<span id="l-onnx-op-scan-8"></span><h2><a class="toc-backref" href="#id7">Scan - 8</a><a class="headerlink" href="#scan-8" title="Permalink to this headline">#</a></h2>
<p><strong>Version</strong></p>
<ul class="simple">
<li><p><strong>name</strong>: <a class="reference external" href="https://github.com/onnx/onnx/blob/main/docs/Operators.md#Scan">Scan (GitHub)</a></p></li>
<li><p><strong>domain</strong>: <strong>main</strong></p></li>
<li><p><strong>since_version</strong>: <strong>8</strong></p></li>
<li><p><strong>function</strong>: False</p></li>
<li><p><strong>support_level</strong>: SupportType.COMMON</p></li>
<li><p><strong>shape inference</strong>: True</p></li>
</ul>
<p>This version of the operator has been available
<strong>since version 8</strong>.</p>
<p><strong>Summary</strong></p>
<p>Scan can be used to iterate over one or more scan_input tensors,
constructing zero or more scan_output tensors. It combines ideas from general recurrences,
functional programming constructs such as scan, fold, map, and zip and is intended to enable
generalizations of RNN-like constructs for sequence-to-sequence processing.
Other tensors (referred to as state_variables here) can be used to carry a state
when iterating from one element to another (similar to hidden-state in RNNs, also referred
to as loop-carried dependences in the context of loops). All these tensors are required to
have the same shape in each iteration of the loop (a restriction imposed to enable efficient
memory allocation). Many common usages involve a single scan_input tensor (where functionality
similar to scan, fold and map can be obtained). When more than one scan_input is used,
a behavior similar to zip is obtained.</p>
<p>The attribute body must be a graph, specifying the computation to be performed in
every iteration. It takes as input the current values of the state_variables and
the current iterated element of the scan_inputs. It must return the (updated) values
of the state_variables and zero or more scan_output_element tensors. The values of the
scan_output_element tensors are concatenated over all the iterations to produce the
scan_output values of the scan construct (similar to the concatenated intermediate
hidden-state values of RNN-like constructs).</p>
<p>The scan operation returns the final values of the state_variables as well as the
scan_outputs.</p>
<p>The operation supports batching, and the batch-axis is required to be 0.
When multiple scan_input tensors are used, they must all have the same batch-size,
and they must all have the same maximum-sequence-length (the dimensionality of the
sequence axis or scan axis). The sequence axis or scan axis is required to be 1.</p>
<p>The operation has an optional sequence_lens input (of shape [BATCH_SIZE]) to
allow variable length sequences of length &lt;= the maximum-sequence-length. If this
input is not specified, all sequences are assumed to be of length equal to
maximum-sequence-length. For variable length input sequences, the scan_outputs
will consist of a sequence of same length as the input, padded to the
maximum-sequence-length.</p>
<p>The optional attribute directions can be used to scan a sequence in the reverse direction.
If this attribute is omitted, all sequences are scanned in the forward direction.
A bidirectional scan be performed by specifying the same tensor input twice in the
scan_inputs, once with a forward direction, and once with a backward direction.</p>
<p>Note that because of the ONNX restriction that only the last parameter of an operator can
be variadic, the initial-states and scan-inputs are listed together as one input parameter.
Similarly, the final-states and scan-outputs are listed together as one output parameter.
The attribute num_scan_inputs indicates the number M of scan-inputs.</p>
<p>The behavior of</p>
<blockquote>
<div><dl class="simple">
<dt>Scan &lt;</dt><dd><p>num_scan_inputs = m,
body = loop-body</p>
</dd>
</dl>
<p>&gt; (sequence_lengths, init_1, …, init_n, scan_1, …, scan_m)</p>
</div></blockquote>
<p>is equivalent to the following pseudo-code:</p>
<blockquote>
<div><p>// T.shape[0] denotes the batch-size of T
// The batch-size of scan_1, …, scan_m are all required to be equal
batch_size = scan_1.shape[0];</p>
<p>// scan_i.shape[1] denotes the (max) sequence-length of scan_i
// scan_i.shape[1] is required to be equal to scan_j.shape[1] for all i,j.
max_sequence_length = scan_1.shape[1];</p>
<dl>
<dt>for (int batch = 0; batch &lt; batch_size; ++batch) {</dt><dd><p>// initialize state-variables
st_1 = init_1; … st_n = init_n;
// initialize scan-output variables: [] denotes an empty tensor
scan_out_1 = []; …; scan_out_k = [];
// identify number of iterations:
N = (sequence_lengths specified) ? sequence_lengths[batch] : max_sequence_length;</p>
<p>// execute loop
for (int t = 0; t &lt; N; ++t) {</p>
<blockquote>
<div><p>// generate the scan-input elements: the notation T&lt;axis=k&gt;[t] indicates the sub-tensor
// of rank one less than T obtained by indexing T at position t along axis k.
si_1 = (scan_1&lt;axis=0&gt;[batch])&lt;axis=1&gt;[t];
… ;
si_m = (scan_m&lt;axis=0&gt;[batch])&lt;axis=1&gt;[t];
// execute loop-body
st_1, …, st_n, so_1, …, so_k = loop-body(st_1, …, st_n, si_1, …, si_m)
// accumulate the scan-output elements
scan_out_1 = Concat&lt;axis=0&gt;(scan_out_1, so_1); … ; scan_out_k = Concat&lt;axis=0&gt;(scan_out_k, so_k);</p>
</div></blockquote>
<p>}
// accumulate the outputs for this batch:
bst_1[batch] = st_1; …, bst_n[batch] = st_n;
// Note scan-outputs will have size max_sequence_length, but only first N values will be meaningful.
// The remaining values have an undefined value.
b_scan_out_1[batch] = scan_out_1; …; b_scan_out_k[batch] = scan_out_k;</p>
</dd>
</dl>
<p>}
return bst_1, …, bst_n, b_scan_out_1, …, b_scan_out_k;</p>
</div></blockquote>
<p><em>Sample usage: Encoding RNN using a Scan</em></p>
<p>The following example shows how a simple RNN over an input tensor %X, with weight tensor %Wi,
recurrence weight tensor %Ri, bias tensors %Wbi and %Rbi, and initial hidden-state %H_0 can
be encoded as a ScanLoop. Note that the loop-body is a nested graph, and it directly computes
%Wi, %Ri, %Wbi, and %Rbi (typically constants or initializers in the body graph). If these
values are computed in the outer graph, they need to be passed in as extra state_variables.</p>
<blockquote>
<div><dl class="simple">
<dt>graph rnn-encoding {</dt><dd><p>%H_0 = …
%X = …
%Y_h, %Y = Scan[body = &lt;graph rnn-cell-1&gt;, num_scan_inputs=1](“”, %H_0, %X)
return %Y, %Y_h</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>graph rnn-cell-1 (</dt><dd><p>%H_tminus1[FLOAT, tensor]
%X_t[FLOAT, tensor]</p>
</dd>
<dt>) {</dt><dd><p>%Wi = …
%Ri = …
%Wbi = …
%Rbi = …
%t1 = X_t * (Wi^T)
%t2 = H_tminus1*(Ri^T)
%t3 = Add(%t1, %t2)
%t4 = Add(%t3, %Wbi)
%t5 = Add(%t4, %Rbi)
%Ht = Tanh(%t5)
%Accumulate = Identity(%Ht)
return %Ht, %Accumulate</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p><strong>Attributes</strong></p>
<ul class="simple">
<li><p><strong>body</strong> (required):
The graph run each iteration. It has N+M inputs: (loop state
variables…, scan_input_elts…). It has N+K outputs: (loop state
variables…, scan_output_elts…). Each scan_output is created by
concatenating the value of the specified scan_output_elt value at
the end of each iteration of the loop. It is an error if the
dimensions of these values change across loop iterations.</p></li>
<li><p><strong>directions</strong>:
An optional list of M flags. The i-th element of the list specifies
the direction to be scanned for the i-th scan_input tensor: 0
indicates forward direction and 1 indicates reverse direction. If
omitted, all scan_input tensors will be scanned in the forward
direction.</p></li>
<li><p><strong>num_scan_inputs</strong> (required):
An attribute specifying the number of scan_inputs M.</p></li>
</ul>
<p><strong>Inputs</strong></p>
<p>Between 2 and 2147483647 inputs.</p>
<ul class="simple">
<li><p><strong>sequence_lens</strong> (optional, heterogeneous) - <strong>I</strong>:
Optional tensor specifying lengths of the sequences in a batch. If
this input is not specified, all sequences are assumed to be of the
maximum sequence length (the dimension of the sequence axis of the
scan_input tensors).</p></li>
<li><p><strong>initial_state_and_scan_inputs</strong> (variadic) - <strong>V</strong>:
Initial values of the loop’s N state variables followed by M
scan_inputs</p></li>
</ul>
<p><strong>Outputs</strong></p>
<p>Between 1 and 2147483647 outputs.</p>
<ul class="simple">
<li><p><strong>final_state_and_scan_outputs</strong> (variadic) - <strong>V</strong>:
Final values of the loop’s N state variables followed by K
scan_outputs</p></li>
</ul>
<p><strong>Type Constraints</strong></p>
<ul class="simple">
<li><p><strong>I</strong> in (
tensor(int64)
):
Int64 tensor</p></li>
<li><p><strong>V</strong> in (
tensor(bool),
tensor(complex128),
tensor(complex64),
tensor(double),
tensor(float),
tensor(float16),
tensor(int16),
tensor(int32),
tensor(int64),
tensor(int8),
tensor(string),
tensor(uint16),
tensor(uint32),
tensor(uint64),
tensor(uint8)
):
All Tensor types</p></li>
</ul>
</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="onnx__Round.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Round</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="onnx__Scatter.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Scatter</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2022, Xavier Dupré.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>